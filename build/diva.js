/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/build/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/array.prototype.fill/index.js":
/*!****************************************************!*\
  !*** ./node_modules/array.prototype.fill/index.js ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("(function () {\n  if (Array.prototype.fill) return;\n\n  var fill = function (value) {\n    // Steps 1-2.\n    if (this == null) {\n      throw new TypeError(\"this is null or not defined\");\n    }\n\n    var O = Object(this);\n\n    // Steps 3-5.\n    var len = O.length >>> 0;\n\n    // Steps 6-7.\n    var start = arguments[1];\n    var relativeStart = start >> 0;\n\n    // Step 8.\n    var k = relativeStart < 0 ?\n      Math.max(len + relativeStart, 0) :\n      Math.min(relativeStart, len);\n\n    // Steps 9-10.\n    var end = arguments[2];\n    var relativeEnd = end === undefined ?\n      len : end >> 0;\n\n    // Step 11.\n    var last = relativeEnd < 0 ?\n      Math.max(len + relativeEnd, 0) :\n      Math.min(relativeEnd, len);\n\n    // Step 12.\n    while (k < last) {\n      O[k] = value;\n      k++;\n    }\n\n    // Step 13.\n    return O;\n  };\n\n  if (Object.defineProperty) {\n    try {\n      Object.defineProperty(Array.prototype, 'fill', {\n        value: fill,\n        configurable: true,\n        enumerable: false,\n        writable: true\n      });\n    } catch(e) {}\n  }\n\n  if (!Array.prototype.fill) {\n    Array.prototype.fill = fill;\n  }\n})(this);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXJyYXkucHJvdG90eXBlLmZpbGwvaW5kZXguanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXJyYXkucHJvdG90eXBlLmZpbGwvaW5kZXguanM/M2E4YiJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICBpZiAoQXJyYXkucHJvdG90eXBlLmZpbGwpIHJldHVybjtcblxuICB2YXIgZmlsbCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vIFN0ZXBzIDEtMi5cbiAgICBpZiAodGhpcyA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwidGhpcyBpcyBudWxsIG9yIG5vdCBkZWZpbmVkXCIpO1xuICAgIH1cblxuICAgIHZhciBPID0gT2JqZWN0KHRoaXMpO1xuXG4gICAgLy8gU3RlcHMgMy01LlxuICAgIHZhciBsZW4gPSBPLmxlbmd0aCA+Pj4gMDtcblxuICAgIC8vIFN0ZXBzIDYtNy5cbiAgICB2YXIgc3RhcnQgPSBhcmd1bWVudHNbMV07XG4gICAgdmFyIHJlbGF0aXZlU3RhcnQgPSBzdGFydCA+PiAwO1xuXG4gICAgLy8gU3RlcCA4LlxuICAgIHZhciBrID0gcmVsYXRpdmVTdGFydCA8IDAgP1xuICAgICAgTWF0aC5tYXgobGVuICsgcmVsYXRpdmVTdGFydCwgMCkgOlxuICAgICAgTWF0aC5taW4ocmVsYXRpdmVTdGFydCwgbGVuKTtcblxuICAgIC8vIFN0ZXBzIDktMTAuXG4gICAgdmFyIGVuZCA9IGFyZ3VtZW50c1syXTtcbiAgICB2YXIgcmVsYXRpdmVFbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/XG4gICAgICBsZW4gOiBlbmQgPj4gMDtcblxuICAgIC8vIFN0ZXAgMTEuXG4gICAgdmFyIGxhc3QgPSByZWxhdGl2ZUVuZCA8IDAgP1xuICAgICAgTWF0aC5tYXgobGVuICsgcmVsYXRpdmVFbmQsIDApIDpcbiAgICAgIE1hdGgubWluKHJlbGF0aXZlRW5kLCBsZW4pO1xuXG4gICAgLy8gU3RlcCAxMi5cbiAgICB3aGlsZSAoayA8IGxhc3QpIHtcbiAgICAgIE9ba10gPSB2YWx1ZTtcbiAgICAgIGsrKztcbiAgICB9XG5cbiAgICAvLyBTdGVwIDEzLlxuICAgIHJldHVybiBPO1xuICB9O1xuXG4gIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHtcbiAgICB0cnkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2ZpbGwnLCB7XG4gICAgICAgIHZhbHVlOiBmaWxsLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfSBjYXRjaChlKSB7fVxuICB9XG5cbiAgaWYgKCFBcnJheS5wcm90b3R5cGUuZmlsbCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5maWxsID0gZmlsbDtcbiAgfVxufSkodGhpcyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/array.prototype.fill/index.js\n");

/***/ }),

/***/ "./node_modules/debug/node_modules/ms/index.js":
/*!*****************************************************!*\
  !*** ./node_modules/debug/node_modules/ms/index.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\-?\\d?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvZGVidWcvbm9kZV9tb2R1bGVzL21zL2luZGV4LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2RlYnVnL25vZGVfbW9kdWxlcy9tcy9pbmRleC5qcz85MzYzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSGVscGVycy5cbiAqL1xuXG52YXIgcyA9IDEwMDA7XG52YXIgbSA9IHMgKiA2MDtcbnZhciBoID0gbSAqIDYwO1xudmFyIGQgPSBoICogMjQ7XG52YXIgdyA9IGQgKiA3O1xudmFyIHkgPSBkICogMzY1LjI1O1xuXG4vKipcbiAqIFBhcnNlIG9yIGZvcm1hdCB0aGUgZ2l2ZW4gYHZhbGAuXG4gKlxuICogT3B0aW9uczpcbiAqXG4gKiAgLSBgbG9uZ2AgdmVyYm9zZSBmb3JtYXR0aW5nIFtmYWxzZV1cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ3xOdW1iZXJ9IHZhbFxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxuICogQHRocm93cyB7RXJyb3J9IHRocm93IGFuIGVycm9yIGlmIHZhbCBpcyBub3QgYSBub24tZW1wdHkgc3RyaW5nIG9yIGEgbnVtYmVyXG4gKiBAcmV0dXJuIHtTdHJpbmd8TnVtYmVyfVxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHZhbCwgb3B0aW9ucykge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgdmFyIHR5cGUgPSB0eXBlb2YgdmFsO1xuICBpZiAodHlwZSA9PT0gJ3N0cmluZycgJiYgdmFsLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4gcGFyc2UodmFsKTtcbiAgfSBlbHNlIGlmICh0eXBlID09PSAnbnVtYmVyJyAmJiBpc05hTih2YWwpID09PSBmYWxzZSkge1xuICAgIHJldHVybiBvcHRpb25zLmxvbmcgPyBmbXRMb25nKHZhbCkgOiBmbXRTaG9ydCh2YWwpO1xuICB9XG4gIHRocm93IG5ldyBFcnJvcihcbiAgICAndmFsIGlzIG5vdCBhIG5vbi1lbXB0eSBzdHJpbmcgb3IgYSB2YWxpZCBudW1iZXIuIHZhbD0nICtcbiAgICAgIEpTT04uc3RyaW5naWZ5KHZhbClcbiAgKTtcbn07XG5cbi8qKlxuICogUGFyc2UgdGhlIGdpdmVuIGBzdHJgIGFuZCByZXR1cm4gbWlsbGlzZWNvbmRzLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAqIEByZXR1cm4ge051bWJlcn1cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIHBhcnNlKHN0cikge1xuICBzdHIgPSBTdHJpbmcoc3RyKTtcbiAgaWYgKHN0ci5sZW5ndGggPiAxMDApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIG1hdGNoID0gL14oKD86XFxkKyk/XFwtP1xcZD9cXC4/XFxkKykgKihtaWxsaXNlY29uZHM/fG1zZWNzP3xtc3xzZWNvbmRzP3xzZWNzP3xzfG1pbnV0ZXM/fG1pbnM/fG18aG91cnM/fGhycz98aHxkYXlzP3xkfHdlZWtzP3x3fHllYXJzP3x5cnM/fHkpPyQvaS5leGVjKFxuICAgIHN0clxuICApO1xuICBpZiAoIW1hdGNoKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBuID0gcGFyc2VGbG9hdChtYXRjaFsxXSk7XG4gIHZhciB0eXBlID0gKG1hdGNoWzJdIHx8ICdtcycpLnRvTG93ZXJDYXNlKCk7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ3llYXJzJzpcbiAgICBjYXNlICd5ZWFyJzpcbiAgICBjYXNlICd5cnMnOlxuICAgIGNhc2UgJ3lyJzpcbiAgICBjYXNlICd5JzpcbiAgICAgIHJldHVybiBuICogeTtcbiAgICBjYXNlICd3ZWVrcyc6XG4gICAgY2FzZSAnd2Vlayc6XG4gICAgY2FzZSAndyc6XG4gICAgICByZXR1cm4gbiAqIHc7XG4gICAgY2FzZSAnZGF5cyc6XG4gICAgY2FzZSAnZGF5JzpcbiAgICBjYXNlICdkJzpcbiAgICAgIHJldHVybiBuICogZDtcbiAgICBjYXNlICdob3Vycyc6XG4gICAgY2FzZSAnaG91cic6XG4gICAgY2FzZSAnaHJzJzpcbiAgICBjYXNlICdocic6XG4gICAgY2FzZSAnaCc6XG4gICAgICByZXR1cm4gbiAqIGg7XG4gICAgY2FzZSAnbWludXRlcyc6XG4gICAgY2FzZSAnbWludXRlJzpcbiAgICBjYXNlICdtaW5zJzpcbiAgICBjYXNlICdtaW4nOlxuICAgIGNhc2UgJ20nOlxuICAgICAgcmV0dXJuIG4gKiBtO1xuICAgIGNhc2UgJ3NlY29uZHMnOlxuICAgIGNhc2UgJ3NlY29uZCc6XG4gICAgY2FzZSAnc2Vjcyc6XG4gICAgY2FzZSAnc2VjJzpcbiAgICBjYXNlICdzJzpcbiAgICAgIHJldHVybiBuICogcztcbiAgICBjYXNlICdtaWxsaXNlY29uZHMnOlxuICAgIGNhc2UgJ21pbGxpc2Vjb25kJzpcbiAgICBjYXNlICdtc2Vjcyc6XG4gICAgY2FzZSAnbXNlYyc6XG4gICAgY2FzZSAnbXMnOlxuICAgICAgcmV0dXJuIG47XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn1cblxuLyoqXG4gKiBTaG9ydCBmb3JtYXQgZm9yIGBtc2AuXG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IG1zXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBmbXRTaG9ydChtcykge1xuICB2YXIgbXNBYnMgPSBNYXRoLmFicyhtcyk7XG4gIGlmIChtc0FicyA+PSBkKSB7XG4gICAgcmV0dXJuIE1hdGgucm91bmQobXMgLyBkKSArICdkJztcbiAgfVxuICBpZiAobXNBYnMgPj0gaCkge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gaCkgKyAnaCc7XG4gIH1cbiAgaWYgKG1zQWJzID49IG0pIHtcbiAgICByZXR1cm4gTWF0aC5yb3VuZChtcyAvIG0pICsgJ20nO1xuICB9XG4gIGlmIChtc0FicyA+PSBzKSB7XG4gICAgcmV0dXJuIE1hdGgucm91bmQobXMgLyBzKSArICdzJztcbiAgfVxuICByZXR1cm4gbXMgKyAnbXMnO1xufVxuXG4vKipcbiAqIExvbmcgZm9ybWF0IGZvciBgbXNgLlxuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBtc1xuICogQHJldHVybiB7U3RyaW5nfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gZm10TG9uZyhtcykge1xuICB2YXIgbXNBYnMgPSBNYXRoLmFicyhtcyk7XG4gIGlmIChtc0FicyA+PSBkKSB7XG4gICAgcmV0dXJuIHBsdXJhbChtcywgbXNBYnMsIGQsICdkYXknKTtcbiAgfVxuICBpZiAobXNBYnMgPj0gaCkge1xuICAgIHJldHVybiBwbHVyYWwobXMsIG1zQWJzLCBoLCAnaG91cicpO1xuICB9XG4gIGlmIChtc0FicyA+PSBtKSB7XG4gICAgcmV0dXJuIHBsdXJhbChtcywgbXNBYnMsIG0sICdtaW51dGUnKTtcbiAgfVxuICBpZiAobXNBYnMgPj0gcykge1xuICAgIHJldHVybiBwbHVyYWwobXMsIG1zQWJzLCBzLCAnc2Vjb25kJyk7XG4gIH1cbiAgcmV0dXJuIG1zICsgJyBtcyc7XG59XG5cbi8qKlxuICogUGx1cmFsaXphdGlvbiBoZWxwZXIuXG4gKi9cblxuZnVuY3Rpb24gcGx1cmFsKG1zLCBtc0FicywgbiwgbmFtZSkge1xuICB2YXIgaXNQbHVyYWwgPSBtc0FicyA+PSBuICogMS41O1xuICByZXR1cm4gTWF0aC5yb3VuZChtcyAvIG4pICsgJyAnICsgbmFtZSArIChpc1BsdXJhbCA/ICdzJyA6ICcnKTtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/debug/node_modules/ms/index.js\n");

/***/ }),

/***/ "./node_modules/debug/src/browser.js":
/*!*******************************************!*\
  !*** ./node_modules/debug/src/browser.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(process) {\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\n/**\n * Colors.\n */\n\nexports.colors = ['#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC', '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF', '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC', '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF', '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC', '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033', '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366', '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933', '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC', '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF', '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'];\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n// eslint-disable-next-line complexity\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n    return true;\n  } // Internet Explorer and Edge do not support colors.\n\n\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  } // Is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\n\n  return typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || // Is firebug? http://stackoverflow.com/a/398120/376773\n  typeof window !== 'undefined' && window.console && (window.console.firebug || window.console.exception && window.console.table) || // Is firefox >= v31?\n  // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n  typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31 || // Double check webkit in userAgent just in case we are in a worker\n  typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/);\n}\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\n\nfunction formatArgs(args) {\n  args[0] = (this.useColors ? '%c' : '') + this.namespace + (this.useColors ? ' %c' : ' ') + args[0] + (this.useColors ? '%c ' : ' ') + '+' + module.exports.humanize(this.diff);\n\n  if (!this.useColors) {\n    return;\n  }\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit'); // The final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function (match) {\n    if (match === '%%') {\n      return;\n    }\n\n    index++;\n\n    if (match === '%c') {\n      // We only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n  args.splice(lastC, 0, c);\n}\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\n\nfunction log() {\n  var _console;\n\n  // This hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return (typeof console === \"undefined\" ? \"undefined\" : _typeof(console)) === 'object' && console.log && (_console = console).log.apply(_console, arguments);\n}\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\n\nfunction save(namespaces) {\n  try {\n    if (namespaces) {\n      exports.storage.setItem('debug', namespaces);\n    } else {\n      exports.storage.removeItem('debug');\n    }\n  } catch (error) {// Swallow\n    // XXX (@Qix-) should we be logging these?\n  }\n}\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\n\nfunction load() {\n  var r;\n\n  try {\n    r = exports.storage.getItem('debug');\n  } catch (error) {} // Swallow\n  // XXX (@Qix-) should we be logging these?\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\n\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\n\nfunction localstorage() {\n  try {\n    // TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n    // The Browser also has localStorage in the global context.\n    return localStorage;\n  } catch (error) {// Swallow\n    // XXX (@Qix-) should we be logging these?\n  }\n}\n\nmodule.exports = __webpack_require__(/*! ./common */ \"./node_modules/debug/src/common.js\")(exports);\nvar formatters = module.exports.formatters;\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n  try {\n    return JSON.stringify(v);\n  } catch (error) {\n    return '[UnexpectedJSONParseError]: ' + error.message;\n  }\n};\n\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../process/browser.js */ \"./node_modules/process/browser.js\")))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvZGVidWcvc3JjL2Jyb3dzZXIuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvZGVidWcvc3JjL2Jyb3dzZXIuanM/MzRlYiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH1cblxuLyogZXNsaW50LWVudiBicm93c2VyICovXG5cbi8qKlxuICogVGhpcyBpcyB0aGUgd2ViIGJyb3dzZXIgaW1wbGVtZW50YXRpb24gb2YgYGRlYnVnKClgLlxuICovXG5leHBvcnRzLmxvZyA9IGxvZztcbmV4cG9ydHMuZm9ybWF0QXJncyA9IGZvcm1hdEFyZ3M7XG5leHBvcnRzLnNhdmUgPSBzYXZlO1xuZXhwb3J0cy5sb2FkID0gbG9hZDtcbmV4cG9ydHMudXNlQ29sb3JzID0gdXNlQ29sb3JzO1xuZXhwb3J0cy5zdG9yYWdlID0gbG9jYWxzdG9yYWdlKCk7XG4vKipcbiAqIENvbG9ycy5cbiAqL1xuXG5leHBvcnRzLmNvbG9ycyA9IFsnIzAwMDBDQycsICcjMDAwMEZGJywgJyMwMDMzQ0MnLCAnIzAwMzNGRicsICcjMDA2NkNDJywgJyMwMDY2RkYnLCAnIzAwOTlDQycsICcjMDA5OUZGJywgJyMwMENDMDAnLCAnIzAwQ0MzMycsICcjMDBDQzY2JywgJyMwMENDOTknLCAnIzAwQ0NDQycsICcjMDBDQ0ZGJywgJyMzMzAwQ0MnLCAnIzMzMDBGRicsICcjMzMzM0NDJywgJyMzMzMzRkYnLCAnIzMzNjZDQycsICcjMzM2NkZGJywgJyMzMzk5Q0MnLCAnIzMzOTlGRicsICcjMzNDQzAwJywgJyMzM0NDMzMnLCAnIzMzQ0M2NicsICcjMzNDQzk5JywgJyMzM0NDQ0MnLCAnIzMzQ0NGRicsICcjNjYwMENDJywgJyM2NjAwRkYnLCAnIzY2MzNDQycsICcjNjYzM0ZGJywgJyM2NkNDMDAnLCAnIzY2Q0MzMycsICcjOTkwMENDJywgJyM5OTAwRkYnLCAnIzk5MzNDQycsICcjOTkzM0ZGJywgJyM5OUNDMDAnLCAnIzk5Q0MzMycsICcjQ0MwMDAwJywgJyNDQzAwMzMnLCAnI0NDMDA2NicsICcjQ0MwMDk5JywgJyNDQzAwQ0MnLCAnI0NDMDBGRicsICcjQ0MzMzAwJywgJyNDQzMzMzMnLCAnI0NDMzM2NicsICcjQ0MzMzk5JywgJyNDQzMzQ0MnLCAnI0NDMzNGRicsICcjQ0M2NjAwJywgJyNDQzY2MzMnLCAnI0NDOTkwMCcsICcjQ0M5OTMzJywgJyNDQ0NDMDAnLCAnI0NDQ0MzMycsICcjRkYwMDAwJywgJyNGRjAwMzMnLCAnI0ZGMDA2NicsICcjRkYwMDk5JywgJyNGRjAwQ0MnLCAnI0ZGMDBGRicsICcjRkYzMzAwJywgJyNGRjMzMzMnLCAnI0ZGMzM2NicsICcjRkYzMzk5JywgJyNGRjMzQ0MnLCAnI0ZGMzNGRicsICcjRkY2NjAwJywgJyNGRjY2MzMnLCAnI0ZGOTkwMCcsICcjRkY5OTMzJywgJyNGRkNDMDAnLCAnI0ZGQ0MzMyddO1xuLyoqXG4gKiBDdXJyZW50bHkgb25seSBXZWJLaXQtYmFzZWQgV2ViIEluc3BlY3RvcnMsIEZpcmVmb3ggPj0gdjMxLFxuICogYW5kIHRoZSBGaXJlYnVnIGV4dGVuc2lvbiAoYW55IEZpcmVmb3ggdmVyc2lvbikgYXJlIGtub3duXG4gKiB0byBzdXBwb3J0IFwiJWNcIiBDU1MgY3VzdG9taXphdGlvbnMuXG4gKlxuICogVE9ETzogYWRkIGEgYGxvY2FsU3RvcmFnZWAgdmFyaWFibGUgdG8gZXhwbGljaXRseSBlbmFibGUvZGlzYWJsZSBjb2xvcnNcbiAqL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbXBsZXhpdHlcblxuZnVuY3Rpb24gdXNlQ29sb3JzKCkge1xuICAvLyBOQjogSW4gYW4gRWxlY3Ryb24gcHJlbG9hZCBzY3JpcHQsIGRvY3VtZW50IHdpbGwgYmUgZGVmaW5lZCBidXQgbm90IGZ1bGx5XG4gIC8vIGluaXRpYWxpemVkLiBTaW5jZSB3ZSBrbm93IHdlJ3JlIGluIENocm9tZSwgd2UnbGwganVzdCBkZXRlY3QgdGhpcyBjYXNlXG4gIC8vIGV4cGxpY2l0bHlcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wcm9jZXNzICYmICh3aW5kb3cucHJvY2Vzcy50eXBlID09PSAncmVuZGVyZXInIHx8IHdpbmRvdy5wcm9jZXNzLl9fbndqcykpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSAvLyBJbnRlcm5ldCBFeHBsb3JlciBhbmQgRWRnZSBkbyBub3Qgc3VwcG9ydCBjb2xvcnMuXG5cblxuICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudCAmJiBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goLyhlZGdlfHRyaWRlbnQpXFwvKFxcZCspLykpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gLy8gSXMgd2Via2l0PyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNjQ1OTYwNi8zNzY3NzNcbiAgLy8gZG9jdW1lbnQgaXMgdW5kZWZpbmVkIGluIHJlYWN0LW5hdGl2ZTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0LW5hdGl2ZS9wdWxsLzE2MzJcblxuXG4gIHJldHVybiB0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLldlYmtpdEFwcGVhcmFuY2UgfHwgLy8gSXMgZmlyZWJ1Zz8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMzk4MTIwLzM3Njc3M1xuICB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuY29uc29sZSAmJiAod2luZG93LmNvbnNvbGUuZmlyZWJ1ZyB8fCB3aW5kb3cuY29uc29sZS5leGNlcHRpb24gJiYgd2luZG93LmNvbnNvbGUudGFibGUpIHx8IC8vIElzIGZpcmVmb3ggPj0gdjMxP1xuICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1Rvb2xzL1dlYl9Db25zb2xlI1N0eWxpbmdfbWVzc2FnZXNcbiAgdHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudCAmJiBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL2ZpcmVmb3hcXC8oXFxkKykvKSAmJiBwYXJzZUludChSZWdFeHAuJDEsIDEwKSA+PSAzMSB8fCAvLyBEb3VibGUgY2hlY2sgd2Via2l0IGluIHVzZXJBZ2VudCBqdXN0IGluIGNhc2Ugd2UgYXJlIGluIGEgd29ya2VyXG4gIHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci51c2VyQWdlbnQgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9hcHBsZXdlYmtpdFxcLyhcXGQrKS8pO1xufVxuLyoqXG4gKiBDb2xvcml6ZSBsb2cgYXJndW1lbnRzIGlmIGVuYWJsZWQuXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5cbmZ1bmN0aW9uIGZvcm1hdEFyZ3MoYXJncykge1xuICBhcmdzWzBdID0gKHRoaXMudXNlQ29sb3JzID8gJyVjJyA6ICcnKSArIHRoaXMubmFtZXNwYWNlICsgKHRoaXMudXNlQ29sb3JzID8gJyAlYycgOiAnICcpICsgYXJnc1swXSArICh0aGlzLnVzZUNvbG9ycyA/ICclYyAnIDogJyAnKSArICcrJyArIG1vZHVsZS5leHBvcnRzLmh1bWFuaXplKHRoaXMuZGlmZik7XG5cbiAgaWYgKCF0aGlzLnVzZUNvbG9ycykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBjID0gJ2NvbG9yOiAnICsgdGhpcy5jb2xvcjtcbiAgYXJncy5zcGxpY2UoMSwgMCwgYywgJ2NvbG9yOiBpbmhlcml0Jyk7IC8vIFRoZSBmaW5hbCBcIiVjXCIgaXMgc29tZXdoYXQgdHJpY2t5LCBiZWNhdXNlIHRoZXJlIGNvdWxkIGJlIG90aGVyXG4gIC8vIGFyZ3VtZW50cyBwYXNzZWQgZWl0aGVyIGJlZm9yZSBvciBhZnRlciB0aGUgJWMsIHNvIHdlIG5lZWQgdG9cbiAgLy8gZmlndXJlIG91dCB0aGUgY29ycmVjdCBpbmRleCB0byBpbnNlcnQgdGhlIENTUyBpbnRvXG5cbiAgdmFyIGluZGV4ID0gMDtcbiAgdmFyIGxhc3RDID0gMDtcbiAgYXJnc1swXS5yZXBsYWNlKC8lW2EtekEtWiVdL2csIGZ1bmN0aW9uIChtYXRjaCkge1xuICAgIGlmIChtYXRjaCA9PT0gJyUlJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGluZGV4Kys7XG5cbiAgICBpZiAobWF0Y2ggPT09ICclYycpIHtcbiAgICAgIC8vIFdlIG9ubHkgYXJlIGludGVyZXN0ZWQgaW4gdGhlICpsYXN0KiAlY1xuICAgICAgLy8gKHRoZSB1c2VyIG1heSBoYXZlIHByb3ZpZGVkIHRoZWlyIG93bilcbiAgICAgIGxhc3RDID0gaW5kZXg7XG4gICAgfVxuICB9KTtcbiAgYXJncy5zcGxpY2UobGFzdEMsIDAsIGMpO1xufVxuLyoqXG4gKiBJbnZva2VzIGBjb25zb2xlLmxvZygpYCB3aGVuIGF2YWlsYWJsZS5cbiAqIE5vLW9wIHdoZW4gYGNvbnNvbGUubG9nYCBpcyBub3QgYSBcImZ1bmN0aW9uXCIuXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5cbmZ1bmN0aW9uIGxvZygpIHtcbiAgdmFyIF9jb25zb2xlO1xuXG4gIC8vIFRoaXMgaGFja2VyeSBpcyByZXF1aXJlZCBmb3IgSUU4LzksIHdoZXJlXG4gIC8vIHRoZSBgY29uc29sZS5sb2dgIGZ1bmN0aW9uIGRvZXNuJ3QgaGF2ZSAnYXBwbHknXG4gIHJldHVybiAodHlwZW9mIGNvbnNvbGUgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihjb25zb2xlKSkgPT09ICdvYmplY3QnICYmIGNvbnNvbGUubG9nICYmIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgYXJndW1lbnRzKTtcbn1cbi8qKlxuICogU2F2ZSBgbmFtZXNwYWNlc2AuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZXNcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cblxuZnVuY3Rpb24gc2F2ZShuYW1lc3BhY2VzKSB7XG4gIHRyeSB7XG4gICAgaWYgKG5hbWVzcGFjZXMpIHtcbiAgICAgIGV4cG9ydHMuc3RvcmFnZS5zZXRJdGVtKCdkZWJ1ZycsIG5hbWVzcGFjZXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBleHBvcnRzLnN0b3JhZ2UucmVtb3ZlSXRlbSgnZGVidWcnKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7Ly8gU3dhbGxvd1xuICAgIC8vIFhYWCAoQFFpeC0pIHNob3VsZCB3ZSBiZSBsb2dnaW5nIHRoZXNlP1xuICB9XG59XG4vKipcbiAqIExvYWQgYG5hbWVzcGFjZXNgLlxuICpcbiAqIEByZXR1cm4ge1N0cmluZ30gcmV0dXJucyB0aGUgcHJldmlvdXNseSBwZXJzaXN0ZWQgZGVidWcgbW9kZXNcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cblxuZnVuY3Rpb24gbG9hZCgpIHtcbiAgdmFyIHI7XG5cbiAgdHJ5IHtcbiAgICByID0gZXhwb3J0cy5zdG9yYWdlLmdldEl0ZW0oJ2RlYnVnJyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7fSAvLyBTd2FsbG93XG4gIC8vIFhYWCAoQFFpeC0pIHNob3VsZCB3ZSBiZSBsb2dnaW5nIHRoZXNlP1xuICAvLyBJZiBkZWJ1ZyBpc24ndCBzZXQgaW4gTFMsIGFuZCB3ZSdyZSBpbiBFbGVjdHJvbiwgdHJ5IHRvIGxvYWQgJERFQlVHXG5cblxuICBpZiAoIXIgJiYgdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmICdlbnYnIGluIHByb2Nlc3MpIHtcbiAgICByID0gcHJvY2Vzcy5lbnYuREVCVUc7XG4gIH1cblxuICByZXR1cm4gcjtcbn1cbi8qKlxuICogTG9jYWxzdG9yYWdlIGF0dGVtcHRzIHRvIHJldHVybiB0aGUgbG9jYWxzdG9yYWdlLlxuICpcbiAqIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugc2FmYXJpIHRocm93c1xuICogd2hlbiBhIHVzZXIgZGlzYWJsZXMgY29va2llcy9sb2NhbHN0b3JhZ2VcbiAqIGFuZCB5b3UgYXR0ZW1wdCB0byBhY2Nlc3MgaXQuXG4gKlxuICogQHJldHVybiB7TG9jYWxTdG9yYWdlfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuXG5mdW5jdGlvbiBsb2NhbHN0b3JhZ2UoKSB7XG4gIHRyeSB7XG4gICAgLy8gVFZNTEtpdCAoQXBwbGUgVFYgSlMgUnVudGltZSkgZG9lcyBub3QgaGF2ZSBhIHdpbmRvdyBvYmplY3QsIGp1c3QgbG9jYWxTdG9yYWdlIGluIHRoZSBnbG9iYWwgY29udGV4dFxuICAgIC8vIFRoZSBCcm93c2VyIGFsc28gaGFzIGxvY2FsU3RvcmFnZSBpbiB0aGUgZ2xvYmFsIGNvbnRleHQuXG4gICAgcmV0dXJuIGxvY2FsU3RvcmFnZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHsvLyBTd2FsbG93XG4gICAgLy8gWFhYIChAUWl4LSkgc2hvdWxkIHdlIGJlIGxvZ2dpbmcgdGhlc2U/XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2NvbW1vbicpKGV4cG9ydHMpO1xudmFyIGZvcm1hdHRlcnMgPSBtb2R1bGUuZXhwb3J0cy5mb3JtYXR0ZXJzO1xuLyoqXG4gKiBNYXAgJWogdG8gYEpTT04uc3RyaW5naWZ5KClgLCBzaW5jZSBubyBXZWIgSW5zcGVjdG9ycyBkbyB0aGF0IGJ5IGRlZmF1bHQuXG4gKi9cblxuZm9ybWF0dGVycy5qID0gZnVuY3Rpb24gKHYpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodik7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuICdbVW5leHBlY3RlZEpTT05QYXJzZUVycm9yXTogJyArIGVycm9yLm1lc3NhZ2U7XG4gIH1cbn07XG5cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/debug/src/browser.js\n");

/***/ }),

/***/ "./node_modules/debug/src/common.js":
/*!******************************************!*\
  !*** ./node_modules/debug/src/common.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\nfunction setup(env) {\n  createDebug.debug = createDebug;\n  createDebug.default = createDebug;\n  createDebug.coerce = coerce;\n  createDebug.disable = disable;\n  createDebug.enable = enable;\n  createDebug.enabled = enabled;\n  createDebug.humanize = __webpack_require__(/*! ms */ \"./node_modules/debug/node_modules/ms/index.js\");\n  Object.keys(env).forEach(function (key) {\n    createDebug[key] = env[key];\n  });\n  /**\n  * Active `debug` instances.\n  */\n\n  createDebug.instances = [];\n  /**\n  * The currently active debug mode names, and names to skip.\n  */\n\n  createDebug.names = [];\n  createDebug.skips = [];\n  /**\n  * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n  *\n  * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n  */\n\n  createDebug.formatters = {};\n  /**\n  * Selects a color for a debug namespace\n  * @param {String} namespace The namespace string for the for the debug instance to be colored\n  * @return {Number|String} An ANSI color code for the given namespace\n  * @api private\n  */\n\n  function selectColor(namespace) {\n    var hash = 0;\n\n    for (var i = 0; i < namespace.length; i++) {\n      hash = (hash << 5) - hash + namespace.charCodeAt(i);\n      hash |= 0; // Convert to 32bit integer\n    }\n\n    return createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n  }\n\n  createDebug.selectColor = selectColor;\n  /**\n  * Create a debugger with the given `namespace`.\n  *\n  * @param {String} namespace\n  * @return {Function}\n  * @api public\n  */\n\n  function createDebug(namespace) {\n    var prevTime;\n\n    function debug() {\n      // Disabled?\n      if (!debug.enabled) {\n        return;\n      }\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      var self = debug; // Set `diff` timestamp\n\n      var curr = Number(new Date());\n      var ms = curr - (prevTime || curr);\n      self.diff = ms;\n      self.prev = prevTime;\n      self.curr = curr;\n      prevTime = curr;\n      args[0] = createDebug.coerce(args[0]);\n\n      if (typeof args[0] !== 'string') {\n        // Anything else let's inspect with %O\n        args.unshift('%O');\n      } // Apply any `formatters` transformations\n\n\n      var index = 0;\n      args[0] = args[0].replace(/%([a-zA-Z%])/g, function (match, format) {\n        // If we encounter an escaped % then don't increase the array index\n        if (match === '%%') {\n          return match;\n        }\n\n        index++;\n        var formatter = createDebug.formatters[format];\n\n        if (typeof formatter === 'function') {\n          var val = args[index];\n          match = formatter.call(self, val); // Now we need to remove `args[index]` since it's inlined in the `format`\n\n          args.splice(index, 1);\n          index--;\n        }\n\n        return match;\n      }); // Apply env-specific formatting (colors, etc.)\n\n      createDebug.formatArgs.call(self, args);\n      var logFn = self.log || createDebug.log;\n      logFn.apply(self, args);\n    }\n\n    debug.namespace = namespace;\n    debug.enabled = createDebug.enabled(namespace);\n    debug.useColors = createDebug.useColors();\n    debug.color = selectColor(namespace);\n    debug.destroy = destroy;\n    debug.extend = extend; // Debug.formatArgs = formatArgs;\n    // debug.rawLog = rawLog;\n    // env-specific initialization logic for debug instances\n\n    if (typeof createDebug.init === 'function') {\n      createDebug.init(debug);\n    }\n\n    createDebug.instances.push(debug);\n    return debug;\n  }\n\n  function destroy() {\n    var index = createDebug.instances.indexOf(this);\n\n    if (index !== -1) {\n      createDebug.instances.splice(index, 1);\n      return true;\n    }\n\n    return false;\n  }\n\n  function extend(namespace, delimiter) {\n    return createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n  }\n  /**\n  * Enables a debug mode by namespaces. This can include modes\n  * separated by a colon and wildcards.\n  *\n  * @param {String} namespaces\n  * @api public\n  */\n\n\n  function enable(namespaces) {\n    createDebug.save(namespaces);\n    createDebug.names = [];\n    createDebug.skips = [];\n    var i;\n    var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n    var len = split.length;\n\n    for (i = 0; i < len; i++) {\n      if (!split[i]) {\n        // ignore empty strings\n        continue;\n      }\n\n      namespaces = split[i].replace(/\\*/g, '.*?');\n\n      if (namespaces[0] === '-') {\n        createDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n      } else {\n        createDebug.names.push(new RegExp('^' + namespaces + '$'));\n      }\n    }\n\n    for (i = 0; i < createDebug.instances.length; i++) {\n      var instance = createDebug.instances[i];\n      instance.enabled = createDebug.enabled(instance.namespace);\n    }\n  }\n  /**\n  * Disable debug output.\n  *\n  * @api public\n  */\n\n\n  function disable() {\n    createDebug.enable('');\n  }\n  /**\n  * Returns true if the given mode name is enabled, false otherwise.\n  *\n  * @param {String} name\n  * @return {Boolean}\n  * @api public\n  */\n\n\n  function enabled(name) {\n    if (name[name.length - 1] === '*') {\n      return true;\n    }\n\n    var i;\n    var len;\n\n    for (i = 0, len = createDebug.skips.length; i < len; i++) {\n      if (createDebug.skips[i].test(name)) {\n        return false;\n      }\n    }\n\n    for (i = 0, len = createDebug.names.length; i < len; i++) {\n      if (createDebug.names[i].test(name)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n  /**\n  * Coerce `val`.\n  *\n  * @param {Mixed} val\n  * @return {Mixed}\n  * @api private\n  */\n\n\n  function coerce(val) {\n    if (val instanceof Error) {\n      return val.stack || val.message;\n    }\n\n    return val;\n  }\n\n  createDebug.enable(createDebug.load());\n  return createDebug;\n}\n\nmodule.exports = setup;\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvZGVidWcvc3JjL2NvbW1vbi5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9kZWJ1Zy9zcmMvY29tbW9uLmpzP2RjOTAiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogVGhpcyBpcyB0aGUgY29tbW9uIGxvZ2ljIGZvciBib3RoIHRoZSBOb2RlLmpzIGFuZCB3ZWIgYnJvd3NlclxuICogaW1wbGVtZW50YXRpb25zIG9mIGBkZWJ1ZygpYC5cbiAqL1xuZnVuY3Rpb24gc2V0dXAoZW52KSB7XG4gIGNyZWF0ZURlYnVnLmRlYnVnID0gY3JlYXRlRGVidWc7XG4gIGNyZWF0ZURlYnVnLmRlZmF1bHQgPSBjcmVhdGVEZWJ1ZztcbiAgY3JlYXRlRGVidWcuY29lcmNlID0gY29lcmNlO1xuICBjcmVhdGVEZWJ1Zy5kaXNhYmxlID0gZGlzYWJsZTtcbiAgY3JlYXRlRGVidWcuZW5hYmxlID0gZW5hYmxlO1xuICBjcmVhdGVEZWJ1Zy5lbmFibGVkID0gZW5hYmxlZDtcbiAgY3JlYXRlRGVidWcuaHVtYW5pemUgPSByZXF1aXJlKCdtcycpO1xuICBPYmplY3Qua2V5cyhlbnYpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIGNyZWF0ZURlYnVnW2tleV0gPSBlbnZba2V5XTtcbiAgfSk7XG4gIC8qKlxuICAqIEFjdGl2ZSBgZGVidWdgIGluc3RhbmNlcy5cbiAgKi9cblxuICBjcmVhdGVEZWJ1Zy5pbnN0YW5jZXMgPSBbXTtcbiAgLyoqXG4gICogVGhlIGN1cnJlbnRseSBhY3RpdmUgZGVidWcgbW9kZSBuYW1lcywgYW5kIG5hbWVzIHRvIHNraXAuXG4gICovXG5cbiAgY3JlYXRlRGVidWcubmFtZXMgPSBbXTtcbiAgY3JlYXRlRGVidWcuc2tpcHMgPSBbXTtcbiAgLyoqXG4gICogTWFwIG9mIHNwZWNpYWwgXCIlblwiIGhhbmRsaW5nIGZ1bmN0aW9ucywgZm9yIHRoZSBkZWJ1ZyBcImZvcm1hdFwiIGFyZ3VtZW50LlxuICAqXG4gICogVmFsaWQga2V5IG5hbWVzIGFyZSBhIHNpbmdsZSwgbG93ZXIgb3IgdXBwZXItY2FzZSBsZXR0ZXIsIGkuZS4gXCJuXCIgYW5kIFwiTlwiLlxuICAqL1xuXG4gIGNyZWF0ZURlYnVnLmZvcm1hdHRlcnMgPSB7fTtcbiAgLyoqXG4gICogU2VsZWN0cyBhIGNvbG9yIGZvciBhIGRlYnVnIG5hbWVzcGFjZVxuICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lc3BhY2UgVGhlIG5hbWVzcGFjZSBzdHJpbmcgZm9yIHRoZSBmb3IgdGhlIGRlYnVnIGluc3RhbmNlIHRvIGJlIGNvbG9yZWRcbiAgKiBAcmV0dXJuIHtOdW1iZXJ8U3RyaW5nfSBBbiBBTlNJIGNvbG9yIGNvZGUgZm9yIHRoZSBnaXZlbiBuYW1lc3BhY2VcbiAgKiBAYXBpIHByaXZhdGVcbiAgKi9cblxuICBmdW5jdGlvbiBzZWxlY3RDb2xvcihuYW1lc3BhY2UpIHtcbiAgICB2YXIgaGFzaCA9IDA7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5hbWVzcGFjZS5sZW5ndGg7IGkrKykge1xuICAgICAgaGFzaCA9IChoYXNoIDw8IDUpIC0gaGFzaCArIG5hbWVzcGFjZS5jaGFyQ29kZUF0KGkpO1xuICAgICAgaGFzaCB8PSAwOyAvLyBDb252ZXJ0IHRvIDMyYml0IGludGVnZXJcbiAgICB9XG5cbiAgICByZXR1cm4gY3JlYXRlRGVidWcuY29sb3JzW01hdGguYWJzKGhhc2gpICUgY3JlYXRlRGVidWcuY29sb3JzLmxlbmd0aF07XG4gIH1cblxuICBjcmVhdGVEZWJ1Zy5zZWxlY3RDb2xvciA9IHNlbGVjdENvbG9yO1xuICAvKipcbiAgKiBDcmVhdGUgYSBkZWJ1Z2dlciB3aXRoIHRoZSBnaXZlbiBgbmFtZXNwYWNlYC5cbiAgKlxuICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lc3BhY2VcbiAgKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAgKiBAYXBpIHB1YmxpY1xuICAqL1xuXG4gIGZ1bmN0aW9uIGNyZWF0ZURlYnVnKG5hbWVzcGFjZSkge1xuICAgIHZhciBwcmV2VGltZTtcblxuICAgIGZ1bmN0aW9uIGRlYnVnKCkge1xuICAgICAgLy8gRGlzYWJsZWQ/XG4gICAgICBpZiAoIWRlYnVnLmVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICAgIH1cblxuICAgICAgdmFyIHNlbGYgPSBkZWJ1ZzsgLy8gU2V0IGBkaWZmYCB0aW1lc3RhbXBcblxuICAgICAgdmFyIGN1cnIgPSBOdW1iZXIobmV3IERhdGUoKSk7XG4gICAgICB2YXIgbXMgPSBjdXJyIC0gKHByZXZUaW1lIHx8IGN1cnIpO1xuICAgICAgc2VsZi5kaWZmID0gbXM7XG4gICAgICBzZWxmLnByZXYgPSBwcmV2VGltZTtcbiAgICAgIHNlbGYuY3VyciA9IGN1cnI7XG4gICAgICBwcmV2VGltZSA9IGN1cnI7XG4gICAgICBhcmdzWzBdID0gY3JlYXRlRGVidWcuY29lcmNlKGFyZ3NbMF0pO1xuXG4gICAgICBpZiAodHlwZW9mIGFyZ3NbMF0gIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIC8vIEFueXRoaW5nIGVsc2UgbGV0J3MgaW5zcGVjdCB3aXRoICVPXG4gICAgICAgIGFyZ3MudW5zaGlmdCgnJU8nKTtcbiAgICAgIH0gLy8gQXBwbHkgYW55IGBmb3JtYXR0ZXJzYCB0cmFuc2Zvcm1hdGlvbnNcblxuXG4gICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgYXJnc1swXSA9IGFyZ3NbMF0ucmVwbGFjZSgvJShbYS16QS1aJV0pL2csIGZ1bmN0aW9uIChtYXRjaCwgZm9ybWF0KSB7XG4gICAgICAgIC8vIElmIHdlIGVuY291bnRlciBhbiBlc2NhcGVkICUgdGhlbiBkb24ndCBpbmNyZWFzZSB0aGUgYXJyYXkgaW5kZXhcbiAgICAgICAgaWYgKG1hdGNoID09PSAnJSUnKSB7XG4gICAgICAgICAgcmV0dXJuIG1hdGNoO1xuICAgICAgICB9XG5cbiAgICAgICAgaW5kZXgrKztcbiAgICAgICAgdmFyIGZvcm1hdHRlciA9IGNyZWF0ZURlYnVnLmZvcm1hdHRlcnNbZm9ybWF0XTtcblxuICAgICAgICBpZiAodHlwZW9mIGZvcm1hdHRlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHZhciB2YWwgPSBhcmdzW2luZGV4XTtcbiAgICAgICAgICBtYXRjaCA9IGZvcm1hdHRlci5jYWxsKHNlbGYsIHZhbCk7IC8vIE5vdyB3ZSBuZWVkIHRvIHJlbW92ZSBgYXJnc1tpbmRleF1gIHNpbmNlIGl0J3MgaW5saW5lZCBpbiB0aGUgYGZvcm1hdGBcblxuICAgICAgICAgIGFyZ3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICBpbmRleC0tO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1hdGNoO1xuICAgICAgfSk7IC8vIEFwcGx5IGVudi1zcGVjaWZpYyBmb3JtYXR0aW5nIChjb2xvcnMsIGV0Yy4pXG5cbiAgICAgIGNyZWF0ZURlYnVnLmZvcm1hdEFyZ3MuY2FsbChzZWxmLCBhcmdzKTtcbiAgICAgIHZhciBsb2dGbiA9IHNlbGYubG9nIHx8IGNyZWF0ZURlYnVnLmxvZztcbiAgICAgIGxvZ0ZuLmFwcGx5KHNlbGYsIGFyZ3MpO1xuICAgIH1cblxuICAgIGRlYnVnLm5hbWVzcGFjZSA9IG5hbWVzcGFjZTtcbiAgICBkZWJ1Zy5lbmFibGVkID0gY3JlYXRlRGVidWcuZW5hYmxlZChuYW1lc3BhY2UpO1xuICAgIGRlYnVnLnVzZUNvbG9ycyA9IGNyZWF0ZURlYnVnLnVzZUNvbG9ycygpO1xuICAgIGRlYnVnLmNvbG9yID0gc2VsZWN0Q29sb3IobmFtZXNwYWNlKTtcbiAgICBkZWJ1Zy5kZXN0cm95ID0gZGVzdHJveTtcbiAgICBkZWJ1Zy5leHRlbmQgPSBleHRlbmQ7IC8vIERlYnVnLmZvcm1hdEFyZ3MgPSBmb3JtYXRBcmdzO1xuICAgIC8vIGRlYnVnLnJhd0xvZyA9IHJhd0xvZztcbiAgICAvLyBlbnYtc3BlY2lmaWMgaW5pdGlhbGl6YXRpb24gbG9naWMgZm9yIGRlYnVnIGluc3RhbmNlc1xuXG4gICAgaWYgKHR5cGVvZiBjcmVhdGVEZWJ1Zy5pbml0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjcmVhdGVEZWJ1Zy5pbml0KGRlYnVnKTtcbiAgICB9XG5cbiAgICBjcmVhdGVEZWJ1Zy5pbnN0YW5jZXMucHVzaChkZWJ1Zyk7XG4gICAgcmV0dXJuIGRlYnVnO1xuICB9XG5cbiAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICB2YXIgaW5kZXggPSBjcmVhdGVEZWJ1Zy5pbnN0YW5jZXMuaW5kZXhPZih0aGlzKTtcblxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIGNyZWF0ZURlYnVnLmluc3RhbmNlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gZXh0ZW5kKG5hbWVzcGFjZSwgZGVsaW1pdGVyKSB7XG4gICAgcmV0dXJuIGNyZWF0ZURlYnVnKHRoaXMubmFtZXNwYWNlICsgKHR5cGVvZiBkZWxpbWl0ZXIgPT09ICd1bmRlZmluZWQnID8gJzonIDogZGVsaW1pdGVyKSArIG5hbWVzcGFjZSk7XG4gIH1cbiAgLyoqXG4gICogRW5hYmxlcyBhIGRlYnVnIG1vZGUgYnkgbmFtZXNwYWNlcy4gVGhpcyBjYW4gaW5jbHVkZSBtb2Rlc1xuICAqIHNlcGFyYXRlZCBieSBhIGNvbG9uIGFuZCB3aWxkY2FyZHMuXG4gICpcbiAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlc1xuICAqIEBhcGkgcHVibGljXG4gICovXG5cblxuICBmdW5jdGlvbiBlbmFibGUobmFtZXNwYWNlcykge1xuICAgIGNyZWF0ZURlYnVnLnNhdmUobmFtZXNwYWNlcyk7XG4gICAgY3JlYXRlRGVidWcubmFtZXMgPSBbXTtcbiAgICBjcmVhdGVEZWJ1Zy5za2lwcyA9IFtdO1xuICAgIHZhciBpO1xuICAgIHZhciBzcGxpdCA9ICh0eXBlb2YgbmFtZXNwYWNlcyA9PT0gJ3N0cmluZycgPyBuYW1lc3BhY2VzIDogJycpLnNwbGl0KC9bXFxzLF0rLyk7XG4gICAgdmFyIGxlbiA9IHNwbGl0Lmxlbmd0aDtcblxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgaWYgKCFzcGxpdFtpXSkge1xuICAgICAgICAvLyBpZ25vcmUgZW1wdHkgc3RyaW5nc1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgbmFtZXNwYWNlcyA9IHNwbGl0W2ldLnJlcGxhY2UoL1xcKi9nLCAnLio/Jyk7XG5cbiAgICAgIGlmIChuYW1lc3BhY2VzWzBdID09PSAnLScpIHtcbiAgICAgICAgY3JlYXRlRGVidWcuc2tpcHMucHVzaChuZXcgUmVnRXhwKCdeJyArIG5hbWVzcGFjZXMuc3Vic3RyKDEpICsgJyQnKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjcmVhdGVEZWJ1Zy5uYW1lcy5wdXNoKG5ldyBSZWdFeHAoJ14nICsgbmFtZXNwYWNlcyArICckJykpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCBjcmVhdGVEZWJ1Zy5pbnN0YW5jZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBpbnN0YW5jZSA9IGNyZWF0ZURlYnVnLmluc3RhbmNlc1tpXTtcbiAgICAgIGluc3RhbmNlLmVuYWJsZWQgPSBjcmVhdGVEZWJ1Zy5lbmFibGVkKGluc3RhbmNlLm5hbWVzcGFjZSk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAqIERpc2FibGUgZGVidWcgb3V0cHV0LlxuICAqXG4gICogQGFwaSBwdWJsaWNcbiAgKi9cblxuXG4gIGZ1bmN0aW9uIGRpc2FibGUoKSB7XG4gICAgY3JlYXRlRGVidWcuZW5hYmxlKCcnKTtcbiAgfVxuICAvKipcbiAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIG1vZGUgbmFtZSBpcyBlbmFibGVkLCBmYWxzZSBvdGhlcndpc2UuXG4gICpcbiAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICogQGFwaSBwdWJsaWNcbiAgKi9cblxuXG4gIGZ1bmN0aW9uIGVuYWJsZWQobmFtZSkge1xuICAgIGlmIChuYW1lW25hbWUubGVuZ3RoIC0gMV0gPT09ICcqJykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgdmFyIGk7XG4gICAgdmFyIGxlbjtcblxuICAgIGZvciAoaSA9IDAsIGxlbiA9IGNyZWF0ZURlYnVnLnNraXBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBpZiAoY3JlYXRlRGVidWcuc2tpcHNbaV0udGVzdChuYW1lKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChpID0gMCwgbGVuID0gY3JlYXRlRGVidWcubmFtZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGlmIChjcmVhdGVEZWJ1Zy5uYW1lc1tpXS50ZXN0KG5hbWUpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICAvKipcbiAgKiBDb2VyY2UgYHZhbGAuXG4gICpcbiAgKiBAcGFyYW0ge01peGVkfSB2YWxcbiAgKiBAcmV0dXJuIHtNaXhlZH1cbiAgKiBAYXBpIHByaXZhdGVcbiAgKi9cblxuXG4gIGZ1bmN0aW9uIGNvZXJjZSh2YWwpIHtcbiAgICBpZiAodmFsIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIHJldHVybiB2YWwuc3RhY2sgfHwgdmFsLm1lc3NhZ2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHZhbDtcbiAgfVxuXG4gIGNyZWF0ZURlYnVnLmVuYWJsZShjcmVhdGVEZWJ1Zy5sb2FkKCkpO1xuICByZXR1cm4gY3JlYXRlRGVidWc7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gc2V0dXA7XG5cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/debug/src/common.js\n");

/***/ }),

/***/ "./node_modules/lodash.maxby/index.js":
/*!********************************************!*\
  !*** ./node_modules/lodash.maxby/index.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/* WEBPACK VAR INJECTION */(function(global, module) {/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used to compose bitmasks for comparison styles. */\nvar UNORDERED_COMPARE_FLAG = 1,\n    PARTIAL_COMPARE_FLAG = 2;\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/,\n    reLeadingDot = /^\\./,\n    rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Detect free variable `exports`. */\nvar freeExports =  true && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array ? array.length : 0;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    Uint8Array = root.Uint8Array,\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    splice = arrayProto.splice;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView'),\n    Map = getNative(root, 'Map'),\n    Promise = getNative(root, 'Promise'),\n    Set = getNative(root, 'Set'),\n    WeakMap = getNative(root, 'WeakMap'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values ? values.length : 0;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  this.__data__ = new ListCache(entries);\n}\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n}\n\n/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  return this.__data__['delete'](key);\n}\n\n/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\n/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var cache = this.__data__;\n  if (cache instanceof ListCache) {\n    var pairs = cache.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      return this;\n    }\n    cache = this.__data__ = new MapCache(pairs);\n  }\n  cache.set(key, value);\n  return this;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  // Safari 9 makes `arguments.length` enumerable in strict mode.\n  var result = (isArray(value) || isArguments(value))\n    ? baseTimes(value.length, String)\n    : [];\n\n  var length = result.length,\n      skipIndexes = !!length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (key == 'length' || isIndex(key, length)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of methods like `_.max` and `_.min` which accepts a\n * `comparator` to determine the extremum value.\n *\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} iteratee The iteratee invoked per iteration.\n * @param {Function} comparator The comparator used to compare values.\n * @returns {*} Returns the extremum value.\n */\nfunction baseExtremum(array, iteratee, comparator) {\n  var index = -1,\n      length = array.length;\n\n  while (++index < length) {\n    var value = array[index],\n        current = iteratee(value);\n\n    if (current != null && (computed === undefined\n          ? (current === current && !isSymbol(current))\n          : comparator(current, computed)\n        )) {\n      var computed = current,\n          result = value;\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = isKey(path, object) ? [path] : castPath(path);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\n/**\n * The base implementation of `getTag`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  return objectToString.call(value);\n}\n\n/**\n * The base implementation of `_.gt` which doesn't coerce arguments.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if `value` is greater than `other`,\n *  else `false`.\n */\nfunction baseGt(value, other) {\n  return value > other;\n}\n\n/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {boolean} [bitmask] The bitmask of comparison flags.\n *  The bitmask may be composed of the following flags:\n *     1 - Unordered comparison\n *     2 - Partial comparison\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, customizer, bitmask, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObject(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, baseIsEqual, customizer, bitmask, stack);\n}\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {number} [bitmask] The bitmask of comparison flags. See `baseIsEqual`\n *  for more details.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, equalFunc, customizer, bitmask, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = arrayTag,\n      othTag = arrayTag;\n\n  if (!objIsArr) {\n    objTag = getTag(object);\n    objTag = objTag == argsTag ? objectTag : objTag;\n  }\n  if (!othIsArr) {\n    othTag = getTag(other);\n    othTag = othTag == argsTag ? objectTag : othTag;\n  }\n  var objIsObj = objTag == objectTag && !isHostObject(object),\n      othIsObj = othTag == objectTag && !isHostObject(other),\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, equalFunc, customizer, bitmask, stack)\n      : equalByTag(object, other, objTag, equalFunc, customizer, bitmask, stack);\n  }\n  if (!(bitmask & PARTIAL_COMPARE_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, customizer, bitmask, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, equalFunc, customizer, bitmask, stack);\n}\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, customizer, UNORDERED_COMPARE_FLAG | PARTIAL_COMPARE_FLAG, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[objectToString.call(value)];\n}\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, undefined, UNORDERED_COMPARE_FLAG | PARTIAL_COMPARE_FLAG);\n  };\n}\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value) {\n  return isArray(value) ? value : stringToPath(value);\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Function} customizer The function to customize comparisons.\n * @param {number} bitmask The bitmask of comparison flags. See `baseIsEqual`\n *  for more details.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, equalFunc, customizer, bitmask, stack) {\n  var isPartial = bitmask & PARTIAL_COMPARE_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & UNORDERED_COMPARE_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!seen.has(othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, customizer, bitmask, stack))) {\n              return seen.add(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, customizer, bitmask, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Function} customizer The function to customize comparisons.\n * @param {number} bitmask The bitmask of comparison flags. See `baseIsEqual`\n *  for more details.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, equalFunc, customizer, bitmask, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & PARTIAL_COMPARE_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= UNORDERED_COMPARE_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), equalFunc, customizer, bitmask, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Function} customizer The function to customize comparisons.\n * @param {number} bitmask The bitmask of comparison flags. See `baseIsEqual`\n *  for more details.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, equalFunc, customizer, bitmask, stack) {\n  var isPartial = bitmask & PARTIAL_COMPARE_FLAG,\n      objProps = keys(object),\n      objLength = objProps.length,\n      othProps = keys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, customizer, bitmask, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11,\n// for data views in Edge < 14, and promises in Node.js.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = objectToString.call(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : undefined;\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = isKey(path, object) ? [path] : castPath(path);\n\n  var result,\n      index = -1,\n      length = path.length;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result) {\n    return result;\n  }\n  var length = object ? object.length : 0;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\n/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoize(function(string) {\n  string = toString(string);\n\n  var result = [];\n  if (reLeadingDot.test(string)) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, string) {\n    result.push(quote ? string.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result);\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Assign cache to `_.memoize`.\nmemoize.Cache = MapCache;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nfunction isArguments(value) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&\n    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\n/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\n/**\n * This method is like `_.max` except that it accepts `iteratee` which is\n * invoked for each element in `array` to generate the criterion by which\n * the value is ranked. The iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Math\n * @param {Array} array The array to iterate over.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {*} Returns the maximum value.\n * @example\n *\n * var objects = [{ 'n': 1 }, { 'n': 2 }];\n *\n * _.maxBy(objects, function(o) { return o.n; });\n * // => { 'n': 2 }\n *\n * // The `_.property` iteratee shorthand.\n * _.maxBy(objects, 'n');\n * // => { 'n': 2 }\n */\nfunction maxBy(array, iteratee) {\n  return (array && array.length)\n    ? baseExtremum(array, baseIteratee(iteratee, 2), baseGt)\n    : undefined;\n}\n\nmodule.exports = maxBy;\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ \"./node_modules/webpack/buildin/global.js\"), __webpack_require__(/*! ./../webpack/buildin/module.js */ \"./node_modules/webpack/buildin/module.js\")(module)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvbG9kYXNoLm1heGJ5L2luZGV4LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2xvZGFzaC5tYXhieS9pbmRleC5qcz9iMzdhIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogbG9kYXNoIChDdXN0b20gQnVpbGQpIDxodHRwczovL2xvZGFzaC5jb20vPlxuICogQnVpbGQ6IGBsb2Rhc2ggbW9kdWxhcml6ZSBleHBvcnRzPVwibnBtXCIgLW8gLi9gXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycyA8aHR0cHM6Ly9qcXVlcnkub3JnLz5cbiAqIFJlbGVhc2VkIHVuZGVyIE1JVCBsaWNlbnNlIDxodHRwczovL2xvZGFzaC5jb20vbGljZW5zZT5cbiAqIEJhc2VkIG9uIFVuZGVyc2NvcmUuanMgMS44LjMgPGh0dHA6Ly91bmRlcnNjb3JlanMub3JnL0xJQ0VOU0U+XG4gKiBDb3B5cmlnaHQgSmVyZW15IEFzaGtlbmFzLCBEb2N1bWVudENsb3VkIGFuZCBJbnZlc3RpZ2F0aXZlIFJlcG9ydGVycyAmIEVkaXRvcnNcbiAqL1xuXG4vKiogVXNlZCBhcyB0aGUgc2l6ZSB0byBlbmFibGUgbGFyZ2UgYXJyYXkgb3B0aW1pemF0aW9ucy4gKi9cbnZhciBMQVJHRV9BUlJBWV9TSVpFID0gMjAwO1xuXG4vKiogVXNlZCBhcyB0aGUgYFR5cGVFcnJvcmAgbWVzc2FnZSBmb3IgXCJGdW5jdGlvbnNcIiBtZXRob2RzLiAqL1xudmFyIEZVTkNfRVJST1JfVEVYVCA9ICdFeHBlY3RlZCBhIGZ1bmN0aW9uJztcblxuLyoqIFVzZWQgdG8gc3RhbmQtaW4gZm9yIGB1bmRlZmluZWRgIGhhc2ggdmFsdWVzLiAqL1xudmFyIEhBU0hfVU5ERUZJTkVEID0gJ19fbG9kYXNoX2hhc2hfdW5kZWZpbmVkX18nO1xuXG4vKiogVXNlZCB0byBjb21wb3NlIGJpdG1hc2tzIGZvciBjb21wYXJpc29uIHN0eWxlcy4gKi9cbnZhciBVTk9SREVSRURfQ09NUEFSRV9GTEFHID0gMSxcbiAgICBQQVJUSUFMX0NPTVBBUkVfRkxBRyA9IDI7XG5cbi8qKiBVc2VkIGFzIHJlZmVyZW5jZXMgZm9yIHZhcmlvdXMgYE51bWJlcmAgY29uc3RhbnRzLiAqL1xudmFyIElORklOSVRZID0gMSAvIDAsXG4gICAgTUFYX1NBRkVfSU5URUdFUiA9IDkwMDcxOTkyNTQ3NDA5OTE7XG5cbi8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgcmVmZXJlbmNlcy4gKi9cbnZhciBhcmdzVGFnID0gJ1tvYmplY3QgQXJndW1lbnRzXScsXG4gICAgYXJyYXlUYWcgPSAnW29iamVjdCBBcnJheV0nLFxuICAgIGJvb2xUYWcgPSAnW29iamVjdCBCb29sZWFuXScsXG4gICAgZGF0ZVRhZyA9ICdbb2JqZWN0IERhdGVdJyxcbiAgICBlcnJvclRhZyA9ICdbb2JqZWN0IEVycm9yXScsXG4gICAgZnVuY1RhZyA9ICdbb2JqZWN0IEZ1bmN0aW9uXScsXG4gICAgZ2VuVGFnID0gJ1tvYmplY3QgR2VuZXJhdG9yRnVuY3Rpb25dJyxcbiAgICBtYXBUYWcgPSAnW29iamVjdCBNYXBdJyxcbiAgICBudW1iZXJUYWcgPSAnW29iamVjdCBOdW1iZXJdJyxcbiAgICBvYmplY3RUYWcgPSAnW29iamVjdCBPYmplY3RdJyxcbiAgICBwcm9taXNlVGFnID0gJ1tvYmplY3QgUHJvbWlzZV0nLFxuICAgIHJlZ2V4cFRhZyA9ICdbb2JqZWN0IFJlZ0V4cF0nLFxuICAgIHNldFRhZyA9ICdbb2JqZWN0IFNldF0nLFxuICAgIHN0cmluZ1RhZyA9ICdbb2JqZWN0IFN0cmluZ10nLFxuICAgIHN5bWJvbFRhZyA9ICdbb2JqZWN0IFN5bWJvbF0nLFxuICAgIHdlYWtNYXBUYWcgPSAnW29iamVjdCBXZWFrTWFwXSc7XG5cbnZhciBhcnJheUJ1ZmZlclRhZyA9ICdbb2JqZWN0IEFycmF5QnVmZmVyXScsXG4gICAgZGF0YVZpZXdUYWcgPSAnW29iamVjdCBEYXRhVmlld10nLFxuICAgIGZsb2F0MzJUYWcgPSAnW29iamVjdCBGbG9hdDMyQXJyYXldJyxcbiAgICBmbG9hdDY0VGFnID0gJ1tvYmplY3QgRmxvYXQ2NEFycmF5XScsXG4gICAgaW50OFRhZyA9ICdbb2JqZWN0IEludDhBcnJheV0nLFxuICAgIGludDE2VGFnID0gJ1tvYmplY3QgSW50MTZBcnJheV0nLFxuICAgIGludDMyVGFnID0gJ1tvYmplY3QgSW50MzJBcnJheV0nLFxuICAgIHVpbnQ4VGFnID0gJ1tvYmplY3QgVWludDhBcnJheV0nLFxuICAgIHVpbnQ4Q2xhbXBlZFRhZyA9ICdbb2JqZWN0IFVpbnQ4Q2xhbXBlZEFycmF5XScsXG4gICAgdWludDE2VGFnID0gJ1tvYmplY3QgVWludDE2QXJyYXldJyxcbiAgICB1aW50MzJUYWcgPSAnW29iamVjdCBVaW50MzJBcnJheV0nO1xuXG4vKiogVXNlZCB0byBtYXRjaCBwcm9wZXJ0eSBuYW1lcyB3aXRoaW4gcHJvcGVydHkgcGF0aHMuICovXG52YXIgcmVJc0RlZXBQcm9wID0gL1xcLnxcXFsoPzpbXltcXF1dKnwoW1wiJ10pKD86KD8hXFwxKVteXFxcXF18XFxcXC4pKj9cXDEpXFxdLyxcbiAgICByZUlzUGxhaW5Qcm9wID0gL15cXHcqJC8sXG4gICAgcmVMZWFkaW5nRG90ID0gL15cXC4vLFxuICAgIHJlUHJvcE5hbWUgPSAvW14uW1xcXV0rfFxcWyg/OigtP1xcZCsoPzpcXC5cXGQrKT8pfChbXCInXSkoKD86KD8hXFwyKVteXFxcXF18XFxcXC4pKj8pXFwyKVxcXXwoPz0oPzpcXC58XFxbXFxdKSg/OlxcLnxcXFtcXF18JCkpL2c7XG5cbi8qKlxuICogVXNlZCB0byBtYXRjaCBgUmVnRXhwYFxuICogW3N5bnRheCBjaGFyYWN0ZXJzXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1wYXR0ZXJucykuXG4gKi9cbnZhciByZVJlZ0V4cENoYXIgPSAvW1xcXFxeJC4qKz8oKVtcXF17fXxdL2c7XG5cbi8qKiBVc2VkIHRvIG1hdGNoIGJhY2tzbGFzaGVzIGluIHByb3BlcnR5IHBhdGhzLiAqL1xudmFyIHJlRXNjYXBlQ2hhciA9IC9cXFxcKFxcXFwpPy9nO1xuXG4vKiogVXNlZCB0byBkZXRlY3QgaG9zdCBjb25zdHJ1Y3RvcnMgKFNhZmFyaSkuICovXG52YXIgcmVJc0hvc3RDdG9yID0gL15cXFtvYmplY3QgLis/Q29uc3RydWN0b3JcXF0kLztcblxuLyoqIFVzZWQgdG8gZGV0ZWN0IHVuc2lnbmVkIGludGVnZXIgdmFsdWVzLiAqL1xudmFyIHJlSXNVaW50ID0gL14oPzowfFsxLTldXFxkKikkLztcblxuLyoqIFVzZWQgdG8gaWRlbnRpZnkgYHRvU3RyaW5nVGFnYCB2YWx1ZXMgb2YgdHlwZWQgYXJyYXlzLiAqL1xudmFyIHR5cGVkQXJyYXlUYWdzID0ge307XG50eXBlZEFycmF5VGFnc1tmbG9hdDMyVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2Zsb2F0NjRUYWddID1cbnR5cGVkQXJyYXlUYWdzW2ludDhUYWddID0gdHlwZWRBcnJheVRhZ3NbaW50MTZUYWddID1cbnR5cGVkQXJyYXlUYWdzW2ludDMyVGFnXSA9IHR5cGVkQXJyYXlUYWdzW3VpbnQ4VGFnXSA9XG50eXBlZEFycmF5VGFnc1t1aW50OENsYW1wZWRUYWddID0gdHlwZWRBcnJheVRhZ3NbdWludDE2VGFnXSA9XG50eXBlZEFycmF5VGFnc1t1aW50MzJUYWddID0gdHJ1ZTtcbnR5cGVkQXJyYXlUYWdzW2FyZ3NUYWddID0gdHlwZWRBcnJheVRhZ3NbYXJyYXlUYWddID1cbnR5cGVkQXJyYXlUYWdzW2FycmF5QnVmZmVyVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2Jvb2xUYWddID1cbnR5cGVkQXJyYXlUYWdzW2RhdGFWaWV3VGFnXSA9IHR5cGVkQXJyYXlUYWdzW2RhdGVUYWddID1cbnR5cGVkQXJyYXlUYWdzW2Vycm9yVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2Z1bmNUYWddID1cbnR5cGVkQXJyYXlUYWdzW21hcFRhZ10gPSB0eXBlZEFycmF5VGFnc1tudW1iZXJUYWddID1cbnR5cGVkQXJyYXlUYWdzW29iamVjdFRhZ10gPSB0eXBlZEFycmF5VGFnc1tyZWdleHBUYWddID1cbnR5cGVkQXJyYXlUYWdzW3NldFRhZ10gPSB0eXBlZEFycmF5VGFnc1tzdHJpbmdUYWddID1cbnR5cGVkQXJyYXlUYWdzW3dlYWtNYXBUYWddID0gZmFsc2U7XG5cbi8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZSBgZ2xvYmFsYCBmcm9tIE5vZGUuanMuICovXG52YXIgZnJlZUdsb2JhbCA9IHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgZ2xvYmFsICYmIGdsb2JhbC5PYmplY3QgPT09IE9iamVjdCAmJiBnbG9iYWw7XG5cbi8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZSBgc2VsZmAuICovXG52YXIgZnJlZVNlbGYgPSB0eXBlb2Ygc2VsZiA9PSAnb2JqZWN0JyAmJiBzZWxmICYmIHNlbGYuT2JqZWN0ID09PSBPYmplY3QgJiYgc2VsZjtcblxuLyoqIFVzZWQgYXMgYSByZWZlcmVuY2UgdG8gdGhlIGdsb2JhbCBvYmplY3QuICovXG52YXIgcm9vdCA9IGZyZWVHbG9iYWwgfHwgZnJlZVNlbGYgfHwgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblxuLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBleHBvcnRzYC4gKi9cbnZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0cztcblxuLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBtb2R1bGVgLiAqL1xudmFyIGZyZWVNb2R1bGUgPSBmcmVlRXhwb3J0cyAmJiB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZSAmJiAhbW9kdWxlLm5vZGVUeXBlICYmIG1vZHVsZTtcblxuLyoqIERldGVjdCB0aGUgcG9wdWxhciBDb21tb25KUyBleHRlbnNpb24gYG1vZHVsZS5leHBvcnRzYC4gKi9cbnZhciBtb2R1bGVFeHBvcnRzID0gZnJlZU1vZHVsZSAmJiBmcmVlTW9kdWxlLmV4cG9ydHMgPT09IGZyZWVFeHBvcnRzO1xuXG4vKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYHByb2Nlc3NgIGZyb20gTm9kZS5qcy4gKi9cbnZhciBmcmVlUHJvY2VzcyA9IG1vZHVsZUV4cG9ydHMgJiYgZnJlZUdsb2JhbC5wcm9jZXNzO1xuXG4vKiogVXNlZCB0byBhY2Nlc3MgZmFzdGVyIE5vZGUuanMgaGVscGVycy4gKi9cbnZhciBub2RlVXRpbCA9IChmdW5jdGlvbigpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZnJlZVByb2Nlc3MgJiYgZnJlZVByb2Nlc3MuYmluZGluZygndXRpbCcpO1xuICB9IGNhdGNoIChlKSB7fVxufSgpKTtcblxuLyogTm9kZS5qcyBoZWxwZXIgcmVmZXJlbmNlcy4gKi9cbnZhciBub2RlSXNUeXBlZEFycmF5ID0gbm9kZVV0aWwgJiYgbm9kZVV0aWwuaXNUeXBlZEFycmF5O1xuXG4vKipcbiAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5zb21lYCBmb3IgYXJyYXlzIHdpdGhvdXQgc3VwcG9ydCBmb3IgaXRlcmF0ZWVcbiAqIHNob3J0aGFuZHMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7QXJyYXl9IFthcnJheV0gVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWRpY2F0ZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGFueSBlbGVtZW50IHBhc3NlcyB0aGUgcHJlZGljYXRlIGNoZWNrLFxuICogIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gYXJyYXlTb21lKGFycmF5LCBwcmVkaWNhdGUpIHtcbiAgdmFyIGluZGV4ID0gLTEsXG4gICAgICBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDA7XG5cbiAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICBpZiAocHJlZGljYXRlKGFycmF5W2luZGV4XSwgaW5kZXgsIGFycmF5KSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5wcm9wZXJ0eWAgd2l0aG91dCBzdXBwb3J0IGZvciBkZWVwIHBhdGhzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHByb3BlcnR5IHRvIGdldC5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGFjY2Vzc29yIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBiYXNlUHJvcGVydHkoa2V5KSB7XG4gIHJldHVybiBmdW5jdGlvbihvYmplY3QpIHtcbiAgICByZXR1cm4gb2JqZWN0ID09IG51bGwgPyB1bmRlZmluZWQgOiBvYmplY3Rba2V5XTtcbiAgfTtcbn1cblxuLyoqXG4gKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy50aW1lc2Agd2l0aG91dCBzdXBwb3J0IGZvciBpdGVyYXRlZSBzaG9ydGhhbmRzXG4gKiBvciBtYXggYXJyYXkgbGVuZ3RoIGNoZWNrcy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtudW1iZXJ9IG4gVGhlIG51bWJlciBvZiB0aW1lcyB0byBpbnZva2UgYGl0ZXJhdGVlYC5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGl0ZXJhdGVlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGFycmF5IG9mIHJlc3VsdHMuXG4gKi9cbmZ1bmN0aW9uIGJhc2VUaW1lcyhuLCBpdGVyYXRlZSkge1xuICB2YXIgaW5kZXggPSAtMSxcbiAgICAgIHJlc3VsdCA9IEFycmF5KG4pO1xuXG4gIHdoaWxlICgrK2luZGV4IDwgbikge1xuICAgIHJlc3VsdFtpbmRleF0gPSBpdGVyYXRlZShpbmRleCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy51bmFyeWAgd2l0aG91dCBzdXBwb3J0IGZvciBzdG9yaW5nIG1ldGFkYXRhLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBjYXAgYXJndW1lbnRzIGZvci5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGNhcHBlZCBmdW5jdGlvbi5cbiAqL1xuZnVuY3Rpb24gYmFzZVVuYXJ5KGZ1bmMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIGZ1bmModmFsdWUpO1xuICB9O1xufVxuXG4vKipcbiAqIEdldHMgdGhlIHZhbHVlIGF0IGBrZXlgIG9mIGBvYmplY3RgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gW29iamVjdF0gVGhlIG9iamVjdCB0byBxdWVyeS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgcHJvcGVydHkgdG8gZ2V0LlxuICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIHByb3BlcnR5IHZhbHVlLlxuICovXG5mdW5jdGlvbiBnZXRWYWx1ZShvYmplY3QsIGtleSkge1xuICByZXR1cm4gb2JqZWN0ID09IG51bGwgPyB1bmRlZmluZWQgOiBvYmplY3Rba2V5XTtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhIGhvc3Qgb2JqZWN0IGluIElFIDwgOS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIGhvc3Qgb2JqZWN0LCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGlzSG9zdE9iamVjdCh2YWx1ZSkge1xuICAvLyBNYW55IGhvc3Qgb2JqZWN0cyBhcmUgYE9iamVjdGAgb2JqZWN0cyB0aGF0IGNhbiBjb2VyY2UgdG8gc3RyaW5nc1xuICAvLyBkZXNwaXRlIGhhdmluZyBpbXByb3Blcmx5IGRlZmluZWQgYHRvU3RyaW5nYCBtZXRob2RzLlxuICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gIGlmICh2YWx1ZSAhPSBudWxsICYmIHR5cGVvZiB2YWx1ZS50b1N0cmluZyAhPSAnZnVuY3Rpb24nKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJlc3VsdCA9ICEhKHZhbHVlICsgJycpO1xuICAgIH0gY2F0Y2ggKGUpIHt9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBgbWFwYCB0byBpdHMga2V5LXZhbHVlIHBhaXJzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gbWFwIFRoZSBtYXAgdG8gY29udmVydC5cbiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUga2V5LXZhbHVlIHBhaXJzLlxuICovXG5mdW5jdGlvbiBtYXBUb0FycmF5KG1hcCkge1xuICB2YXIgaW5kZXggPSAtMSxcbiAgICAgIHJlc3VsdCA9IEFycmF5KG1hcC5zaXplKTtcblxuICBtYXAuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgcmVzdWx0WysraW5kZXhdID0gW2tleSwgdmFsdWVdO1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgdW5hcnkgZnVuY3Rpb24gdGhhdCBpbnZva2VzIGBmdW5jYCB3aXRoIGl0cyBhcmd1bWVudCB0cmFuc2Zvcm1lZC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gd3JhcC5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IHRyYW5zZm9ybSBUaGUgYXJndW1lbnQgdHJhbnNmb3JtLlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIG92ZXJBcmcoZnVuYywgdHJhbnNmb3JtKSB7XG4gIHJldHVybiBmdW5jdGlvbihhcmcpIHtcbiAgICByZXR1cm4gZnVuYyh0cmFuc2Zvcm0oYXJnKSk7XG4gIH07XG59XG5cbi8qKlxuICogQ29udmVydHMgYHNldGAgdG8gYW4gYXJyYXkgb2YgaXRzIHZhbHVlcy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IHNldCBUaGUgc2V0IHRvIGNvbnZlcnQuXG4gKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIHZhbHVlcy5cbiAqL1xuZnVuY3Rpb24gc2V0VG9BcnJheShzZXQpIHtcbiAgdmFyIGluZGV4ID0gLTEsXG4gICAgICByZXN1bHQgPSBBcnJheShzZXQuc2l6ZSk7XG5cbiAgc2V0LmZvckVhY2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXN1bHRbKytpbmRleF0gPSB2YWx1ZTtcbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKiBVc2VkIGZvciBidWlsdC1pbiBtZXRob2QgcmVmZXJlbmNlcy4gKi9cbnZhciBhcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlLFxuICAgIGZ1bmNQcm90byA9IEZ1bmN0aW9uLnByb3RvdHlwZSxcbiAgICBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7XG5cbi8qKiBVc2VkIHRvIGRldGVjdCBvdmVycmVhY2hpbmcgY29yZS1qcyBzaGltcy4gKi9cbnZhciBjb3JlSnNEYXRhID0gcm9vdFsnX19jb3JlLWpzX3NoYXJlZF9fJ107XG5cbi8qKiBVc2VkIHRvIGRldGVjdCBtZXRob2RzIG1hc3F1ZXJhZGluZyBhcyBuYXRpdmUuICovXG52YXIgbWFza1NyY0tleSA9IChmdW5jdGlvbigpIHtcbiAgdmFyIHVpZCA9IC9bXi5dKyQvLmV4ZWMoY29yZUpzRGF0YSAmJiBjb3JlSnNEYXRhLmtleXMgJiYgY29yZUpzRGF0YS5rZXlzLklFX1BST1RPIHx8ICcnKTtcbiAgcmV0dXJuIHVpZCA/ICgnU3ltYm9sKHNyYylfMS4nICsgdWlkKSA6ICcnO1xufSgpKTtcblxuLyoqIFVzZWQgdG8gcmVzb2x2ZSB0aGUgZGVjb21waWxlZCBzb3VyY2Ugb2YgZnVuY3Rpb25zLiAqL1xudmFyIGZ1bmNUb1N0cmluZyA9IGZ1bmNQcm90by50b1N0cmluZztcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqXG4gKiBVc2VkIHRvIHJlc29sdmUgdGhlXG4gKiBbYHRvU3RyaW5nVGFnYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtb2JqZWN0LnByb3RvdHlwZS50b3N0cmluZylcbiAqIG9mIHZhbHVlcy5cbiAqL1xudmFyIG9iamVjdFRvU3RyaW5nID0gb2JqZWN0UHJvdG8udG9TdHJpbmc7XG5cbi8qKiBVc2VkIHRvIGRldGVjdCBpZiBhIG1ldGhvZCBpcyBuYXRpdmUuICovXG52YXIgcmVJc05hdGl2ZSA9IFJlZ0V4cCgnXicgK1xuICBmdW5jVG9TdHJpbmcuY2FsbChoYXNPd25Qcm9wZXJ0eSkucmVwbGFjZShyZVJlZ0V4cENoYXIsICdcXFxcJCYnKVxuICAucmVwbGFjZSgvaGFzT3duUHJvcGVydHl8KGZ1bmN0aW9uKS4qPyg/PVxcXFxcXCgpfCBmb3IgLis/KD89XFxcXFxcXSkvZywgJyQxLio/JykgKyAnJCdcbik7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIFN5bWJvbCA9IHJvb3QuU3ltYm9sLFxuICAgIFVpbnQ4QXJyYXkgPSByb290LlVpbnQ4QXJyYXksXG4gICAgcHJvcGVydHlJc0VudW1lcmFibGUgPSBvYmplY3RQcm90by5wcm9wZXJ0eUlzRW51bWVyYWJsZSxcbiAgICBzcGxpY2UgPSBhcnJheVByb3RvLnNwbGljZTtcblxuLyogQnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMgZm9yIHRob3NlIHdpdGggdGhlIHNhbWUgbmFtZSBhcyBvdGhlciBgbG9kYXNoYCBtZXRob2RzLiAqL1xudmFyIG5hdGl2ZUtleXMgPSBvdmVyQXJnKE9iamVjdC5rZXlzLCBPYmplY3QpO1xuXG4vKiBCdWlsdC1pbiBtZXRob2QgcmVmZXJlbmNlcyB0aGF0IGFyZSB2ZXJpZmllZCB0byBiZSBuYXRpdmUuICovXG52YXIgRGF0YVZpZXcgPSBnZXROYXRpdmUocm9vdCwgJ0RhdGFWaWV3JyksXG4gICAgTWFwID0gZ2V0TmF0aXZlKHJvb3QsICdNYXAnKSxcbiAgICBQcm9taXNlID0gZ2V0TmF0aXZlKHJvb3QsICdQcm9taXNlJyksXG4gICAgU2V0ID0gZ2V0TmF0aXZlKHJvb3QsICdTZXQnKSxcbiAgICBXZWFrTWFwID0gZ2V0TmF0aXZlKHJvb3QsICdXZWFrTWFwJyksXG4gICAgbmF0aXZlQ3JlYXRlID0gZ2V0TmF0aXZlKE9iamVjdCwgJ2NyZWF0ZScpO1xuXG4vKiogVXNlZCB0byBkZXRlY3QgbWFwcywgc2V0cywgYW5kIHdlYWttYXBzLiAqL1xudmFyIGRhdGFWaWV3Q3RvclN0cmluZyA9IHRvU291cmNlKERhdGFWaWV3KSxcbiAgICBtYXBDdG9yU3RyaW5nID0gdG9Tb3VyY2UoTWFwKSxcbiAgICBwcm9taXNlQ3RvclN0cmluZyA9IHRvU291cmNlKFByb21pc2UpLFxuICAgIHNldEN0b3JTdHJpbmcgPSB0b1NvdXJjZShTZXQpLFxuICAgIHdlYWtNYXBDdG9yU3RyaW5nID0gdG9Tb3VyY2UoV2Vha01hcCk7XG5cbi8qKiBVc2VkIHRvIGNvbnZlcnQgc3ltYm9scyB0byBwcmltaXRpdmVzIGFuZCBzdHJpbmdzLiAqL1xudmFyIHN5bWJvbFByb3RvID0gU3ltYm9sID8gU3ltYm9sLnByb3RvdHlwZSA6IHVuZGVmaW5lZCxcbiAgICBzeW1ib2xWYWx1ZU9mID0gc3ltYm9sUHJvdG8gPyBzeW1ib2xQcm90by52YWx1ZU9mIDogdW5kZWZpbmVkLFxuICAgIHN5bWJvbFRvU3RyaW5nID0gc3ltYm9sUHJvdG8gPyBzeW1ib2xQcm90by50b1N0cmluZyA6IHVuZGVmaW5lZDtcblxuLyoqXG4gKiBDcmVhdGVzIGEgaGFzaCBvYmplY3QuXG4gKlxuICogQHByaXZhdGVcbiAqIEBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtBcnJheX0gW2VudHJpZXNdIFRoZSBrZXktdmFsdWUgcGFpcnMgdG8gY2FjaGUuXG4gKi9cbmZ1bmN0aW9uIEhhc2goZW50cmllcykge1xuICB2YXIgaW5kZXggPSAtMSxcbiAgICAgIGxlbmd0aCA9IGVudHJpZXMgPyBlbnRyaWVzLmxlbmd0aCA6IDA7XG5cbiAgdGhpcy5jbGVhcigpO1xuICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgIHZhciBlbnRyeSA9IGVudHJpZXNbaW5kZXhdO1xuICAgIHRoaXMuc2V0KGVudHJ5WzBdLCBlbnRyeVsxXSk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZW1vdmVzIGFsbCBrZXktdmFsdWUgZW50cmllcyBmcm9tIHRoZSBoYXNoLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBjbGVhclxuICogQG1lbWJlck9mIEhhc2hcbiAqL1xuZnVuY3Rpb24gaGFzaENsZWFyKCkge1xuICB0aGlzLl9fZGF0YV9fID0gbmF0aXZlQ3JlYXRlID8gbmF0aXZlQ3JlYXRlKG51bGwpIDoge307XG59XG5cbi8qKlxuICogUmVtb3ZlcyBga2V5YCBhbmQgaXRzIHZhbHVlIGZyb20gdGhlIGhhc2guXG4gKlxuICogQHByaXZhdGVcbiAqIEBuYW1lIGRlbGV0ZVxuICogQG1lbWJlck9mIEhhc2hcbiAqIEBwYXJhbSB7T2JqZWN0fSBoYXNoIFRoZSBoYXNoIHRvIG1vZGlmeS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gcmVtb3ZlLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBlbnRyeSB3YXMgcmVtb3ZlZCwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBoYXNoRGVsZXRlKGtleSkge1xuICByZXR1cm4gdGhpcy5oYXMoa2V5KSAmJiBkZWxldGUgdGhpcy5fX2RhdGFfX1trZXldO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIGhhc2ggdmFsdWUgZm9yIGBrZXlgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBnZXRcbiAqIEBtZW1iZXJPZiBIYXNoXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIGdldC5cbiAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBlbnRyeSB2YWx1ZS5cbiAqL1xuZnVuY3Rpb24gaGFzaEdldChrZXkpIHtcbiAgdmFyIGRhdGEgPSB0aGlzLl9fZGF0YV9fO1xuICBpZiAobmF0aXZlQ3JlYXRlKSB7XG4gICAgdmFyIHJlc3VsdCA9IGRhdGFba2V5XTtcbiAgICByZXR1cm4gcmVzdWx0ID09PSBIQVNIX1VOREVGSU5FRCA/IHVuZGVmaW5lZCA6IHJlc3VsdDtcbiAgfVxuICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChkYXRhLCBrZXkpID8gZGF0YVtrZXldIDogdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiBhIGhhc2ggdmFsdWUgZm9yIGBrZXlgIGV4aXN0cy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgaGFzXG4gKiBAbWVtYmVyT2YgSGFzaFxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBhbiBlbnRyeSBmb3IgYGtleWAgZXhpc3RzLCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGhhc2hIYXMoa2V5KSB7XG4gIHZhciBkYXRhID0gdGhpcy5fX2RhdGFfXztcbiAgcmV0dXJuIG5hdGl2ZUNyZWF0ZSA/IGRhdGFba2V5XSAhPT0gdW5kZWZpbmVkIDogaGFzT3duUHJvcGVydHkuY2FsbChkYXRhLCBrZXkpO1xufVxuXG4vKipcbiAqIFNldHMgdGhlIGhhc2ggYGtleWAgdG8gYHZhbHVlYC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgc2V0XG4gKiBAbWVtYmVyT2YgSGFzaFxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBzZXQuXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBoYXNoIGluc3RhbmNlLlxuICovXG5mdW5jdGlvbiBoYXNoU2V0KGtleSwgdmFsdWUpIHtcbiAgdmFyIGRhdGEgPSB0aGlzLl9fZGF0YV9fO1xuICBkYXRhW2tleV0gPSAobmF0aXZlQ3JlYXRlICYmIHZhbHVlID09PSB1bmRlZmluZWQpID8gSEFTSF9VTkRFRklORUQgOiB2YWx1ZTtcbiAgcmV0dXJuIHRoaXM7XG59XG5cbi8vIEFkZCBtZXRob2RzIHRvIGBIYXNoYC5cbkhhc2gucHJvdG90eXBlLmNsZWFyID0gaGFzaENsZWFyO1xuSGFzaC5wcm90b3R5cGVbJ2RlbGV0ZSddID0gaGFzaERlbGV0ZTtcbkhhc2gucHJvdG90eXBlLmdldCA9IGhhc2hHZXQ7XG5IYXNoLnByb3RvdHlwZS5oYXMgPSBoYXNoSGFzO1xuSGFzaC5wcm90b3R5cGUuc2V0ID0gaGFzaFNldDtcblxuLyoqXG4gKiBDcmVhdGVzIGFuIGxpc3QgY2FjaGUgb2JqZWN0LlxuICpcbiAqIEBwcml2YXRlXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7QXJyYXl9IFtlbnRyaWVzXSBUaGUga2V5LXZhbHVlIHBhaXJzIHRvIGNhY2hlLlxuICovXG5mdW5jdGlvbiBMaXN0Q2FjaGUoZW50cmllcykge1xuICB2YXIgaW5kZXggPSAtMSxcbiAgICAgIGxlbmd0aCA9IGVudHJpZXMgPyBlbnRyaWVzLmxlbmd0aCA6IDA7XG5cbiAgdGhpcy5jbGVhcigpO1xuICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgIHZhciBlbnRyeSA9IGVudHJpZXNbaW5kZXhdO1xuICAgIHRoaXMuc2V0KGVudHJ5WzBdLCBlbnRyeVsxXSk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZW1vdmVzIGFsbCBrZXktdmFsdWUgZW50cmllcyBmcm9tIHRoZSBsaXN0IGNhY2hlLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBjbGVhclxuICogQG1lbWJlck9mIExpc3RDYWNoZVxuICovXG5mdW5jdGlvbiBsaXN0Q2FjaGVDbGVhcigpIHtcbiAgdGhpcy5fX2RhdGFfXyA9IFtdO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgYGtleWAgYW5kIGl0cyB2YWx1ZSBmcm9tIHRoZSBsaXN0IGNhY2hlLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBkZWxldGVcbiAqIEBtZW1iZXJPZiBMaXN0Q2FjaGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gcmVtb3ZlLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBlbnRyeSB3YXMgcmVtb3ZlZCwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBsaXN0Q2FjaGVEZWxldGUoa2V5KSB7XG4gIHZhciBkYXRhID0gdGhpcy5fX2RhdGFfXyxcbiAgICAgIGluZGV4ID0gYXNzb2NJbmRleE9mKGRhdGEsIGtleSk7XG5cbiAgaWYgKGluZGV4IDwgMCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB2YXIgbGFzdEluZGV4ID0gZGF0YS5sZW5ndGggLSAxO1xuICBpZiAoaW5kZXggPT0gbGFzdEluZGV4KSB7XG4gICAgZGF0YS5wb3AoKTtcbiAgfSBlbHNlIHtcbiAgICBzcGxpY2UuY2FsbChkYXRhLCBpbmRleCwgMSk7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgbGlzdCBjYWNoZSB2YWx1ZSBmb3IgYGtleWAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBuYW1lIGdldFxuICogQG1lbWJlck9mIExpc3RDYWNoZVxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBnZXQuXG4gKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZW50cnkgdmFsdWUuXG4gKi9cbmZ1bmN0aW9uIGxpc3RDYWNoZUdldChrZXkpIHtcbiAgdmFyIGRhdGEgPSB0aGlzLl9fZGF0YV9fLFxuICAgICAgaW5kZXggPSBhc3NvY0luZGV4T2YoZGF0YSwga2V5KTtcblxuICByZXR1cm4gaW5kZXggPCAwID8gdW5kZWZpbmVkIDogZGF0YVtpbmRleF1bMV07XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGEgbGlzdCBjYWNoZSB2YWx1ZSBmb3IgYGtleWAgZXhpc3RzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBoYXNcbiAqIEBtZW1iZXJPZiBMaXN0Q2FjaGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYW4gZW50cnkgZm9yIGBrZXlgIGV4aXN0cywgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBsaXN0Q2FjaGVIYXMoa2V5KSB7XG4gIHJldHVybiBhc3NvY0luZGV4T2YodGhpcy5fX2RhdGFfXywga2V5KSA+IC0xO1xufVxuXG4vKipcbiAqIFNldHMgdGhlIGxpc3QgY2FjaGUgYGtleWAgdG8gYHZhbHVlYC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgc2V0XG4gKiBAbWVtYmVyT2YgTGlzdENhY2hlXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIHNldC5cbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNldC5cbiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGxpc3QgY2FjaGUgaW5zdGFuY2UuXG4gKi9cbmZ1bmN0aW9uIGxpc3RDYWNoZVNldChrZXksIHZhbHVlKSB7XG4gIHZhciBkYXRhID0gdGhpcy5fX2RhdGFfXyxcbiAgICAgIGluZGV4ID0gYXNzb2NJbmRleE9mKGRhdGEsIGtleSk7XG5cbiAgaWYgKGluZGV4IDwgMCkge1xuICAgIGRhdGEucHVzaChba2V5LCB2YWx1ZV0pO1xuICB9IGVsc2Uge1xuICAgIGRhdGFbaW5kZXhdWzFdID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHRoaXM7XG59XG5cbi8vIEFkZCBtZXRob2RzIHRvIGBMaXN0Q2FjaGVgLlxuTGlzdENhY2hlLnByb3RvdHlwZS5jbGVhciA9IGxpc3RDYWNoZUNsZWFyO1xuTGlzdENhY2hlLnByb3RvdHlwZVsnZGVsZXRlJ10gPSBsaXN0Q2FjaGVEZWxldGU7XG5MaXN0Q2FjaGUucHJvdG90eXBlLmdldCA9IGxpc3RDYWNoZUdldDtcbkxpc3RDYWNoZS5wcm90b3R5cGUuaGFzID0gbGlzdENhY2hlSGFzO1xuTGlzdENhY2hlLnByb3RvdHlwZS5zZXQgPSBsaXN0Q2FjaGVTZXQ7XG5cbi8qKlxuICogQ3JlYXRlcyBhIG1hcCBjYWNoZSBvYmplY3QgdG8gc3RvcmUga2V5LXZhbHVlIHBhaXJzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7QXJyYXl9IFtlbnRyaWVzXSBUaGUga2V5LXZhbHVlIHBhaXJzIHRvIGNhY2hlLlxuICovXG5mdW5jdGlvbiBNYXBDYWNoZShlbnRyaWVzKSB7XG4gIHZhciBpbmRleCA9IC0xLFxuICAgICAgbGVuZ3RoID0gZW50cmllcyA/IGVudHJpZXMubGVuZ3RoIDogMDtcblxuICB0aGlzLmNsZWFyKCk7XG4gIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgdmFyIGVudHJ5ID0gZW50cmllc1tpbmRleF07XG4gICAgdGhpcy5zZXQoZW50cnlbMF0sIGVudHJ5WzFdKTtcbiAgfVxufVxuXG4vKipcbiAqIFJlbW92ZXMgYWxsIGtleS12YWx1ZSBlbnRyaWVzIGZyb20gdGhlIG1hcC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgY2xlYXJcbiAqIEBtZW1iZXJPZiBNYXBDYWNoZVxuICovXG5mdW5jdGlvbiBtYXBDYWNoZUNsZWFyKCkge1xuICB0aGlzLl9fZGF0YV9fID0ge1xuICAgICdoYXNoJzogbmV3IEhhc2gsXG4gICAgJ21hcCc6IG5ldyAoTWFwIHx8IExpc3RDYWNoZSksXG4gICAgJ3N0cmluZyc6IG5ldyBIYXNoXG4gIH07XG59XG5cbi8qKlxuICogUmVtb3ZlcyBga2V5YCBhbmQgaXRzIHZhbHVlIGZyb20gdGhlIG1hcC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgZGVsZXRlXG4gKiBAbWVtYmVyT2YgTWFwQ2FjaGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gcmVtb3ZlLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBlbnRyeSB3YXMgcmVtb3ZlZCwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBtYXBDYWNoZURlbGV0ZShrZXkpIHtcbiAgcmV0dXJuIGdldE1hcERhdGEodGhpcywga2V5KVsnZGVsZXRlJ10oa2V5KTtcbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBtYXAgdmFsdWUgZm9yIGBrZXlgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBnZXRcbiAqIEBtZW1iZXJPZiBNYXBDYWNoZVxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBnZXQuXG4gKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZW50cnkgdmFsdWUuXG4gKi9cbmZ1bmN0aW9uIG1hcENhY2hlR2V0KGtleSkge1xuICByZXR1cm4gZ2V0TWFwRGF0YSh0aGlzLCBrZXkpLmdldChrZXkpO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiBhIG1hcCB2YWx1ZSBmb3IgYGtleWAgZXhpc3RzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBoYXNcbiAqIEBtZW1iZXJPZiBNYXBDYWNoZVxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBhbiBlbnRyeSBmb3IgYGtleWAgZXhpc3RzLCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIG1hcENhY2hlSGFzKGtleSkge1xuICByZXR1cm4gZ2V0TWFwRGF0YSh0aGlzLCBrZXkpLmhhcyhrZXkpO1xufVxuXG4vKipcbiAqIFNldHMgdGhlIG1hcCBga2V5YCB0byBgdmFsdWVgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBzZXRcbiAqIEBtZW1iZXJPZiBNYXBDYWNoZVxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBzZXQuXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBtYXAgY2FjaGUgaW5zdGFuY2UuXG4gKi9cbmZ1bmN0aW9uIG1hcENhY2hlU2V0KGtleSwgdmFsdWUpIHtcbiAgZ2V0TWFwRGF0YSh0aGlzLCBrZXkpLnNldChrZXksIHZhbHVlKTtcbiAgcmV0dXJuIHRoaXM7XG59XG5cbi8vIEFkZCBtZXRob2RzIHRvIGBNYXBDYWNoZWAuXG5NYXBDYWNoZS5wcm90b3R5cGUuY2xlYXIgPSBtYXBDYWNoZUNsZWFyO1xuTWFwQ2FjaGUucHJvdG90eXBlWydkZWxldGUnXSA9IG1hcENhY2hlRGVsZXRlO1xuTWFwQ2FjaGUucHJvdG90eXBlLmdldCA9IG1hcENhY2hlR2V0O1xuTWFwQ2FjaGUucHJvdG90eXBlLmhhcyA9IG1hcENhY2hlSGFzO1xuTWFwQ2FjaGUucHJvdG90eXBlLnNldCA9IG1hcENhY2hlU2V0O1xuXG4vKipcbiAqXG4gKiBDcmVhdGVzIGFuIGFycmF5IGNhY2hlIG9iamVjdCB0byBzdG9yZSB1bmlxdWUgdmFsdWVzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7QXJyYXl9IFt2YWx1ZXNdIFRoZSB2YWx1ZXMgdG8gY2FjaGUuXG4gKi9cbmZ1bmN0aW9uIFNldENhY2hlKHZhbHVlcykge1xuICB2YXIgaW5kZXggPSAtMSxcbiAgICAgIGxlbmd0aCA9IHZhbHVlcyA/IHZhbHVlcy5sZW5ndGggOiAwO1xuXG4gIHRoaXMuX19kYXRhX18gPSBuZXcgTWFwQ2FjaGU7XG4gIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgdGhpcy5hZGQodmFsdWVzW2luZGV4XSk7XG4gIH1cbn1cblxuLyoqXG4gKiBBZGRzIGB2YWx1ZWAgdG8gdGhlIGFycmF5IGNhY2hlLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBhZGRcbiAqIEBtZW1iZXJPZiBTZXRDYWNoZVxuICogQGFsaWFzIHB1c2hcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNhY2hlLlxuICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY2FjaGUgaW5zdGFuY2UuXG4gKi9cbmZ1bmN0aW9uIHNldENhY2hlQWRkKHZhbHVlKSB7XG4gIHRoaXMuX19kYXRhX18uc2V0KHZhbHVlLCBIQVNIX1VOREVGSU5FRCk7XG4gIHJldHVybiB0aGlzO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGluIHRoZSBhcnJheSBjYWNoZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgaGFzXG4gKiBAbWVtYmVyT2YgU2V0Q2FjaGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlYXJjaCBmb3IuXG4gKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGZvdW5kLCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIHNldENhY2hlSGFzKHZhbHVlKSB7XG4gIHJldHVybiB0aGlzLl9fZGF0YV9fLmhhcyh2YWx1ZSk7XG59XG5cbi8vIEFkZCBtZXRob2RzIHRvIGBTZXRDYWNoZWAuXG5TZXRDYWNoZS5wcm90b3R5cGUuYWRkID0gU2V0Q2FjaGUucHJvdG90eXBlLnB1c2ggPSBzZXRDYWNoZUFkZDtcblNldENhY2hlLnByb3RvdHlwZS5oYXMgPSBzZXRDYWNoZUhhcztcblxuLyoqXG4gKiBDcmVhdGVzIGEgc3RhY2sgY2FjaGUgb2JqZWN0IHRvIHN0b3JlIGtleS12YWx1ZSBwYWlycy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge0FycmF5fSBbZW50cmllc10gVGhlIGtleS12YWx1ZSBwYWlycyB0byBjYWNoZS5cbiAqL1xuZnVuY3Rpb24gU3RhY2soZW50cmllcykge1xuICB0aGlzLl9fZGF0YV9fID0gbmV3IExpc3RDYWNoZShlbnRyaWVzKTtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIGFsbCBrZXktdmFsdWUgZW50cmllcyBmcm9tIHRoZSBzdGFjay5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgY2xlYXJcbiAqIEBtZW1iZXJPZiBTdGFja1xuICovXG5mdW5jdGlvbiBzdGFja0NsZWFyKCkge1xuICB0aGlzLl9fZGF0YV9fID0gbmV3IExpc3RDYWNoZTtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIGBrZXlgIGFuZCBpdHMgdmFsdWUgZnJvbSB0aGUgc3RhY2suXG4gKlxuICogQHByaXZhdGVcbiAqIEBuYW1lIGRlbGV0ZVxuICogQG1lbWJlck9mIFN0YWNrXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIHJlbW92ZS5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgZW50cnkgd2FzIHJlbW92ZWQsIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gc3RhY2tEZWxldGUoa2V5KSB7XG4gIHJldHVybiB0aGlzLl9fZGF0YV9fWydkZWxldGUnXShrZXkpO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIHN0YWNrIHZhbHVlIGZvciBga2V5YC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgZ2V0XG4gKiBAbWVtYmVyT2YgU3RhY2tcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gZ2V0LlxuICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGVudHJ5IHZhbHVlLlxuICovXG5mdW5jdGlvbiBzdGFja0dldChrZXkpIHtcbiAgcmV0dXJuIHRoaXMuX19kYXRhX18uZ2V0KGtleSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGEgc3RhY2sgdmFsdWUgZm9yIGBrZXlgIGV4aXN0cy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgaGFzXG4gKiBAbWVtYmVyT2YgU3RhY2tcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYW4gZW50cnkgZm9yIGBrZXlgIGV4aXN0cywgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBzdGFja0hhcyhrZXkpIHtcbiAgcmV0dXJuIHRoaXMuX19kYXRhX18uaGFzKGtleSk7XG59XG5cbi8qKlxuICogU2V0cyB0aGUgc3RhY2sgYGtleWAgdG8gYHZhbHVlYC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgc2V0XG4gKiBAbWVtYmVyT2YgU3RhY2tcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gc2V0LlxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2V0LlxuICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgc3RhY2sgY2FjaGUgaW5zdGFuY2UuXG4gKi9cbmZ1bmN0aW9uIHN0YWNrU2V0KGtleSwgdmFsdWUpIHtcbiAgdmFyIGNhY2hlID0gdGhpcy5fX2RhdGFfXztcbiAgaWYgKGNhY2hlIGluc3RhbmNlb2YgTGlzdENhY2hlKSB7XG4gICAgdmFyIHBhaXJzID0gY2FjaGUuX19kYXRhX187XG4gICAgaWYgKCFNYXAgfHwgKHBhaXJzLmxlbmd0aCA8IExBUkdFX0FSUkFZX1NJWkUgLSAxKSkge1xuICAgICAgcGFpcnMucHVzaChba2V5LCB2YWx1ZV0pO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGNhY2hlID0gdGhpcy5fX2RhdGFfXyA9IG5ldyBNYXBDYWNoZShwYWlycyk7XG4gIH1cbiAgY2FjaGUuc2V0KGtleSwgdmFsdWUpO1xuICByZXR1cm4gdGhpcztcbn1cblxuLy8gQWRkIG1ldGhvZHMgdG8gYFN0YWNrYC5cblN0YWNrLnByb3RvdHlwZS5jbGVhciA9IHN0YWNrQ2xlYXI7XG5TdGFjay5wcm90b3R5cGVbJ2RlbGV0ZSddID0gc3RhY2tEZWxldGU7XG5TdGFjay5wcm90b3R5cGUuZ2V0ID0gc3RhY2tHZXQ7XG5TdGFjay5wcm90b3R5cGUuaGFzID0gc3RhY2tIYXM7XG5TdGFjay5wcm90b3R5cGUuc2V0ID0gc3RhY2tTZXQ7XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBhcnJheSBvZiB0aGUgZW51bWVyYWJsZSBwcm9wZXJ0eSBuYW1lcyBvZiB0aGUgYXJyYXktbGlrZSBgdmFsdWVgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBxdWVyeS5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaW5oZXJpdGVkIFNwZWNpZnkgcmV0dXJuaW5nIGluaGVyaXRlZCBwcm9wZXJ0eSBuYW1lcy5cbiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMuXG4gKi9cbmZ1bmN0aW9uIGFycmF5TGlrZUtleXModmFsdWUsIGluaGVyaXRlZCkge1xuICAvLyBTYWZhcmkgOC4xIG1ha2VzIGBhcmd1bWVudHMuY2FsbGVlYCBlbnVtZXJhYmxlIGluIHN0cmljdCBtb2RlLlxuICAvLyBTYWZhcmkgOSBtYWtlcyBgYXJndW1lbnRzLmxlbmd0aGAgZW51bWVyYWJsZSBpbiBzdHJpY3QgbW9kZS5cbiAgdmFyIHJlc3VsdCA9IChpc0FycmF5KHZhbHVlKSB8fCBpc0FyZ3VtZW50cyh2YWx1ZSkpXG4gICAgPyBiYXNlVGltZXModmFsdWUubGVuZ3RoLCBTdHJpbmcpXG4gICAgOiBbXTtcblxuICB2YXIgbGVuZ3RoID0gcmVzdWx0Lmxlbmd0aCxcbiAgICAgIHNraXBJbmRleGVzID0gISFsZW5ndGg7XG5cbiAgZm9yICh2YXIga2V5IGluIHZhbHVlKSB7XG4gICAgaWYgKChpbmhlcml0ZWQgfHwgaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwga2V5KSkgJiZcbiAgICAgICAgIShza2lwSW5kZXhlcyAmJiAoa2V5ID09ICdsZW5ndGgnIHx8IGlzSW5kZXgoa2V5LCBsZW5ndGgpKSkpIHtcbiAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgaW5kZXggYXQgd2hpY2ggdGhlIGBrZXlgIGlzIGZvdW5kIGluIGBhcnJheWAgb2Yga2V5LXZhbHVlIHBhaXJzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaW5zcGVjdC5cbiAqIEBwYXJhbSB7Kn0ga2V5IFRoZSBrZXkgdG8gc2VhcmNoIGZvci5cbiAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBtYXRjaGVkIHZhbHVlLCBlbHNlIGAtMWAuXG4gKi9cbmZ1bmN0aW9uIGFzc29jSW5kZXhPZihhcnJheSwga2V5KSB7XG4gIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7XG4gIHdoaWxlIChsZW5ndGgtLSkge1xuICAgIGlmIChlcShhcnJheVtsZW5ndGhdWzBdLCBrZXkpKSB7XG4gICAgICByZXR1cm4gbGVuZ3RoO1xuICAgIH1cbiAgfVxuICByZXR1cm4gLTE7XG59XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgbWV0aG9kcyBsaWtlIGBfLm1heGAgYW5kIGBfLm1pbmAgd2hpY2ggYWNjZXB0cyBhXG4gKiBgY29tcGFyYXRvcmAgdG8gZGV0ZXJtaW5lIHRoZSBleHRyZW11bSB2YWx1ZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGl0ZXJhdGVlIFRoZSBpdGVyYXRlZSBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjb21wYXJhdG9yIFRoZSBjb21wYXJhdG9yIHVzZWQgdG8gY29tcGFyZSB2YWx1ZXMuXG4gKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZXh0cmVtdW0gdmFsdWUuXG4gKi9cbmZ1bmN0aW9uIGJhc2VFeHRyZW11bShhcnJheSwgaXRlcmF0ZWUsIGNvbXBhcmF0b3IpIHtcbiAgdmFyIGluZGV4ID0gLTEsXG4gICAgICBsZW5ndGggPSBhcnJheS5sZW5ndGg7XG5cbiAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICB2YXIgdmFsdWUgPSBhcnJheVtpbmRleF0sXG4gICAgICAgIGN1cnJlbnQgPSBpdGVyYXRlZSh2YWx1ZSk7XG5cbiAgICBpZiAoY3VycmVudCAhPSBudWxsICYmIChjb21wdXRlZCA9PT0gdW5kZWZpbmVkXG4gICAgICAgICAgPyAoY3VycmVudCA9PT0gY3VycmVudCAmJiAhaXNTeW1ib2woY3VycmVudCkpXG4gICAgICAgICAgOiBjb21wYXJhdG9yKGN1cnJlbnQsIGNvbXB1dGVkKVxuICAgICAgICApKSB7XG4gICAgICB2YXIgY29tcHV0ZWQgPSBjdXJyZW50LFxuICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmdldGAgd2l0aG91dCBzdXBwb3J0IGZvciBkZWZhdWx0IHZhbHVlcy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggb2YgdGhlIHByb3BlcnR5IHRvIGdldC5cbiAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSByZXNvbHZlZCB2YWx1ZS5cbiAqL1xuZnVuY3Rpb24gYmFzZUdldChvYmplY3QsIHBhdGgpIHtcbiAgcGF0aCA9IGlzS2V5KHBhdGgsIG9iamVjdCkgPyBbcGF0aF0gOiBjYXN0UGF0aChwYXRoKTtcblxuICB2YXIgaW5kZXggPSAwLFxuICAgICAgbGVuZ3RoID0gcGF0aC5sZW5ndGg7XG5cbiAgd2hpbGUgKG9iamVjdCAhPSBudWxsICYmIGluZGV4IDwgbGVuZ3RoKSB7XG4gICAgb2JqZWN0ID0gb2JqZWN0W3RvS2V5KHBhdGhbaW5kZXgrK10pXTtcbiAgfVxuICByZXR1cm4gKGluZGV4ICYmIGluZGV4ID09IGxlbmd0aCkgPyBvYmplY3QgOiB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYGdldFRhZ2AuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHF1ZXJ5LlxuICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgYHRvU3RyaW5nVGFnYC5cbiAqL1xuZnVuY3Rpb24gYmFzZUdldFRhZyh2YWx1ZSkge1xuICByZXR1cm4gb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSk7XG59XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uZ3RgIHdoaWNoIGRvZXNuJ3QgY29lcmNlIGFyZ3VtZW50cy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSB7Kn0gb3RoZXIgVGhlIG90aGVyIHZhbHVlIHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBncmVhdGVyIHRoYW4gYG90aGVyYCxcbiAqICBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGJhc2VHdCh2YWx1ZSwgb3RoZXIpIHtcbiAgcmV0dXJuIHZhbHVlID4gb3RoZXI7XG59XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaGFzSW5gIHdpdGhvdXQgc3VwcG9ydCBmb3IgZGVlcCBwYXRocy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IFtvYmplY3RdIFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gKiBAcGFyYW0ge0FycmF5fHN0cmluZ30ga2V5IFRoZSBrZXkgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYGtleWAgZXhpc3RzLCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGJhc2VIYXNJbihvYmplY3QsIGtleSkge1xuICByZXR1cm4gb2JqZWN0ICE9IG51bGwgJiYga2V5IGluIE9iamVjdChvYmplY3QpO1xufVxuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmlzRXF1YWxgIHdoaWNoIHN1cHBvcnRzIHBhcnRpYWwgY29tcGFyaXNvbnNcbiAqIGFuZCB0cmFja3MgdHJhdmVyc2VkIG9iamVjdHMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0geyp9IG90aGVyIFRoZSBvdGhlciB2YWx1ZSB0byBjb21wYXJlLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgY29tcGFyaXNvbnMuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtiaXRtYXNrXSBUaGUgYml0bWFzayBvZiBjb21wYXJpc29uIGZsYWdzLlxuICogIFRoZSBiaXRtYXNrIG1heSBiZSBjb21wb3NlZCBvZiB0aGUgZm9sbG93aW5nIGZsYWdzOlxuICogICAgIDEgLSBVbm9yZGVyZWQgY29tcGFyaXNvblxuICogICAgIDIgLSBQYXJ0aWFsIGNvbXBhcmlzb25cbiAqIEBwYXJhbSB7T2JqZWN0fSBbc3RhY2tdIFRyYWNrcyB0cmF2ZXJzZWQgYHZhbHVlYCBhbmQgYG90aGVyYCBvYmplY3RzLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSB2YWx1ZXMgYXJlIGVxdWl2YWxlbnQsIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gYmFzZUlzRXF1YWwodmFsdWUsIG90aGVyLCBjdXN0b21pemVyLCBiaXRtYXNrLCBzdGFjaykge1xuICBpZiAodmFsdWUgPT09IG90aGVyKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKHZhbHVlID09IG51bGwgfHwgb3RoZXIgPT0gbnVsbCB8fCAoIWlzT2JqZWN0KHZhbHVlKSAmJiAhaXNPYmplY3RMaWtlKG90aGVyKSkpIHtcbiAgICByZXR1cm4gdmFsdWUgIT09IHZhbHVlICYmIG90aGVyICE9PSBvdGhlcjtcbiAgfVxuICByZXR1cm4gYmFzZUlzRXF1YWxEZWVwKHZhbHVlLCBvdGhlciwgYmFzZUlzRXF1YWwsIGN1c3RvbWl6ZXIsIGJpdG1hc2ssIHN0YWNrKTtcbn1cblxuLyoqXG4gKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYGJhc2VJc0VxdWFsYCBmb3IgYXJyYXlzIGFuZCBvYmplY3RzIHdoaWNoIHBlcmZvcm1zXG4gKiBkZWVwIGNvbXBhcmlzb25zIGFuZCB0cmFja3MgdHJhdmVyc2VkIG9iamVjdHMgZW5hYmxpbmcgb2JqZWN0cyB3aXRoIGNpcmN1bGFyXG4gKiByZWZlcmVuY2VzIHRvIGJlIGNvbXBhcmVkLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvdGhlciBUaGUgb3RoZXIgb2JqZWN0IHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcXVhbEZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGRldGVybWluZSBlcXVpdmFsZW50cyBvZiB2YWx1ZXMuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY3VzdG9taXplcl0gVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBjb21wYXJpc29ucy5cbiAqIEBwYXJhbSB7bnVtYmVyfSBbYml0bWFza10gVGhlIGJpdG1hc2sgb2YgY29tcGFyaXNvbiBmbGFncy4gU2VlIGBiYXNlSXNFcXVhbGBcbiAqICBmb3IgbW9yZSBkZXRhaWxzLlxuICogQHBhcmFtIHtPYmplY3R9IFtzdGFja10gVHJhY2tzIHRyYXZlcnNlZCBgb2JqZWN0YCBhbmQgYG90aGVyYCBvYmplY3RzLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBvYmplY3RzIGFyZSBlcXVpdmFsZW50LCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGJhc2VJc0VxdWFsRGVlcChvYmplY3QsIG90aGVyLCBlcXVhbEZ1bmMsIGN1c3RvbWl6ZXIsIGJpdG1hc2ssIHN0YWNrKSB7XG4gIHZhciBvYmpJc0FyciA9IGlzQXJyYXkob2JqZWN0KSxcbiAgICAgIG90aElzQXJyID0gaXNBcnJheShvdGhlciksXG4gICAgICBvYmpUYWcgPSBhcnJheVRhZyxcbiAgICAgIG90aFRhZyA9IGFycmF5VGFnO1xuXG4gIGlmICghb2JqSXNBcnIpIHtcbiAgICBvYmpUYWcgPSBnZXRUYWcob2JqZWN0KTtcbiAgICBvYmpUYWcgPSBvYmpUYWcgPT0gYXJnc1RhZyA/IG9iamVjdFRhZyA6IG9ialRhZztcbiAgfVxuICBpZiAoIW90aElzQXJyKSB7XG4gICAgb3RoVGFnID0gZ2V0VGFnKG90aGVyKTtcbiAgICBvdGhUYWcgPSBvdGhUYWcgPT0gYXJnc1RhZyA/IG9iamVjdFRhZyA6IG90aFRhZztcbiAgfVxuICB2YXIgb2JqSXNPYmogPSBvYmpUYWcgPT0gb2JqZWN0VGFnICYmICFpc0hvc3RPYmplY3Qob2JqZWN0KSxcbiAgICAgIG90aElzT2JqID0gb3RoVGFnID09IG9iamVjdFRhZyAmJiAhaXNIb3N0T2JqZWN0KG90aGVyKSxcbiAgICAgIGlzU2FtZVRhZyA9IG9ialRhZyA9PSBvdGhUYWc7XG5cbiAgaWYgKGlzU2FtZVRhZyAmJiAhb2JqSXNPYmopIHtcbiAgICBzdGFjayB8fCAoc3RhY2sgPSBuZXcgU3RhY2spO1xuICAgIHJldHVybiAob2JqSXNBcnIgfHwgaXNUeXBlZEFycmF5KG9iamVjdCkpXG4gICAgICA/IGVxdWFsQXJyYXlzKG9iamVjdCwgb3RoZXIsIGVxdWFsRnVuYywgY3VzdG9taXplciwgYml0bWFzaywgc3RhY2spXG4gICAgICA6IGVxdWFsQnlUYWcob2JqZWN0LCBvdGhlciwgb2JqVGFnLCBlcXVhbEZ1bmMsIGN1c3RvbWl6ZXIsIGJpdG1hc2ssIHN0YWNrKTtcbiAgfVxuICBpZiAoIShiaXRtYXNrICYgUEFSVElBTF9DT01QQVJFX0ZMQUcpKSB7XG4gICAgdmFyIG9iaklzV3JhcHBlZCA9IG9iaklzT2JqICYmIGhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCAnX193cmFwcGVkX18nKSxcbiAgICAgICAgb3RoSXNXcmFwcGVkID0gb3RoSXNPYmogJiYgaGFzT3duUHJvcGVydHkuY2FsbChvdGhlciwgJ19fd3JhcHBlZF9fJyk7XG5cbiAgICBpZiAob2JqSXNXcmFwcGVkIHx8IG90aElzV3JhcHBlZCkge1xuICAgICAgdmFyIG9ialVud3JhcHBlZCA9IG9iaklzV3JhcHBlZCA/IG9iamVjdC52YWx1ZSgpIDogb2JqZWN0LFxuICAgICAgICAgIG90aFVud3JhcHBlZCA9IG90aElzV3JhcHBlZCA/IG90aGVyLnZhbHVlKCkgOiBvdGhlcjtcblxuICAgICAgc3RhY2sgfHwgKHN0YWNrID0gbmV3IFN0YWNrKTtcbiAgICAgIHJldHVybiBlcXVhbEZ1bmMob2JqVW53cmFwcGVkLCBvdGhVbndyYXBwZWQsIGN1c3RvbWl6ZXIsIGJpdG1hc2ssIHN0YWNrKTtcbiAgICB9XG4gIH1cbiAgaWYgKCFpc1NhbWVUYWcpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgc3RhY2sgfHwgKHN0YWNrID0gbmV3IFN0YWNrKTtcbiAgcmV0dXJuIGVxdWFsT2JqZWN0cyhvYmplY3QsIG90aGVyLCBlcXVhbEZ1bmMsIGN1c3RvbWl6ZXIsIGJpdG1hc2ssIHN0YWNrKTtcbn1cblxuLyoqXG4gKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5pc01hdGNoYCB3aXRob3V0IHN1cHBvcnQgZm9yIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpbnNwZWN0LlxuICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgb2JqZWN0IG9mIHByb3BlcnR5IHZhbHVlcyB0byBtYXRjaC5cbiAqIEBwYXJhbSB7QXJyYXl9IG1hdGNoRGF0YSBUaGUgcHJvcGVydHkgbmFtZXMsIHZhbHVlcywgYW5kIGNvbXBhcmUgZmxhZ3MgdG8gbWF0Y2guXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY3VzdG9taXplcl0gVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBjb21wYXJpc29ucy5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgb2JqZWN0YCBpcyBhIG1hdGNoLCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGJhc2VJc01hdGNoKG9iamVjdCwgc291cmNlLCBtYXRjaERhdGEsIGN1c3RvbWl6ZXIpIHtcbiAgdmFyIGluZGV4ID0gbWF0Y2hEYXRhLmxlbmd0aCxcbiAgICAgIGxlbmd0aCA9IGluZGV4LFxuICAgICAgbm9DdXN0b21pemVyID0gIWN1c3RvbWl6ZXI7XG5cbiAgaWYgKG9iamVjdCA9PSBudWxsKSB7XG4gICAgcmV0dXJuICFsZW5ndGg7XG4gIH1cbiAgb2JqZWN0ID0gT2JqZWN0KG9iamVjdCk7XG4gIHdoaWxlIChpbmRleC0tKSB7XG4gICAgdmFyIGRhdGEgPSBtYXRjaERhdGFbaW5kZXhdO1xuICAgIGlmICgobm9DdXN0b21pemVyICYmIGRhdGFbMl0pXG4gICAgICAgICAgPyBkYXRhWzFdICE9PSBvYmplY3RbZGF0YVswXV1cbiAgICAgICAgICA6ICEoZGF0YVswXSBpbiBvYmplY3QpXG4gICAgICAgICkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgIGRhdGEgPSBtYXRjaERhdGFbaW5kZXhdO1xuICAgIHZhciBrZXkgPSBkYXRhWzBdLFxuICAgICAgICBvYmpWYWx1ZSA9IG9iamVjdFtrZXldLFxuICAgICAgICBzcmNWYWx1ZSA9IGRhdGFbMV07XG5cbiAgICBpZiAobm9DdXN0b21pemVyICYmIGRhdGFbMl0pIHtcbiAgICAgIGlmIChvYmpWYWx1ZSA9PT0gdW5kZWZpbmVkICYmICEoa2V5IGluIG9iamVjdCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgc3RhY2sgPSBuZXcgU3RhY2s7XG4gICAgICBpZiAoY3VzdG9taXplcikge1xuICAgICAgICB2YXIgcmVzdWx0ID0gY3VzdG9taXplcihvYmpWYWx1ZSwgc3JjVmFsdWUsIGtleSwgb2JqZWN0LCBzb3VyY2UsIHN0YWNrKTtcbiAgICAgIH1cbiAgICAgIGlmICghKHJlc3VsdCA9PT0gdW5kZWZpbmVkXG4gICAgICAgICAgICA/IGJhc2VJc0VxdWFsKHNyY1ZhbHVlLCBvYmpWYWx1ZSwgY3VzdG9taXplciwgVU5PUkRFUkVEX0NPTVBBUkVfRkxBRyB8IFBBUlRJQUxfQ09NUEFSRV9GTEFHLCBzdGFjaylcbiAgICAgICAgICAgIDogcmVzdWx0XG4gICAgICAgICAgKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmlzTmF0aXZlYCB3aXRob3V0IGJhZCBzaGltIGNoZWNrcy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIG5hdGl2ZSBmdW5jdGlvbixcbiAqICBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGJhc2VJc05hdGl2ZSh2YWx1ZSkge1xuICBpZiAoIWlzT2JqZWN0KHZhbHVlKSB8fCBpc01hc2tlZCh2YWx1ZSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIHBhdHRlcm4gPSAoaXNGdW5jdGlvbih2YWx1ZSkgfHwgaXNIb3N0T2JqZWN0KHZhbHVlKSkgPyByZUlzTmF0aXZlIDogcmVJc0hvc3RDdG9yO1xuICByZXR1cm4gcGF0dGVybi50ZXN0KHRvU291cmNlKHZhbHVlKSk7XG59XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaXNUeXBlZEFycmF5YCB3aXRob3V0IE5vZGUuanMgb3B0aW1pemF0aW9ucy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHR5cGVkIGFycmF5LCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGJhc2VJc1R5cGVkQXJyYXkodmFsdWUpIHtcbiAgcmV0dXJuIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiZcbiAgICBpc0xlbmd0aCh2YWx1ZS5sZW5ndGgpICYmICEhdHlwZWRBcnJheVRhZ3Nbb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSldO1xufVxuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLml0ZXJhdGVlYC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSBbdmFsdWU9Xy5pZGVudGl0eV0gVGhlIHZhbHVlIHRvIGNvbnZlcnQgdG8gYW4gaXRlcmF0ZWUuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIGl0ZXJhdGVlLlxuICovXG5mdW5jdGlvbiBiYXNlSXRlcmF0ZWUodmFsdWUpIHtcbiAgLy8gRG9uJ3Qgc3RvcmUgdGhlIGB0eXBlb2ZgIHJlc3VsdCBpbiBhIHZhcmlhYmxlIHRvIGF2b2lkIGEgSklUIGJ1ZyBpbiBTYWZhcmkgOS5cbiAgLy8gU2VlIGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xNTYwMzQgZm9yIG1vcmUgZGV0YWlscy5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgcmV0dXJuIGlkZW50aXR5O1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gaXNBcnJheSh2YWx1ZSlcbiAgICAgID8gYmFzZU1hdGNoZXNQcm9wZXJ0eSh2YWx1ZVswXSwgdmFsdWVbMV0pXG4gICAgICA6IGJhc2VNYXRjaGVzKHZhbHVlKTtcbiAgfVxuICByZXR1cm4gcHJvcGVydHkodmFsdWUpO1xufVxuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmtleXNgIHdoaWNoIGRvZXNuJ3QgdHJlYXQgc3BhcnNlIGFycmF5cyBhcyBkZW5zZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcy5cbiAqL1xuZnVuY3Rpb24gYmFzZUtleXMob2JqZWN0KSB7XG4gIGlmICghaXNQcm90b3R5cGUob2JqZWN0KSkge1xuICAgIHJldHVybiBuYXRpdmVLZXlzKG9iamVjdCk7XG4gIH1cbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBmb3IgKHZhciBrZXkgaW4gT2JqZWN0KG9iamVjdCkpIHtcbiAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkgJiYga2V5ICE9ICdjb25zdHJ1Y3RvcicpIHtcbiAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8ubWF0Y2hlc2Agd2hpY2ggZG9lc24ndCBjbG9uZSBgc291cmNlYC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgb2JqZWN0IG9mIHByb3BlcnR5IHZhbHVlcyB0byBtYXRjaC5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHNwZWMgZnVuY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIGJhc2VNYXRjaGVzKHNvdXJjZSkge1xuICB2YXIgbWF0Y2hEYXRhID0gZ2V0TWF0Y2hEYXRhKHNvdXJjZSk7XG4gIGlmIChtYXRjaERhdGEubGVuZ3RoID09IDEgJiYgbWF0Y2hEYXRhWzBdWzJdKSB7XG4gICAgcmV0dXJuIG1hdGNoZXNTdHJpY3RDb21wYXJhYmxlKG1hdGNoRGF0YVswXVswXSwgbWF0Y2hEYXRhWzBdWzFdKTtcbiAgfVxuICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgcmV0dXJuIG9iamVjdCA9PT0gc291cmNlIHx8IGJhc2VJc01hdGNoKG9iamVjdCwgc291cmNlLCBtYXRjaERhdGEpO1xuICB9O1xufVxuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLm1hdGNoZXNQcm9wZXJ0eWAgd2hpY2ggZG9lc24ndCBjbG9uZSBgc3JjVmFsdWVgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aCBUaGUgcGF0aCBvZiB0aGUgcHJvcGVydHkgdG8gZ2V0LlxuICogQHBhcmFtIHsqfSBzcmNWYWx1ZSBUaGUgdmFsdWUgdG8gbWF0Y2guXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBzcGVjIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBiYXNlTWF0Y2hlc1Byb3BlcnR5KHBhdGgsIHNyY1ZhbHVlKSB7XG4gIGlmIChpc0tleShwYXRoKSAmJiBpc1N0cmljdENvbXBhcmFibGUoc3JjVmFsdWUpKSB7XG4gICAgcmV0dXJuIG1hdGNoZXNTdHJpY3RDb21wYXJhYmxlKHRvS2V5KHBhdGgpLCBzcmNWYWx1ZSk7XG4gIH1cbiAgcmV0dXJuIGZ1bmN0aW9uKG9iamVjdCkge1xuICAgIHZhciBvYmpWYWx1ZSA9IGdldChvYmplY3QsIHBhdGgpO1xuICAgIHJldHVybiAob2JqVmFsdWUgPT09IHVuZGVmaW5lZCAmJiBvYmpWYWx1ZSA9PT0gc3JjVmFsdWUpXG4gICAgICA/IGhhc0luKG9iamVjdCwgcGF0aClcbiAgICAgIDogYmFzZUlzRXF1YWwoc3JjVmFsdWUsIG9ialZhbHVlLCB1bmRlZmluZWQsIFVOT1JERVJFRF9DT01QQVJFX0ZMQUcgfCBQQVJUSUFMX0NPTVBBUkVfRkxBRyk7XG4gIH07XG59XG5cbi8qKlxuICogQSBzcGVjaWFsaXplZCB2ZXJzaW9uIG9mIGBiYXNlUHJvcGVydHlgIHdoaWNoIHN1cHBvcnRzIGRlZXAgcGF0aHMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7QXJyYXl8c3RyaW5nfSBwYXRoIFRoZSBwYXRoIG9mIHRoZSBwcm9wZXJ0eSB0byBnZXQuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBhY2Nlc3NvciBmdW5jdGlvbi5cbiAqL1xuZnVuY3Rpb24gYmFzZVByb3BlcnR5RGVlcChwYXRoKSB7XG4gIHJldHVybiBmdW5jdGlvbihvYmplY3QpIHtcbiAgICByZXR1cm4gYmFzZUdldChvYmplY3QsIHBhdGgpO1xuICB9O1xufVxuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnRvU3RyaW5nYCB3aGljaCBkb2Vzbid0IGNvbnZlcnQgbnVsbGlzaFxuICogdmFsdWVzIHRvIGVtcHR5IHN0cmluZ3MuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHByb2Nlc3MuXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBzdHJpbmcuXG4gKi9cbmZ1bmN0aW9uIGJhc2VUb1N0cmluZyh2YWx1ZSkge1xuICAvLyBFeGl0IGVhcmx5IGZvciBzdHJpbmdzIHRvIGF2b2lkIGEgcGVyZm9ybWFuY2UgaGl0IGluIHNvbWUgZW52aXJvbm1lbnRzLlxuICBpZiAodHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGlmIChpc1N5bWJvbCh2YWx1ZSkpIHtcbiAgICByZXR1cm4gc3ltYm9sVG9TdHJpbmcgPyBzeW1ib2xUb1N0cmluZy5jYWxsKHZhbHVlKSA6ICcnO1xuICB9XG4gIHZhciByZXN1bHQgPSAodmFsdWUgKyAnJyk7XG4gIHJldHVybiAocmVzdWx0ID09ICcwJyAmJiAoMSAvIHZhbHVlKSA9PSAtSU5GSU5JVFkpID8gJy0wJyA6IHJlc3VsdDtcbn1cblxuLyoqXG4gKiBDYXN0cyBgdmFsdWVgIHRvIGEgcGF0aCBhcnJheSBpZiBpdCdzIG5vdCBvbmUuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGluc3BlY3QuXG4gKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGNhc3QgcHJvcGVydHkgcGF0aCBhcnJheS5cbiAqL1xuZnVuY3Rpb24gY2FzdFBhdGgodmFsdWUpIHtcbiAgcmV0dXJuIGlzQXJyYXkodmFsdWUpID8gdmFsdWUgOiBzdHJpbmdUb1BhdGgodmFsdWUpO1xufVxuXG4vKipcbiAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgYmFzZUlzRXF1YWxEZWVwYCBmb3IgYXJyYXlzIHdpdGggc3VwcG9ydCBmb3JcbiAqIHBhcnRpYWwgZGVlcCBjb21wYXJpc29ucy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0ge0FycmF5fSBvdGhlciBUaGUgb3RoZXIgYXJyYXkgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGVxdWFsRnVuYyBUaGUgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGVxdWl2YWxlbnRzIG9mIHZhbHVlcy5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGN1c3RvbWl6ZXIgVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBjb21wYXJpc29ucy5cbiAqIEBwYXJhbSB7bnVtYmVyfSBiaXRtYXNrIFRoZSBiaXRtYXNrIG9mIGNvbXBhcmlzb24gZmxhZ3MuIFNlZSBgYmFzZUlzRXF1YWxgXG4gKiAgZm9yIG1vcmUgZGV0YWlscy5cbiAqIEBwYXJhbSB7T2JqZWN0fSBzdGFjayBUcmFja3MgdHJhdmVyc2VkIGBhcnJheWAgYW5kIGBvdGhlcmAgb2JqZWN0cy5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYXJyYXlzIGFyZSBlcXVpdmFsZW50LCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGVxdWFsQXJyYXlzKGFycmF5LCBvdGhlciwgZXF1YWxGdW5jLCBjdXN0b21pemVyLCBiaXRtYXNrLCBzdGFjaykge1xuICB2YXIgaXNQYXJ0aWFsID0gYml0bWFzayAmIFBBUlRJQUxfQ09NUEFSRV9GTEFHLFxuICAgICAgYXJyTGVuZ3RoID0gYXJyYXkubGVuZ3RoLFxuICAgICAgb3RoTGVuZ3RoID0gb3RoZXIubGVuZ3RoO1xuXG4gIGlmIChhcnJMZW5ndGggIT0gb3RoTGVuZ3RoICYmICEoaXNQYXJ0aWFsICYmIG90aExlbmd0aCA+IGFyckxlbmd0aCkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgLy8gQXNzdW1lIGN5Y2xpYyB2YWx1ZXMgYXJlIGVxdWFsLlxuICB2YXIgc3RhY2tlZCA9IHN0YWNrLmdldChhcnJheSk7XG4gIGlmIChzdGFja2VkICYmIHN0YWNrLmdldChvdGhlcikpIHtcbiAgICByZXR1cm4gc3RhY2tlZCA9PSBvdGhlcjtcbiAgfVxuICB2YXIgaW5kZXggPSAtMSxcbiAgICAgIHJlc3VsdCA9IHRydWUsXG4gICAgICBzZWVuID0gKGJpdG1hc2sgJiBVTk9SREVSRURfQ09NUEFSRV9GTEFHKSA/IG5ldyBTZXRDYWNoZSA6IHVuZGVmaW5lZDtcblxuICBzdGFjay5zZXQoYXJyYXksIG90aGVyKTtcbiAgc3RhY2suc2V0KG90aGVyLCBhcnJheSk7XG5cbiAgLy8gSWdub3JlIG5vbi1pbmRleCBwcm9wZXJ0aWVzLlxuICB3aGlsZSAoKytpbmRleCA8IGFyckxlbmd0aCkge1xuICAgIHZhciBhcnJWYWx1ZSA9IGFycmF5W2luZGV4XSxcbiAgICAgICAgb3RoVmFsdWUgPSBvdGhlcltpbmRleF07XG5cbiAgICBpZiAoY3VzdG9taXplcikge1xuICAgICAgdmFyIGNvbXBhcmVkID0gaXNQYXJ0aWFsXG4gICAgICAgID8gY3VzdG9taXplcihvdGhWYWx1ZSwgYXJyVmFsdWUsIGluZGV4LCBvdGhlciwgYXJyYXksIHN0YWNrKVxuICAgICAgICA6IGN1c3RvbWl6ZXIoYXJyVmFsdWUsIG90aFZhbHVlLCBpbmRleCwgYXJyYXksIG90aGVyLCBzdGFjayk7XG4gICAgfVxuICAgIGlmIChjb21wYXJlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAoY29tcGFyZWQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICByZXN1bHQgPSBmYWxzZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICAvLyBSZWN1cnNpdmVseSBjb21wYXJlIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpLlxuICAgIGlmIChzZWVuKSB7XG4gICAgICBpZiAoIWFycmF5U29tZShvdGhlciwgZnVuY3Rpb24ob3RoVmFsdWUsIG90aEluZGV4KSB7XG4gICAgICAgICAgICBpZiAoIXNlZW4uaGFzKG90aEluZGV4KSAmJlxuICAgICAgICAgICAgICAgIChhcnJWYWx1ZSA9PT0gb3RoVmFsdWUgfHwgZXF1YWxGdW5jKGFyclZhbHVlLCBvdGhWYWx1ZSwgY3VzdG9taXplciwgYml0bWFzaywgc3RhY2spKSkge1xuICAgICAgICAgICAgICByZXR1cm4gc2Vlbi5hZGQob3RoSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pKSB7XG4gICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCEoXG4gICAgICAgICAgYXJyVmFsdWUgPT09IG90aFZhbHVlIHx8XG4gICAgICAgICAgICBlcXVhbEZ1bmMoYXJyVmFsdWUsIG90aFZhbHVlLCBjdXN0b21pemVyLCBiaXRtYXNrLCBzdGFjaylcbiAgICAgICAgKSkge1xuICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgc3RhY2tbJ2RlbGV0ZSddKGFycmF5KTtcbiAgc3RhY2tbJ2RlbGV0ZSddKG90aGVyKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYGJhc2VJc0VxdWFsRGVlcGAgZm9yIGNvbXBhcmluZyBvYmplY3RzIG9mXG4gKiB0aGUgc2FtZSBgdG9TdHJpbmdUYWdgLlxuICpcbiAqICoqTm90ZToqKiBUaGlzIGZ1bmN0aW9uIG9ubHkgc3VwcG9ydHMgY29tcGFyaW5nIHZhbHVlcyB3aXRoIHRhZ3Mgb2ZcbiAqIGBCb29sZWFuYCwgYERhdGVgLCBgRXJyb3JgLCBgTnVtYmVyYCwgYFJlZ0V4cGAsIG9yIGBTdHJpbmdgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvdGhlciBUaGUgb3RoZXIgb2JqZWN0IHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnIFRoZSBgdG9TdHJpbmdUYWdgIG9mIHRoZSBvYmplY3RzIHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcXVhbEZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGRldGVybWluZSBlcXVpdmFsZW50cyBvZiB2YWx1ZXMuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjdXN0b21pemVyIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgY29tcGFyaXNvbnMuXG4gKiBAcGFyYW0ge251bWJlcn0gYml0bWFzayBUaGUgYml0bWFzayBvZiBjb21wYXJpc29uIGZsYWdzLiBTZWUgYGJhc2VJc0VxdWFsYFxuICogIGZvciBtb3JlIGRldGFpbHMuXG4gKiBAcGFyYW0ge09iamVjdH0gc3RhY2sgVHJhY2tzIHRyYXZlcnNlZCBgb2JqZWN0YCBhbmQgYG90aGVyYCBvYmplY3RzLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBvYmplY3RzIGFyZSBlcXVpdmFsZW50LCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGVxdWFsQnlUYWcob2JqZWN0LCBvdGhlciwgdGFnLCBlcXVhbEZ1bmMsIGN1c3RvbWl6ZXIsIGJpdG1hc2ssIHN0YWNrKSB7XG4gIHN3aXRjaCAodGFnKSB7XG4gICAgY2FzZSBkYXRhVmlld1RhZzpcbiAgICAgIGlmICgob2JqZWN0LmJ5dGVMZW5ndGggIT0gb3RoZXIuYnl0ZUxlbmd0aCkgfHxcbiAgICAgICAgICAob2JqZWN0LmJ5dGVPZmZzZXQgIT0gb3RoZXIuYnl0ZU9mZnNldCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgb2JqZWN0ID0gb2JqZWN0LmJ1ZmZlcjtcbiAgICAgIG90aGVyID0gb3RoZXIuYnVmZmVyO1xuXG4gICAgY2FzZSBhcnJheUJ1ZmZlclRhZzpcbiAgICAgIGlmICgob2JqZWN0LmJ5dGVMZW5ndGggIT0gb3RoZXIuYnl0ZUxlbmd0aCkgfHxcbiAgICAgICAgICAhZXF1YWxGdW5jKG5ldyBVaW50OEFycmF5KG9iamVjdCksIG5ldyBVaW50OEFycmF5KG90aGVyKSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICBjYXNlIGJvb2xUYWc6XG4gICAgY2FzZSBkYXRlVGFnOlxuICAgIGNhc2UgbnVtYmVyVGFnOlxuICAgICAgLy8gQ29lcmNlIGJvb2xlYW5zIHRvIGAxYCBvciBgMGAgYW5kIGRhdGVzIHRvIG1pbGxpc2Vjb25kcy5cbiAgICAgIC8vIEludmFsaWQgZGF0ZXMgYXJlIGNvZXJjZWQgdG8gYE5hTmAuXG4gICAgICByZXR1cm4gZXEoK29iamVjdCwgK290aGVyKTtcblxuICAgIGNhc2UgZXJyb3JUYWc6XG4gICAgICByZXR1cm4gb2JqZWN0Lm5hbWUgPT0gb3RoZXIubmFtZSAmJiBvYmplY3QubWVzc2FnZSA9PSBvdGhlci5tZXNzYWdlO1xuXG4gICAgY2FzZSByZWdleHBUYWc6XG4gICAgY2FzZSBzdHJpbmdUYWc6XG4gICAgICAvLyBDb2VyY2UgcmVnZXhlcyB0byBzdHJpbmdzIGFuZCB0cmVhdCBzdHJpbmdzLCBwcmltaXRpdmVzIGFuZCBvYmplY3RzLFxuICAgICAgLy8gYXMgZXF1YWwuIFNlZSBodHRwOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtcmVnZXhwLnByb3RvdHlwZS50b3N0cmluZ1xuICAgICAgLy8gZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgIHJldHVybiBvYmplY3QgPT0gKG90aGVyICsgJycpO1xuXG4gICAgY2FzZSBtYXBUYWc6XG4gICAgICB2YXIgY29udmVydCA9IG1hcFRvQXJyYXk7XG5cbiAgICBjYXNlIHNldFRhZzpcbiAgICAgIHZhciBpc1BhcnRpYWwgPSBiaXRtYXNrICYgUEFSVElBTF9DT01QQVJFX0ZMQUc7XG4gICAgICBjb252ZXJ0IHx8IChjb252ZXJ0ID0gc2V0VG9BcnJheSk7XG5cbiAgICAgIGlmIChvYmplY3Quc2l6ZSAhPSBvdGhlci5zaXplICYmICFpc1BhcnRpYWwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgLy8gQXNzdW1lIGN5Y2xpYyB2YWx1ZXMgYXJlIGVxdWFsLlxuICAgICAgdmFyIHN0YWNrZWQgPSBzdGFjay5nZXQob2JqZWN0KTtcbiAgICAgIGlmIChzdGFja2VkKSB7XG4gICAgICAgIHJldHVybiBzdGFja2VkID09IG90aGVyO1xuICAgICAgfVxuICAgICAgYml0bWFzayB8PSBVTk9SREVSRURfQ09NUEFSRV9GTEFHO1xuXG4gICAgICAvLyBSZWN1cnNpdmVseSBjb21wYXJlIG9iamVjdHMgKHN1c2NlcHRpYmxlIHRvIGNhbGwgc3RhY2sgbGltaXRzKS5cbiAgICAgIHN0YWNrLnNldChvYmplY3QsIG90aGVyKTtcbiAgICAgIHZhciByZXN1bHQgPSBlcXVhbEFycmF5cyhjb252ZXJ0KG9iamVjdCksIGNvbnZlcnQob3RoZXIpLCBlcXVhbEZ1bmMsIGN1c3RvbWl6ZXIsIGJpdG1hc2ssIHN0YWNrKTtcbiAgICAgIHN0YWNrWydkZWxldGUnXShvYmplY3QpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgIGNhc2Ugc3ltYm9sVGFnOlxuICAgICAgaWYgKHN5bWJvbFZhbHVlT2YpIHtcbiAgICAgICAgcmV0dXJuIHN5bWJvbFZhbHVlT2YuY2FsbChvYmplY3QpID09IHN5bWJvbFZhbHVlT2YuY2FsbChvdGhlcik7XG4gICAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgYmFzZUlzRXF1YWxEZWVwYCBmb3Igb2JqZWN0cyB3aXRoIHN1cHBvcnQgZm9yXG4gKiBwYXJ0aWFsIGRlZXAgY29tcGFyaXNvbnMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBjb21wYXJlLlxuICogQHBhcmFtIHtPYmplY3R9IG90aGVyIFRoZSBvdGhlciBvYmplY3QgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGVxdWFsRnVuYyBUaGUgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGVxdWl2YWxlbnRzIG9mIHZhbHVlcy5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGN1c3RvbWl6ZXIgVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBjb21wYXJpc29ucy5cbiAqIEBwYXJhbSB7bnVtYmVyfSBiaXRtYXNrIFRoZSBiaXRtYXNrIG9mIGNvbXBhcmlzb24gZmxhZ3MuIFNlZSBgYmFzZUlzRXF1YWxgXG4gKiAgZm9yIG1vcmUgZGV0YWlscy5cbiAqIEBwYXJhbSB7T2JqZWN0fSBzdGFjayBUcmFja3MgdHJhdmVyc2VkIGBvYmplY3RgIGFuZCBgb3RoZXJgIG9iamVjdHMuXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9iamVjdHMgYXJlIGVxdWl2YWxlbnQsIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gZXF1YWxPYmplY3RzKG9iamVjdCwgb3RoZXIsIGVxdWFsRnVuYywgY3VzdG9taXplciwgYml0bWFzaywgc3RhY2spIHtcbiAgdmFyIGlzUGFydGlhbCA9IGJpdG1hc2sgJiBQQVJUSUFMX0NPTVBBUkVfRkxBRyxcbiAgICAgIG9ialByb3BzID0ga2V5cyhvYmplY3QpLFxuICAgICAgb2JqTGVuZ3RoID0gb2JqUHJvcHMubGVuZ3RoLFxuICAgICAgb3RoUHJvcHMgPSBrZXlzKG90aGVyKSxcbiAgICAgIG90aExlbmd0aCA9IG90aFByb3BzLmxlbmd0aDtcblxuICBpZiAob2JqTGVuZ3RoICE9IG90aExlbmd0aCAmJiAhaXNQYXJ0aWFsKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHZhciBpbmRleCA9IG9iakxlbmd0aDtcbiAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICB2YXIga2V5ID0gb2JqUHJvcHNbaW5kZXhdO1xuICAgIGlmICghKGlzUGFydGlhbCA/IGtleSBpbiBvdGhlciA6IGhhc093blByb3BlcnR5LmNhbGwob3RoZXIsIGtleSkpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIC8vIEFzc3VtZSBjeWNsaWMgdmFsdWVzIGFyZSBlcXVhbC5cbiAgdmFyIHN0YWNrZWQgPSBzdGFjay5nZXQob2JqZWN0KTtcbiAgaWYgKHN0YWNrZWQgJiYgc3RhY2suZ2V0KG90aGVyKSkge1xuICAgIHJldHVybiBzdGFja2VkID09IG90aGVyO1xuICB9XG4gIHZhciByZXN1bHQgPSB0cnVlO1xuICBzdGFjay5zZXQob2JqZWN0LCBvdGhlcik7XG4gIHN0YWNrLnNldChvdGhlciwgb2JqZWN0KTtcblxuICB2YXIgc2tpcEN0b3IgPSBpc1BhcnRpYWw7XG4gIHdoaWxlICgrK2luZGV4IDwgb2JqTGVuZ3RoKSB7XG4gICAga2V5ID0gb2JqUHJvcHNbaW5kZXhdO1xuICAgIHZhciBvYmpWYWx1ZSA9IG9iamVjdFtrZXldLFxuICAgICAgICBvdGhWYWx1ZSA9IG90aGVyW2tleV07XG5cbiAgICBpZiAoY3VzdG9taXplcikge1xuICAgICAgdmFyIGNvbXBhcmVkID0gaXNQYXJ0aWFsXG4gICAgICAgID8gY3VzdG9taXplcihvdGhWYWx1ZSwgb2JqVmFsdWUsIGtleSwgb3RoZXIsIG9iamVjdCwgc3RhY2spXG4gICAgICAgIDogY3VzdG9taXplcihvYmpWYWx1ZSwgb3RoVmFsdWUsIGtleSwgb2JqZWN0LCBvdGhlciwgc3RhY2spO1xuICAgIH1cbiAgICAvLyBSZWN1cnNpdmVseSBjb21wYXJlIG9iamVjdHMgKHN1c2NlcHRpYmxlIHRvIGNhbGwgc3RhY2sgbGltaXRzKS5cbiAgICBpZiAoIShjb21wYXJlZCA9PT0gdW5kZWZpbmVkXG4gICAgICAgICAgPyAob2JqVmFsdWUgPT09IG90aFZhbHVlIHx8IGVxdWFsRnVuYyhvYmpWYWx1ZSwgb3RoVmFsdWUsIGN1c3RvbWl6ZXIsIGJpdG1hc2ssIHN0YWNrKSlcbiAgICAgICAgICA6IGNvbXBhcmVkXG4gICAgICAgICkpIHtcbiAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHNraXBDdG9yIHx8IChza2lwQ3RvciA9IGtleSA9PSAnY29uc3RydWN0b3InKTtcbiAgfVxuICBpZiAocmVzdWx0ICYmICFza2lwQ3Rvcikge1xuICAgIHZhciBvYmpDdG9yID0gb2JqZWN0LmNvbnN0cnVjdG9yLFxuICAgICAgICBvdGhDdG9yID0gb3RoZXIuY29uc3RydWN0b3I7XG5cbiAgICAvLyBOb24gYE9iamVjdGAgb2JqZWN0IGluc3RhbmNlcyB3aXRoIGRpZmZlcmVudCBjb25zdHJ1Y3RvcnMgYXJlIG5vdCBlcXVhbC5cbiAgICBpZiAob2JqQ3RvciAhPSBvdGhDdG9yICYmXG4gICAgICAgICgnY29uc3RydWN0b3InIGluIG9iamVjdCAmJiAnY29uc3RydWN0b3InIGluIG90aGVyKSAmJlxuICAgICAgICAhKHR5cGVvZiBvYmpDdG9yID09ICdmdW5jdGlvbicgJiYgb2JqQ3RvciBpbnN0YW5jZW9mIG9iakN0b3IgJiZcbiAgICAgICAgICB0eXBlb2Ygb3RoQ3RvciA9PSAnZnVuY3Rpb24nICYmIG90aEN0b3IgaW5zdGFuY2VvZiBvdGhDdG9yKSkge1xuICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIHN0YWNrWydkZWxldGUnXShvYmplY3QpO1xuICBzdGFja1snZGVsZXRlJ10ob3RoZXIpO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIEdldHMgdGhlIGRhdGEgZm9yIGBtYXBgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gbWFwIFRoZSBtYXAgdG8gcXVlcnkuXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSByZWZlcmVuY2Uga2V5LlxuICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIG1hcCBkYXRhLlxuICovXG5mdW5jdGlvbiBnZXRNYXBEYXRhKG1hcCwga2V5KSB7XG4gIHZhciBkYXRhID0gbWFwLl9fZGF0YV9fO1xuICByZXR1cm4gaXNLZXlhYmxlKGtleSlcbiAgICA/IGRhdGFbdHlwZW9mIGtleSA9PSAnc3RyaW5nJyA/ICdzdHJpbmcnIDogJ2hhc2gnXVxuICAgIDogZGF0YS5tYXA7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgcHJvcGVydHkgbmFtZXMsIHZhbHVlcywgYW5kIGNvbXBhcmUgZmxhZ3Mgb2YgYG9iamVjdGAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbWF0Y2ggZGF0YSBvZiBgb2JqZWN0YC5cbiAqL1xuZnVuY3Rpb24gZ2V0TWF0Y2hEYXRhKG9iamVjdCkge1xuICB2YXIgcmVzdWx0ID0ga2V5cyhvYmplY3QpLFxuICAgICAgbGVuZ3RoID0gcmVzdWx0Lmxlbmd0aDtcblxuICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICB2YXIga2V5ID0gcmVzdWx0W2xlbmd0aF0sXG4gICAgICAgIHZhbHVlID0gb2JqZWN0W2tleV07XG5cbiAgICByZXN1bHRbbGVuZ3RoXSA9IFtrZXksIHZhbHVlLCBpc1N0cmljdENvbXBhcmFibGUodmFsdWUpXTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIEdldHMgdGhlIG5hdGl2ZSBmdW5jdGlvbiBhdCBga2V5YCBvZiBgb2JqZWN0YC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBtZXRob2QgdG8gZ2V0LlxuICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGZ1bmN0aW9uIGlmIGl0J3MgbmF0aXZlLCBlbHNlIGB1bmRlZmluZWRgLlxuICovXG5mdW5jdGlvbiBnZXROYXRpdmUob2JqZWN0LCBrZXkpIHtcbiAgdmFyIHZhbHVlID0gZ2V0VmFsdWUob2JqZWN0LCBrZXkpO1xuICByZXR1cm4gYmFzZUlzTmF0aXZlKHZhbHVlKSA/IHZhbHVlIDogdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIGB0b1N0cmluZ1RhZ2Agb2YgYHZhbHVlYC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gcXVlcnkuXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBgdG9TdHJpbmdUYWdgLlxuICovXG52YXIgZ2V0VGFnID0gYmFzZUdldFRhZztcblxuLy8gRmFsbGJhY2sgZm9yIGRhdGEgdmlld3MsIG1hcHMsIHNldHMsIGFuZCB3ZWFrIG1hcHMgaW4gSUUgMTEsXG4vLyBmb3IgZGF0YSB2aWV3cyBpbiBFZGdlIDwgMTQsIGFuZCBwcm9taXNlcyBpbiBOb2RlLmpzLlxuaWYgKChEYXRhVmlldyAmJiBnZXRUYWcobmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcigxKSkpICE9IGRhdGFWaWV3VGFnKSB8fFxuICAgIChNYXAgJiYgZ2V0VGFnKG5ldyBNYXApICE9IG1hcFRhZykgfHxcbiAgICAoUHJvbWlzZSAmJiBnZXRUYWcoUHJvbWlzZS5yZXNvbHZlKCkpICE9IHByb21pc2VUYWcpIHx8XG4gICAgKFNldCAmJiBnZXRUYWcobmV3IFNldCkgIT0gc2V0VGFnKSB8fFxuICAgIChXZWFrTWFwICYmIGdldFRhZyhuZXcgV2Vha01hcCkgIT0gd2Vha01hcFRhZykpIHtcbiAgZ2V0VGFnID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICB2YXIgcmVzdWx0ID0gb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSksXG4gICAgICAgIEN0b3IgPSByZXN1bHQgPT0gb2JqZWN0VGFnID8gdmFsdWUuY29uc3RydWN0b3IgOiB1bmRlZmluZWQsXG4gICAgICAgIGN0b3JTdHJpbmcgPSBDdG9yID8gdG9Tb3VyY2UoQ3RvcikgOiB1bmRlZmluZWQ7XG5cbiAgICBpZiAoY3RvclN0cmluZykge1xuICAgICAgc3dpdGNoIChjdG9yU3RyaW5nKSB7XG4gICAgICAgIGNhc2UgZGF0YVZpZXdDdG9yU3RyaW5nOiByZXR1cm4gZGF0YVZpZXdUYWc7XG4gICAgICAgIGNhc2UgbWFwQ3RvclN0cmluZzogcmV0dXJuIG1hcFRhZztcbiAgICAgICAgY2FzZSBwcm9taXNlQ3RvclN0cmluZzogcmV0dXJuIHByb21pc2VUYWc7XG4gICAgICAgIGNhc2Ugc2V0Q3RvclN0cmluZzogcmV0dXJuIHNldFRhZztcbiAgICAgICAgY2FzZSB3ZWFrTWFwQ3RvclN0cmluZzogcmV0dXJuIHdlYWtNYXBUYWc7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGBwYXRoYCBleGlzdHMgb24gYG9iamVjdGAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAqIEBwYXJhbSB7QXJyYXl8c3RyaW5nfSBwYXRoIFRoZSBwYXRoIHRvIGNoZWNrLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gaGFzRnVuYyBUaGUgZnVuY3Rpb24gdG8gY2hlY2sgcHJvcGVydGllcy5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgcGF0aGAgZXhpc3RzLCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGhhc1BhdGgob2JqZWN0LCBwYXRoLCBoYXNGdW5jKSB7XG4gIHBhdGggPSBpc0tleShwYXRoLCBvYmplY3QpID8gW3BhdGhdIDogY2FzdFBhdGgocGF0aCk7XG5cbiAgdmFyIHJlc3VsdCxcbiAgICAgIGluZGV4ID0gLTEsXG4gICAgICBsZW5ndGggPSBwYXRoLmxlbmd0aDtcblxuICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgIHZhciBrZXkgPSB0b0tleShwYXRoW2luZGV4XSk7XG4gICAgaWYgKCEocmVzdWx0ID0gb2JqZWN0ICE9IG51bGwgJiYgaGFzRnVuYyhvYmplY3QsIGtleSkpKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgb2JqZWN0ID0gb2JqZWN0W2tleV07XG4gIH1cbiAgaWYgKHJlc3VsdCkge1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgdmFyIGxlbmd0aCA9IG9iamVjdCA/IG9iamVjdC5sZW5ndGggOiAwO1xuICByZXR1cm4gISFsZW5ndGggJiYgaXNMZW5ndGgobGVuZ3RoKSAmJiBpc0luZGV4KGtleSwgbGVuZ3RoKSAmJlxuICAgIChpc0FycmF5KG9iamVjdCkgfHwgaXNBcmd1bWVudHMob2JqZWN0KSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSB2YWxpZCBhcnJheS1saWtlIGluZGV4LlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEBwYXJhbSB7bnVtYmVyfSBbbGVuZ3RoPU1BWF9TQUZFX0lOVEVHRVJdIFRoZSB1cHBlciBib3VuZHMgb2YgYSB2YWxpZCBpbmRleC5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgdmFsaWQgaW5kZXgsIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gaXNJbmRleCh2YWx1ZSwgbGVuZ3RoKSB7XG4gIGxlbmd0aCA9IGxlbmd0aCA9PSBudWxsID8gTUFYX1NBRkVfSU5URUdFUiA6IGxlbmd0aDtcbiAgcmV0dXJuICEhbGVuZ3RoICYmXG4gICAgKHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJyB8fCByZUlzVWludC50ZXN0KHZhbHVlKSkgJiZcbiAgICAodmFsdWUgPiAtMSAmJiB2YWx1ZSAlIDEgPT0gMCAmJiB2YWx1ZSA8IGxlbmd0aCk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSBwcm9wZXJ0eSBuYW1lIGFuZCBub3QgYSBwcm9wZXJ0eSBwYXRoLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb2JqZWN0XSBUaGUgb2JqZWN0IHRvIHF1ZXJ5IGtleXMgb24uXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHByb3BlcnR5IG5hbWUsIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gaXNLZXkodmFsdWUsIG9iamVjdCkge1xuICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIHR5cGUgPSB0eXBlb2YgdmFsdWU7XG4gIGlmICh0eXBlID09ICdudW1iZXInIHx8IHR5cGUgPT0gJ3N5bWJvbCcgfHwgdHlwZSA9PSAnYm9vbGVhbicgfHxcbiAgICAgIHZhbHVlID09IG51bGwgfHwgaXNTeW1ib2wodmFsdWUpKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIHJlSXNQbGFpblByb3AudGVzdCh2YWx1ZSkgfHwgIXJlSXNEZWVwUHJvcC50ZXN0KHZhbHVlKSB8fFxuICAgIChvYmplY3QgIT0gbnVsbCAmJiB2YWx1ZSBpbiBPYmplY3Qob2JqZWN0KSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgc3VpdGFibGUgZm9yIHVzZSBhcyB1bmlxdWUgb2JqZWN0IGtleS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBzdWl0YWJsZSwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBpc0tleWFibGUodmFsdWUpIHtcbiAgdmFyIHR5cGUgPSB0eXBlb2YgdmFsdWU7XG4gIHJldHVybiAodHlwZSA9PSAnc3RyaW5nJyB8fCB0eXBlID09ICdudW1iZXInIHx8IHR5cGUgPT0gJ3N5bWJvbCcgfHwgdHlwZSA9PSAnYm9vbGVhbicpXG4gICAgPyAodmFsdWUgIT09ICdfX3Byb3RvX18nKVxuICAgIDogKHZhbHVlID09PSBudWxsKTtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgYGZ1bmNgIGhhcyBpdHMgc291cmNlIG1hc2tlZC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYGZ1bmNgIGlzIG1hc2tlZCwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBpc01hc2tlZChmdW5jKSB7XG4gIHJldHVybiAhIW1hc2tTcmNLZXkgJiYgKG1hc2tTcmNLZXkgaW4gZnVuYyk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgbGlrZWx5IGEgcHJvdG90eXBlIG9iamVjdC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHByb3RvdHlwZSwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBpc1Byb3RvdHlwZSh2YWx1ZSkge1xuICB2YXIgQ3RvciA9IHZhbHVlICYmIHZhbHVlLmNvbnN0cnVjdG9yLFxuICAgICAgcHJvdG8gPSAodHlwZW9mIEN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBDdG9yLnByb3RvdHlwZSkgfHwgb2JqZWN0UHJvdG87XG5cbiAgcmV0dXJuIHZhbHVlID09PSBwcm90bztcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBzdWl0YWJsZSBmb3Igc3RyaWN0IGVxdWFsaXR5IGNvbXBhcmlzb25zLCBpLmUuIGA9PT1gLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlmIHN1aXRhYmxlIGZvciBzdHJpY3RcbiAqICBlcXVhbGl0eSBjb21wYXJpc29ucywgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBpc1N0cmljdENvbXBhcmFibGUodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlID09PSB2YWx1ZSAmJiAhaXNPYmplY3QodmFsdWUpO1xufVxuXG4vKipcbiAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgbWF0Y2hlc1Byb3BlcnR5YCBmb3Igc291cmNlIHZhbHVlcyBzdWl0YWJsZVxuICogZm9yIHN0cmljdCBlcXVhbGl0eSBjb21wYXJpc29ucywgaS5lLiBgPT09YC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBwcm9wZXJ0eSB0byBnZXQuXG4gKiBAcGFyYW0geyp9IHNyY1ZhbHVlIFRoZSB2YWx1ZSB0byBtYXRjaC5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHNwZWMgZnVuY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIG1hdGNoZXNTdHJpY3RDb21wYXJhYmxlKGtleSwgc3JjVmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKG9iamVjdCkge1xuICAgIGlmIChvYmplY3QgPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gb2JqZWN0W2tleV0gPT09IHNyY1ZhbHVlICYmXG4gICAgICAoc3JjVmFsdWUgIT09IHVuZGVmaW5lZCB8fCAoa2V5IGluIE9iamVjdChvYmplY3QpKSk7XG4gIH07XG59XG5cbi8qKlxuICogQ29udmVydHMgYHN0cmluZ2AgdG8gYSBwcm9wZXJ0eSBwYXRoIGFycmF5LlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgcHJvcGVydHkgcGF0aCBhcnJheS5cbiAqL1xudmFyIHN0cmluZ1RvUGF0aCA9IG1lbW9pemUoZnVuY3Rpb24oc3RyaW5nKSB7XG4gIHN0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7XG5cbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBpZiAocmVMZWFkaW5nRG90LnRlc3Qoc3RyaW5nKSkge1xuICAgIHJlc3VsdC5wdXNoKCcnKTtcbiAgfVxuICBzdHJpbmcucmVwbGFjZShyZVByb3BOYW1lLCBmdW5jdGlvbihtYXRjaCwgbnVtYmVyLCBxdW90ZSwgc3RyaW5nKSB7XG4gICAgcmVzdWx0LnB1c2gocXVvdGUgPyBzdHJpbmcucmVwbGFjZShyZUVzY2FwZUNoYXIsICckMScpIDogKG51bWJlciB8fCBtYXRjaCkpO1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn0pO1xuXG4vKipcbiAqIENvbnZlcnRzIGB2YWx1ZWAgdG8gYSBzdHJpbmcga2V5IGlmIGl0J3Mgbm90IGEgc3RyaW5nIG9yIHN5bWJvbC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gaW5zcGVjdC5cbiAqIEByZXR1cm5zIHtzdHJpbmd8c3ltYm9sfSBSZXR1cm5zIHRoZSBrZXkuXG4gKi9cbmZ1bmN0aW9uIHRvS2V5KHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycgfHwgaXNTeW1ib2wodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIHZhciByZXN1bHQgPSAodmFsdWUgKyAnJyk7XG4gIHJldHVybiAocmVzdWx0ID09ICcwJyAmJiAoMSAvIHZhbHVlKSA9PSAtSU5GSU5JVFkpID8gJy0wJyA6IHJlc3VsdDtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBgZnVuY2AgdG8gaXRzIHNvdXJjZSBjb2RlLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBwcm9jZXNzLlxuICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgc291cmNlIGNvZGUuXG4gKi9cbmZ1bmN0aW9uIHRvU291cmNlKGZ1bmMpIHtcbiAgaWYgKGZ1bmMgIT0gbnVsbCkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gZnVuY1RvU3RyaW5nLmNhbGwoZnVuYyk7XG4gICAgfSBjYXRjaCAoZSkge31cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIChmdW5jICsgJycpO1xuICAgIH0gY2F0Y2ggKGUpIHt9XG4gIH1cbiAgcmV0dXJuICcnO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IG1lbW9pemVzIHRoZSByZXN1bHQgb2YgYGZ1bmNgLiBJZiBgcmVzb2x2ZXJgIGlzXG4gKiBwcm92aWRlZCwgaXQgZGV0ZXJtaW5lcyB0aGUgY2FjaGUga2V5IGZvciBzdG9yaW5nIHRoZSByZXN1bHQgYmFzZWQgb24gdGhlXG4gKiBhcmd1bWVudHMgcHJvdmlkZWQgdG8gdGhlIG1lbW9pemVkIGZ1bmN0aW9uLiBCeSBkZWZhdWx0LCB0aGUgZmlyc3QgYXJndW1lbnRcbiAqIHByb3ZpZGVkIHRvIHRoZSBtZW1vaXplZCBmdW5jdGlvbiBpcyB1c2VkIGFzIHRoZSBtYXAgY2FjaGUga2V5LiBUaGUgYGZ1bmNgXG4gKiBpcyBpbnZva2VkIHdpdGggdGhlIGB0aGlzYCBiaW5kaW5nIG9mIHRoZSBtZW1vaXplZCBmdW5jdGlvbi5cbiAqXG4gKiAqKk5vdGU6KiogVGhlIGNhY2hlIGlzIGV4cG9zZWQgYXMgdGhlIGBjYWNoZWAgcHJvcGVydHkgb24gdGhlIG1lbW9pemVkXG4gKiBmdW5jdGlvbi4gSXRzIGNyZWF0aW9uIG1heSBiZSBjdXN0b21pemVkIGJ5IHJlcGxhY2luZyB0aGUgYF8ubWVtb2l6ZS5DYWNoZWBcbiAqIGNvbnN0cnVjdG9yIHdpdGggb25lIHdob3NlIGluc3RhbmNlcyBpbXBsZW1lbnQgdGhlXG4gKiBbYE1hcGBdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLXByb3BlcnRpZXMtb2YtdGhlLW1hcC1wcm90b3R5cGUtb2JqZWN0KVxuICogbWV0aG9kIGludGVyZmFjZSBvZiBgZGVsZXRlYCwgYGdldGAsIGBoYXNgLCBhbmQgYHNldGAuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAwLjEuMFxuICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBoYXZlIGl0cyBvdXRwdXQgbWVtb2l6ZWQuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcmVzb2x2ZXJdIFRoZSBmdW5jdGlvbiB0byByZXNvbHZlIHRoZSBjYWNoZSBrZXkuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBtZW1vaXplZCBmdW5jdGlvbi5cbiAqIEBleGFtcGxlXG4gKlxuICogdmFyIG9iamVjdCA9IHsgJ2EnOiAxLCAnYic6IDIgfTtcbiAqIHZhciBvdGhlciA9IHsgJ2MnOiAzLCAnZCc6IDQgfTtcbiAqXG4gKiB2YXIgdmFsdWVzID0gXy5tZW1vaXplKF8udmFsdWVzKTtcbiAqIHZhbHVlcyhvYmplY3QpO1xuICogLy8gPT4gWzEsIDJdXG4gKlxuICogdmFsdWVzKG90aGVyKTtcbiAqIC8vID0+IFszLCA0XVxuICpcbiAqIG9iamVjdC5hID0gMjtcbiAqIHZhbHVlcyhvYmplY3QpO1xuICogLy8gPT4gWzEsIDJdXG4gKlxuICogLy8gTW9kaWZ5IHRoZSByZXN1bHQgY2FjaGUuXG4gKiB2YWx1ZXMuY2FjaGUuc2V0KG9iamVjdCwgWydhJywgJ2InXSk7XG4gKiB2YWx1ZXMob2JqZWN0KTtcbiAqIC8vID0+IFsnYScsICdiJ11cbiAqXG4gKiAvLyBSZXBsYWNlIGBfLm1lbW9pemUuQ2FjaGVgLlxuICogXy5tZW1vaXplLkNhY2hlID0gV2Vha01hcDtcbiAqL1xuZnVuY3Rpb24gbWVtb2l6ZShmdW5jLCByZXNvbHZlcikge1xuICBpZiAodHlwZW9mIGZ1bmMgIT0gJ2Z1bmN0aW9uJyB8fCAocmVzb2x2ZXIgJiYgdHlwZW9mIHJlc29sdmVyICE9ICdmdW5jdGlvbicpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO1xuICB9XG4gIHZhciBtZW1vaXplZCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICBrZXkgPSByZXNvbHZlciA/IHJlc29sdmVyLmFwcGx5KHRoaXMsIGFyZ3MpIDogYXJnc1swXSxcbiAgICAgICAgY2FjaGUgPSBtZW1vaXplZC5jYWNoZTtcblxuICAgIGlmIChjYWNoZS5oYXMoa2V5KSkge1xuICAgICAgcmV0dXJuIGNhY2hlLmdldChrZXkpO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gZnVuYy5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICBtZW1vaXplZC5jYWNoZSA9IGNhY2hlLnNldChrZXksIHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcbiAgbWVtb2l6ZWQuY2FjaGUgPSBuZXcgKG1lbW9pemUuQ2FjaGUgfHwgTWFwQ2FjaGUpO1xuICByZXR1cm4gbWVtb2l6ZWQ7XG59XG5cbi8vIEFzc2lnbiBjYWNoZSB0byBgXy5tZW1vaXplYC5cbm1lbW9pemUuQ2FjaGUgPSBNYXBDYWNoZTtcblxuLyoqXG4gKiBQZXJmb3JtcyBhXG4gKiBbYFNhbWVWYWx1ZVplcm9gXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1zYW1ldmFsdWV6ZXJvKVxuICogY29tcGFyaXNvbiBiZXR3ZWVuIHR3byB2YWx1ZXMgdG8gZGV0ZXJtaW5lIGlmIHRoZXkgYXJlIGVxdWl2YWxlbnQuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0geyp9IG90aGVyIFRoZSBvdGhlciB2YWx1ZSB0byBjb21wYXJlLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSB2YWx1ZXMgYXJlIGVxdWl2YWxlbnQsIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogdmFyIG9iamVjdCA9IHsgJ2EnOiAxIH07XG4gKiB2YXIgb3RoZXIgPSB7ICdhJzogMSB9O1xuICpcbiAqIF8uZXEob2JqZWN0LCBvYmplY3QpO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uZXEob2JqZWN0LCBvdGhlcik7XG4gKiAvLyA9PiBmYWxzZVxuICpcbiAqIF8uZXEoJ2EnLCAnYScpO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uZXEoJ2EnLCBPYmplY3QoJ2EnKSk7XG4gKiAvLyA9PiBmYWxzZVxuICpcbiAqIF8uZXEoTmFOLCBOYU4pO1xuICogLy8gPT4gdHJ1ZVxuICovXG5mdW5jdGlvbiBlcSh2YWx1ZSwgb3RoZXIpIHtcbiAgcmV0dXJuIHZhbHVlID09PSBvdGhlciB8fCAodmFsdWUgIT09IHZhbHVlICYmIG90aGVyICE9PSBvdGhlcik7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgbGlrZWx5IGFuIGBhcmd1bWVudHNgIG9iamVjdC5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDAuMS4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhbiBgYXJndW1lbnRzYCBvYmplY3QsXG4gKiAgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzQXJndW1lbnRzKGZ1bmN0aW9uKCkgeyByZXR1cm4gYXJndW1lbnRzOyB9KCkpO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNBcmd1bWVudHMoWzEsIDIsIDNdKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzQXJndW1lbnRzKHZhbHVlKSB7XG4gIC8vIFNhZmFyaSA4LjEgbWFrZXMgYGFyZ3VtZW50cy5jYWxsZWVgIGVudW1lcmFibGUgaW4gc3RyaWN0IG1vZGUuXG4gIHJldHVybiBpc0FycmF5TGlrZU9iamVjdCh2YWx1ZSkgJiYgaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ2NhbGxlZScpICYmXG4gICAgKCFwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHZhbHVlLCAnY2FsbGVlJykgfHwgb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gYXJnc1RhZyk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgY2xhc3NpZmllZCBhcyBhbiBgQXJyYXlgIG9iamVjdC5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDAuMS4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhbiBhcnJheSwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzQXJyYXkoWzEsIDIsIDNdKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzQXJyYXkoZG9jdW1lbnQuYm9keS5jaGlsZHJlbik7XG4gKiAvLyA9PiBmYWxzZVxuICpcbiAqIF8uaXNBcnJheSgnYWJjJyk7XG4gKiAvLyA9PiBmYWxzZVxuICpcbiAqIF8uaXNBcnJheShfLm5vb3ApO1xuICogLy8gPT4gZmFsc2VcbiAqL1xudmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGFycmF5LWxpa2UuIEEgdmFsdWUgaXMgY29uc2lkZXJlZCBhcnJheS1saWtlIGlmIGl0J3NcbiAqIG5vdCBhIGZ1bmN0aW9uIGFuZCBoYXMgYSBgdmFsdWUubGVuZ3RoYCB0aGF0J3MgYW4gaW50ZWdlciBncmVhdGVyIHRoYW4gb3JcbiAqIGVxdWFsIHRvIGAwYCBhbmQgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIGBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUmAuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYXJyYXktbGlrZSwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzQXJyYXlMaWtlKFsxLCAyLCAzXSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FycmF5TGlrZShkb2N1bWVudC5ib2R5LmNoaWxkcmVuKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzQXJyYXlMaWtlKCdhYmMnKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzQXJyYXlMaWtlKF8ubm9vcCk7XG4gKiAvLyA9PiBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0FycmF5TGlrZSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiBpc0xlbmd0aCh2YWx1ZS5sZW5ndGgpICYmICFpc0Z1bmN0aW9uKHZhbHVlKTtcbn1cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmlzQXJyYXlMaWtlYCBleGNlcHQgdGhhdCBpdCBhbHNvIGNoZWNrcyBpZiBgdmFsdWVgXG4gKiBpcyBhbiBvYmplY3QuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYW4gYXJyYXktbGlrZSBvYmplY3QsXG4gKiAgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzQXJyYXlMaWtlT2JqZWN0KFsxLCAyLCAzXSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FycmF5TGlrZU9iamVjdChkb2N1bWVudC5ib2R5LmNoaWxkcmVuKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzQXJyYXlMaWtlT2JqZWN0KCdhYmMnKTtcbiAqIC8vID0+IGZhbHNlXG4gKlxuICogXy5pc0FycmF5TGlrZU9iamVjdChfLm5vb3ApO1xuICogLy8gPT4gZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUxpa2VPYmplY3QodmFsdWUpIHtcbiAgcmV0dXJuIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgaXNBcnJheUxpa2UodmFsdWUpO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGNsYXNzaWZpZWQgYXMgYSBgRnVuY3Rpb25gIG9iamVjdC5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDAuMS4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIGZ1bmN0aW9uLCBlbHNlIGBmYWxzZWAuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8uaXNGdW5jdGlvbihfKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzRnVuY3Rpb24oL2FiYy8pO1xuICogLy8gPT4gZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZSkge1xuICAvLyBUaGUgdXNlIG9mIGBPYmplY3QjdG9TdHJpbmdgIGF2b2lkcyBpc3N1ZXMgd2l0aCB0aGUgYHR5cGVvZmAgb3BlcmF0b3JcbiAgLy8gaW4gU2FmYXJpIDgtOSB3aGljaCByZXR1cm5zICdvYmplY3QnIGZvciB0eXBlZCBhcnJheSBhbmQgb3RoZXIgY29uc3RydWN0b3JzLlxuICB2YXIgdGFnID0gaXNPYmplY3QodmFsdWUpID8gb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSkgOiAnJztcbiAgcmV0dXJuIHRhZyA9PSBmdW5jVGFnIHx8IHRhZyA9PSBnZW5UYWc7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSB2YWxpZCBhcnJheS1saWtlIGxlbmd0aC5cbiAqXG4gKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgaXMgbG9vc2VseSBiYXNlZCBvblxuICogW2BUb0xlbmd0aGBdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLXRvbGVuZ3RoKS5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDQuMC4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHZhbGlkIGxlbmd0aCwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzTGVuZ3RoKDMpO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNMZW5ndGgoTnVtYmVyLk1JTl9WQUxVRSk7XG4gKiAvLyA9PiBmYWxzZVxuICpcbiAqIF8uaXNMZW5ndGgoSW5maW5pdHkpO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzTGVuZ3RoKCczJyk7XG4gKiAvLyA9PiBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0xlbmd0aCh2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdudW1iZXInICYmXG4gICAgdmFsdWUgPiAtMSAmJiB2YWx1ZSAlIDEgPT0gMCAmJiB2YWx1ZSA8PSBNQVhfU0FGRV9JTlRFR0VSO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIHRoZVxuICogW2xhbmd1YWdlIHR5cGVdKGh0dHA6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1lY21hc2NyaXB0LWxhbmd1YWdlLXR5cGVzKVxuICogb2YgYE9iamVjdGAuIChlLmcuIGFycmF5cywgZnVuY3Rpb25zLCBvYmplY3RzLCByZWdleGVzLCBgbmV3IE51bWJlcigwKWAsIGFuZCBgbmV3IFN0cmluZygnJylgKVxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgMC4xLjBcbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFuIG9iamVjdCwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzT2JqZWN0KHt9KTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzT2JqZWN0KFsxLCAyLCAzXSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc09iamVjdChfLm5vb3ApO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNPYmplY3QobnVsbCk7XG4gKiAvLyA9PiBmYWxzZVxuICovXG5mdW5jdGlvbiBpc09iamVjdCh2YWx1ZSkge1xuICB2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTtcbiAgcmV0dXJuICEhdmFsdWUgJiYgKHR5cGUgPT0gJ29iamVjdCcgfHwgdHlwZSA9PSAnZnVuY3Rpb24nKTtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBvYmplY3QtbGlrZS4gQSB2YWx1ZSBpcyBvYmplY3QtbGlrZSBpZiBpdCdzIG5vdCBgbnVsbGBcbiAqIGFuZCBoYXMgYSBgdHlwZW9mYCByZXN1bHQgb2YgXCJvYmplY3RcIi5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDQuMC4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBvYmplY3QtbGlrZSwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzT2JqZWN0TGlrZSh7fSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc09iamVjdExpa2UoWzEsIDIsIDNdKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzT2JqZWN0TGlrZShfLm5vb3ApO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzT2JqZWN0TGlrZShudWxsKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0TGlrZSh2YWx1ZSkge1xuICByZXR1cm4gISF2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCc7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgY2xhc3NpZmllZCBhcyBhIGBTeW1ib2xgIHByaW1pdGl2ZSBvciBvYmplY3QuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBzeW1ib2wsIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5pc1N5bWJvbChTeW1ib2wuaXRlcmF0b3IpO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNTeW1ib2woJ2FiYycpO1xuICogLy8gPT4gZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNTeW1ib2wodmFsdWUpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnc3ltYm9sJyB8fFxuICAgIChpc09iamVjdExpa2UodmFsdWUpICYmIG9iamVjdFRvU3RyaW5nLmNhbGwodmFsdWUpID09IHN5bWJvbFRhZyk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgY2xhc3NpZmllZCBhcyBhIHR5cGVkIGFycmF5LlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgMy4wLjBcbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgdHlwZWQgYXJyYXksIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5pc1R5cGVkQXJyYXkobmV3IFVpbnQ4QXJyYXkpO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNUeXBlZEFycmF5KFtdKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbnZhciBpc1R5cGVkQXJyYXkgPSBub2RlSXNUeXBlZEFycmF5ID8gYmFzZVVuYXJ5KG5vZGVJc1R5cGVkQXJyYXkpIDogYmFzZUlzVHlwZWRBcnJheTtcblxuLyoqXG4gKiBDb252ZXJ0cyBgdmFsdWVgIHRvIGEgc3RyaW5nLiBBbiBlbXB0eSBzdHJpbmcgaXMgcmV0dXJuZWQgZm9yIGBudWxsYFxuICogYW5kIGB1bmRlZmluZWRgIHZhbHVlcy4gVGhlIHNpZ24gb2YgYC0wYCBpcyBwcmVzZXJ2ZWQuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHByb2Nlc3MuXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBzdHJpbmcuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8udG9TdHJpbmcobnVsbCk7XG4gKiAvLyA9PiAnJ1xuICpcbiAqIF8udG9TdHJpbmcoLTApO1xuICogLy8gPT4gJy0wJ1xuICpcbiAqIF8udG9TdHJpbmcoWzEsIDIsIDNdKTtcbiAqIC8vID0+ICcxLDIsMydcbiAqL1xuZnVuY3Rpb24gdG9TdHJpbmcodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlID09IG51bGwgPyAnJyA6IGJhc2VUb1N0cmluZyh2YWx1ZSk7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgdmFsdWUgYXQgYHBhdGhgIG9mIGBvYmplY3RgLiBJZiB0aGUgcmVzb2x2ZWQgdmFsdWUgaXNcbiAqIGB1bmRlZmluZWRgLCB0aGUgYGRlZmF1bHRWYWx1ZWAgaXMgcmV0dXJuZWQgaW4gaXRzIHBsYWNlLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgMy43LjBcbiAqIEBjYXRlZ29yeSBPYmplY3RcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAqIEBwYXJhbSB7QXJyYXl8c3RyaW5nfSBwYXRoIFRoZSBwYXRoIG9mIHRoZSBwcm9wZXJ0eSB0byBnZXQuXG4gKiBAcGFyYW0geyp9IFtkZWZhdWx0VmFsdWVdIFRoZSB2YWx1ZSByZXR1cm5lZCBmb3IgYHVuZGVmaW5lZGAgcmVzb2x2ZWQgdmFsdWVzLlxuICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIHJlc29sdmVkIHZhbHVlLlxuICogQGV4YW1wbGVcbiAqXG4gKiB2YXIgb2JqZWN0ID0geyAnYSc6IFt7ICdiJzogeyAnYyc6IDMgfSB9XSB9O1xuICpcbiAqIF8uZ2V0KG9iamVjdCwgJ2FbMF0uYi5jJyk7XG4gKiAvLyA9PiAzXG4gKlxuICogXy5nZXQob2JqZWN0LCBbJ2EnLCAnMCcsICdiJywgJ2MnXSk7XG4gKiAvLyA9PiAzXG4gKlxuICogXy5nZXQob2JqZWN0LCAnYS5iLmMnLCAnZGVmYXVsdCcpO1xuICogLy8gPT4gJ2RlZmF1bHQnXG4gKi9cbmZ1bmN0aW9uIGdldChvYmplY3QsIHBhdGgsIGRlZmF1bHRWYWx1ZSkge1xuICB2YXIgcmVzdWx0ID0gb2JqZWN0ID09IG51bGwgPyB1bmRlZmluZWQgOiBiYXNlR2V0KG9iamVjdCwgcGF0aCk7XG4gIHJldHVybiByZXN1bHQgPT09IHVuZGVmaW5lZCA/IGRlZmF1bHRWYWx1ZSA6IHJlc3VsdDtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgYHBhdGhgIGlzIGEgZGlyZWN0IG9yIGluaGVyaXRlZCBwcm9wZXJ0eSBvZiBgb2JqZWN0YC5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDQuMC4wXG4gKiBAY2F0ZWdvcnkgT2JqZWN0XG4gKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gKiBAcGFyYW0ge0FycmF5fHN0cmluZ30gcGF0aCBUaGUgcGF0aCB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgcGF0aGAgZXhpc3RzLCBlbHNlIGBmYWxzZWAuXG4gKiBAZXhhbXBsZVxuICpcbiAqIHZhciBvYmplY3QgPSBfLmNyZWF0ZSh7ICdhJzogXy5jcmVhdGUoeyAnYic6IDIgfSkgfSk7XG4gKlxuICogXy5oYXNJbihvYmplY3QsICdhJyk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5oYXNJbihvYmplY3QsICdhLmInKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmhhc0luKG9iamVjdCwgWydhJywgJ2InXSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5oYXNJbihvYmplY3QsICdiJyk7XG4gKiAvLyA9PiBmYWxzZVxuICovXG5mdW5jdGlvbiBoYXNJbihvYmplY3QsIHBhdGgpIHtcbiAgcmV0dXJuIG9iamVjdCAhPSBudWxsICYmIGhhc1BhdGgob2JqZWN0LCBwYXRoLCBiYXNlSGFzSW4pO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgdGhlIG93biBlbnVtZXJhYmxlIHByb3BlcnR5IG5hbWVzIG9mIGBvYmplY3RgLlxuICpcbiAqICoqTm90ZToqKiBOb24tb2JqZWN0IHZhbHVlcyBhcmUgY29lcmNlZCB0byBvYmplY3RzLiBTZWUgdGhlXG4gKiBbRVMgc3BlY10oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtb2JqZWN0LmtleXMpXG4gKiBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBzaW5jZSAwLjEuMFxuICogQG1lbWJlck9mIF9cbiAqIEBjYXRlZ29yeSBPYmplY3RcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMuXG4gKiBAZXhhbXBsZVxuICpcbiAqIGZ1bmN0aW9uIEZvbygpIHtcbiAqICAgdGhpcy5hID0gMTtcbiAqICAgdGhpcy5iID0gMjtcbiAqIH1cbiAqXG4gKiBGb28ucHJvdG90eXBlLmMgPSAzO1xuICpcbiAqIF8ua2V5cyhuZXcgRm9vKTtcbiAqIC8vID0+IFsnYScsICdiJ10gKGl0ZXJhdGlvbiBvcmRlciBpcyBub3QgZ3VhcmFudGVlZClcbiAqXG4gKiBfLmtleXMoJ2hpJyk7XG4gKiAvLyA9PiBbJzAnLCAnMSddXG4gKi9cbmZ1bmN0aW9uIGtleXMob2JqZWN0KSB7XG4gIHJldHVybiBpc0FycmF5TGlrZShvYmplY3QpID8gYXJyYXlMaWtlS2V5cyhvYmplY3QpIDogYmFzZUtleXMob2JqZWN0KTtcbn1cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCByZXR1cm5zIHRoZSBmaXJzdCBhcmd1bWVudCBpdCByZWNlaXZlcy5cbiAqXG4gKiBAc3RhdGljXG4gKiBAc2luY2UgMC4xLjBcbiAqIEBtZW1iZXJPZiBfXG4gKiBAY2F0ZWdvcnkgVXRpbFxuICogQHBhcmFtIHsqfSB2YWx1ZSBBbnkgdmFsdWUuXG4gKiBAcmV0dXJucyB7Kn0gUmV0dXJucyBgdmFsdWVgLlxuICogQGV4YW1wbGVcbiAqXG4gKiB2YXIgb2JqZWN0ID0geyAnYSc6IDEgfTtcbiAqXG4gKiBjb25zb2xlLmxvZyhfLmlkZW50aXR5KG9iamVjdCkgPT09IG9iamVjdCk7XG4gKiAvLyA9PiB0cnVlXG4gKi9cbmZ1bmN0aW9uIGlkZW50aXR5KHZhbHVlKSB7XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSB2YWx1ZSBhdCBgcGF0aGAgb2YgYSBnaXZlbiBvYmplY3QuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAyLjQuMFxuICogQGNhdGVnb3J5IFV0aWxcbiAqIEBwYXJhbSB7QXJyYXl8c3RyaW5nfSBwYXRoIFRoZSBwYXRoIG9mIHRoZSBwcm9wZXJ0eSB0byBnZXQuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBhY2Nlc3NvciBmdW5jdGlvbi5cbiAqIEBleGFtcGxlXG4gKlxuICogdmFyIG9iamVjdHMgPSBbXG4gKiAgIHsgJ2EnOiB7ICdiJzogMiB9IH0sXG4gKiAgIHsgJ2EnOiB7ICdiJzogMSB9IH1cbiAqIF07XG4gKlxuICogXy5tYXAob2JqZWN0cywgXy5wcm9wZXJ0eSgnYS5iJykpO1xuICogLy8gPT4gWzIsIDFdXG4gKlxuICogXy5tYXAoXy5zb3J0Qnkob2JqZWN0cywgXy5wcm9wZXJ0eShbJ2EnLCAnYiddKSksICdhLmInKTtcbiAqIC8vID0+IFsxLCAyXVxuICovXG5mdW5jdGlvbiBwcm9wZXJ0eShwYXRoKSB7XG4gIHJldHVybiBpc0tleShwYXRoKSA/IGJhc2VQcm9wZXJ0eSh0b0tleShwYXRoKSkgOiBiYXNlUHJvcGVydHlEZWVwKHBhdGgpO1xufVxuXG4vKipcbiAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8ubWF4YCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGBpdGVyYXRlZWAgd2hpY2ggaXNcbiAqIGludm9rZWQgZm9yIGVhY2ggZWxlbWVudCBpbiBgYXJyYXlgIHRvIGdlbmVyYXRlIHRoZSBjcml0ZXJpb24gYnkgd2hpY2hcbiAqIHRoZSB2YWx1ZSBpcyByYW5rZWQuIFRoZSBpdGVyYXRlZSBpcyBpbnZva2VkIHdpdGggb25lIGFyZ3VtZW50OiAodmFsdWUpLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgNC4wLjBcbiAqIEBjYXRlZ29yeSBNYXRoXG4gKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gW2l0ZXJhdGVlPV8uaWRlbnRpdHldIFRoZSBpdGVyYXRlZSBpbnZva2VkIHBlciBlbGVtZW50LlxuICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIG1heGltdW0gdmFsdWUuXG4gKiBAZXhhbXBsZVxuICpcbiAqIHZhciBvYmplY3RzID0gW3sgJ24nOiAxIH0sIHsgJ24nOiAyIH1dO1xuICpcbiAqIF8ubWF4Qnkob2JqZWN0cywgZnVuY3Rpb24obykgeyByZXR1cm4gby5uOyB9KTtcbiAqIC8vID0+IHsgJ24nOiAyIH1cbiAqXG4gKiAvLyBUaGUgYF8ucHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAqIF8ubWF4Qnkob2JqZWN0cywgJ24nKTtcbiAqIC8vID0+IHsgJ24nOiAyIH1cbiAqL1xuZnVuY3Rpb24gbWF4QnkoYXJyYXksIGl0ZXJhdGVlKSB7XG4gIHJldHVybiAoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKVxuICAgID8gYmFzZUV4dHJlbXVtKGFycmF5LCBiYXNlSXRlcmF0ZWUoaXRlcmF0ZWUsIDIpLCBiYXNlR3QpXG4gICAgOiB1bmRlZmluZWQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gbWF4Qnk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/lodash.maxby/index.js\n");

/***/ }),

/***/ "./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./source/css/diva.scss":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/sass-loader/lib/loader.js!./source/css/diva.scss ***!
  \*******************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("// extracted by mini-css-extract-plugin//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvbWluaS1jc3MtZXh0cmFjdC1wbHVnaW4vZGlzdC9sb2FkZXIuanMhLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9saWIvbG9hZGVyLmpzIS4vc291cmNlL2Nzcy9kaXZhLnNjc3MuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvY3NzL2RpdmEuc2Nzcz9mM2JmIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGV4dHJhY3RlZCBieSBtaW5pLWNzcy1leHRyYWN0LXBsdWdpbiJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./source/css/diva.scss\n");

/***/ }),

/***/ "./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcz9mMjhjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG5mdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbihmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgfVxufSAoKSlcbmZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG4gICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfSBjYXRjaChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5mdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7XG4gICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuXG4gICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZE9uY2VMaXN0ZW5lciA9IG5vb3A7XG5cbnByb2Nlc3MubGlzdGVuZXJzID0gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIFtdIH1cblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/process/browser.js\n");

/***/ }),

/***/ "./node_modules/style-loader/lib/addStyles.js":
/*!****************************************************!*\
  !*** ./node_modules/style-loader/lib/addStyles.js ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = __webpack_require__(/*! ./urls */ \"./node_modules/style-loader/lib/urls.js\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (false) {}\n\n\treturn __webpack_require__.nc;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = typeof options.transform === 'function'\n\t\t ? options.transform(obj.css) \n\t\t : options.transform.default(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2xpYi9hZGRTdHlsZXMuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2xpYi9hZGRTdHlsZXMuanM/Njg0NCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuXHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxuXHRBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhXG4qL1xuXG52YXIgc3R5bGVzSW5Eb20gPSB7fTtcblxudmFyXHRtZW1vaXplID0gZnVuY3Rpb24gKGZuKSB7XG5cdHZhciBtZW1vO1xuXG5cdHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdFx0aWYgKHR5cGVvZiBtZW1vID09PSBcInVuZGVmaW5lZFwiKSBtZW1vID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRyZXR1cm4gbWVtbztcblx0fTtcbn07XG5cbnZhciBpc09sZElFID0gbWVtb2l6ZShmdW5jdGlvbiAoKSB7XG5cdC8vIFRlc3QgZm9yIElFIDw9IDkgYXMgcHJvcG9zZWQgYnkgQnJvd3NlcmhhY2tzXG5cdC8vIEBzZWUgaHR0cDovL2Jyb3dzZXJoYWNrcy5jb20vI2hhY2stZTcxZDg2OTJmNjUzMzQxNzNmZWU3MTVjMjIyY2I4MDVcblx0Ly8gVGVzdHMgZm9yIGV4aXN0ZW5jZSBvZiBzdGFuZGFyZCBnbG9iYWxzIGlzIHRvIGFsbG93IHN0eWxlLWxvYWRlclxuXHQvLyB0byBvcGVyYXRlIGNvcnJlY3RseSBpbnRvIG5vbi1zdGFuZGFyZCBlbnZpcm9ubWVudHNcblx0Ly8gQHNlZSBodHRwczovL2dpdGh1Yi5jb20vd2VicGFjay1jb250cmliL3N0eWxlLWxvYWRlci9pc3N1ZXMvMTc3XG5cdHJldHVybiB3aW5kb3cgJiYgZG9jdW1lbnQgJiYgZG9jdW1lbnQuYWxsICYmICF3aW5kb3cuYXRvYjtcbn0pO1xuXG52YXIgZ2V0VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldCwgcGFyZW50KSB7XG4gIGlmIChwYXJlbnQpe1xuICAgIHJldHVybiBwYXJlbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpO1xuICB9XG4gIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCk7XG59O1xuXG52YXIgZ2V0RWxlbWVudCA9IChmdW5jdGlvbiAoZm4pIHtcblx0dmFyIG1lbW8gPSB7fTtcblxuXHRyZXR1cm4gZnVuY3Rpb24odGFyZ2V0LCBwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBwYXNzaW5nIGZ1bmN0aW9uIGluIG9wdGlvbnMsIHRoZW4gdXNlIGl0IGZvciByZXNvbHZlIFwiaGVhZFwiIGVsZW1lbnQuXG4gICAgICAgICAgICAgICAgLy8gVXNlZnVsIGZvciBTaGFkb3cgUm9vdCBzdHlsZSBpLmVcbiAgICAgICAgICAgICAgICAvLyB7XG4gICAgICAgICAgICAgICAgLy8gICBpbnNlcnRJbnRvOiBmdW5jdGlvbiAoKSB7IHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvb1wiKS5zaGFkb3dSb290IH1cbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0YXJnZXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZW1vW3RhcmdldF0gPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdHZhciBzdHlsZVRhcmdldCA9IGdldFRhcmdldC5jYWxsKHRoaXMsIHRhcmdldCwgcGFyZW50KTtcblx0XHRcdC8vIFNwZWNpYWwgY2FzZSB0byByZXR1cm4gaGVhZCBvZiBpZnJhbWUgaW5zdGVhZCBvZiBpZnJhbWUgaXRzZWxmXG5cdFx0XHRpZiAod2luZG93LkhUTUxJRnJhbWVFbGVtZW50ICYmIHN0eWxlVGFyZ2V0IGluc3RhbmNlb2Ygd2luZG93LkhUTUxJRnJhbWVFbGVtZW50KSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Ly8gVGhpcyB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhY2Nlc3MgdG8gaWZyYW1lIGlzIGJsb2NrZWRcblx0XHRcdFx0XHQvLyBkdWUgdG8gY3Jvc3Mtb3JpZ2luIHJlc3RyaWN0aW9uc1xuXHRcdFx0XHRcdHN0eWxlVGFyZ2V0ID0gc3R5bGVUYXJnZXQuY29udGVudERvY3VtZW50LmhlYWQ7XG5cdFx0XHRcdH0gY2F0Y2goZSkge1xuXHRcdFx0XHRcdHN0eWxlVGFyZ2V0ID0gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0bWVtb1t0YXJnZXRdID0gc3R5bGVUYXJnZXQ7XG5cdFx0fVxuXHRcdHJldHVybiBtZW1vW3RhcmdldF1cblx0fTtcbn0pKCk7XG5cbnZhciBzaW5nbGV0b24gPSBudWxsO1xudmFyXHRzaW5nbGV0b25Db3VudGVyID0gMDtcbnZhclx0c3R5bGVzSW5zZXJ0ZWRBdFRvcCA9IFtdO1xuXG52YXJcdGZpeFVybHMgPSByZXF1aXJlKFwiLi91cmxzXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGxpc3QsIG9wdGlvbnMpIHtcblx0aWYgKHR5cGVvZiBERUJVRyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBERUJVRykge1xuXHRcdGlmICh0eXBlb2YgZG9jdW1lbnQgIT09IFwib2JqZWN0XCIpIHRocm93IG5ldyBFcnJvcihcIlRoZSBzdHlsZS1sb2FkZXIgY2Fubm90IGJlIHVzZWQgaW4gYSBub24tYnJvd3NlciBlbnZpcm9ubWVudFwiKTtcblx0fVxuXG5cdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG5cdG9wdGlvbnMuYXR0cnMgPSB0eXBlb2Ygb3B0aW9ucy5hdHRycyA9PT0gXCJvYmplY3RcIiA/IG9wdGlvbnMuYXR0cnMgOiB7fTtcblxuXHQvLyBGb3JjZSBzaW5nbGUtdGFnIHNvbHV0aW9uIG9uIElFNi05LCB3aGljaCBoYXMgYSBoYXJkIGxpbWl0IG9uIHRoZSAjIG9mIDxzdHlsZT5cblx0Ly8gdGFncyBpdCB3aWxsIGFsbG93IG9uIGEgcGFnZVxuXHRpZiAoIW9wdGlvbnMuc2luZ2xldG9uICYmIHR5cGVvZiBvcHRpb25zLnNpbmdsZXRvbiAhPT0gXCJib29sZWFuXCIpIG9wdGlvbnMuc2luZ2xldG9uID0gaXNPbGRJRSgpO1xuXG5cdC8vIEJ5IGRlZmF1bHQsIGFkZCA8c3R5bGU+IHRhZ3MgdG8gdGhlIDxoZWFkPiBlbGVtZW50XG4gICAgICAgIGlmICghb3B0aW9ucy5pbnNlcnRJbnRvKSBvcHRpb25zLmluc2VydEludG8gPSBcImhlYWRcIjtcblxuXHQvLyBCeSBkZWZhdWx0LCBhZGQgPHN0eWxlPiB0YWdzIHRvIHRoZSBib3R0b20gb2YgdGhlIHRhcmdldFxuXHRpZiAoIW9wdGlvbnMuaW5zZXJ0QXQpIG9wdGlvbnMuaW5zZXJ0QXQgPSBcImJvdHRvbVwiO1xuXG5cdHZhciBzdHlsZXMgPSBsaXN0VG9TdHlsZXMobGlzdCwgb3B0aW9ucyk7XG5cblx0YWRkU3R5bGVzVG9Eb20oc3R5bGVzLCBvcHRpb25zKTtcblxuXHRyZXR1cm4gZnVuY3Rpb24gdXBkYXRlIChuZXdMaXN0KSB7XG5cdFx0dmFyIG1heVJlbW92ZSA9IFtdO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBpdGVtID0gc3R5bGVzW2ldO1xuXHRcdFx0dmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XG5cblx0XHRcdGRvbVN0eWxlLnJlZnMtLTtcblx0XHRcdG1heVJlbW92ZS5wdXNoKGRvbVN0eWxlKTtcblx0XHR9XG5cblx0XHRpZihuZXdMaXN0KSB7XG5cdFx0XHR2YXIgbmV3U3R5bGVzID0gbGlzdFRvU3R5bGVzKG5ld0xpc3QsIG9wdGlvbnMpO1xuXHRcdFx0YWRkU3R5bGVzVG9Eb20obmV3U3R5bGVzLCBvcHRpb25zKTtcblx0XHR9XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG1heVJlbW92ZS5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGRvbVN0eWxlID0gbWF5UmVtb3ZlW2ldO1xuXG5cdFx0XHRpZihkb21TdHlsZS5yZWZzID09PSAwKSB7XG5cdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspIGRvbVN0eWxlLnBhcnRzW2pdKCk7XG5cblx0XHRcdFx0ZGVsZXRlIHN0eWxlc0luRG9tW2RvbVN0eWxlLmlkXTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG59O1xuXG5mdW5jdGlvbiBhZGRTdHlsZXNUb0RvbSAoc3R5bGVzLCBvcHRpb25zKSB7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIGl0ZW0gPSBzdHlsZXNbaV07XG5cdFx0dmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XG5cblx0XHRpZihkb21TdHlsZSkge1xuXHRcdFx0ZG9tU3R5bGUucmVmcysrO1xuXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0ZG9tU3R5bGUucGFydHNbal0oaXRlbS5wYXJ0c1tqXSk7XG5cdFx0XHR9XG5cblx0XHRcdGZvcig7IGogPCBpdGVtLnBhcnRzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdGRvbVN0eWxlLnBhcnRzLnB1c2goYWRkU3R5bGUoaXRlbS5wYXJ0c1tqXSwgb3B0aW9ucykpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgcGFydHMgPSBbXTtcblxuXHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGl0ZW0ucGFydHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0cGFydHMucHVzaChhZGRTdHlsZShpdGVtLnBhcnRzW2pdLCBvcHRpb25zKSk7XG5cdFx0XHR9XG5cblx0XHRcdHN0eWxlc0luRG9tW2l0ZW0uaWRdID0ge2lkOiBpdGVtLmlkLCByZWZzOiAxLCBwYXJ0czogcGFydHN9O1xuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiBsaXN0VG9TdHlsZXMgKGxpc3QsIG9wdGlvbnMpIHtcblx0dmFyIHN0eWxlcyA9IFtdO1xuXHR2YXIgbmV3U3R5bGVzID0ge307XG5cblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIGl0ZW0gPSBsaXN0W2ldO1xuXHRcdHZhciBpZCA9IG9wdGlvbnMuYmFzZSA/IGl0ZW1bMF0gKyBvcHRpb25zLmJhc2UgOiBpdGVtWzBdO1xuXHRcdHZhciBjc3MgPSBpdGVtWzFdO1xuXHRcdHZhciBtZWRpYSA9IGl0ZW1bMl07XG5cdFx0dmFyIHNvdXJjZU1hcCA9IGl0ZW1bM107XG5cdFx0dmFyIHBhcnQgPSB7Y3NzOiBjc3MsIG1lZGlhOiBtZWRpYSwgc291cmNlTWFwOiBzb3VyY2VNYXB9O1xuXG5cdFx0aWYoIW5ld1N0eWxlc1tpZF0pIHN0eWxlcy5wdXNoKG5ld1N0eWxlc1tpZF0gPSB7aWQ6IGlkLCBwYXJ0czogW3BhcnRdfSk7XG5cdFx0ZWxzZSBuZXdTdHlsZXNbaWRdLnBhcnRzLnB1c2gocGFydCk7XG5cdH1cblxuXHRyZXR1cm4gc3R5bGVzO1xufVxuXG5mdW5jdGlvbiBpbnNlcnRTdHlsZUVsZW1lbnQgKG9wdGlvbnMsIHN0eWxlKSB7XG5cdHZhciB0YXJnZXQgPSBnZXRFbGVtZW50KG9wdGlvbnMuaW5zZXJ0SW50bylcblxuXHRpZiAoIXRhcmdldCkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIkNvdWxkbid0IGZpbmQgYSBzdHlsZSB0YXJnZXQuIFRoaXMgcHJvYmFibHkgbWVhbnMgdGhhdCB0aGUgdmFsdWUgZm9yIHRoZSAnaW5zZXJ0SW50bycgcGFyYW1ldGVyIGlzIGludmFsaWQuXCIpO1xuXHR9XG5cblx0dmFyIGxhc3RTdHlsZUVsZW1lbnRJbnNlcnRlZEF0VG9wID0gc3R5bGVzSW5zZXJ0ZWRBdFRvcFtzdHlsZXNJbnNlcnRlZEF0VG9wLmxlbmd0aCAtIDFdO1xuXG5cdGlmIChvcHRpb25zLmluc2VydEF0ID09PSBcInRvcFwiKSB7XG5cdFx0aWYgKCFsYXN0U3R5bGVFbGVtZW50SW5zZXJ0ZWRBdFRvcCkge1xuXHRcdFx0dGFyZ2V0Lmluc2VydEJlZm9yZShzdHlsZSwgdGFyZ2V0LmZpcnN0Q2hpbGQpO1xuXHRcdH0gZWxzZSBpZiAobGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AubmV4dFNpYmxpbmcpIHtcblx0XHRcdHRhcmdldC5pbnNlcnRCZWZvcmUoc3R5bGUsIGxhc3RTdHlsZUVsZW1lbnRJbnNlcnRlZEF0VG9wLm5leHRTaWJsaW5nKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGFyZ2V0LmFwcGVuZENoaWxkKHN0eWxlKTtcblx0XHR9XG5cdFx0c3R5bGVzSW5zZXJ0ZWRBdFRvcC5wdXNoKHN0eWxlKTtcblx0fSBlbHNlIGlmIChvcHRpb25zLmluc2VydEF0ID09PSBcImJvdHRvbVwiKSB7XG5cdFx0dGFyZ2V0LmFwcGVuZENoaWxkKHN0eWxlKTtcblx0fSBlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucy5pbnNlcnRBdCA9PT0gXCJvYmplY3RcIiAmJiBvcHRpb25zLmluc2VydEF0LmJlZm9yZSkge1xuXHRcdHZhciBuZXh0U2libGluZyA9IGdldEVsZW1lbnQob3B0aW9ucy5pbnNlcnRBdC5iZWZvcmUsIHRhcmdldCk7XG5cdFx0dGFyZ2V0Lmluc2VydEJlZm9yZShzdHlsZSwgbmV4dFNpYmxpbmcpO1xuXHR9IGVsc2Uge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIltTdHlsZSBMb2FkZXJdXFxuXFxuIEludmFsaWQgdmFsdWUgZm9yIHBhcmFtZXRlciAnaW5zZXJ0QXQnICgnb3B0aW9ucy5pbnNlcnRBdCcpIGZvdW5kLlxcbiBNdXN0IGJlICd0b3AnLCAnYm90dG9tJywgb3IgT2JqZWN0LlxcbiAoaHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi9zdHlsZS1sb2FkZXIjaW5zZXJ0YXQpXFxuXCIpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVN0eWxlRWxlbWVudCAoc3R5bGUpIHtcblx0aWYgKHN0eWxlLnBhcmVudE5vZGUgPT09IG51bGwpIHJldHVybiBmYWxzZTtcblx0c3R5bGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZSk7XG5cblx0dmFyIGlkeCA9IHN0eWxlc0luc2VydGVkQXRUb3AuaW5kZXhPZihzdHlsZSk7XG5cdGlmKGlkeCA+PSAwKSB7XG5cdFx0c3R5bGVzSW5zZXJ0ZWRBdFRvcC5zcGxpY2UoaWR4LCAxKTtcblx0fVxufVxuXG5mdW5jdGlvbiBjcmVhdGVTdHlsZUVsZW1lbnQgKG9wdGlvbnMpIHtcblx0dmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuXG5cdGlmKG9wdGlvbnMuYXR0cnMudHlwZSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0b3B0aW9ucy5hdHRycy50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xuXHR9XG5cblx0aWYob3B0aW9ucy5hdHRycy5ub25jZSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0dmFyIG5vbmNlID0gZ2V0Tm9uY2UoKTtcblx0XHRpZiAobm9uY2UpIHtcblx0XHRcdG9wdGlvbnMuYXR0cnMubm9uY2UgPSBub25jZTtcblx0XHR9XG5cdH1cblxuXHRhZGRBdHRycyhzdHlsZSwgb3B0aW9ucy5hdHRycyk7XG5cdGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zLCBzdHlsZSk7XG5cblx0cmV0dXJuIHN0eWxlO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVMaW5rRWxlbWVudCAob3B0aW9ucykge1xuXHR2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpO1xuXG5cdGlmKG9wdGlvbnMuYXR0cnMudHlwZSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0b3B0aW9ucy5hdHRycy50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xuXHR9XG5cdG9wdGlvbnMuYXR0cnMucmVsID0gXCJzdHlsZXNoZWV0XCI7XG5cblx0YWRkQXR0cnMobGluaywgb3B0aW9ucy5hdHRycyk7XG5cdGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zLCBsaW5rKTtcblxuXHRyZXR1cm4gbGluaztcbn1cblxuZnVuY3Rpb24gYWRkQXR0cnMgKGVsLCBhdHRycykge1xuXHRPYmplY3Qua2V5cyhhdHRycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG5cdFx0ZWwuc2V0QXR0cmlidXRlKGtleSwgYXR0cnNba2V5XSk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBnZXROb25jZSgpIHtcblx0aWYgKHR5cGVvZiBfX3dlYnBhY2tfbm9uY2VfXyA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdHJldHVybiBfX3dlYnBhY2tfbm9uY2VfXztcbn1cblxuZnVuY3Rpb24gYWRkU3R5bGUgKG9iaiwgb3B0aW9ucykge1xuXHR2YXIgc3R5bGUsIHVwZGF0ZSwgcmVtb3ZlLCByZXN1bHQ7XG5cblx0Ly8gSWYgYSB0cmFuc2Zvcm0gZnVuY3Rpb24gd2FzIGRlZmluZWQsIHJ1biBpdCBvbiB0aGUgY3NzXG5cdGlmIChvcHRpb25zLnRyYW5zZm9ybSAmJiBvYmouY3NzKSB7XG5cdCAgICByZXN1bHQgPSB0eXBlb2Ygb3B0aW9ucy50cmFuc2Zvcm0gPT09ICdmdW5jdGlvbidcblx0XHQgPyBvcHRpb25zLnRyYW5zZm9ybShvYmouY3NzKSBcblx0XHQgOiBvcHRpb25zLnRyYW5zZm9ybS5kZWZhdWx0KG9iai5jc3MpO1xuXG5cdCAgICBpZiAocmVzdWx0KSB7XG5cdCAgICBcdC8vIElmIHRyYW5zZm9ybSByZXR1cm5zIGEgdmFsdWUsIHVzZSB0aGF0IGluc3RlYWQgb2YgdGhlIG9yaWdpbmFsIGNzcy5cblx0ICAgIFx0Ly8gVGhpcyBhbGxvd3MgcnVubmluZyBydW50aW1lIHRyYW5zZm9ybWF0aW9ucyBvbiB0aGUgY3NzLlxuXHQgICAgXHRvYmouY3NzID0gcmVzdWx0O1xuXHQgICAgfSBlbHNlIHtcblx0ICAgIFx0Ly8gSWYgdGhlIHRyYW5zZm9ybSBmdW5jdGlvbiByZXR1cm5zIGEgZmFsc3kgdmFsdWUsIGRvbid0IGFkZCB0aGlzIGNzcy5cblx0ICAgIFx0Ly8gVGhpcyBhbGxvd3MgY29uZGl0aW9uYWwgbG9hZGluZyBvZiBjc3Ncblx0ICAgIFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgXHRcdC8vIG5vb3Bcblx0ICAgIFx0fTtcblx0ICAgIH1cblx0fVxuXG5cdGlmIChvcHRpb25zLnNpbmdsZXRvbikge1xuXHRcdHZhciBzdHlsZUluZGV4ID0gc2luZ2xldG9uQ291bnRlcisrO1xuXG5cdFx0c3R5bGUgPSBzaW5nbGV0b24gfHwgKHNpbmdsZXRvbiA9IGNyZWF0ZVN0eWxlRWxlbWVudChvcHRpb25zKSk7XG5cblx0XHR1cGRhdGUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGUsIHN0eWxlSW5kZXgsIGZhbHNlKTtcblx0XHRyZW1vdmUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGUsIHN0eWxlSW5kZXgsIHRydWUpO1xuXG5cdH0gZWxzZSBpZiAoXG5cdFx0b2JqLnNvdXJjZU1hcCAmJlxuXHRcdHR5cGVvZiBVUkwgPT09IFwiZnVuY3Rpb25cIiAmJlxuXHRcdHR5cGVvZiBVUkwuY3JlYXRlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcblx0XHR0eXBlb2YgVVJMLnJldm9rZU9iamVjdFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXG5cdFx0dHlwZW9mIEJsb2IgPT09IFwiZnVuY3Rpb25cIiAmJlxuXHRcdHR5cGVvZiBidG9hID09PSBcImZ1bmN0aW9uXCJcblx0KSB7XG5cdFx0c3R5bGUgPSBjcmVhdGVMaW5rRWxlbWVudChvcHRpb25zKTtcblx0XHR1cGRhdGUgPSB1cGRhdGVMaW5rLmJpbmQobnVsbCwgc3R5bGUsIG9wdGlvbnMpO1xuXHRcdHJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJlbW92ZVN0eWxlRWxlbWVudChzdHlsZSk7XG5cblx0XHRcdGlmKHN0eWxlLmhyZWYpIFVSTC5yZXZva2VPYmplY3RVUkwoc3R5bGUuaHJlZik7XG5cdFx0fTtcblx0fSBlbHNlIHtcblx0XHRzdHlsZSA9IGNyZWF0ZVN0eWxlRWxlbWVudChvcHRpb25zKTtcblx0XHR1cGRhdGUgPSBhcHBseVRvVGFnLmJpbmQobnVsbCwgc3R5bGUpO1xuXHRcdHJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJlbW92ZVN0eWxlRWxlbWVudChzdHlsZSk7XG5cdFx0fTtcblx0fVxuXG5cdHVwZGF0ZShvYmopO1xuXG5cdHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZSAobmV3T2JqKSB7XG5cdFx0aWYgKG5ld09iaikge1xuXHRcdFx0aWYgKFxuXHRcdFx0XHRuZXdPYmouY3NzID09PSBvYmouY3NzICYmXG5cdFx0XHRcdG5ld09iai5tZWRpYSA9PT0gb2JqLm1lZGlhICYmXG5cdFx0XHRcdG5ld09iai5zb3VyY2VNYXAgPT09IG9iai5zb3VyY2VNYXBcblx0XHRcdCkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHVwZGF0ZShvYmogPSBuZXdPYmopO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZW1vdmUoKTtcblx0XHR9XG5cdH07XG59XG5cbnZhciByZXBsYWNlVGV4dCA9IChmdW5jdGlvbiAoKSB7XG5cdHZhciB0ZXh0U3RvcmUgPSBbXTtcblxuXHRyZXR1cm4gZnVuY3Rpb24gKGluZGV4LCByZXBsYWNlbWVudCkge1xuXHRcdHRleHRTdG9yZVtpbmRleF0gPSByZXBsYWNlbWVudDtcblxuXHRcdHJldHVybiB0ZXh0U3RvcmUuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJ1xcbicpO1xuXHR9O1xufSkoKTtcblxuZnVuY3Rpb24gYXBwbHlUb1NpbmdsZXRvblRhZyAoc3R5bGUsIGluZGV4LCByZW1vdmUsIG9iaikge1xuXHR2YXIgY3NzID0gcmVtb3ZlID8gXCJcIiA6IG9iai5jc3M7XG5cblx0aWYgKHN0eWxlLnN0eWxlU2hlZXQpIHtcblx0XHRzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQgPSByZXBsYWNlVGV4dChpbmRleCwgY3NzKTtcblx0fSBlbHNlIHtcblx0XHR2YXIgY3NzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcyk7XG5cdFx0dmFyIGNoaWxkTm9kZXMgPSBzdHlsZS5jaGlsZE5vZGVzO1xuXG5cdFx0aWYgKGNoaWxkTm9kZXNbaW5kZXhdKSBzdHlsZS5yZW1vdmVDaGlsZChjaGlsZE5vZGVzW2luZGV4XSk7XG5cblx0XHRpZiAoY2hpbGROb2Rlcy5sZW5ndGgpIHtcblx0XHRcdHN0eWxlLmluc2VydEJlZm9yZShjc3NOb2RlLCBjaGlsZE5vZGVzW2luZGV4XSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN0eWxlLmFwcGVuZENoaWxkKGNzc05vZGUpO1xuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiBhcHBseVRvVGFnIChzdHlsZSwgb2JqKSB7XG5cdHZhciBjc3MgPSBvYmouY3NzO1xuXHR2YXIgbWVkaWEgPSBvYmoubWVkaWE7XG5cblx0aWYobWVkaWEpIHtcblx0XHRzdHlsZS5zZXRBdHRyaWJ1dGUoXCJtZWRpYVwiLCBtZWRpYSlcblx0fVxuXG5cdGlmKHN0eWxlLnN0eWxlU2hlZXQpIHtcblx0XHRzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQgPSBjc3M7XG5cdH0gZWxzZSB7XG5cdFx0d2hpbGUoc3R5bGUuZmlyc3RDaGlsZCkge1xuXHRcdFx0c3R5bGUucmVtb3ZlQ2hpbGQoc3R5bGUuZmlyc3RDaGlsZCk7XG5cdFx0fVxuXG5cdFx0c3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7XG5cdH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlTGluayAobGluaywgb3B0aW9ucywgb2JqKSB7XG5cdHZhciBjc3MgPSBvYmouY3NzO1xuXHR2YXIgc291cmNlTWFwID0gb2JqLnNvdXJjZU1hcDtcblxuXHQvKlxuXHRcdElmIGNvbnZlcnRUb0Fic29sdXRlVXJscyBpc24ndCBkZWZpbmVkLCBidXQgc291cmNlbWFwcyBhcmUgZW5hYmxlZFxuXHRcdGFuZCB0aGVyZSBpcyBubyBwdWJsaWNQYXRoIGRlZmluZWQgdGhlbiBsZXRzIHR1cm4gY29udmVydFRvQWJzb2x1dGVVcmxzXG5cdFx0b24gYnkgZGVmYXVsdC4gIE90aGVyd2lzZSBkZWZhdWx0IHRvIHRoZSBjb252ZXJ0VG9BYnNvbHV0ZVVybHMgb3B0aW9uXG5cdFx0ZGlyZWN0bHlcblx0Ki9cblx0dmFyIGF1dG9GaXhVcmxzID0gb3B0aW9ucy5jb252ZXJ0VG9BYnNvbHV0ZVVybHMgPT09IHVuZGVmaW5lZCAmJiBzb3VyY2VNYXA7XG5cblx0aWYgKG9wdGlvbnMuY29udmVydFRvQWJzb2x1dGVVcmxzIHx8IGF1dG9GaXhVcmxzKSB7XG5cdFx0Y3NzID0gZml4VXJscyhjc3MpO1xuXHR9XG5cblx0aWYgKHNvdXJjZU1hcCkge1xuXHRcdC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzI2NjAzODc1XG5cdFx0Y3NzICs9IFwiXFxuLyojIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxcIiArIGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHNvdXJjZU1hcCkpKSkgKyBcIiAqL1wiO1xuXHR9XG5cblx0dmFyIGJsb2IgPSBuZXcgQmxvYihbY3NzXSwgeyB0eXBlOiBcInRleHQvY3NzXCIgfSk7XG5cblx0dmFyIG9sZFNyYyA9IGxpbmsuaHJlZjtcblxuXHRsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuXG5cdGlmKG9sZFNyYykgVVJMLnJldm9rZU9iamVjdFVSTChvbGRTcmMpO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/style-loader/lib/addStyles.js\n");

/***/ }),

/***/ "./node_modules/style-loader/lib/urls.js":
/*!***********************************************!*\
  !*** ./node_modules/style-loader/lib/urls.js ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2xpYi91cmxzLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9saWIvdXJscy5qcz9mNmQzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuLyoqXG4gKiBXaGVuIHNvdXJjZSBtYXBzIGFyZSBlbmFibGVkLCBgc3R5bGUtbG9hZGVyYCB1c2VzIGEgbGluayBlbGVtZW50IHdpdGggYSBkYXRhLXVyaSB0b1xuICogZW1iZWQgdGhlIGNzcyBvbiB0aGUgcGFnZS4gVGhpcyBicmVha3MgYWxsIHJlbGF0aXZlIHVybHMgYmVjYXVzZSBub3cgdGhleSBhcmUgcmVsYXRpdmUgdG8gYVxuICogYnVuZGxlIGluc3RlYWQgb2YgdGhlIGN1cnJlbnQgcGFnZS5cbiAqXG4gKiBPbmUgc29sdXRpb24gaXMgdG8gb25seSB1c2UgZnVsbCB1cmxzLCBidXQgdGhhdCBtYXkgYmUgaW1wb3NzaWJsZS5cbiAqXG4gKiBJbnN0ZWFkLCB0aGlzIGZ1bmN0aW9uIFwiZml4ZXNcIiB0aGUgcmVsYXRpdmUgdXJscyB0byBiZSBhYnNvbHV0ZSBhY2NvcmRpbmcgdG8gdGhlIGN1cnJlbnQgcGFnZSBsb2NhdGlvbi5cbiAqXG4gKiBBIHJ1ZGltZW50YXJ5IHRlc3Qgc3VpdGUgaXMgbG9jYXRlZCBhdCBgdGVzdC9maXhVcmxzLmpzYCBhbmQgY2FuIGJlIHJ1biB2aWEgdGhlIGBucG0gdGVzdGAgY29tbWFuZC5cbiAqXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoY3NzKSB7XG4gIC8vIGdldCBjdXJyZW50IGxvY2F0aW9uXG4gIHZhciBsb2NhdGlvbiA9IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgd2luZG93LmxvY2F0aW9uO1xuXG4gIGlmICghbG9jYXRpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJmaXhVcmxzIHJlcXVpcmVzIHdpbmRvdy5sb2NhdGlvblwiKTtcbiAgfVxuXG5cdC8vIGJsYW5rIG9yIG51bGw/XG5cdGlmICghY3NzIHx8IHR5cGVvZiBjc3MgIT09IFwic3RyaW5nXCIpIHtcblx0ICByZXR1cm4gY3NzO1xuICB9XG5cbiAgdmFyIGJhc2VVcmwgPSBsb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIGxvY2F0aW9uLmhvc3Q7XG4gIHZhciBjdXJyZW50RGlyID0gYmFzZVVybCArIGxvY2F0aW9uLnBhdGhuYW1lLnJlcGxhY2UoL1xcL1teXFwvXSokLywgXCIvXCIpO1xuXG5cdC8vIGNvbnZlcnQgZWFjaCB1cmwoLi4uKVxuXHQvKlxuXHRUaGlzIHJlZ3VsYXIgZXhwcmVzc2lvbiBpcyBqdXN0IGEgd2F5IHRvIHJlY3Vyc2l2ZWx5IG1hdGNoIGJyYWNrZXRzIHdpdGhpblxuXHRhIHN0cmluZy5cblxuXHQgL3VybFxccypcXCggID0gTWF0Y2ggb24gdGhlIHdvcmQgXCJ1cmxcIiB3aXRoIGFueSB3aGl0ZXNwYWNlIGFmdGVyIGl0IGFuZCB0aGVuIGEgcGFyZW5zXG5cdCAgICggID0gU3RhcnQgYSBjYXB0dXJpbmcgZ3JvdXBcblx0ICAgICAoPzogID0gU3RhcnQgYSBub24tY2FwdHVyaW5nIGdyb3VwXG5cdCAgICAgICAgIFteKShdICA9IE1hdGNoIGFueXRoaW5nIHRoYXQgaXNuJ3QgYSBwYXJlbnRoZXNlc1xuXHQgICAgICAgICB8ICA9IE9SXG5cdCAgICAgICAgIFxcKCAgPSBNYXRjaCBhIHN0YXJ0IHBhcmVudGhlc2VzXG5cdCAgICAgICAgICAgICAoPzogID0gU3RhcnQgYW5vdGhlciBub24tY2FwdHVyaW5nIGdyb3Vwc1xuXHQgICAgICAgICAgICAgICAgIFteKShdKyAgPSBNYXRjaCBhbnl0aGluZyB0aGF0IGlzbid0IGEgcGFyZW50aGVzZXNcblx0ICAgICAgICAgICAgICAgICB8ICA9IE9SXG5cdCAgICAgICAgICAgICAgICAgXFwoICA9IE1hdGNoIGEgc3RhcnQgcGFyZW50aGVzZXNcblx0ICAgICAgICAgICAgICAgICAgICAgW14pKF0qICA9IE1hdGNoIGFueXRoaW5nIHRoYXQgaXNuJ3QgYSBwYXJlbnRoZXNlc1xuXHQgICAgICAgICAgICAgICAgIFxcKSAgPSBNYXRjaCBhIGVuZCBwYXJlbnRoZXNlc1xuXHQgICAgICAgICAgICAgKSAgPSBFbmQgR3JvdXBcbiAgICAgICAgICAgICAgKlxcKSA9IE1hdGNoIGFueXRoaW5nIGFuZCB0aGVuIGEgY2xvc2UgcGFyZW5zXG4gICAgICAgICAgKSAgPSBDbG9zZSBub24tY2FwdHVyaW5nIGdyb3VwXG4gICAgICAgICAgKiAgPSBNYXRjaCBhbnl0aGluZ1xuICAgICAgICkgID0gQ2xvc2UgY2FwdHVyaW5nIGdyb3VwXG5cdCBcXCkgID0gTWF0Y2ggYSBjbG9zZSBwYXJlbnNcblxuXHQgL2dpICA9IEdldCBhbGwgbWF0Y2hlcywgbm90IHRoZSBmaXJzdC4gIEJlIGNhc2UgaW5zZW5zaXRpdmUuXG5cdCAqL1xuXHR2YXIgZml4ZWRDc3MgPSBjc3MucmVwbGFjZSgvdXJsXFxzKlxcKCgoPzpbXikoXXxcXCgoPzpbXikoXSt8XFwoW14pKF0qXFwpKSpcXCkpKilcXCkvZ2ksIGZ1bmN0aW9uKGZ1bGxNYXRjaCwgb3JpZ1VybCkge1xuXHRcdC8vIHN0cmlwIHF1b3RlcyAoaWYgdGhleSBleGlzdClcblx0XHR2YXIgdW5xdW90ZWRPcmlnVXJsID0gb3JpZ1VybFxuXHRcdFx0LnRyaW0oKVxuXHRcdFx0LnJlcGxhY2UoL15cIiguKilcIiQvLCBmdW5jdGlvbihvLCAkMSl7IHJldHVybiAkMTsgfSlcblx0XHRcdC5yZXBsYWNlKC9eJyguKiknJC8sIGZ1bmN0aW9uKG8sICQxKXsgcmV0dXJuICQxOyB9KTtcblxuXHRcdC8vIGFscmVhZHkgYSBmdWxsIHVybD8gbm8gY2hhbmdlXG5cdFx0aWYgKC9eKCN8ZGF0YTp8aHR0cDpcXC9cXC98aHR0cHM6XFwvXFwvfGZpbGU6XFwvXFwvXFwvfFxccyokKS9pLnRlc3QodW5xdW90ZWRPcmlnVXJsKSkge1xuXHRcdCAgcmV0dXJuIGZ1bGxNYXRjaDtcblx0XHR9XG5cblx0XHQvLyBjb252ZXJ0IHRoZSB1cmwgdG8gYSBmdWxsIHVybFxuXHRcdHZhciBuZXdVcmw7XG5cblx0XHRpZiAodW5xdW90ZWRPcmlnVXJsLmluZGV4T2YoXCIvL1wiKSA9PT0gMCkge1xuXHRcdCAgXHQvL1RPRE86IHNob3VsZCB3ZSBhZGQgcHJvdG9jb2w/XG5cdFx0XHRuZXdVcmwgPSB1bnF1b3RlZE9yaWdVcmw7XG5cdFx0fSBlbHNlIGlmICh1bnF1b3RlZE9yaWdVcmwuaW5kZXhPZihcIi9cIikgPT09IDApIHtcblx0XHRcdC8vIHBhdGggc2hvdWxkIGJlIHJlbGF0aXZlIHRvIHRoZSBiYXNlIHVybFxuXHRcdFx0bmV3VXJsID0gYmFzZVVybCArIHVucXVvdGVkT3JpZ1VybDsgLy8gYWxyZWFkeSBzdGFydHMgd2l0aCAnLydcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gcGF0aCBzaG91bGQgYmUgcmVsYXRpdmUgdG8gY3VycmVudCBkaXJlY3Rvcnlcblx0XHRcdG5ld1VybCA9IGN1cnJlbnREaXIgKyB1bnF1b3RlZE9yaWdVcmwucmVwbGFjZSgvXlxcLlxcLy8sIFwiXCIpOyAvLyBTdHJpcCBsZWFkaW5nICcuLydcblx0XHR9XG5cblx0XHQvLyBzZW5kIGJhY2sgdGhlIGZpeGVkIHVybCguLi4pXG5cdFx0cmV0dXJuIFwidXJsKFwiICsgSlNPTi5zdHJpbmdpZnkobmV3VXJsKSArIFwiKVwiO1xuXHR9KTtcblxuXHQvLyBzZW5kIGJhY2sgdGhlIGZpeGVkIGNzc1xuXHRyZXR1cm4gZml4ZWRDc3M7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/style-loader/lib/urls.js\n");

/***/ }),

/***/ "./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay9idWlsZGluL2dsb2JhbC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8od2VicGFjaykvYnVpbGRpbi9nbG9iYWwuanM/Y2QwMCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZztcblxuLy8gVGhpcyB3b3JrcyBpbiBub24tc3RyaWN0IG1vZGVcbmcgPSAoZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzO1xufSkoKTtcblxudHJ5IHtcblx0Ly8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApXG5cdGcgPSBnIHx8IG5ldyBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XG59IGNhdGNoIChlKSB7XG5cdC8vIFRoaXMgd29ya3MgaWYgdGhlIHdpbmRvdyByZWZlcmVuY2UgaXMgYXZhaWxhYmxlXG5cdGlmICh0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiKSBnID0gd2luZG93O1xufVxuXG4vLyBnIGNhbiBzdGlsbCBiZSB1bmRlZmluZWQsIGJ1dCBub3RoaW5nIHRvIGRvIGFib3V0IGl0Li4uXG4vLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xuLy8gZWFzaWVyIHRvIGhhbmRsZSB0aGlzIGNhc2UuIGlmKCFnbG9iYWwpIHsgLi4ufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGc7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/webpack/buildin/global.js\n");

/***/ }),

/***/ "./node_modules/webpack/buildin/module.js":
/*!***********************************!*\
  !*** (webpack)/buildin/module.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = function(module) {\r\n\tif (!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif (!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay9idWlsZGluL21vZHVsZS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8od2VicGFjaykvYnVpbGRpbi9tb2R1bGUuanM/Y2VkMiJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xyXG5cdGlmICghbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xyXG5cdFx0bW9kdWxlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKCkge307XHJcblx0XHRtb2R1bGUucGF0aHMgPSBbXTtcclxuXHRcdC8vIG1vZHVsZS5wYXJlbnQgPSB1bmRlZmluZWQgYnkgZGVmYXVsdFxyXG5cdFx0aWYgKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJsb2FkZWRcIiwge1xyXG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxyXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHJldHVybiBtb2R1bGUubDtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImlkXCIsIHtcclxuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcclxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XHJcblx0fVxyXG5cdHJldHVybiBtb2R1bGU7XHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/webpack/buildin/module.js\n");

/***/ }),

/***/ "./source/css/diva.scss":
/*!******************************!*\
  !*** ./source/css/diva.scss ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("\nvar content = __webpack_require__(/*! !../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader!../../node_modules/sass-loader/lib/loader.js!./diva.scss */ \"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./source/css/diva.scss\");\n\nif(typeof content === 'string') content = [[module.i, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = __webpack_require__(/*! ../../node_modules/style-loader/lib/addStyles.js */ \"./node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(false) {}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvY3NzL2RpdmEuc2Nzcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9jc3MvZGl2YS5zY3NzPzk2ODYiXSwic291cmNlc0NvbnRlbnQiOlsiXG52YXIgY29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uL25vZGVfbW9kdWxlcy9taW5pLWNzcy1leHRyYWN0LXBsdWdpbi9kaXN0L2xvYWRlci5qcyEuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuLi8uLi9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvbGliL2xvYWRlci5qcyEuL2RpdmEuc2Nzc1wiKTtcblxuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG5cbnZhciB0cmFuc2Zvcm07XG52YXIgaW5zZXJ0SW50bztcblxuXG5cbnZhciBvcHRpb25zID0ge1wiaG1yXCI6dHJ1ZX1cblxub3B0aW9ucy50cmFuc2Zvcm0gPSB0cmFuc2Zvcm1cbm9wdGlvbnMuaW5zZXJ0SW50byA9IHVuZGVmaW5lZDtcblxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9saWIvYWRkU3R5bGVzLmpzXCIpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2FscztcblxuaWYobW9kdWxlLmhvdCkge1xuXHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL21pbmktY3NzLWV4dHJhY3QtcGx1Z2luL2Rpc3QvbG9hZGVyLmpzIS4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9saWIvbG9hZGVyLmpzIS4vZGl2YS5zY3NzXCIsIGZ1bmN0aW9uKCkge1xuXHRcdHZhciBuZXdDb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL21pbmktY3NzLWV4dHJhY3QtcGx1Z2luL2Rpc3QvbG9hZGVyLmpzIS4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9saWIvbG9hZGVyLmpzIS4vZGl2YS5zY3NzXCIpO1xuXG5cdFx0aWYodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSBuZXdDb250ZW50ID0gW1ttb2R1bGUuaWQsIG5ld0NvbnRlbnQsICcnXV07XG5cblx0XHR2YXIgbG9jYWxzID0gKGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdHZhciBrZXksIGlkeCA9IDA7XG5cblx0XHRcdGZvcihrZXkgaW4gYSkge1xuXHRcdFx0XHRpZighYiB8fCBhW2tleV0gIT09IGJba2V5XSkgcmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRpZHgrKztcblx0XHRcdH1cblxuXHRcdFx0Zm9yKGtleSBpbiBiKSBpZHgtLTtcblxuXHRcdFx0cmV0dXJuIGlkeCA9PT0gMDtcblx0XHR9KGNvbnRlbnQubG9jYWxzLCBuZXdDb250ZW50LmxvY2FscykpO1xuXG5cdFx0aWYoIWxvY2FscykgdGhyb3cgbmV3IEVycm9yKCdBYm9ydGluZyBDU1MgSE1SIGR1ZSB0byBjaGFuZ2VkIGNzcy1tb2R1bGVzIGxvY2Fscy4nKTtcblxuXHRcdHVwZGF0ZShuZXdDb250ZW50KTtcblx0fSk7XG5cblx0bW9kdWxlLmhvdC5kaXNwb3NlKGZ1bmN0aW9uKCkgeyB1cGRhdGUoKTsgfSk7XG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./source/css/diva.scss\n");

/***/ }),

/***/ "./source/js/composite-image.js":
/*!**************************************!*\
  !*** ./source/js/composite-image.js ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CompositeImage; });\n/* harmony import */ var _tile_coverage_map__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tile-coverage-map */ \"./source/js/tile-coverage-map.js\");\n\n\n/**\n * @class CompositeImage\n * @private\n *\n * Utility class to composite tiles into a complete image\n * and track the rendered state of an image as new tiles\n * load.\n */\n\n/**\n * @param levels {Array.<Array.<Tile>>}\n * @constructor\n */\nclass CompositeImage\n{\n    constructor(levels)\n    {\n        this._levels = levels;  // Assume levels sorted high-res first\n        const urlsToTiles = this._urlsToTiles = {};\n\n        levels.forEach(level =>\n        {\n            level.tiles.forEach(tile =>\n            {\n                urlsToTiles[tile.url] = {\n                    zoomLevel: level.zoomLevel,\n                    row: tile.row,\n                    col: tile.col\n                };\n            });\n        });\n\n        this.clear();\n    }\n\n    clear ()\n    {\n        const loadedByLevel = this._loadedByLevel = {};\n\n        this._levels.forEach(level => {\n            loadedByLevel[level.zoomLevel] = new _tile_coverage_map__WEBPACK_IMPORTED_MODULE_0__[\"default\"](level.rows, level.cols);\n        });\n    }\n\n    getTiles (baseZoomLevel)\n    {\n        const toRenderByLevel = [];\n        const highestZoomLevel = this._levels[0].zoomLevel;\n        const covered = new _tile_coverage_map__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this._levels[0].rows, this._levels[0].cols);\n\n        let bestLevelIndex;\n\n        // Default to the lowest zoom level\n        if (baseZoomLevel === null)\n        {\n            bestLevelIndex = 0;\n        }\n        else\n        {\n            const ceilLevel = Math.ceil(baseZoomLevel);\n            bestLevelIndex = findIndex(this._levels, level => level.zoomLevel <= ceilLevel);\n            // bestLevelIndex = this._levels.findIndex((level) => level.zoomLevel <= ceilLevel);\n        }\n\n\n        // The best level, followed by higher-res levels in ascending order of resolution,\n        // followed by lower-res levels in descending order of resolution\n        const levelsByPreference = this._levels.slice(0, bestLevelIndex + 1).reverse()\n            .concat(this._levels.slice(bestLevelIndex + 1));\n\n        levelsByPreference.forEach( (level) =>\n        {\n            const loaded = this._loadedByLevel[level.zoomLevel];\n\n            let additionalTiles = level.tiles.filter(tile => loaded.isLoaded(tile.row, tile.col));\n\n            // Filter out entirely covered tiles\n\n            // FIXME: Is it better to draw all of a partially covered tile,\n            // with some of it ultimately covered, or to pick out the region\n            // which needs to be drawn?\n            // See https://github.com/DDMAL/diva.js/issues/358\n            const scaleRatio = Math.pow(2, highestZoomLevel - level.zoomLevel);\n\n            additionalTiles = additionalTiles.filter(tile => {\n                let isNeeded = false;\n\n                const highResRow = tile.row * scaleRatio;\n                const highResCol = tile.col * scaleRatio;\n\n                for (let i=0; i < scaleRatio; i++)\n                {\n                    for (let j=0; j < scaleRatio; j++)\n                    {\n                        if (!covered.isLoaded(highResRow + i, highResCol + j))\n                        {\n                            isNeeded = true;\n                            covered.set(highResRow + i, highResCol + j, true);\n                        }\n                    }\n                }\n\n                return isNeeded;\n            });\n\n            toRenderByLevel.push(additionalTiles);\n        }, this);\n\n        // Less-preferred tiles should come first\n        toRenderByLevel.reverse();\n\n        const tiles = [];\n\n        toRenderByLevel.forEach(byLevel => {\n            tiles.push.apply(tiles, byLevel);\n        });\n\n        return tiles;\n    }\n\n    /**\n     * Update the composite image to take into account all the URLs\n     * loaded in an image cache.\n     *\n     * @param cache {ImageCache}\n     */\n    updateFromCache (cache)\n    {\n        this.clear();\n\n        this._levels.forEach( (level) =>\n        {\n            const loaded = this._loadedByLevel[level.zoomLevel];\n\n            level.tiles.forEach(tile => {\n                if (cache.has(tile.url))\n                    loaded.set(tile.row, tile.col, true);\n            });\n        }, this);\n    }\n\n    updateWithLoadedUrls (urls)\n    {\n        urls.forEach( (url) =>\n        {\n            const entry = this._urlsToTiles[url];\n            this._loadedByLevel[entry.zoomLevel].set(entry.row, entry.col, true);\n        }, this);\n    }\n}\n\n// function fill (count, value)\n// {\n//     const arr = new Array(count);\n//\n//     for (let i=0; i < count; i++)\n//         arr[i] = value;\n//\n//     return arr;\n// }\n\nfunction findIndex (array, predicate)\n{\n    const length = array.length;\n    for (let i = 0; i < length; i++)\n    {\n        if (predicate(array[i], i))\n            return i;\n    }\n\n    return -1;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvY29tcG9zaXRlLWltYWdlLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL2NvbXBvc2l0ZS1pbWFnZS5qcz9iN2E2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBUaWxlQ292ZXJhZ2VNYXAgZnJvbSBcIi4vdGlsZS1jb3ZlcmFnZS1tYXBcIjtcblxuLyoqXG4gKiBAY2xhc3MgQ29tcG9zaXRlSW1hZ2VcbiAqIEBwcml2YXRlXG4gKlxuICogVXRpbGl0eSBjbGFzcyB0byBjb21wb3NpdGUgdGlsZXMgaW50byBhIGNvbXBsZXRlIGltYWdlXG4gKiBhbmQgdHJhY2sgdGhlIHJlbmRlcmVkIHN0YXRlIG9mIGFuIGltYWdlIGFzIG5ldyB0aWxlc1xuICogbG9hZC5cbiAqL1xuXG4vKipcbiAqIEBwYXJhbSBsZXZlbHMge0FycmF5LjxBcnJheS48VGlsZT4+fVxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbXBvc2l0ZUltYWdlXG57XG4gICAgY29uc3RydWN0b3IobGV2ZWxzKVxuICAgIHtcbiAgICAgICAgdGhpcy5fbGV2ZWxzID0gbGV2ZWxzOyAgLy8gQXNzdW1lIGxldmVscyBzb3J0ZWQgaGlnaC1yZXMgZmlyc3RcbiAgICAgICAgY29uc3QgdXJsc1RvVGlsZXMgPSB0aGlzLl91cmxzVG9UaWxlcyA9IHt9O1xuXG4gICAgICAgIGxldmVscy5mb3JFYWNoKGxldmVsID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldmVsLnRpbGVzLmZvckVhY2godGlsZSA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHVybHNUb1RpbGVzW3RpbGUudXJsXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgem9vbUxldmVsOiBsZXZlbC56b29tTGV2ZWwsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogdGlsZS5yb3csXG4gICAgICAgICAgICAgICAgICAgIGNvbDogdGlsZS5jb2xcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICB9XG5cbiAgICBjbGVhciAoKVxuICAgIHtcbiAgICAgICAgY29uc3QgbG9hZGVkQnlMZXZlbCA9IHRoaXMuX2xvYWRlZEJ5TGV2ZWwgPSB7fTtcblxuICAgICAgICB0aGlzLl9sZXZlbHMuZm9yRWFjaChsZXZlbCA9PiB7XG4gICAgICAgICAgICBsb2FkZWRCeUxldmVsW2xldmVsLnpvb21MZXZlbF0gPSBuZXcgVGlsZUNvdmVyYWdlTWFwKGxldmVsLnJvd3MsIGxldmVsLmNvbHMpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBnZXRUaWxlcyAoYmFzZVpvb21MZXZlbClcbiAgICB7XG4gICAgICAgIGNvbnN0IHRvUmVuZGVyQnlMZXZlbCA9IFtdO1xuICAgICAgICBjb25zdCBoaWdoZXN0Wm9vbUxldmVsID0gdGhpcy5fbGV2ZWxzWzBdLnpvb21MZXZlbDtcbiAgICAgICAgY29uc3QgY292ZXJlZCA9IG5ldyBUaWxlQ292ZXJhZ2VNYXAodGhpcy5fbGV2ZWxzWzBdLnJvd3MsIHRoaXMuX2xldmVsc1swXS5jb2xzKTtcblxuICAgICAgICBsZXQgYmVzdExldmVsSW5kZXg7XG5cbiAgICAgICAgLy8gRGVmYXVsdCB0byB0aGUgbG93ZXN0IHpvb20gbGV2ZWxcbiAgICAgICAgaWYgKGJhc2Vab29tTGV2ZWwgPT09IG51bGwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGJlc3RMZXZlbEluZGV4ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGNlaWxMZXZlbCA9IE1hdGguY2VpbChiYXNlWm9vbUxldmVsKTtcbiAgICAgICAgICAgIGJlc3RMZXZlbEluZGV4ID0gZmluZEluZGV4KHRoaXMuX2xldmVscywgbGV2ZWwgPT4gbGV2ZWwuem9vbUxldmVsIDw9IGNlaWxMZXZlbCk7XG4gICAgICAgICAgICAvLyBiZXN0TGV2ZWxJbmRleCA9IHRoaXMuX2xldmVscy5maW5kSW5kZXgoKGxldmVsKSA9PiBsZXZlbC56b29tTGV2ZWwgPD0gY2VpbExldmVsKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy8gVGhlIGJlc3QgbGV2ZWwsIGZvbGxvd2VkIGJ5IGhpZ2hlci1yZXMgbGV2ZWxzIGluIGFzY2VuZGluZyBvcmRlciBvZiByZXNvbHV0aW9uLFxuICAgICAgICAvLyBmb2xsb3dlZCBieSBsb3dlci1yZXMgbGV2ZWxzIGluIGRlc2NlbmRpbmcgb3JkZXIgb2YgcmVzb2x1dGlvblxuICAgICAgICBjb25zdCBsZXZlbHNCeVByZWZlcmVuY2UgPSB0aGlzLl9sZXZlbHMuc2xpY2UoMCwgYmVzdExldmVsSW5kZXggKyAxKS5yZXZlcnNlKClcbiAgICAgICAgICAgIC5jb25jYXQodGhpcy5fbGV2ZWxzLnNsaWNlKGJlc3RMZXZlbEluZGV4ICsgMSkpO1xuXG4gICAgICAgIGxldmVsc0J5UHJlZmVyZW5jZS5mb3JFYWNoKCAobGV2ZWwpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGxvYWRlZCA9IHRoaXMuX2xvYWRlZEJ5TGV2ZWxbbGV2ZWwuem9vbUxldmVsXTtcblxuICAgICAgICAgICAgbGV0IGFkZGl0aW9uYWxUaWxlcyA9IGxldmVsLnRpbGVzLmZpbHRlcih0aWxlID0+IGxvYWRlZC5pc0xvYWRlZCh0aWxlLnJvdywgdGlsZS5jb2wpKTtcblxuICAgICAgICAgICAgLy8gRmlsdGVyIG91dCBlbnRpcmVseSBjb3ZlcmVkIHRpbGVzXG5cbiAgICAgICAgICAgIC8vIEZJWE1FOiBJcyBpdCBiZXR0ZXIgdG8gZHJhdyBhbGwgb2YgYSBwYXJ0aWFsbHkgY292ZXJlZCB0aWxlLFxuICAgICAgICAgICAgLy8gd2l0aCBzb21lIG9mIGl0IHVsdGltYXRlbHkgY292ZXJlZCwgb3IgdG8gcGljayBvdXQgdGhlIHJlZ2lvblxuICAgICAgICAgICAgLy8gd2hpY2ggbmVlZHMgdG8gYmUgZHJhd24/XG4gICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0RETUFML2RpdmEuanMvaXNzdWVzLzM1OFxuICAgICAgICAgICAgY29uc3Qgc2NhbGVSYXRpbyA9IE1hdGgucG93KDIsIGhpZ2hlc3Rab29tTGV2ZWwgLSBsZXZlbC56b29tTGV2ZWwpO1xuXG4gICAgICAgICAgICBhZGRpdGlvbmFsVGlsZXMgPSBhZGRpdGlvbmFsVGlsZXMuZmlsdGVyKHRpbGUgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBpc05lZWRlZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgaGlnaFJlc1JvdyA9IHRpbGUucm93ICogc2NhbGVSYXRpbztcbiAgICAgICAgICAgICAgICBjb25zdCBoaWdoUmVzQ29sID0gdGlsZS5jb2wgKiBzY2FsZVJhdGlvO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaT0wOyBpIDwgc2NhbGVSYXRpbzsgaSsrKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaj0wOyBqIDwgc2NhbGVSYXRpbzsgaisrKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvdmVyZWQuaXNMb2FkZWQoaGlnaFJlc1JvdyArIGksIGhpZ2hSZXNDb2wgKyBqKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc05lZWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY292ZXJlZC5zZXQoaGlnaFJlc1JvdyArIGksIGhpZ2hSZXNDb2wgKyBqLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBpc05lZWRlZDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0b1JlbmRlckJ5TGV2ZWwucHVzaChhZGRpdGlvbmFsVGlsZXMpO1xuICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICAvLyBMZXNzLXByZWZlcnJlZCB0aWxlcyBzaG91bGQgY29tZSBmaXJzdFxuICAgICAgICB0b1JlbmRlckJ5TGV2ZWwucmV2ZXJzZSgpO1xuXG4gICAgICAgIGNvbnN0IHRpbGVzID0gW107XG5cbiAgICAgICAgdG9SZW5kZXJCeUxldmVsLmZvckVhY2goYnlMZXZlbCA9PiB7XG4gICAgICAgICAgICB0aWxlcy5wdXNoLmFwcGx5KHRpbGVzLCBieUxldmVsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRpbGVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgY29tcG9zaXRlIGltYWdlIHRvIHRha2UgaW50byBhY2NvdW50IGFsbCB0aGUgVVJMc1xuICAgICAqIGxvYWRlZCBpbiBhbiBpbWFnZSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjYWNoZSB7SW1hZ2VDYWNoZX1cbiAgICAgKi9cbiAgICB1cGRhdGVGcm9tQ2FjaGUgKGNhY2hlKVxuICAgIHtcbiAgICAgICAgdGhpcy5jbGVhcigpO1xuXG4gICAgICAgIHRoaXMuX2xldmVscy5mb3JFYWNoKCAobGV2ZWwpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGxvYWRlZCA9IHRoaXMuX2xvYWRlZEJ5TGV2ZWxbbGV2ZWwuem9vbUxldmVsXTtcblxuICAgICAgICAgICAgbGV2ZWwudGlsZXMuZm9yRWFjaCh0aWxlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoY2FjaGUuaGFzKHRpbGUudXJsKSlcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVkLnNldCh0aWxlLnJvdywgdGlsZS5jb2wsIHRydWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH1cblxuICAgIHVwZGF0ZVdpdGhMb2FkZWRVcmxzICh1cmxzKVxuICAgIHtcbiAgICAgICAgdXJscy5mb3JFYWNoKCAodXJsKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBlbnRyeSA9IHRoaXMuX3VybHNUb1RpbGVzW3VybF07XG4gICAgICAgICAgICB0aGlzLl9sb2FkZWRCeUxldmVsW2VudHJ5Lnpvb21MZXZlbF0uc2V0KGVudHJ5LnJvdywgZW50cnkuY29sLCB0cnVlKTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgfVxufVxuXG4vLyBmdW5jdGlvbiBmaWxsIChjb3VudCwgdmFsdWUpXG4vLyB7XG4vLyAgICAgY29uc3QgYXJyID0gbmV3IEFycmF5KGNvdW50KTtcbi8vXG4vLyAgICAgZm9yIChsZXQgaT0wOyBpIDwgY291bnQ7IGkrKylcbi8vICAgICAgICAgYXJyW2ldID0gdmFsdWU7XG4vL1xuLy8gICAgIHJldHVybiBhcnI7XG4vLyB9XG5cbmZ1bmN0aW9uIGZpbmRJbmRleCAoYXJyYXksIHByZWRpY2F0ZSlcbntcbiAgICBjb25zdCBsZW5ndGggPSBhcnJheS5sZW5ndGg7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKylcbiAgICB7XG4gICAgICAgIGlmIChwcmVkaWNhdGUoYXJyYXlbaV0sIGkpKVxuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgfVxuXG4gICAgcmV0dXJuIC0xO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./source/js/composite-image.js\n");

/***/ }),

/***/ "./source/js/diva-global.js":
/*!**********************************!*\
  !*** ./source/js/diva-global.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_events__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/events */ \"./source/js/utils/events.js\");\n\n// import PluginRegistry from './plugin-registry';\n\nconst diva = {\n    Events: _utils_events__WEBPACK_IMPORTED_MODULE_0__[\"Events\"],\n\n    // registerPlugin: function (plugin)\n    // {\n    //     PluginRegistry.register(plugin);\n    // },\n\n    /**\n     * Create a new Diva instance at the given element\n     *\n     * @param element {Element}\n     * @param options {Object}\n     * @returns {Diva}\n     */\n    // create: function (element, options)\n    // {\n    //     if (diva.find(element))\n    //         throw new Error('Diva is already initialized on ' + reprElem(element));\n    //\n    //     const $elem = $(element);\n    //     $elem.diva(options);\n    //\n    //     return $elem.data('diva');\n    // },\n\n    /**\n     * Return the Diva instance attached to the\n     * element, if any.\n     *\n     * @param element\n     * @returns {Diva|null}\n     */\n    // find: function (element)\n    // {\n    //     return $(element).data('diva') || null;\n    // }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (diva);\n\n// function reprElem(elem)\n// {\n//     const id = elem.id ? '#' + elem.id : elem.id;\n//     const classes = elem.className ? '.' + elem.className.split(/\\s+/g).join('.') : '';\n//\n//     return (id ? id : elem.tagName.toLowerCase()) + classes;\n// }\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvZGl2YS1nbG9iYWwuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvZGl2YS1nbG9iYWwuanM/YmM0NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFdmVudHMgfSBmcm9tICcuL3V0aWxzL2V2ZW50cyc7XG4vLyBpbXBvcnQgUGx1Z2luUmVnaXN0cnkgZnJvbSAnLi9wbHVnaW4tcmVnaXN0cnknO1xuXG5jb25zdCBkaXZhID0ge1xuICAgIEV2ZW50czogRXZlbnRzLFxuXG4gICAgLy8gcmVnaXN0ZXJQbHVnaW46IGZ1bmN0aW9uIChwbHVnaW4pXG4gICAgLy8ge1xuICAgIC8vICAgICBQbHVnaW5SZWdpc3RyeS5yZWdpc3RlcihwbHVnaW4pO1xuICAgIC8vIH0sXG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgRGl2YSBpbnN0YW5jZSBhdCB0aGUgZ2l2ZW4gZWxlbWVudFxuICAgICAqXG4gICAgICogQHBhcmFtIGVsZW1lbnQge0VsZW1lbnR9XG4gICAgICogQHBhcmFtIG9wdGlvbnMge09iamVjdH1cbiAgICAgKiBAcmV0dXJucyB7RGl2YX1cbiAgICAgKi9cbiAgICAvLyBjcmVhdGU6IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKVxuICAgIC8vIHtcbiAgICAvLyAgICAgaWYgKGRpdmEuZmluZChlbGVtZW50KSlcbiAgICAvLyAgICAgICAgIHRocm93IG5ldyBFcnJvcignRGl2YSBpcyBhbHJlYWR5IGluaXRpYWxpemVkIG9uICcgKyByZXByRWxlbShlbGVtZW50KSk7XG4gICAgLy9cbiAgICAvLyAgICAgY29uc3QgJGVsZW0gPSAkKGVsZW1lbnQpO1xuICAgIC8vICAgICAkZWxlbS5kaXZhKG9wdGlvbnMpO1xuICAgIC8vXG4gICAgLy8gICAgIHJldHVybiAkZWxlbS5kYXRhKCdkaXZhJyk7XG4gICAgLy8gfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgRGl2YSBpbnN0YW5jZSBhdHRhY2hlZCB0byB0aGVcbiAgICAgKiBlbGVtZW50LCBpZiBhbnkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZWxlbWVudFxuICAgICAqIEByZXR1cm5zIHtEaXZhfG51bGx9XG4gICAgICovXG4gICAgLy8gZmluZDogZnVuY3Rpb24gKGVsZW1lbnQpXG4gICAgLy8ge1xuICAgIC8vICAgICByZXR1cm4gJChlbGVtZW50KS5kYXRhKCdkaXZhJykgfHwgbnVsbDtcbiAgICAvLyB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBkaXZhO1xuXG4vLyBmdW5jdGlvbiByZXByRWxlbShlbGVtKVxuLy8ge1xuLy8gICAgIGNvbnN0IGlkID0gZWxlbS5pZCA/ICcjJyArIGVsZW0uaWQgOiBlbGVtLmlkO1xuLy8gICAgIGNvbnN0IGNsYXNzZXMgPSBlbGVtLmNsYXNzTmFtZSA/ICcuJyArIGVsZW0uY2xhc3NOYW1lLnNwbGl0KC9cXHMrL2cpLmpvaW4oJy4nKSA6ICcnO1xuLy9cbi8vICAgICByZXR1cm4gKGlkID8gaWQgOiBlbGVtLnRhZ05hbWUudG9Mb3dlckNhc2UoKSkgKyBjbGFzc2VzO1xuLy8gfVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/diva-global.js\n");

/***/ }),

/***/ "./source/js/diva.js":
/*!***************************!*\
  !*** ./source/js/diva.js ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_vanilla_kinetic__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/vanilla.kinetic */ \"./source/js/utils/vanilla.kinetic.js\");\n/* harmony import */ var _utils_vanilla_kinetic__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_utils_vanilla_kinetic__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_dragscroll__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/dragscroll */ \"./source/js/utils/dragscroll.js\");\n/* harmony import */ var _utils_dragscroll__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_utils_dragscroll__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_elt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/elt */ \"./source/js/utils/elt.js\");\n/* harmony import */ var _exceptions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./exceptions */ \"./source/js/exceptions.js\");\n/* harmony import */ var _diva_global__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./diva-global */ \"./source/js/diva-global.js\");\n/* harmony import */ var _viewer_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./viewer-core */ \"./source/js/viewer-core.js\");\n/* harmony import */ var _image_manifest__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./image-manifest */ \"./source/js/image-manifest.js\");\n/* harmony import */ var _toolbar__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./toolbar */ \"./source/js/toolbar.js\");\n/* harmony import */ var _utils_hash_params__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./utils/hash-params */ \"./source/js/utils/hash-params.js\");\n\n\n\n\n\n\n\n\n\n\n\n/**\n * The top-level class for Diva objects. This is instantiated by passing in an HTML element\n * ID or HTML Element node and an object containing a list of options, of which the 'objectData'\n * option is required and which must point to a IIIF Presentation API Manifest:\n *\n * var diva = new Diva('element-id', {\n *     objectData: \"http://example.com/iiif-manifest.json\"\n * });\n *\n * This class also serves as the entry point for the Events system, in which applications can subscribe\n * to notifications sent from Diva instances:\n *\n * Diva.Events.subscribe('VisiblePageDidChange', function () { console.log(\"Visible Page Changed\"); });\n *\n *\n *\n **/\nclass Diva\n{\n    constructor (element, options)\n    {\n        /*\n         * If a string is passed in, convert that to an element.\n         * */\n        if (!(element instanceof HTMLElement))\n        {\n            this.element = document.getElementById(element);\n\n            if (this.element === null)\n            {\n                throw new _exceptions__WEBPACK_IMPORTED_MODULE_3__[\"DivaParentElementNotFoundException\"]();\n            }\n        }\n\n        if (!options.objectData)\n        {\n            throw new _exceptions__WEBPACK_IMPORTED_MODULE_3__[\"ObjectDataNotSuppliedException\"]('You must supply either a URL or a literal object to the `objectData` key.');\n        }\n\n        this.options = Object.assign({\n            acceptHeader: \"application/json\", // The header to send off to the server in content negotiation\n            adaptivePadding: 0.05,      // The ratio of padding to the page dimension\n            arrowScrollAmount: 40,      // The amount (in pixels) to scroll by when using arrow keys\n            blockMobileMove: false,     // Prevent moving or scrolling the page on mobile devices\n            objectData: '',             // A IIIF Manifest or a JSON file generated by process.py that provides the object dimension data, or a URL pointing to such data - *REQUIRED*\n            enableAutoTitle: true,      // Shows the title within a div of id diva-title\n            enableFilename: true,       // Uses filenames and not page numbers for links (i=bm_001.tif, not p=1)\n            enableFullscreen: true,     // Enable or disable fullscreen icon (mode still available)\n            enableGotoPage: true,       // A \"go to page\" jump box\n            enableGotoSuggestions: true, // Controls whether suggestions are shown under the input field when the user is typing in the 'go to page' form\n            enableGridIcon: true,       // A grid view of all the pages\n            enableGridControls: 'buttons',  // Specify control of pages per grid row in Grid view. Possible values: 'buttons' (+/-), 'slider'. Any other value disables the controls.\n            enableImageTitles: true,    // Adds \"Page {n}\" title to page images if true\n            enableIndexAsLabel: false,\t// Use index numbers instead of page labels in the page n-m display.\n            enableKeyScroll: true,      // Captures scrolling using the arrow and page up/down keys regardless of page focus. When off, defers to default browser scrolling behavior.\n            enableLinkIcon: true,       // Controls the visibility of the link icon\n            enableNonPagedVisibilityIcon: true, // Controls the visibility of the icon to toggle the visibility of non-paged pages. (Automatically hidden if no 'non-paged' pages).\n            enableSpaceScroll: false,   // Scrolling down by pressing the space key\n            enableToolbar: true,        // Enables the toolbar. Note that disabling this means you have to handle all controls yourself.\n            enableZoomControls: 'buttons', // Specify controls for zooming in and out. Possible values: 'buttons' (+/-), 'slider'. Any other value disables the controls.\n            fillParentHeight: true,     // Use a flexbox layout to allow Diva to fill its parent's height\n            fixedPadding: 10,           // Fallback if adaptive padding is set to 0\n            fixedHeightGrid: true,      // So each page in grid view has the same height (only widths differ)\n            goDirectlyTo: 0,            // Default initial page to show (0-indexed)\n            hashParamSuffix: null,      // Used when there are multiple document viewers on a page\n            inFullscreen: false,        // Set to true to load fullscreen mode initially\n            inBookLayout: false,       // Set to true to view the document with facing pages in document mode\n            inGrid: false,              // Set to true to load grid view initially\n            maxPagesPerRow: 8,          // Maximum number of pages per row in grid view\n            maxZoomLevel: -1,           // Optional; defaults to the max zoom returned in the JSON response\n            minPagesPerRow: 2,          // Minimum pages per row in grid view. Recommended default.\n            minZoomLevel: 0,            // Defaults to 0 (the minimum zoom)\n            onGotoSubmit: null,         // When set to a function that takes a string and returns a page index, this will override the default behaviour of the 'go to page' form submission\n            pageAliases: {},            // An object mapping specific page indices to aliases (has priority over 'pageAliasFunction'\n            pageAliasFunction: function(){return false;},  // A function mapping page indices to an alias. If false is returned, default page number is displayed\n            pageLoadTimeout: 200,       // Number of milliseconds to wait before loading pages\n            pagesPerRow: 5,             // The default number of pages per row in grid view\n            showNonPagedPages: false,   // Whether pages tagged as 'non-paged' (in IIIF manifests only) should be visible after initial load\n            throbberTimeout: 100,       // Number of milliseconds to wait before showing throbber\n            tileHeight: 256,            // The height of each tile, in pixels; usually 256\n            tileWidth: 256,             // The width of each tile, in pixels; usually 256\n            toolbarParentObject: null,  // The toolbar parent object.\n            verticallyOriented: true,   // Determines vertical vs. horizontal orientation\n            viewportMargin: 200,        // Pretend tiles +/- 200px away from viewport are in\n            zoomLevel: 2                // The initial zoom level (used to store the current zoom level)\n        }, options);\n\n        // In order to fill the height, use a wrapper div displayed using a flexbox layout\n        const wrapperElement = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_2__[\"elt\"])('div', {\n            class: `diva-wrapper${this.options.fillParentHeight ? \" diva-wrapper-flexbox\" : \"\"}`\n        });\n\n        this.element.appendChild(wrapperElement);\n\n        this.options.toolbarParentObject = this.options.toolbarParentObject || wrapperElement;\n\n        const viewerCore = new _viewer_core__WEBPACK_IMPORTED_MODULE_5__[\"default\"](wrapperElement, this.options, this);\n\n        this.viewerState = viewerCore.getInternalState();\n        this.settings = viewerCore.getSettings();\n        this.toolbar = new _toolbar__WEBPACK_IMPORTED_MODULE_7__[\"default\"](this);\n\n        wrapperElement.id = this.settings.ID + 'wrapper';\n\n        this.divaState = {\n            viewerCore: viewerCore,\n            toolbar: this.settings.enableToolbar ? this.toolbar : null\n        };\n\n        // only render the toolbar after the object has been loaded\n        let handle = _diva_global__WEBPACK_IMPORTED_MODULE_4__[\"default\"].Events.subscribe('ObjectDidLoad', () =>\n        {\n            this.toolbar.render();\n            _diva_global__WEBPACK_IMPORTED_MODULE_4__[\"default\"].Events.unsubscribe(handle);\n        });\n        this.hashState = this._getHashParamState();\n\n        this._loadOrFetchObjectData();\n    }\n\n    /**\n     * @private\n     **/\n    _loadOrFetchObjectData ()\n    {\n        if (typeof this.settings.objectData === 'object')\n        {\n            // Defer execution until initialization has completed\n            setTimeout(() =>\n            {\n                this._loadObjectData(this.settings.objectData, this.hashState);\n            }, 0);\n        }\n        else\n        {\n            const pendingManifestRequest = fetch(this.settings.objectData, {\n                headers: {\n                    \"Accept\": this.settings.acceptHeader\n                }\n            }).then( (response) =>\n            {\n                if (!response.ok)\n                {\n                    this._ajaxError(response);\n\n                    let error = new Error(response.statusText);\n                    error.response = response;\n                    throw error;\n                }\n                return response.json();\n\n            }).then( (data) =>\n            {\n                this._loadObjectData(data, this.hashState);\n            });\n\n            // Store the pending request so that it can be cancelled in the event that Diva needs to be destroyed\n            this.divaState.viewerCore.setPendingManifestRequest(pendingManifestRequest);\n        }\n    }\n\n    /**\n     * @private\n     **/\n    _showError (message)\n    {\n        this.divaState.viewerCore.showError(message);\n    }\n\n    /**\n     * @private\n     * */\n    _ajaxError (response)\n    {\n        // Show a basic error message within the document viewer pane\n        const errorMessage = ['Invalid objectData setting. Error code: ' + response.status + ' ' + response.statusText];\n\n        // Detect and handle CORS errors\n        const dataHasAbsolutePath = this.settings.objectData.lastIndexOf('http', 0) === 0;\n\n        if (dataHasAbsolutePath)\n        {\n            const jsonHost = this.settings.objectData.replace(/https?:\\/\\//i, \"\").split(/[/?#]/)[0];\n\n            if (window.location.hostname !== jsonHost)\n            {\n                errorMessage.push(\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_2__[\"elt\"])('p', 'Attempted to access cross-origin data without CORS.'),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_2__[\"elt\"])('p',\n                        'You may need to update your server configuration to support CORS. For help, see the ',\n                        Object(_utils_elt__WEBPACK_IMPORTED_MODULE_2__[\"elt\"])('a', {\n                            href: 'https://github.com/DDMAL/diva.js/wiki/Installation#a-note-about-cross-site-requests',\n                            target: '_blank'\n                        }, 'cross-site request documentation.')\n                    )\n                );\n            }\n        }\n\n        this._showError(errorMessage);\n    }\n\n    /**\n     * @private\n     **/\n    _loadObjectData (responseData, hashState)\n    {\n        let manifest;\n\n        // TODO improve IIIF detection method\n        if (!responseData.hasOwnProperty('@context') && (responseData['@context'].indexOf('iiif') === -1 || responseData['@context'].indexOf('shared-canvas') === -1))\n        {\n            throw new _exceptions__WEBPACK_IMPORTED_MODULE_3__[\"NotAnIIIFManifestException\"]('This does not appear to be a IIIF Manifest.');\n        }\n\n        // trigger ManifestDidLoad event\n        _diva_global__WEBPACK_IMPORTED_MODULE_4__[\"default\"].Events.publish('ManifestDidLoad', [responseData], this);\n        manifest = _image_manifest__WEBPACK_IMPORTED_MODULE_6__[\"default\"].fromIIIF(responseData);\n        const loadOptions = hashState ? this._getLoadOptionsForState(hashState, manifest) : {};\n\n        this.divaState.viewerCore.setManifest(manifest, loadOptions);\n    }\n\n    /**\n     * Parse the hash parameters into the format used by getState and setState\n     *\n     * @private\n     **/\n    _getHashParamState ()\n    {\n        const state = {};\n\n        ['f', 'v', 'z', 'n', 'i', 'p', 'y', 'x'].forEach( (param) =>\n        {\n            const value = _utils_hash_params__WEBPACK_IMPORTED_MODULE_8__[\"default\"].get(param + this.settings.hashParamSuffix);\n\n            // `false` is returned if the value is missing\n            if (value !== false)\n                state[param] = value;\n        });\n\n        // Do some awkward special-casing, since this format is kind of weird.\n\n        // For inFullscreen (f), true and false strings should be interpreted\n        // as booleans.\n        if (state.f === 'true')\n            state.f = true;\n        else if (state.f === 'false')\n            state.f = false;\n\n        // Convert numerical values to integers, if provided\n        ['z', 'n', 'p', 'x', 'y'].forEach( (param) =>\n        {\n            if (param in state)\n                state[param] = parseInt(state[param], 10);\n        });\n\n        return state;\n    }\n\n    /**\n     * @private\n     **/\n    _getLoadOptionsForState (state, manifest)\n    {\n        manifest = manifest || this.settings.manifest;\n\n        const options = ('v' in state) ? this._getViewState(state.v) : {};\n\n        if ('f' in state)\n            options.inFullscreen = state.f;\n\n        if ('z' in state)\n            options.zoomLevel = state.z;\n\n        if ('n' in state)\n            options.pagesPerRow = state.n;\n\n        // Only change specify the page if state.i or state.p is valid\n        let pageIndex = this._getPageIndexForManifest(manifest, state.i);\n\n        if (!(pageIndex >= 0 && pageIndex < manifest.pages.length))\n        {\n            pageIndex = state.p - 1;\n\n            // Possibly NaN\n            if (!(pageIndex >= 0 && pageIndex < manifest.pages.length))\n                pageIndex = null;\n        }\n\n        if (pageIndex !== null)\n        {\n            const horizontalOffset = parseInt(state.x, 10);\n            const verticalOffset = parseInt(state.y, 10);\n\n            options.goDirectlyTo = pageIndex;\n            options.horizontalOffset = horizontalOffset;\n            options.verticalOffset = verticalOffset;\n        }\n\n        return options;\n    }\n\n    /**\n     * @private\n     * */\n    _getViewState (view)\n    {\n        switch (view)\n        {\n            case 'd':\n                return {\n                    inGrid: false,\n                    inBookLayout: false\n                };\n\n            case 'b':\n                return {\n                    inGrid: false,\n                    inBookLayout: true\n                };\n\n            case 'g':\n                return {\n                    inGrid: true,\n                    inBookLayout: false\n                };\n\n            default:\n                return {};\n        }\n    }\n\n    /**\n     * @private\n     * */\n    _getPageIndexForManifest (manifest, filename)\n    {\n        let i;\n        const np = manifest.pages.length;\n\n        for (i = 0; i < np; i++)\n        {\n            if (manifest.pages[i].f === filename)\n            {\n                return i;\n            }\n        }\n\n        return -1;\n    }\n\n    /**\n     * @private\n     * */\n    _getState ()\n    {\n        let view;\n\n        if (this.settings.inGrid)\n        {\n            view = 'g';\n        }\n        else if (this.settings.inBookLayout)\n        {\n            view = 'b';\n        }\n        else\n        {\n            view = 'd';\n        }\n\n        const layout = this.divaState.viewerCore.getCurrentLayout();\n        const pageOffset = layout.getPageToViewportCenterOffset(this.settings.activePageIndex, this.viewerState.viewport);\n\n        return {\n            'f': this.settings.inFullscreen,\n            'v': view,\n            'z': this.settings.zoomLevel,\n            'n': this.settings.pagesPerRow,\n            'i': this.settings.enableFilename ? this.settings.manifest.pages[this.settings.activePageIndex].f : false,\n            'p': this.settings.enableFilename ? false : this.settings.activePageIndex + 1,\n            'y': pageOffset ? pageOffset.y : false,\n            'x': pageOffset ? pageOffset.x : false\n        };\n    }\n\n    /**\n     * @private\n     **/\n    _getURLHash ()\n    {\n        const hashParams = this._getState();\n        const hashStringBuilder = [];\n        let param;\n\n        for (param in hashParams)\n        {\n            if (hashParams[param] !== false)\n                hashStringBuilder.push(param + this.settings.hashParamSuffix + '=' + encodeURIComponent(hashParams[param]));\n        }\n\n        return hashStringBuilder.join('&');\n    }\n\n    /**\n     * Returns the page index associated with the given filename; must called after setting settings.manifest\n     *\n     * @private\n     **/\n    _getPageIndex (filename)\n    {\n        return this._getPageIndexForManifest(this.settings.manifest, filename);\n    }\n\n    /**\n     * @private\n     * */\n    _checkLoaded ()\n    {\n        if (!this.viewerState.loaded)\n        {\n            console.warn(\"The viewer is not completely initialized. This is likely because it is still downloading data. To fix this, only call this function if the isReady() method returns true.\");\n            return false;\n        }\n        return true;\n    }\n\n    /**\n     * Called when the fullscreen icon is clicked\n     *\n     * @private\n     **/\n    _toggleFullscreen ()\n    {\n        this._reloadViewer({\n            inFullscreen: !this.settings.inFullscreen\n        });\n\n        // handle toolbar opacity in fullscreen\n        let t;\n        let hover = false;\n        let tools = document.getElementById(this.settings.selector + 'tools');\n        const TIMEOUT = 2000;\n\n        if (this.settings.inFullscreen) \n        {\n            tools.classList.add(\"diva-fullscreen-tools\");\n\n            document.addEventListener('mousemove', toggleOpacity.bind(this));\n            document.getElementsByClassName('diva-viewport')[0].addEventListener('scroll', toggleOpacity.bind(this));\n            tools.addEventListener('mouseenter', function () {\n                hover = true;\n            });\n            tools.addEventListener('mouseleave', function () {\n                hover = false;\n            });\n        }\n        else\n        {\n            tools.classList.remove(\"diva-fullscreen-tools\");\n        }\n\n        function toggleOpacity () \n        {\n            tools.style.opacity = 1;\n            clearTimeout(t);\n            if (!hover && this.settings.inFullscreen) {\n                t = setTimeout(function () \n                {\n                    tools.style.opacity = 0;\n                }, TIMEOUT);\n            }\n        }\n    }\n\n    /**\n     * Toggles between orientations\n     *\n     * @private\n     * */\n    _togglePageLayoutOrientation ()\n    {\n        const verticallyOriented = !this.settings.verticallyOriented;\n\n        //if in grid, switch out of grid\n        this._reloadViewer({\n            inGrid: false,\n            verticallyOriented: verticallyOriented,\n            goDirectlyTo: this.settings.activePageIndex,\n            verticalOffset: this.divaState.viewerCore.getYOffset(),\n            horizontalOffset: this.divaState.viewerCore.getXOffset()\n        });\n\n        return verticallyOriented;\n    }\n\n    /**\n     * Called when the change view icon is clicked\n     *\n     * @private\n     **/\n    _changeView (destinationView)\n    {\n        switch (destinationView)\n        {\n            case 'document':\n                return this._reloadViewer({\n                    inGrid: false,\n                    inBookLayout: false\n                });\n\n            case 'book':\n                return this._reloadViewer({\n                    inGrid: false,\n                    inBookLayout: true\n                });\n\n            case 'grid':\n                return this._reloadViewer({\n                    inGrid: true\n                });\n\n            default:\n                return false;\n        }\n    }\n\n    /**\n     * @private\n     *\n     * @param {Number} pageIndex - 0-based page index.\n     * @param {Number} xAnchor - x coordinate to jump to on resulting page.\n     * @param {Number} yAnchor - y coordinate to jump to on resulting page.\n     * @returns {Boolean} - Whether the jump was successful.\n     **/\n    _gotoPageByIndex (pageIndex, xAnchor, yAnchor)\n    {\n        let pidx = parseInt(pageIndex, 10);\n\n        if (this._isPageIndexValid(pidx))\n        {\n            const xOffset = this.divaState.viewerCore.getXOffset(pidx, xAnchor);\n            const yOffset = this.divaState.viewerCore.getYOffset(pidx, yAnchor);\n\n            this.viewerState.renderer.goto(pidx, yOffset, xOffset);\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Check if a page index is valid\n     *\n     * @private\n     * @param {Number} pageIndex - Numeric (0-based) page index\n     * @return {Boolean} whether the page index is valid or not.\n     */\n    _isPageIndexValid (pageIndex)\n    {\n        return this.settings.manifest.isPageValid(pageIndex, this.settings.showNonPagedPages);\n    }\n\n    /**\n     * Given a pageX and pageY value, returns either the page visible at that (x,y)\n     * position or -1 if no page is.\n     *\n     * @private\n     */\n    _getPageIndexForPageXYValues (pageX, pageY)\n    {\n        //get the four edges of the outer element\n        const outerOffset = this.viewerState.outerElement.getBoundingClientRect();\n        const outerTop = outerOffset.top;\n        const outerLeft = outerOffset.left;\n        const outerBottom = outerOffset.bottom;\n        const outerRight = outerOffset.right;\n\n        //if the clicked position was outside the diva-outer object, it was not on a visible portion of a page\n        if (pageX < outerLeft || pageX > outerRight)\n            return -1;\n\n        if (pageY < outerTop || pageY > outerBottom)\n            return -1;\n\n        //navigate through all diva page objects\n        const pages = document.getElementsByClassName('diva-page');\n        let curPageIdx = pages.length;\n        while (curPageIdx--)\n        {\n            //get the offset for each page\n            const curPage = pages[curPageIdx];\n            const curOffset = curPage.getBoundingClientRect();\n\n            //if this point is outside the horizontal boundaries of the page, continue\n            if (pageX < curOffset.left || pageX > curOffset.right)\n                continue;\n\n            //same with vertical boundaries\n            if (pageY < curOffset.top || pageY > curOffset.bottom)\n                continue;\n\n            //if we made it through the above two, we found the page we're looking for\n            return curPage.getAttribute('data-index');\n        }\n\n        //if we made it through that entire while loop, we didn't click on a page\n        return -1;\n    }\n\n    /**\n     * @private\n     **/\n    _reloadViewer (newOptions)\n    {\n        return this.divaState.viewerCore.reload(newOptions);\n    }\n\n    /**\n     * @private\n     */\n    _getCurrentURL ()\n    {\n        return location.protocol + '//' + location.host + location.pathname + location.search + '#' + this._getURLHash();\n    }\n\n    /**\n     * ===============================================\n     *                PUBLIC FUNCTIONS\n     * ===============================================\n     **/\n\n    /**\n     *  Activate this instance of diva via the active Diva controller.\n     *\n     *  @public\n     */\n    activate ()\n    {\n        this.viewerState.isActiveDiva = true;\n    }\n\n    /**\n     * Change the object (objectData) parameter currently being rendered by Diva.\n     *\n     * @public\n     * @params {object} objectData - An IIIF Manifest object OR a URL to a IIIF manifest.\n     */\n    changeObject (objectData)\n    {\n        this.viewerState.loaded = false;\n        this.divaState.viewerCore.clear();\n\n        if (this.viewerState.renderer)\n            this.viewerState.renderer.destroy();\n\n        this.viewerState.options.objectData = objectData;\n\n        this._loadOrFetchObjectData();\n    }\n\n    /**\n     * Change views. Takes 'document', 'book', or 'grid' to specify which view to switch into\n     *\n     * @public\n     * @params {string} destinationView - the destination view to change to.\n     */\n    changeView (destinationView)\n    {\n        this._changeView(destinationView);\n    }\n\n    /**\n     *  Deactivate this diva instance through the active Diva controller.\n     *\n     *  @public\n     **/\n    deactivate ()\n    {\n        this.viewerState.isActiveDiva = false;\n    }\n\n    /**\n     * Destroys this instance, tells plugins to do the same\n     *\n     * @public\n     **/\n    destroy ()\n    {\n        this.divaState.viewerCore.destroy();\n    }\n\n    /**\n     * Disables document dragging, scrolling (by keyboard if set), and zooming by double-clicking\n     *\n     * @public\n     **/\n    disableScrollable ()\n    {\n        this.divaState.viewerCore.disableScrollable();\n    }\n\n    /**\n     * Re-enables document dragging, scrolling (by keyboard if set), and zooming by double-clicking\n     *\n     * @public\n     **/\n    enableScrollable ()\n    {\n        this.divaState.viewerCore.enableScrollable();\n    }\n\n    /**\n     * Disables document drag scrolling\n     *\n     * @public\n     */\n    disableDragScrollable ()\n    {\n        this.divaState.viewerCore.disableDragScrollable();\n    }\n    \n    /**\n     * Enables document drag scrolling\n     *\n     * @public\n     */\n    enableDragScrollable ()\n    {\n        this.divaState.viewerCore.enableDragScrollable();\n    }\n\n    /**\n     * Enter fullscreen mode if currently not in fullscreen mode. If currently in fullscreen\n     * mode this will have no effect.\n     *\n     * This function will work even if enableFullscreen is set to false in the options.\n     *\n     * @public\n     * @returns {boolean} - Whether the switch to fullscreen was successful or not.\n     **/\n    enterFullscreenMode ()\n    {\n        if (!this.settings.inFullscreen)\n        {\n            this._toggleFullscreen();\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Enter grid view if currently not in grid view. If currently in grid view mode\n     * this will have no effect.\n     *\n     * @public\n     * @returns {boolean} - Whether the switch to grid view was successful or not.\n     **/\n    enterGridView ()\n    {\n        if (!this.settings.inGrid)\n        {\n            this._changeView('grid');\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Returns an array of all page image URIs in the document.\n     *\n     * @public\n     * @returns {Array} - An array of all the URIs in the document.\n     * */\n    getAllPageURIs ()\n    {\n        return this.settings.manifest.pages.map( (pg) =>\n        {\n            return pg.f;\n        });\n    }\n\n    /**\n     * Get the canvas identifier for the currently visible page.\n     *\n     * @public\n     * @returns {string} - The URI of the currently visible canvas.\n     **/\n    getCurrentCanvas ()\n    {\n        return this.settings.manifest.pages[this.settings.activePageIndex].canvas;\n    }\n\n    /**\n     * Returns the dimensions of the current page at the current zoom level. Also works in\n     * grid view.\n     *\n     * @public\n     * @returns {object} - An object containing the current page dimensions at the current zoom level.\n     **/\n    getCurrentPageDimensionsAtCurrentZoomLevel ()\n    {\n        return this.getPageDimensionsAtCurrentZoomLevel(this.settings.activePageIndex);\n    }\n\n    /**\n     * Returns the current filename (deprecated). Returns the URI for current page.\n     *\n     * @public\n     * @deprecated\n     * @returns {string} - The URI for the current page image.\n     **/\n    getCurrentPageFilename ()\n    {\n        console.warn('This method will be deprecated in the next version of Diva. Please use getCurrentPageURI instead.');\n        return this.settings.manifest.pages[this.settings.activePageIndex].f;\n    }\n\n    /**\n     * Returns an array of page indices that are visible in the viewport.\n     *\n     * @public\n     * @returns {array} - The 0-based indices array for the currently visible pages.\n     **/\n    getCurrentPageIndices ()\n    {\n        return this.settings.currentPageIndices;\n    }\n\n    /**\n     * Returns the 0-based index for the current page.\n     *\n     * @public\n     * @returns {number} - The 0-based index for the currently visible page.\n     **/\n     getActivePageIndex ()\n     {\n        return this.settings.activePageIndex;\n     }\n\n    /**\n     * Shortcut to getPageOffset for current page.\n     *\n     * @public\n     * @returns {} -\n     * */\n    getCurrentPageOffset ()\n    {\n        return this.getPageOffset(this.settings.activePageIndex);\n    }\n\n    /**\n     * Returns the current URI for the visible page.\n     *\n     * @public\n     * @returns {string} - The URI for the current page image.\n     **/\n    getCurrentPageURI ()\n    {\n        return this.settings.manifest.pages[this.settings.activePageIndex].f;\n    }\n\n    /**\n     * Return the current URL for the viewer, including the hash parameters reflecting\n     * the current state of the viewer.\n     *\n     * @public\n     * @returns {string} - The URL for the current view state.\n     * */\n    getCurrentURL ()\n    {\n        return this._getCurrentURL();\n    }\n\n    /**\n     * Returns an array of all filenames in the document. Deprecated.\n     *\n     * @public\n     * @deprecated\n     * @returns {Array} - An array of all the URIs in the document.\n     * */\n    getFilenames ()\n    {\n        console.warn('This will be removed in the next version of Diva. Use getAllPageURIs instead.');\n\n        return this.settings.manifest.pages.map( (pg) =>\n        {\n            return pg.f;\n        });\n    }\n\n    /**\n     * Get the number of grid pages per row.\n     *\n     * @public\n     * @returns {number} - The number of grid pages per row.\n     **/\n    getGridPagesPerRow ()\n    {\n        // TODO(wabain): Add test case\n        return this.settings.pagesPerRow;\n    }\n\n    /**\n     * Get the instance ID number.\n     *\n     * @public\n     * @returns {number} - The instance ID.\n     * */\n    //\n    getInstanceId ()\n    {\n        return this.settings.ID;\n    }\n\n    /**\n     * Get the instance selector for this instance. This is the selector for the parent\n     * div.\n     *\n     * @public\n     * @returns {string} - The viewport selector.\n     * */\n    getInstanceSelector ()\n    {\n        return this.divaState.viewerCore.selector;\n    }\n\n    /**\n     * Returns the title of the document, based on the label in the IIIF manifest.\n     *\n     * @public\n     * @returns {string} - The current title of the object from the label key in the IIIF Manifest.\n     **/\n    getItemTitle ()\n    {\n        return this.settings.manifest.itemTitle;\n    }\n\n    /**\n     * Gets the maximum zoom level for the entire document.\n     *\n     * @public\n     * @returns {number} - The maximum zoom level for the document\n     * */\n    getMaxZoomLevel ()\n    {\n        return this.settings.maxZoomLevel;\n    }\n\n    /**\n     * Gets the max zoom level for a given page.\n     *\n     * @public\n     * @param {number} pageIdx - The 0-based index number for the page.\n     * @returns {number} - The maximum zoom level for that page.\n     * */\n    getMaxZoomLevelForPage (pageIdx)\n    {\n        if (!this._checkLoaded())\n            return false;\n\n        return this.settings.manifest.pages[pageIdx].m;\n    }\n\n    /**\n     * Gets the minimum zoom level for the entire document.\n     *\n     * @public\n     * @returns {number} - The minimum zoom level for the document\n     * */\n    getMinZoomLevel ()\n    {\n        return this.settings.minZoomLevel;\n    }\n\n    /**\n     * Gets the number of pages in the document.\n     *\n     * @public\n     * @returns {number} - The number of pages in the document.\n     * */\n    getNumberOfPages ()\n    {\n        if (!this._checkLoaded())\n            return false;\n\n        return this.settings.numPages;\n    }\n\n    /**\n     * If a canvas has multiple images defined, returns the non-primary image.\n     *\n     * @public\n     * @params {number} pageIndex - The page index for which to return the other images.\n     * @returns {object} An object containing the other images.\n     **/\n    getOtherImages (pageIndex)\n    {\n        return this.settings.manifest.pages[pageIndex].otherImages;\n    }\n\n    /**\n     * Get page dimensions in the current view and zoom level\n     *\n     * @public\n     * @params {number} pageIndex - A valid 0-based page index\n     * @returns {object} - An object containing the dimensions of the page\n     * */\n    getPageDimensions (pageIndex)\n    {\n        if (!this._checkLoaded())\n            return null;\n\n        return this.divaState.viewerCore.getCurrentLayout().getPageDimensions(pageIndex);\n    }\n\n    /**\n     * Returns the dimensions of a given page at the current zoom level.\n     * Also works in Grid view\n     *\n     * @public\n     * @param {number} pageIndex - The 0-based page index\n     * @returns {object} - An object containing the page dimensions at the current zoom level.\n     * */\n    getPageDimensionsAtCurrentZoomLevel (pageIndex)\n    {\n        let pidx = parseInt(pageIndex, 10);\n\n        if (!this._isPageIndexValid(pidx))\n            throw new Error('Invalid Page Index');\n\n        return this.divaState.viewerCore.getCurrentLayout().getPageDimensions(pidx);\n    }\n\n    /**\n     * Get page dimensions at a given zoom level\n     *\n     * @public\n     * @params {number} pageIdx - A valid 0-based page index\n     * @params {number} zoomLevel - A candidate zoom level.\n     * @returns {object} - An object containing the dimensions of the page at the given zoom level.\n     **/\n    getPageDimensionsAtZoomLevel (pageIdx, zoomLevel)\n    {\n        if (!this._checkLoaded())\n            return false;\n\n        if (zoomLevel > this.settings.maxZoomLevel)\n            zoomLevel = this.settings.maxZoomLevel;\n\n        const pg = this.settings.manifest.pages[parseInt(pageIdx, 10)];\n        const pgAtZoom = pg.d[parseInt(zoomLevel, 10)];\n\n        return {\n            width: pgAtZoom.w,\n            height: pgAtZoom.h\n        };\n    }\n\n    /**\n     * Returns a URL for the image of the page at the given index. The\n     * optional size parameter supports setting the image width or height\n     * (default is full-sized).\n     *\n     * @public\n     * @params {number} pageIndex - 0-based page index\n     * @params {?object} size - an object containing width and height information\n     * @returns {string} - The IIIF URL for a given page at an optional size\n     */\n    getPageImageURL (pageIndex, size)\n    {\n        return this.settings.manifest.getPageImageURL(pageIndex, size);\n    }\n\n    /**\n     * Given a set of co-ordinates (e.g., from a mouse click), return the 0-based page index\n     * for which it matches.\n     *\n     * @public\n     * @params {number} pageX - The x co-ordinate\n     * @params {number} pageY - The y co-ordinate\n     * @returns {number} - The page index matching the co-ordinates.\n     * */\n    getPageIndexForPageXYValues (pageX, pageY)\n    {\n        return this._getPageIndexForPageXYValues(pageX, pageY);\n    }\n\n    /**\n     * Returns distance between the northwest corners of diva-inner and page index.\n     *\n     * @public\n     * @params {number} pageIndex - The 0-based page index\n     * @params {?options} options - A set of options to pass in.\n     * @returns {object} - The offset between the upper left corner and the page.\n     *\n     * */\n    getPageOffset (pageIndex, options)\n    {\n        const region = this.divaState.viewerCore.getPageRegion(pageIndex, options);\n\n        return {\n            top: region.top,\n            left: region.left\n        };\n    }\n\n    /**\n     * Get the instance settings.\n     *\n     * @public\n     * @returns {object} - The current instance settings.\n     * */\n    getSettings ()\n    {\n        return this.settings;\n    }\n\n    /**\n     * Get an object representing the complete state of the viewer.\n     *\n     * @public\n     * @returns {object} - The current instance state.\n     * */\n    getState ()\n    {\n        return this._getState();\n    }\n\n    /**\n     * Get the current zoom level.\n     *\n     * @public\n     * @returns {number} - The current zoom level.\n     * */\n    getZoomLevel ()\n    {\n        return this.settings.zoomLevel;\n    }\n\n    /**\n     *  Go to a particular page (with indexing starting at 0).\n     *  The (xAnchor) side of the page will be anchored to the (xAnchor) side of the diva-outer element\n     *\n     *  @public\n     *  @params {number} pageIndex - 0-based page index.\n     *  @params {?string} xAnchor - may either be \"left\", \"right\", or default \"center\"\n     *  @params {?string} yAnchor - may either be \"top\", \"bottom\", or default \"center\"; same process as xAnchor.\n     *  @returns {boolean} - True if the page index is valid; false if it is not.\n     * */\n    gotoPageByIndex (pageIndex, xAnchor, yAnchor)\n    {\n        this._gotoPageByIndex(pageIndex, xAnchor, yAnchor);\n    }\n\n    /**\n     * Given a canvas label, attempt to go to that page. If no label was found.\n     * the label will be attempted to match against the page index.\n     *\n     * @public\n     * @params {string} label - The label to search on.\n     * @params {?string} xAnchor - may either be \"left\", \"right\", or default \"center\"\n     * @params {?string} yAnchor - may either be \"top\", \"bottom\", or default \"center\"\n     * @returns {boolean} - True if the page index is valid; false if it is not.\n     * */\n    gotoPageByLabel (label, xAnchor, yAnchor)\n    {\n        const pages = this.settings.manifest.pages;\n        let llc = label.toLowerCase();\n\n        for (let i = 0, len = pages.length; i < len; i++)\n        {\n            if (pages[i].l.toLowerCase().indexOf(llc) > -1)\n                return this._gotoPageByIndex(i, xAnchor, yAnchor);\n        }\n\n        const pageIndex = parseInt(label, 10) - 1;\n        return this._gotoPageByIndex(pageIndex, xAnchor, yAnchor);\n    }\n\n    /**\n     * Jump to a page based on its filename. Deprecated. Use gotoPageByURI instead.\n     *\n     * @public\n     * @params {string} filename - The filename of the image to jump to.\n     * @params {?string} xAnchor - may either be \"left\", \"right\", or default \"center\"\n     * @params {?string} yAnchor - may either be \"top\", \"bottom\", or default \"center\"\n     * @returns {boolean} true if successful and false if the filename is not found.\n    */\n    gotoPageByName (filename, xAnchor, yAnchor)\n    {\n        console.warn('This method will be removed in the next version of Diva.js. Use gotoPageByURI instead.');\n        const pageIndex = this._getPageIndex(filename);\n        return this._gotoPageByIndex(pageIndex, xAnchor, yAnchor);\n    }\n\n    /**\n     * Jump to a page based on its URI.\n     *\n     * @public\n     * @params {string} uri - The URI of the image to jump to.\n     * @params {?string} xAnchor - may either be \"left\", \"right\", or default \"center\"\n     * @params {?string} yAnchor - may either be \"top\", \"bottom\", or default \"center\"\n     * @returns {boolean} true if successful and false if the URI is not found.\n     */\n    gotoPageByURI (uri, xAnchor, yAnchor)\n    {\n        const pageIndex = this._getPageIndex(uri);\n        return this._gotoPageByIndex(pageIndex, xAnchor, yAnchor);\n    }\n\n    /**\n     * Whether the page has other images to display.\n     *\n     * @public\n     * @params {number} pageIndex - The 0-based page index\n     * @returns {boolean} Whether the page has other images to display.\n     **/\n    hasOtherImages (pageIndex)\n    {\n        return this.settings.manifest.pages[pageIndex].otherImages === true;\n    }\n\n    /**\n     * Hides the pages that are marked \"non-paged\" in the IIIF manifest.\n     *\n     * @public\n     **/\n    hideNonPagedPages ()\n    {\n        this._reloadViewer({ showNonPagedPages: false });\n    }\n\n    /**\n     * Is the viewer currently in full-screen mode?\n     *\n     * @public\n     * @returns {boolean} - Whether the viewer is in fullscreen mode.\n     **/\n    isInFullscreen ()\n    {\n        return this.settings.inFullscreen;\n    }\n\n    /**\n     * Check if a page index is within the range of the document\n     *\n     * @public\n     * @returns {boolean} - Whether the page index is valid.\n     **/\n    isPageIndexValid (pageIndex)\n    {\n        return this._isPageIndexValid(pageIndex);\n    }\n\n    /**\n     * Determines if a page is currently in the viewport\n     *\n     * @public\n     * @params {number} pageIndex - The 0-based page index\n     * @returns {boolean} - Whether the page is currently in the viewport.\n     **/\n    isPageInViewport (pageIndex)\n    {\n        return this.viewerState.renderer.isPageVisible(pageIndex);\n    }\n\n    /**\n     * Whether the Diva viewer has been fully initialized.\n     *\n     * @public\n     * @returns {boolean} - True if the viewer is initialized; false otherwise.\n     **/\n    isReady ()\n    {\n        return this.viewerState.loaded;\n    }\n\n    /**\n     * Check if something (e.g. a highlight box on a particular page) is visible\n     *\n     * @public\n     * @params {number} pageIndex - The 0-based page index\n     * @params {number} leftOffset - The distance of the region from the left of the viewport\n     * @params {number} topOffset - The distance of the region from the top of the viewport\n     * @params {number} width - The width of the region\n     * @params {number} height - The height of the region\n     * @returns {boolean} - Whether the region is in the viewport.\n     **/\n    isRegionInViewport (pageIndex, leftOffset, topOffset, width, height)\n    {\n        const layout = this.divaState.viewerCore.getCurrentLayout();\n\n        if (!layout)\n            return false;\n\n        const offset = layout.getPageOffset(pageIndex);\n\n        const top = offset.top + topOffset;\n        const left = offset.left + leftOffset;\n\n        return this.viewerState.viewport.intersectsRegion({\n            top: top,\n            bottom: top + height,\n            left: left,\n            right: left + width\n        });\n    }\n\n    /**\n     * Whether the page layout is vertically or horizontally oriented.\n     *\n     * @public\n     * @returns {boolean} - True if vertical; false if horizontal.\n     **/\n    isVerticallyOriented ()\n    {\n        return this.settings.verticallyOriented;\n    }\n\n    /**\n     * Leave fullscreen mode if currently in fullscreen mode.\n     *\n     * @public\n     * @returns {boolean} - true if in fullscreen mode intitially, false otherwise\n     **/\n    leaveFullscreenMode ()\n    {\n        if (this.settings.inFullscreen)\n        {\n            this._toggleFullscreen();\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Leave grid view if currently in grid view.\n     *\n     * @public\n     * @returns {boolean} - true if in grid view initially, false otherwise\n     **/\n    leaveGridView ()\n    {\n        if (this.settings.inGrid)\n        {\n            this._reloadViewer({ inGrid: false });\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Set the number of grid pages per row.\n     *\n     * @public\n     * @params {number} pagesPerRow - The number of pages per row\n     * @returns {boolean} - True if the operation was successful.\n     **/\n    setGridPagesPerRow (pagesPerRow)\n    {\n        // TODO(wabain): Add test case\n        if (!this.divaState.viewerCore.isValidOption('pagesPerRow', pagesPerRow))\n            return false;\n\n        return this._reloadViewer({\n            inGrid: true,\n            pagesPerRow: pagesPerRow\n        });\n    }\n\n    /**\n     * Align this diva instance with a state object (as returned by getState)\n     *\n     * @public\n     * @params {object} state - A Diva state object.\n     * @returns {boolean} - True if the operation was successful.\n     **/\n    setState (state)\n    {\n        this._reloadViewer(this._getLoadOptionsForState(state));\n    }\n\n    /**\n     * Sets the zoom level.\n     *\n     * @public\n     * @returns {boolean} - True if the operation was successful.\n     **/\n    setZoomLevel (zoomLevel)\n    {\n        if (this.settings.inGrid)\n        {\n            this._reloadViewer({\n                inGrid: false\n            });\n        }\n\n        return this.divaState.viewerCore.zoom(zoomLevel);\n    }\n\n    /**\n     * Show non-paged pages.\n     *\n     * @public\n     * @returns {boolean} - True if the operation was successful.\n     **/\n    showNonPagedPages ()\n    {\n        this._reloadViewer({ showNonPagedPages: true });\n    }\n\n    /**\n     * Toggle fullscreen mode.\n     *\n     * @public\n     * @returns {boolean} - True if the operation was successful.\n     **/\n    toggleFullscreenMode ()\n    {\n        this._toggleFullscreen();\n    }\n\n    /**\n     * Show/Hide non-paged pages\n     *\n     * @public\n     * @returns {boolean} - True if the operation was successful.\n     **/\n    toggleNonPagedPagesVisibility ()\n    {\n        this._reloadViewer({\n            showNonPagedPages: !this.settings.showNonPagedPages\n        });\n    }\n\n    //Changes between horizontal layout and vertical layout. Returns true if document is now vertically oriented, false otherwise.\n    toggleOrientation ()\n    {\n        return this._togglePageLayoutOrientation();\n    }\n\n    /**\n     * Translates a measurement from the zoom level on the largest size\n     * to one on the current zoom level.\n     *\n     * For example, a point 1000 on an image that is on zoom level 2 of 5\n     * translates to a position of 111.111... (1000 / (5 - 2)^2).\n     *\n     * Works for a single pixel co-ordinate or a dimension (e.g., translates a box\n     * that is 1000 pixels wide on the original to one that is 111.111 pixels wide\n     * on the current zoom level).\n     *\n     * @public\n     * @params {number} position - A point on the max zoom level\n     * @returns {number} - The same point on the current zoom level.\n    */\n    translateFromMaxZoomLevel (position)\n    {\n        const zoomDifference = this.settings.maxZoomLevel - this.settings.zoomLevel;\n        return position / Math.pow(2, zoomDifference);\n    }\n\n    /**\n     * Translates a measurement from the current zoom level to the position on the\n     * largest zoom level.\n     *\n     * Works for a single pixel co-ordinate or a dimension (e.g., translates a box\n     * that is 111.111 pixels wide on the current image to one that is 1000 pixels wide\n     * on the current zoom level).\n     *\n     * @public\n     * @params {number} position - A point on the current zoom level\n     * @returns {number} - The same point on the max zoom level.\n    */\n    translateToMaxZoomLevel (position)\n    {\n        const zoomDifference = this.settings.maxZoomLevel - this.settings.zoomLevel;\n\n        // if there is no difference, it's a box on the max zoom level and\n        // we can just return the position.\n        if (zoomDifference === 0)\n            return position;\n\n        return position * Math.pow(2, zoomDifference);\n    }\n\n    /**\n     * Zoom in.\n     *\n     * @public\n     * @returns {boolean} - false if it's at the maximum zoom\n     **/\n    zoomIn ()\n    {\n        return this.setZoomLevel(this.settings.zoomLevel + 1);\n    }\n\n    /**\n     * Zoom out.\n     * @returns {boolean} - false if it's at the minimum zoom\n     **/\n    zoomOut ()\n    {\n        return this.setZoomLevel(this.settings.zoomLevel - 1);\n    }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Diva);\n\n/**\n * Make `Diva` available in the global context.\n * */\n(function (global)\n{\n    global.Diva = global.Diva || Diva;\n    global.Diva.Events = _diva_global__WEBPACK_IMPORTED_MODULE_4__[\"default\"].Events;\n})(window);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvZGl2YS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9qcy9kaXZhLmpzP2YwMGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICcuL3V0aWxzL3ZhbmlsbGEua2luZXRpYyc7XG5pbXBvcnQgJy4vdXRpbHMvZHJhZ3Njcm9sbCc7XG5pbXBvcnQgeyBlbHQgfSBmcm9tIFwiLi91dGlscy9lbHRcIjtcbmltcG9ydCB7XG4gICAgRGl2YVBhcmVudEVsZW1lbnROb3RGb3VuZEV4Y2VwdGlvbixcbiAgICBOb3RBbklJSUZNYW5pZmVzdEV4Y2VwdGlvbixcbiAgICBPYmplY3REYXRhTm90U3VwcGxpZWRFeGNlcHRpb25cbn0gZnJvbSBcIi4vZXhjZXB0aW9uc1wiO1xuaW1wb3J0IGRpdmEgZnJvbSBcIi4vZGl2YS1nbG9iYWxcIjtcbmltcG9ydCBWaWV3ZXJDb3JlIGZyb20gXCIuL3ZpZXdlci1jb3JlXCI7XG5pbXBvcnQgSW1hZ2VNYW5pZmVzdCBmcm9tIFwiLi9pbWFnZS1tYW5pZmVzdFwiO1xuaW1wb3J0IFRvb2xiYXIgZnJvbSBcIi4vdG9vbGJhclwiO1xuaW1wb3J0IEhhc2hQYXJhbXMgZnJvbSBcIi4vdXRpbHMvaGFzaC1wYXJhbXNcIjtcblxuXG4vKipcbiAqIFRoZSB0b3AtbGV2ZWwgY2xhc3MgZm9yIERpdmEgb2JqZWN0cy4gVGhpcyBpcyBpbnN0YW50aWF0ZWQgYnkgcGFzc2luZyBpbiBhbiBIVE1MIGVsZW1lbnRcbiAqIElEIG9yIEhUTUwgRWxlbWVudCBub2RlIGFuZCBhbiBvYmplY3QgY29udGFpbmluZyBhIGxpc3Qgb2Ygb3B0aW9ucywgb2Ygd2hpY2ggdGhlICdvYmplY3REYXRhJ1xuICogb3B0aW9uIGlzIHJlcXVpcmVkIGFuZCB3aGljaCBtdXN0IHBvaW50IHRvIGEgSUlJRiBQcmVzZW50YXRpb24gQVBJIE1hbmlmZXN0OlxuICpcbiAqIHZhciBkaXZhID0gbmV3IERpdmEoJ2VsZW1lbnQtaWQnLCB7XG4gKiAgICAgb2JqZWN0RGF0YTogXCJodHRwOi8vZXhhbXBsZS5jb20vaWlpZi1tYW5pZmVzdC5qc29uXCJcbiAqIH0pO1xuICpcbiAqIFRoaXMgY2xhc3MgYWxzbyBzZXJ2ZXMgYXMgdGhlIGVudHJ5IHBvaW50IGZvciB0aGUgRXZlbnRzIHN5c3RlbSwgaW4gd2hpY2ggYXBwbGljYXRpb25zIGNhbiBzdWJzY3JpYmVcbiAqIHRvIG5vdGlmaWNhdGlvbnMgc2VudCBmcm9tIERpdmEgaW5zdGFuY2VzOlxuICpcbiAqIERpdmEuRXZlbnRzLnN1YnNjcmliZSgnVmlzaWJsZVBhZ2VEaWRDaGFuZ2UnLCBmdW5jdGlvbiAoKSB7IGNvbnNvbGUubG9nKFwiVmlzaWJsZSBQYWdlIENoYW5nZWRcIik7IH0pO1xuICpcbiAqXG4gKlxuICoqL1xuY2xhc3MgRGl2YVxue1xuICAgIGNvbnN0cnVjdG9yIChlbGVtZW50LCBvcHRpb25zKVxuICAgIHtcbiAgICAgICAgLypcbiAgICAgICAgICogSWYgYSBzdHJpbmcgaXMgcGFzc2VkIGluLCBjb252ZXJ0IHRoYXQgdG8gYW4gZWxlbWVudC5cbiAgICAgICAgICogKi9cbiAgICAgICAgaWYgKCEoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbWVudCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQgPT09IG51bGwpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IERpdmFQYXJlbnRFbGVtZW50Tm90Rm91bmRFeGNlcHRpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghb3B0aW9ucy5vYmplY3REYXRhKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgT2JqZWN0RGF0YU5vdFN1cHBsaWVkRXhjZXB0aW9uKCdZb3UgbXVzdCBzdXBwbHkgZWl0aGVyIGEgVVJMIG9yIGEgbGl0ZXJhbCBvYmplY3QgdG8gdGhlIGBvYmplY3REYXRhYCBrZXkuJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHtcbiAgICAgICAgICAgIGFjY2VwdEhlYWRlcjogXCJhcHBsaWNhdGlvbi9qc29uXCIsIC8vIFRoZSBoZWFkZXIgdG8gc2VuZCBvZmYgdG8gdGhlIHNlcnZlciBpbiBjb250ZW50IG5lZ290aWF0aW9uXG4gICAgICAgICAgICBhZGFwdGl2ZVBhZGRpbmc6IDAuMDUsICAgICAgLy8gVGhlIHJhdGlvIG9mIHBhZGRpbmcgdG8gdGhlIHBhZ2UgZGltZW5zaW9uXG4gICAgICAgICAgICBhcnJvd1Njcm9sbEFtb3VudDogNDAsICAgICAgLy8gVGhlIGFtb3VudCAoaW4gcGl4ZWxzKSB0byBzY3JvbGwgYnkgd2hlbiB1c2luZyBhcnJvdyBrZXlzXG4gICAgICAgICAgICBibG9ja01vYmlsZU1vdmU6IGZhbHNlLCAgICAgLy8gUHJldmVudCBtb3Zpbmcgb3Igc2Nyb2xsaW5nIHRoZSBwYWdlIG9uIG1vYmlsZSBkZXZpY2VzXG4gICAgICAgICAgICBvYmplY3REYXRhOiAnJywgICAgICAgICAgICAgLy8gQSBJSUlGIE1hbmlmZXN0IG9yIGEgSlNPTiBmaWxlIGdlbmVyYXRlZCBieSBwcm9jZXNzLnB5IHRoYXQgcHJvdmlkZXMgdGhlIG9iamVjdCBkaW1lbnNpb24gZGF0YSwgb3IgYSBVUkwgcG9pbnRpbmcgdG8gc3VjaCBkYXRhIC0gKlJFUVVJUkVEKlxuICAgICAgICAgICAgZW5hYmxlQXV0b1RpdGxlOiB0cnVlLCAgICAgIC8vIFNob3dzIHRoZSB0aXRsZSB3aXRoaW4gYSBkaXYgb2YgaWQgZGl2YS10aXRsZVxuICAgICAgICAgICAgZW5hYmxlRmlsZW5hbWU6IHRydWUsICAgICAgIC8vIFVzZXMgZmlsZW5hbWVzIGFuZCBub3QgcGFnZSBudW1iZXJzIGZvciBsaW5rcyAoaT1ibV8wMDEudGlmLCBub3QgcD0xKVxuICAgICAgICAgICAgZW5hYmxlRnVsbHNjcmVlbjogdHJ1ZSwgICAgIC8vIEVuYWJsZSBvciBkaXNhYmxlIGZ1bGxzY3JlZW4gaWNvbiAobW9kZSBzdGlsbCBhdmFpbGFibGUpXG4gICAgICAgICAgICBlbmFibGVHb3RvUGFnZTogdHJ1ZSwgICAgICAgLy8gQSBcImdvIHRvIHBhZ2VcIiBqdW1wIGJveFxuICAgICAgICAgICAgZW5hYmxlR290b1N1Z2dlc3Rpb25zOiB0cnVlLCAvLyBDb250cm9scyB3aGV0aGVyIHN1Z2dlc3Rpb25zIGFyZSBzaG93biB1bmRlciB0aGUgaW5wdXQgZmllbGQgd2hlbiB0aGUgdXNlciBpcyB0eXBpbmcgaW4gdGhlICdnbyB0byBwYWdlJyBmb3JtXG4gICAgICAgICAgICBlbmFibGVHcmlkSWNvbjogdHJ1ZSwgICAgICAgLy8gQSBncmlkIHZpZXcgb2YgYWxsIHRoZSBwYWdlc1xuICAgICAgICAgICAgZW5hYmxlR3JpZENvbnRyb2xzOiAnYnV0dG9ucycsICAvLyBTcGVjaWZ5IGNvbnRyb2wgb2YgcGFnZXMgcGVyIGdyaWQgcm93IGluIEdyaWQgdmlldy4gUG9zc2libGUgdmFsdWVzOiAnYnV0dG9ucycgKCsvLSksICdzbGlkZXInLiBBbnkgb3RoZXIgdmFsdWUgZGlzYWJsZXMgdGhlIGNvbnRyb2xzLlxuICAgICAgICAgICAgZW5hYmxlSW1hZ2VUaXRsZXM6IHRydWUsICAgIC8vIEFkZHMgXCJQYWdlIHtufVwiIHRpdGxlIHRvIHBhZ2UgaW1hZ2VzIGlmIHRydWVcbiAgICAgICAgICAgIGVuYWJsZUluZGV4QXNMYWJlbDogZmFsc2UsXHQvLyBVc2UgaW5kZXggbnVtYmVycyBpbnN0ZWFkIG9mIHBhZ2UgbGFiZWxzIGluIHRoZSBwYWdlIG4tbSBkaXNwbGF5LlxuICAgICAgICAgICAgZW5hYmxlS2V5U2Nyb2xsOiB0cnVlLCAgICAgIC8vIENhcHR1cmVzIHNjcm9sbGluZyB1c2luZyB0aGUgYXJyb3cgYW5kIHBhZ2UgdXAvZG93biBrZXlzIHJlZ2FyZGxlc3Mgb2YgcGFnZSBmb2N1cy4gV2hlbiBvZmYsIGRlZmVycyB0byBkZWZhdWx0IGJyb3dzZXIgc2Nyb2xsaW5nIGJlaGF2aW9yLlxuICAgICAgICAgICAgZW5hYmxlTGlua0ljb246IHRydWUsICAgICAgIC8vIENvbnRyb2xzIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBsaW5rIGljb25cbiAgICAgICAgICAgIGVuYWJsZU5vblBhZ2VkVmlzaWJpbGl0eUljb246IHRydWUsIC8vIENvbnRyb2xzIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBpY29uIHRvIHRvZ2dsZSB0aGUgdmlzaWJpbGl0eSBvZiBub24tcGFnZWQgcGFnZXMuIChBdXRvbWF0aWNhbGx5IGhpZGRlbiBpZiBubyAnbm9uLXBhZ2VkJyBwYWdlcykuXG4gICAgICAgICAgICBlbmFibGVTcGFjZVNjcm9sbDogZmFsc2UsICAgLy8gU2Nyb2xsaW5nIGRvd24gYnkgcHJlc3NpbmcgdGhlIHNwYWNlIGtleVxuICAgICAgICAgICAgZW5hYmxlVG9vbGJhcjogdHJ1ZSwgICAgICAgIC8vIEVuYWJsZXMgdGhlIHRvb2xiYXIuIE5vdGUgdGhhdCBkaXNhYmxpbmcgdGhpcyBtZWFucyB5b3UgaGF2ZSB0byBoYW5kbGUgYWxsIGNvbnRyb2xzIHlvdXJzZWxmLlxuICAgICAgICAgICAgZW5hYmxlWm9vbUNvbnRyb2xzOiAnYnV0dG9ucycsIC8vIFNwZWNpZnkgY29udHJvbHMgZm9yIHpvb21pbmcgaW4gYW5kIG91dC4gUG9zc2libGUgdmFsdWVzOiAnYnV0dG9ucycgKCsvLSksICdzbGlkZXInLiBBbnkgb3RoZXIgdmFsdWUgZGlzYWJsZXMgdGhlIGNvbnRyb2xzLlxuICAgICAgICAgICAgZmlsbFBhcmVudEhlaWdodDogdHJ1ZSwgICAgIC8vIFVzZSBhIGZsZXhib3ggbGF5b3V0IHRvIGFsbG93IERpdmEgdG8gZmlsbCBpdHMgcGFyZW50J3MgaGVpZ2h0XG4gICAgICAgICAgICBmaXhlZFBhZGRpbmc6IDEwLCAgICAgICAgICAgLy8gRmFsbGJhY2sgaWYgYWRhcHRpdmUgcGFkZGluZyBpcyBzZXQgdG8gMFxuICAgICAgICAgICAgZml4ZWRIZWlnaHRHcmlkOiB0cnVlLCAgICAgIC8vIFNvIGVhY2ggcGFnZSBpbiBncmlkIHZpZXcgaGFzIHRoZSBzYW1lIGhlaWdodCAob25seSB3aWR0aHMgZGlmZmVyKVxuICAgICAgICAgICAgZ29EaXJlY3RseVRvOiAwLCAgICAgICAgICAgIC8vIERlZmF1bHQgaW5pdGlhbCBwYWdlIHRvIHNob3cgKDAtaW5kZXhlZClcbiAgICAgICAgICAgIGhhc2hQYXJhbVN1ZmZpeDogbnVsbCwgICAgICAvLyBVc2VkIHdoZW4gdGhlcmUgYXJlIG11bHRpcGxlIGRvY3VtZW50IHZpZXdlcnMgb24gYSBwYWdlXG4gICAgICAgICAgICBpbkZ1bGxzY3JlZW46IGZhbHNlLCAgICAgICAgLy8gU2V0IHRvIHRydWUgdG8gbG9hZCBmdWxsc2NyZWVuIG1vZGUgaW5pdGlhbGx5XG4gICAgICAgICAgICBpbkJvb2tMYXlvdXQ6IGZhbHNlLCAgICAgICAvLyBTZXQgdG8gdHJ1ZSB0byB2aWV3IHRoZSBkb2N1bWVudCB3aXRoIGZhY2luZyBwYWdlcyBpbiBkb2N1bWVudCBtb2RlXG4gICAgICAgICAgICBpbkdyaWQ6IGZhbHNlLCAgICAgICAgICAgICAgLy8gU2V0IHRvIHRydWUgdG8gbG9hZCBncmlkIHZpZXcgaW5pdGlhbGx5XG4gICAgICAgICAgICBtYXhQYWdlc1BlclJvdzogOCwgICAgICAgICAgLy8gTWF4aW11bSBudW1iZXIgb2YgcGFnZXMgcGVyIHJvdyBpbiBncmlkIHZpZXdcbiAgICAgICAgICAgIG1heFpvb21MZXZlbDogLTEsICAgICAgICAgICAvLyBPcHRpb25hbDsgZGVmYXVsdHMgdG8gdGhlIG1heCB6b29tIHJldHVybmVkIGluIHRoZSBKU09OIHJlc3BvbnNlXG4gICAgICAgICAgICBtaW5QYWdlc1BlclJvdzogMiwgICAgICAgICAgLy8gTWluaW11bSBwYWdlcyBwZXIgcm93IGluIGdyaWQgdmlldy4gUmVjb21tZW5kZWQgZGVmYXVsdC5cbiAgICAgICAgICAgIG1pblpvb21MZXZlbDogMCwgICAgICAgICAgICAvLyBEZWZhdWx0cyB0byAwICh0aGUgbWluaW11bSB6b29tKVxuICAgICAgICAgICAgb25Hb3RvU3VibWl0OiBudWxsLCAgICAgICAgIC8vIFdoZW4gc2V0IHRvIGEgZnVuY3Rpb24gdGhhdCB0YWtlcyBhIHN0cmluZyBhbmQgcmV0dXJucyBhIHBhZ2UgaW5kZXgsIHRoaXMgd2lsbCBvdmVycmlkZSB0aGUgZGVmYXVsdCBiZWhhdmlvdXIgb2YgdGhlICdnbyB0byBwYWdlJyBmb3JtIHN1Ym1pc3Npb25cbiAgICAgICAgICAgIHBhZ2VBbGlhc2VzOiB7fSwgICAgICAgICAgICAvLyBBbiBvYmplY3QgbWFwcGluZyBzcGVjaWZpYyBwYWdlIGluZGljZXMgdG8gYWxpYXNlcyAoaGFzIHByaW9yaXR5IG92ZXIgJ3BhZ2VBbGlhc0Z1bmN0aW9uJ1xuICAgICAgICAgICAgcGFnZUFsaWFzRnVuY3Rpb246IGZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO30sICAvLyBBIGZ1bmN0aW9uIG1hcHBpbmcgcGFnZSBpbmRpY2VzIHRvIGFuIGFsaWFzLiBJZiBmYWxzZSBpcyByZXR1cm5lZCwgZGVmYXVsdCBwYWdlIG51bWJlciBpcyBkaXNwbGF5ZWRcbiAgICAgICAgICAgIHBhZ2VMb2FkVGltZW91dDogMjAwLCAgICAgICAvLyBOdW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgYmVmb3JlIGxvYWRpbmcgcGFnZXNcbiAgICAgICAgICAgIHBhZ2VzUGVyUm93OiA1LCAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBudW1iZXIgb2YgcGFnZXMgcGVyIHJvdyBpbiBncmlkIHZpZXdcbiAgICAgICAgICAgIHNob3dOb25QYWdlZFBhZ2VzOiBmYWxzZSwgICAvLyBXaGV0aGVyIHBhZ2VzIHRhZ2dlZCBhcyAnbm9uLXBhZ2VkJyAoaW4gSUlJRiBtYW5pZmVzdHMgb25seSkgc2hvdWxkIGJlIHZpc2libGUgYWZ0ZXIgaW5pdGlhbCBsb2FkXG4gICAgICAgICAgICB0aHJvYmJlclRpbWVvdXQ6IDEwMCwgICAgICAgLy8gTnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IGJlZm9yZSBzaG93aW5nIHRocm9iYmVyXG4gICAgICAgICAgICB0aWxlSGVpZ2h0OiAyNTYsICAgICAgICAgICAgLy8gVGhlIGhlaWdodCBvZiBlYWNoIHRpbGUsIGluIHBpeGVsczsgdXN1YWxseSAyNTZcbiAgICAgICAgICAgIHRpbGVXaWR0aDogMjU2LCAgICAgICAgICAgICAvLyBUaGUgd2lkdGggb2YgZWFjaCB0aWxlLCBpbiBwaXhlbHM7IHVzdWFsbHkgMjU2XG4gICAgICAgICAgICB0b29sYmFyUGFyZW50T2JqZWN0OiBudWxsLCAgLy8gVGhlIHRvb2xiYXIgcGFyZW50IG9iamVjdC5cbiAgICAgICAgICAgIHZlcnRpY2FsbHlPcmllbnRlZDogdHJ1ZSwgICAvLyBEZXRlcm1pbmVzIHZlcnRpY2FsIHZzLiBob3Jpem9udGFsIG9yaWVudGF0aW9uXG4gICAgICAgICAgICB2aWV3cG9ydE1hcmdpbjogMjAwLCAgICAgICAgLy8gUHJldGVuZCB0aWxlcyArLy0gMjAwcHggYXdheSBmcm9tIHZpZXdwb3J0IGFyZSBpblxuICAgICAgICAgICAgem9vbUxldmVsOiAyICAgICAgICAgICAgICAgIC8vIFRoZSBpbml0aWFsIHpvb20gbGV2ZWwgKHVzZWQgdG8gc3RvcmUgdGhlIGN1cnJlbnQgem9vbSBsZXZlbClcbiAgICAgICAgfSwgb3B0aW9ucyk7XG5cbiAgICAgICAgLy8gSW4gb3JkZXIgdG8gZmlsbCB0aGUgaGVpZ2h0LCB1c2UgYSB3cmFwcGVyIGRpdiBkaXNwbGF5ZWQgdXNpbmcgYSBmbGV4Ym94IGxheW91dFxuICAgICAgICBjb25zdCB3cmFwcGVyRWxlbWVudCA9IGVsdCgnZGl2Jywge1xuICAgICAgICAgICAgY2xhc3M6IGBkaXZhLXdyYXBwZXIke3RoaXMub3B0aW9ucy5maWxsUGFyZW50SGVpZ2h0ID8gXCIgZGl2YS13cmFwcGVyLWZsZXhib3hcIiA6IFwiXCJ9YFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQod3JhcHBlckVsZW1lbnQpO1xuXG4gICAgICAgIHRoaXMub3B0aW9ucy50b29sYmFyUGFyZW50T2JqZWN0ID0gdGhpcy5vcHRpb25zLnRvb2xiYXJQYXJlbnRPYmplY3QgfHwgd3JhcHBlckVsZW1lbnQ7XG5cbiAgICAgICAgY29uc3Qgdmlld2VyQ29yZSA9IG5ldyBWaWV3ZXJDb3JlKHdyYXBwZXJFbGVtZW50LCB0aGlzLm9wdGlvbnMsIHRoaXMpO1xuXG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUgPSB2aWV3ZXJDb3JlLmdldEludGVybmFsU3RhdGUoKTtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHZpZXdlckNvcmUuZ2V0U2V0dGluZ3MoKTtcbiAgICAgICAgdGhpcy50b29sYmFyID0gbmV3IFRvb2xiYXIodGhpcyk7XG5cbiAgICAgICAgd3JhcHBlckVsZW1lbnQuaWQgPSB0aGlzLnNldHRpbmdzLklEICsgJ3dyYXBwZXInO1xuXG4gICAgICAgIHRoaXMuZGl2YVN0YXRlID0ge1xuICAgICAgICAgICAgdmlld2VyQ29yZTogdmlld2VyQ29yZSxcbiAgICAgICAgICAgIHRvb2xiYXI6IHRoaXMuc2V0dGluZ3MuZW5hYmxlVG9vbGJhciA/IHRoaXMudG9vbGJhciA6IG51bGxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBvbmx5IHJlbmRlciB0aGUgdG9vbGJhciBhZnRlciB0aGUgb2JqZWN0IGhhcyBiZWVuIGxvYWRlZFxuICAgICAgICBsZXQgaGFuZGxlID0gZGl2YS5FdmVudHMuc3Vic2NyaWJlKCdPYmplY3REaWRMb2FkJywgKCkgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy50b29sYmFyLnJlbmRlcigpO1xuICAgICAgICAgICAgZGl2YS5FdmVudHMudW5zdWJzY3JpYmUoaGFuZGxlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaGFzaFN0YXRlID0gdGhpcy5fZ2V0SGFzaFBhcmFtU3RhdGUoKTtcblxuICAgICAgICB0aGlzLl9sb2FkT3JGZXRjaE9iamVjdERhdGEoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqKi9cbiAgICBfbG9hZE9yRmV0Y2hPYmplY3REYXRhICgpXG4gICAge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuc2V0dGluZ3Mub2JqZWN0RGF0YSA9PT0gJ29iamVjdCcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIERlZmVyIGV4ZWN1dGlvbiB1bnRpbCBpbml0aWFsaXphdGlvbiBoYXMgY29tcGxldGVkXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZE9iamVjdERhdGEodGhpcy5zZXR0aW5ncy5vYmplY3REYXRhLCB0aGlzLmhhc2hTdGF0ZSk7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHBlbmRpbmdNYW5pZmVzdFJlcXVlc3QgPSBmZXRjaCh0aGlzLnNldHRpbmdzLm9iamVjdERhdGEsIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgIFwiQWNjZXB0XCI6IHRoaXMuc2V0dGluZ3MuYWNjZXB0SGVhZGVyXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkudGhlbiggKHJlc3BvbnNlKSA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hamF4RXJyb3IocmVzcG9uc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIGxldCBlcnJvciA9IG5ldyBFcnJvcihyZXNwb25zZS5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IucmVzcG9uc2UgPSByZXNwb25zZTtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgICAgICAgIH0pLnRoZW4oIChkYXRhKSA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRPYmplY3REYXRhKGRhdGEsIHRoaXMuaGFzaFN0YXRlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBTdG9yZSB0aGUgcGVuZGluZyByZXF1ZXN0IHNvIHRoYXQgaXQgY2FuIGJlIGNhbmNlbGxlZCBpbiB0aGUgZXZlbnQgdGhhdCBEaXZhIG5lZWRzIHRvIGJlIGRlc3Ryb3llZFxuICAgICAgICAgICAgdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5zZXRQZW5kaW5nTWFuaWZlc3RSZXF1ZXN0KHBlbmRpbmdNYW5pZmVzdFJlcXVlc3QpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiovXG4gICAgX3Nob3dFcnJvciAobWVzc2FnZSlcbiAgICB7XG4gICAgICAgIHRoaXMuZGl2YVN0YXRlLnZpZXdlckNvcmUuc2hvd0Vycm9yKG1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogKi9cbiAgICBfYWpheEVycm9yIChyZXNwb25zZSlcbiAgICB7XG4gICAgICAgIC8vIFNob3cgYSBiYXNpYyBlcnJvciBtZXNzYWdlIHdpdGhpbiB0aGUgZG9jdW1lbnQgdmlld2VyIHBhbmVcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gWydJbnZhbGlkIG9iamVjdERhdGEgc2V0dGluZy4gRXJyb3IgY29kZTogJyArIHJlc3BvbnNlLnN0YXR1cyArICcgJyArIHJlc3BvbnNlLnN0YXR1c1RleHRdO1xuXG4gICAgICAgIC8vIERldGVjdCBhbmQgaGFuZGxlIENPUlMgZXJyb3JzXG4gICAgICAgIGNvbnN0IGRhdGFIYXNBYnNvbHV0ZVBhdGggPSB0aGlzLnNldHRpbmdzLm9iamVjdERhdGEubGFzdEluZGV4T2YoJ2h0dHAnLCAwKSA9PT0gMDtcblxuICAgICAgICBpZiAoZGF0YUhhc0Fic29sdXRlUGF0aClcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QganNvbkhvc3QgPSB0aGlzLnNldHRpbmdzLm9iamVjdERhdGEucmVwbGFjZSgvaHR0cHM/OlxcL1xcLy9pLCBcIlwiKS5zcGxpdCgvWy8/I10vKVswXTtcblxuICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSAhPT0ganNvbkhvc3QpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlLnB1c2goXG4gICAgICAgICAgICAgICAgICAgIGVsdCgncCcsICdBdHRlbXB0ZWQgdG8gYWNjZXNzIGNyb3NzLW9yaWdpbiBkYXRhIHdpdGhvdXQgQ09SUy4nKSxcbiAgICAgICAgICAgICAgICAgICAgZWx0KCdwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdZb3UgbWF5IG5lZWQgdG8gdXBkYXRlIHlvdXIgc2VydmVyIGNvbmZpZ3VyYXRpb24gdG8gc3VwcG9ydCBDT1JTLiBGb3IgaGVscCwgc2VlIHRoZSAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWx0KCdhJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWY6ICdodHRwczovL2dpdGh1Yi5jb20vRERNQUwvZGl2YS5qcy93aWtpL0luc3RhbGxhdGlvbiNhLW5vdGUtYWJvdXQtY3Jvc3Mtc2l0ZS1yZXF1ZXN0cycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiAnX2JsYW5rJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgJ2Nyb3NzLXNpdGUgcmVxdWVzdCBkb2N1bWVudGF0aW9uLicpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fc2hvd0Vycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiovXG4gICAgX2xvYWRPYmplY3REYXRhIChyZXNwb25zZURhdGEsIGhhc2hTdGF0ZSlcbiAgICB7XG4gICAgICAgIGxldCBtYW5pZmVzdDtcblxuICAgICAgICAvLyBUT0RPIGltcHJvdmUgSUlJRiBkZXRlY3Rpb24gbWV0aG9kXG4gICAgICAgIGlmICghcmVzcG9uc2VEYXRhLmhhc093blByb3BlcnR5KCdAY29udGV4dCcpICYmIChyZXNwb25zZURhdGFbJ0Bjb250ZXh0J10uaW5kZXhPZignaWlpZicpID09PSAtMSB8fCByZXNwb25zZURhdGFbJ0Bjb250ZXh0J10uaW5kZXhPZignc2hhcmVkLWNhbnZhcycpID09PSAtMSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBOb3RBbklJSUZNYW5pZmVzdEV4Y2VwdGlvbignVGhpcyBkb2VzIG5vdCBhcHBlYXIgdG8gYmUgYSBJSUlGIE1hbmlmZXN0LicpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gdHJpZ2dlciBNYW5pZmVzdERpZExvYWQgZXZlbnRcbiAgICAgICAgZGl2YS5FdmVudHMucHVibGlzaCgnTWFuaWZlc3REaWRMb2FkJywgW3Jlc3BvbnNlRGF0YV0sIHRoaXMpO1xuICAgICAgICBtYW5pZmVzdCA9IEltYWdlTWFuaWZlc3QuZnJvbUlJSUYocmVzcG9uc2VEYXRhKTtcbiAgICAgICAgY29uc3QgbG9hZE9wdGlvbnMgPSBoYXNoU3RhdGUgPyB0aGlzLl9nZXRMb2FkT3B0aW9uc0ZvclN0YXRlKGhhc2hTdGF0ZSwgbWFuaWZlc3QpIDoge307XG5cbiAgICAgICAgdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5zZXRNYW5pZmVzdChtYW5pZmVzdCwgbG9hZE9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIHRoZSBoYXNoIHBhcmFtZXRlcnMgaW50byB0aGUgZm9ybWF0IHVzZWQgYnkgZ2V0U3RhdGUgYW5kIHNldFN0YXRlXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqKi9cbiAgICBfZ2V0SGFzaFBhcmFtU3RhdGUgKClcbiAgICB7XG4gICAgICAgIGNvbnN0IHN0YXRlID0ge307XG5cbiAgICAgICAgWydmJywgJ3YnLCAneicsICduJywgJ2knLCAncCcsICd5JywgJ3gnXS5mb3JFYWNoKCAocGFyYW0pID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gSGFzaFBhcmFtcy5nZXQocGFyYW0gKyB0aGlzLnNldHRpbmdzLmhhc2hQYXJhbVN1ZmZpeCk7XG5cbiAgICAgICAgICAgIC8vIGBmYWxzZWAgaXMgcmV0dXJuZWQgaWYgdGhlIHZhbHVlIGlzIG1pc3NpbmdcbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgc3RhdGVbcGFyYW1dID0gdmFsdWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIERvIHNvbWUgYXdrd2FyZCBzcGVjaWFsLWNhc2luZywgc2luY2UgdGhpcyBmb3JtYXQgaXMga2luZCBvZiB3ZWlyZC5cblxuICAgICAgICAvLyBGb3IgaW5GdWxsc2NyZWVuIChmKSwgdHJ1ZSBhbmQgZmFsc2Ugc3RyaW5ncyBzaG91bGQgYmUgaW50ZXJwcmV0ZWRcbiAgICAgICAgLy8gYXMgYm9vbGVhbnMuXG4gICAgICAgIGlmIChzdGF0ZS5mID09PSAndHJ1ZScpXG4gICAgICAgICAgICBzdGF0ZS5mID0gdHJ1ZTtcbiAgICAgICAgZWxzZSBpZiAoc3RhdGUuZiA9PT0gJ2ZhbHNlJylcbiAgICAgICAgICAgIHN0YXRlLmYgPSBmYWxzZTtcblxuICAgICAgICAvLyBDb252ZXJ0IG51bWVyaWNhbCB2YWx1ZXMgdG8gaW50ZWdlcnMsIGlmIHByb3ZpZGVkXG4gICAgICAgIFsneicsICduJywgJ3AnLCAneCcsICd5J10uZm9yRWFjaCggKHBhcmFtKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAocGFyYW0gaW4gc3RhdGUpXG4gICAgICAgICAgICAgICAgc3RhdGVbcGFyYW1dID0gcGFyc2VJbnQoc3RhdGVbcGFyYW1dLCAxMCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBzdGF0ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqKi9cbiAgICBfZ2V0TG9hZE9wdGlvbnNGb3JTdGF0ZSAoc3RhdGUsIG1hbmlmZXN0KVxuICAgIHtcbiAgICAgICAgbWFuaWZlc3QgPSBtYW5pZmVzdCB8fCB0aGlzLnNldHRpbmdzLm1hbmlmZXN0O1xuXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSAoJ3YnIGluIHN0YXRlKSA/IHRoaXMuX2dldFZpZXdTdGF0ZShzdGF0ZS52KSA6IHt9O1xuXG4gICAgICAgIGlmICgnZicgaW4gc3RhdGUpXG4gICAgICAgICAgICBvcHRpb25zLmluRnVsbHNjcmVlbiA9IHN0YXRlLmY7XG5cbiAgICAgICAgaWYgKCd6JyBpbiBzdGF0ZSlcbiAgICAgICAgICAgIG9wdGlvbnMuem9vbUxldmVsID0gc3RhdGUuejtcblxuICAgICAgICBpZiAoJ24nIGluIHN0YXRlKVxuICAgICAgICAgICAgb3B0aW9ucy5wYWdlc1BlclJvdyA9IHN0YXRlLm47XG5cbiAgICAgICAgLy8gT25seSBjaGFuZ2Ugc3BlY2lmeSB0aGUgcGFnZSBpZiBzdGF0ZS5pIG9yIHN0YXRlLnAgaXMgdmFsaWRcbiAgICAgICAgbGV0IHBhZ2VJbmRleCA9IHRoaXMuX2dldFBhZ2VJbmRleEZvck1hbmlmZXN0KG1hbmlmZXN0LCBzdGF0ZS5pKTtcblxuICAgICAgICBpZiAoIShwYWdlSW5kZXggPj0gMCAmJiBwYWdlSW5kZXggPCBtYW5pZmVzdC5wYWdlcy5sZW5ndGgpKVxuICAgICAgICB7XG4gICAgICAgICAgICBwYWdlSW5kZXggPSBzdGF0ZS5wIC0gMTtcblxuICAgICAgICAgICAgLy8gUG9zc2libHkgTmFOXG4gICAgICAgICAgICBpZiAoIShwYWdlSW5kZXggPj0gMCAmJiBwYWdlSW5kZXggPCBtYW5pZmVzdC5wYWdlcy5sZW5ndGgpKVxuICAgICAgICAgICAgICAgIHBhZ2VJbmRleCA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFnZUluZGV4ICE9PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBob3Jpem9udGFsT2Zmc2V0ID0gcGFyc2VJbnQoc3RhdGUueCwgMTApO1xuICAgICAgICAgICAgY29uc3QgdmVydGljYWxPZmZzZXQgPSBwYXJzZUludChzdGF0ZS55LCAxMCk7XG5cbiAgICAgICAgICAgIG9wdGlvbnMuZ29EaXJlY3RseVRvID0gcGFnZUluZGV4O1xuICAgICAgICAgICAgb3B0aW9ucy5ob3Jpem9udGFsT2Zmc2V0ID0gaG9yaXpvbnRhbE9mZnNldDtcbiAgICAgICAgICAgIG9wdGlvbnMudmVydGljYWxPZmZzZXQgPSB2ZXJ0aWNhbE9mZnNldDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvcHRpb25zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogKi9cbiAgICBfZ2V0Vmlld1N0YXRlICh2aWV3KVxuICAgIHtcbiAgICAgICAgc3dpdGNoICh2aWV3KVxuICAgICAgICB7XG4gICAgICAgICAgICBjYXNlICdkJzpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBpbkdyaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBpbkJvb2tMYXlvdXQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY2FzZSAnYic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgaW5HcmlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaW5Cb29rTGF5b3V0OiB0cnVlXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY2FzZSAnZyc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgaW5HcmlkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpbkJvb2tMYXlvdXQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqICovXG4gICAgX2dldFBhZ2VJbmRleEZvck1hbmlmZXN0IChtYW5pZmVzdCwgZmlsZW5hbWUpXG4gICAge1xuICAgICAgICBsZXQgaTtcbiAgICAgICAgY29uc3QgbnAgPSBtYW5pZmVzdC5wYWdlcy5sZW5ndGg7XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG5wOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChtYW5pZmVzdC5wYWdlc1tpXS5mID09PSBmaWxlbmFtZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqICovXG4gICAgX2dldFN0YXRlICgpXG4gICAge1xuICAgICAgICBsZXQgdmlldztcblxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5pbkdyaWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZpZXcgPSAnZyc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5zZXR0aW5ncy5pbkJvb2tMYXlvdXQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZpZXcgPSAnYic7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB2aWV3ID0gJ2QnO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5nZXRDdXJyZW50TGF5b3V0KCk7XG4gICAgICAgIGNvbnN0IHBhZ2VPZmZzZXQgPSBsYXlvdXQuZ2V0UGFnZVRvVmlld3BvcnRDZW50ZXJPZmZzZXQodGhpcy5zZXR0aW5ncy5hY3RpdmVQYWdlSW5kZXgsIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAnZic6IHRoaXMuc2V0dGluZ3MuaW5GdWxsc2NyZWVuLFxuICAgICAgICAgICAgJ3YnOiB2aWV3LFxuICAgICAgICAgICAgJ3onOiB0aGlzLnNldHRpbmdzLnpvb21MZXZlbCxcbiAgICAgICAgICAgICduJzogdGhpcy5zZXR0aW5ncy5wYWdlc1BlclJvdyxcbiAgICAgICAgICAgICdpJzogdGhpcy5zZXR0aW5ncy5lbmFibGVGaWxlbmFtZSA/IHRoaXMuc2V0dGluZ3MubWFuaWZlc3QucGFnZXNbdGhpcy5zZXR0aW5ncy5hY3RpdmVQYWdlSW5kZXhdLmYgOiBmYWxzZSxcbiAgICAgICAgICAgICdwJzogdGhpcy5zZXR0aW5ncy5lbmFibGVGaWxlbmFtZSA/IGZhbHNlIDogdGhpcy5zZXR0aW5ncy5hY3RpdmVQYWdlSW5kZXggKyAxLFxuICAgICAgICAgICAgJ3knOiBwYWdlT2Zmc2V0ID8gcGFnZU9mZnNldC55IDogZmFsc2UsXG4gICAgICAgICAgICAneCc6IHBhZ2VPZmZzZXQgPyBwYWdlT2Zmc2V0LnggOiBmYWxzZVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICoqL1xuICAgIF9nZXRVUkxIYXNoICgpXG4gICAge1xuICAgICAgICBjb25zdCBoYXNoUGFyYW1zID0gdGhpcy5fZ2V0U3RhdGUoKTtcbiAgICAgICAgY29uc3QgaGFzaFN0cmluZ0J1aWxkZXIgPSBbXTtcbiAgICAgICAgbGV0IHBhcmFtO1xuXG4gICAgICAgIGZvciAocGFyYW0gaW4gaGFzaFBhcmFtcylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGhhc2hQYXJhbXNbcGFyYW1dICE9PSBmYWxzZSlcbiAgICAgICAgICAgICAgICBoYXNoU3RyaW5nQnVpbGRlci5wdXNoKHBhcmFtICsgdGhpcy5zZXR0aW5ncy5oYXNoUGFyYW1TdWZmaXggKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoaGFzaFBhcmFtc1twYXJhbV0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBoYXNoU3RyaW5nQnVpbGRlci5qb2luKCcmJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcGFnZSBpbmRleCBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIGZpbGVuYW1lOyBtdXN0IGNhbGxlZCBhZnRlciBzZXR0aW5nIHNldHRpbmdzLm1hbmlmZXN0XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqKi9cbiAgICBfZ2V0UGFnZUluZGV4IChmaWxlbmFtZSlcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRQYWdlSW5kZXhGb3JNYW5pZmVzdCh0aGlzLnNldHRpbmdzLm1hbmlmZXN0LCBmaWxlbmFtZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiAqL1xuICAgIF9jaGVja0xvYWRlZCAoKVxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLnZpZXdlclN0YXRlLmxvYWRlZClcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiVGhlIHZpZXdlciBpcyBub3QgY29tcGxldGVseSBpbml0aWFsaXplZC4gVGhpcyBpcyBsaWtlbHkgYmVjYXVzZSBpdCBpcyBzdGlsbCBkb3dubG9hZGluZyBkYXRhLiBUbyBmaXggdGhpcywgb25seSBjYWxsIHRoaXMgZnVuY3Rpb24gaWYgdGhlIGlzUmVhZHkoKSBtZXRob2QgcmV0dXJucyB0cnVlLlwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgZnVsbHNjcmVlbiBpY29uIGlzIGNsaWNrZWRcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICoqL1xuICAgIF90b2dnbGVGdWxsc2NyZWVuICgpXG4gICAge1xuICAgICAgICB0aGlzLl9yZWxvYWRWaWV3ZXIoe1xuICAgICAgICAgICAgaW5GdWxsc2NyZWVuOiAhdGhpcy5zZXR0aW5ncy5pbkZ1bGxzY3JlZW5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gaGFuZGxlIHRvb2xiYXIgb3BhY2l0eSBpbiBmdWxsc2NyZWVuXG4gICAgICAgIGxldCB0O1xuICAgICAgICBsZXQgaG92ZXIgPSBmYWxzZTtcbiAgICAgICAgbGV0IHRvb2xzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5zZXR0aW5ncy5zZWxlY3RvciArICd0b29scycpO1xuICAgICAgICBjb25zdCBUSU1FT1VUID0gMjAwMDtcblxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5pbkZ1bGxzY3JlZW4pIFxuICAgICAgICB7XG4gICAgICAgICAgICB0b29scy5jbGFzc0xpc3QuYWRkKFwiZGl2YS1mdWxsc2NyZWVuLXRvb2xzXCIpO1xuXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0b2dnbGVPcGFjaXR5LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZGl2YS12aWV3cG9ydCcpWzBdLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRvZ2dsZU9wYWNpdHkuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB0b29scy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGhvdmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdG9vbHMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBob3ZlciA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0b29scy5jbGFzc0xpc3QucmVtb3ZlKFwiZGl2YS1mdWxsc2NyZWVuLXRvb2xzXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdG9nZ2xlT3BhY2l0eSAoKSBcbiAgICAgICAge1xuICAgICAgICAgICAgdG9vbHMuc3R5bGUub3BhY2l0eSA9IDE7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodCk7XG4gICAgICAgICAgICBpZiAoIWhvdmVyICYmIHRoaXMuc2V0dGluZ3MuaW5GdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgdCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0b29scy5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICAgICAgICAgICAgICB9LCBUSU1FT1VUKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRvZ2dsZXMgYmV0d2VlbiBvcmllbnRhdGlvbnNcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogKi9cbiAgICBfdG9nZ2xlUGFnZUxheW91dE9yaWVudGF0aW9uICgpXG4gICAge1xuICAgICAgICBjb25zdCB2ZXJ0aWNhbGx5T3JpZW50ZWQgPSAhdGhpcy5zZXR0aW5ncy52ZXJ0aWNhbGx5T3JpZW50ZWQ7XG5cbiAgICAgICAgLy9pZiBpbiBncmlkLCBzd2l0Y2ggb3V0IG9mIGdyaWRcbiAgICAgICAgdGhpcy5fcmVsb2FkVmlld2VyKHtcbiAgICAgICAgICAgIGluR3JpZDogZmFsc2UsXG4gICAgICAgICAgICB2ZXJ0aWNhbGx5T3JpZW50ZWQ6IHZlcnRpY2FsbHlPcmllbnRlZCxcbiAgICAgICAgICAgIGdvRGlyZWN0bHlUbzogdGhpcy5zZXR0aW5ncy5hY3RpdmVQYWdlSW5kZXgsXG4gICAgICAgICAgICB2ZXJ0aWNhbE9mZnNldDogdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5nZXRZT2Zmc2V0KCksXG4gICAgICAgICAgICBob3Jpem9udGFsT2Zmc2V0OiB0aGlzLmRpdmFTdGF0ZS52aWV3ZXJDb3JlLmdldFhPZmZzZXQoKVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gdmVydGljYWxseU9yaWVudGVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBjaGFuZ2UgdmlldyBpY29uIGlzIGNsaWNrZWRcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICoqL1xuICAgIF9jaGFuZ2VWaWV3IChkZXN0aW5hdGlvblZpZXcpXG4gICAge1xuICAgICAgICBzd2l0Y2ggKGRlc3RpbmF0aW9uVmlldylcbiAgICAgICAge1xuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWxvYWRWaWV3ZXIoe1xuICAgICAgICAgICAgICAgICAgICBpbkdyaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBpbkJvb2tMYXlvdXQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2Jvb2snOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWxvYWRWaWV3ZXIoe1xuICAgICAgICAgICAgICAgICAgICBpbkdyaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBpbkJvb2tMYXlvdXQ6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FzZSAnZ3JpZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbG9hZFZpZXdlcih7XG4gICAgICAgICAgICAgICAgICAgIGluR3JpZDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcGFnZUluZGV4IC0gMC1iYXNlZCBwYWdlIGluZGV4LlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4QW5jaG9yIC0geCBjb29yZGluYXRlIHRvIGp1bXAgdG8gb24gcmVzdWx0aW5nIHBhZ2UuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHlBbmNob3IgLSB5IGNvb3JkaW5hdGUgdG8ganVtcCB0byBvbiByZXN1bHRpbmcgcGFnZS5cbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gLSBXaGV0aGVyIHRoZSBqdW1wIHdhcyBzdWNjZXNzZnVsLlxuICAgICAqKi9cbiAgICBfZ290b1BhZ2VCeUluZGV4IChwYWdlSW5kZXgsIHhBbmNob3IsIHlBbmNob3IpXG4gICAge1xuICAgICAgICBsZXQgcGlkeCA9IHBhcnNlSW50KHBhZ2VJbmRleCwgMTApO1xuXG4gICAgICAgIGlmICh0aGlzLl9pc1BhZ2VJbmRleFZhbGlkKHBpZHgpKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB4T2Zmc2V0ID0gdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5nZXRYT2Zmc2V0KHBpZHgsIHhBbmNob3IpO1xuICAgICAgICAgICAgY29uc3QgeU9mZnNldCA9IHRoaXMuZGl2YVN0YXRlLnZpZXdlckNvcmUuZ2V0WU9mZnNldChwaWR4LCB5QW5jaG9yKTtcblxuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5yZW5kZXJlci5nb3RvKHBpZHgsIHlPZmZzZXQsIHhPZmZzZXQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgYSBwYWdlIGluZGV4IGlzIHZhbGlkXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBwYWdlSW5kZXggLSBOdW1lcmljICgwLWJhc2VkKSBwYWdlIGluZGV4XG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gd2hldGhlciB0aGUgcGFnZSBpbmRleCBpcyB2YWxpZCBvciBub3QuXG4gICAgICovXG4gICAgX2lzUGFnZUluZGV4VmFsaWQgKHBhZ2VJbmRleClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLm1hbmlmZXN0LmlzUGFnZVZhbGlkKHBhZ2VJbmRleCwgdGhpcy5zZXR0aW5ncy5zaG93Tm9uUGFnZWRQYWdlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2l2ZW4gYSBwYWdlWCBhbmQgcGFnZVkgdmFsdWUsIHJldHVybnMgZWl0aGVyIHRoZSBwYWdlIHZpc2libGUgYXQgdGhhdCAoeCx5KVxuICAgICAqIHBvc2l0aW9uIG9yIC0xIGlmIG5vIHBhZ2UgaXMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9nZXRQYWdlSW5kZXhGb3JQYWdlWFlWYWx1ZXMgKHBhZ2VYLCBwYWdlWSlcbiAgICB7XG4gICAgICAgIC8vZ2V0IHRoZSBmb3VyIGVkZ2VzIG9mIHRoZSBvdXRlciBlbGVtZW50XG4gICAgICAgIGNvbnN0IG91dGVyT2Zmc2V0ID0gdGhpcy52aWV3ZXJTdGF0ZS5vdXRlckVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGNvbnN0IG91dGVyVG9wID0gb3V0ZXJPZmZzZXQudG9wO1xuICAgICAgICBjb25zdCBvdXRlckxlZnQgPSBvdXRlck9mZnNldC5sZWZ0O1xuICAgICAgICBjb25zdCBvdXRlckJvdHRvbSA9IG91dGVyT2Zmc2V0LmJvdHRvbTtcbiAgICAgICAgY29uc3Qgb3V0ZXJSaWdodCA9IG91dGVyT2Zmc2V0LnJpZ2h0O1xuXG4gICAgICAgIC8vaWYgdGhlIGNsaWNrZWQgcG9zaXRpb24gd2FzIG91dHNpZGUgdGhlIGRpdmEtb3V0ZXIgb2JqZWN0LCBpdCB3YXMgbm90IG9uIGEgdmlzaWJsZSBwb3J0aW9uIG9mIGEgcGFnZVxuICAgICAgICBpZiAocGFnZVggPCBvdXRlckxlZnQgfHwgcGFnZVggPiBvdXRlclJpZ2h0KVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuXG4gICAgICAgIGlmIChwYWdlWSA8IG91dGVyVG9wIHx8IHBhZ2VZID4gb3V0ZXJCb3R0b20pXG4gICAgICAgICAgICByZXR1cm4gLTE7XG5cbiAgICAgICAgLy9uYXZpZ2F0ZSB0aHJvdWdoIGFsbCBkaXZhIHBhZ2Ugb2JqZWN0c1xuICAgICAgICBjb25zdCBwYWdlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2RpdmEtcGFnZScpO1xuICAgICAgICBsZXQgY3VyUGFnZUlkeCA9IHBhZ2VzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGN1clBhZ2VJZHgtLSlcbiAgICAgICAge1xuICAgICAgICAgICAgLy9nZXQgdGhlIG9mZnNldCBmb3IgZWFjaCBwYWdlXG4gICAgICAgICAgICBjb25zdCBjdXJQYWdlID0gcGFnZXNbY3VyUGFnZUlkeF07XG4gICAgICAgICAgICBjb25zdCBjdXJPZmZzZXQgPSBjdXJQYWdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgICAgICAvL2lmIHRoaXMgcG9pbnQgaXMgb3V0c2lkZSB0aGUgaG9yaXpvbnRhbCBib3VuZGFyaWVzIG9mIHRoZSBwYWdlLCBjb250aW51ZVxuICAgICAgICAgICAgaWYgKHBhZ2VYIDwgY3VyT2Zmc2V0LmxlZnQgfHwgcGFnZVggPiBjdXJPZmZzZXQucmlnaHQpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIC8vc2FtZSB3aXRoIHZlcnRpY2FsIGJvdW5kYXJpZXNcbiAgICAgICAgICAgIGlmIChwYWdlWSA8IGN1ck9mZnNldC50b3AgfHwgcGFnZVkgPiBjdXJPZmZzZXQuYm90dG9tKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAvL2lmIHdlIG1hZGUgaXQgdGhyb3VnaCB0aGUgYWJvdmUgdHdvLCB3ZSBmb3VuZCB0aGUgcGFnZSB3ZSdyZSBsb29raW5nIGZvclxuICAgICAgICAgICAgcmV0dXJuIGN1clBhZ2UuZ2V0QXR0cmlidXRlKCdkYXRhLWluZGV4Jyk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIHdlIG1hZGUgaXQgdGhyb3VnaCB0aGF0IGVudGlyZSB3aGlsZSBsb29wLCB3ZSBkaWRuJ3QgY2xpY2sgb24gYSBwYWdlXG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqKi9cbiAgICBfcmVsb2FkVmlld2VyIChuZXdPcHRpb25zKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGl2YVN0YXRlLnZpZXdlckNvcmUucmVsb2FkKG5ld09wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2dldEN1cnJlbnRVUkwgKClcbiAgICB7XG4gICAgICAgIHJldHVybiBsb2NhdGlvbi5wcm90b2NvbCArICcvLycgKyBsb2NhdGlvbi5ob3N0ICsgbG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5zZWFyY2ggKyAnIycgKyB0aGlzLl9nZXRVUkxIYXNoKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgKiAgICAgICAgICAgICAgICBQVUJMSUMgRlVOQ1RJT05TXG4gICAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgKiovXG5cbiAgICAvKipcbiAgICAgKiAgQWN0aXZhdGUgdGhpcyBpbnN0YW5jZSBvZiBkaXZhIHZpYSB0aGUgYWN0aXZlIERpdmEgY29udHJvbGxlci5cbiAgICAgKlxuICAgICAqICBAcHVibGljXG4gICAgICovXG4gICAgYWN0aXZhdGUgKClcbiAgICB7XG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUuaXNBY3RpdmVEaXZhID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGFuZ2UgdGhlIG9iamVjdCAob2JqZWN0RGF0YSkgcGFyYW1ldGVyIGN1cnJlbnRseSBiZWluZyByZW5kZXJlZCBieSBEaXZhLlxuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbXMge29iamVjdH0gb2JqZWN0RGF0YSAtIEFuIElJSUYgTWFuaWZlc3Qgb2JqZWN0IE9SIGEgVVJMIHRvIGEgSUlJRiBtYW5pZmVzdC5cbiAgICAgKi9cbiAgICBjaGFuZ2VPYmplY3QgKG9iamVjdERhdGEpXG4gICAge1xuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmxvYWRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRpdmFTdGF0ZS52aWV3ZXJDb3JlLmNsZWFyKCk7XG5cbiAgICAgICAgaWYgKHRoaXMudmlld2VyU3RhdGUucmVuZGVyZXIpXG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnJlbmRlcmVyLmRlc3Ryb3koKTtcblxuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLm9wdGlvbnMub2JqZWN0RGF0YSA9IG9iamVjdERhdGE7XG5cbiAgICAgICAgdGhpcy5fbG9hZE9yRmV0Y2hPYmplY3REYXRhKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hhbmdlIHZpZXdzLiBUYWtlcyAnZG9jdW1lbnQnLCAnYm9vaycsIG9yICdncmlkJyB0byBzcGVjaWZ5IHdoaWNoIHZpZXcgdG8gc3dpdGNoIGludG9cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW1zIHtzdHJpbmd9IGRlc3RpbmF0aW9uVmlldyAtIHRoZSBkZXN0aW5hdGlvbiB2aWV3IHRvIGNoYW5nZSB0by5cbiAgICAgKi9cbiAgICBjaGFuZ2VWaWV3IChkZXN0aW5hdGlvblZpZXcpXG4gICAge1xuICAgICAgICB0aGlzLl9jaGFuZ2VWaWV3KGRlc3RpbmF0aW9uVmlldyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogIERlYWN0aXZhdGUgdGhpcyBkaXZhIGluc3RhbmNlIHRocm91Z2ggdGhlIGFjdGl2ZSBEaXZhIGNvbnRyb2xsZXIuXG4gICAgICpcbiAgICAgKiAgQHB1YmxpY1xuICAgICAqKi9cbiAgICBkZWFjdGl2YXRlICgpXG4gICAge1xuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmlzQWN0aXZlRGl2YSA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoaXMgaW5zdGFuY2UsIHRlbGxzIHBsdWdpbnMgdG8gZG8gdGhlIHNhbWVcbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiovXG4gICAgZGVzdHJveSAoKVxuICAgIHtcbiAgICAgICAgdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5kZXN0cm95KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGlzYWJsZXMgZG9jdW1lbnQgZHJhZ2dpbmcsIHNjcm9sbGluZyAoYnkga2V5Ym9hcmQgaWYgc2V0KSwgYW5kIHpvb21pbmcgYnkgZG91YmxlLWNsaWNraW5nXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICoqL1xuICAgIGRpc2FibGVTY3JvbGxhYmxlICgpXG4gICAge1xuICAgICAgICB0aGlzLmRpdmFTdGF0ZS52aWV3ZXJDb3JlLmRpc2FibGVTY3JvbGxhYmxlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmUtZW5hYmxlcyBkb2N1bWVudCBkcmFnZ2luZywgc2Nyb2xsaW5nIChieSBrZXlib2FyZCBpZiBzZXQpLCBhbmQgem9vbWluZyBieSBkb3VibGUtY2xpY2tpbmdcbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiovXG4gICAgZW5hYmxlU2Nyb2xsYWJsZSAoKVxuICAgIHtcbiAgICAgICAgdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5lbmFibGVTY3JvbGxhYmxlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGlzYWJsZXMgZG9jdW1lbnQgZHJhZyBzY3JvbGxpbmdcbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBkaXNhYmxlRHJhZ1Njcm9sbGFibGUgKClcbiAgICB7XG4gICAgICAgIHRoaXMuZGl2YVN0YXRlLnZpZXdlckNvcmUuZGlzYWJsZURyYWdTY3JvbGxhYmxlKCk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEVuYWJsZXMgZG9jdW1lbnQgZHJhZyBzY3JvbGxpbmdcbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBlbmFibGVEcmFnU2Nyb2xsYWJsZSAoKVxuICAgIHtcbiAgICAgICAgdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5lbmFibGVEcmFnU2Nyb2xsYWJsZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVudGVyIGZ1bGxzY3JlZW4gbW9kZSBpZiBjdXJyZW50bHkgbm90IGluIGZ1bGxzY3JlZW4gbW9kZS4gSWYgY3VycmVudGx5IGluIGZ1bGxzY3JlZW5cbiAgICAgKiBtb2RlIHRoaXMgd2lsbCBoYXZlIG5vIGVmZmVjdC5cbiAgICAgKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gd2lsbCB3b3JrIGV2ZW4gaWYgZW5hYmxlRnVsbHNjcmVlbiBpcyBzZXQgdG8gZmFsc2UgaW4gdGhlIG9wdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gV2hldGhlciB0aGUgc3dpdGNoIHRvIGZ1bGxzY3JlZW4gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90LlxuICAgICAqKi9cbiAgICBlbnRlckZ1bGxzY3JlZW5Nb2RlICgpXG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuaW5GdWxsc2NyZWVuKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl90b2dnbGVGdWxsc2NyZWVuKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbnRlciBncmlkIHZpZXcgaWYgY3VycmVudGx5IG5vdCBpbiBncmlkIHZpZXcuIElmIGN1cnJlbnRseSBpbiBncmlkIHZpZXcgbW9kZVxuICAgICAqIHRoaXMgd2lsbCBoYXZlIG5vIGVmZmVjdC5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSBXaGV0aGVyIHRoZSBzd2l0Y2ggdG8gZ3JpZCB2aWV3IHdhcyBzdWNjZXNzZnVsIG9yIG5vdC5cbiAgICAgKiovXG4gICAgZW50ZXJHcmlkVmlldyAoKVxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmluR3JpZClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fY2hhbmdlVmlldygnZ3JpZCcpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBhcnJheSBvZiBhbGwgcGFnZSBpbWFnZSBVUklzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IC0gQW4gYXJyYXkgb2YgYWxsIHRoZSBVUklzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKiAqL1xuICAgIGdldEFsbFBhZ2VVUklzICgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5tYW5pZmVzdC5wYWdlcy5tYXAoIChwZykgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHBnLmY7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY2FudmFzIGlkZW50aWZpZXIgZm9yIHRoZSBjdXJyZW50bHkgdmlzaWJsZSBwYWdlLlxuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IC0gVGhlIFVSSSBvZiB0aGUgY3VycmVudGx5IHZpc2libGUgY2FudmFzLlxuICAgICAqKi9cbiAgICBnZXRDdXJyZW50Q2FudmFzICgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5tYW5pZmVzdC5wYWdlc1t0aGlzLnNldHRpbmdzLmFjdGl2ZVBhZ2VJbmRleF0uY2FudmFzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGRpbWVuc2lvbnMgb2YgdGhlIGN1cnJlbnQgcGFnZSBhdCB0aGUgY3VycmVudCB6b29tIGxldmVsLiBBbHNvIHdvcmtzIGluXG4gICAgICogZ3JpZCB2aWV3LlxuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IC0gQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIGN1cnJlbnQgcGFnZSBkaW1lbnNpb25zIGF0IHRoZSBjdXJyZW50IHpvb20gbGV2ZWwuXG4gICAgICoqL1xuICAgIGdldEN1cnJlbnRQYWdlRGltZW5zaW9uc0F0Q3VycmVudFpvb21MZXZlbCAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UGFnZURpbWVuc2lvbnNBdEN1cnJlbnRab29tTGV2ZWwodGhpcy5zZXR0aW5ncy5hY3RpdmVQYWdlSW5kZXgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgZmlsZW5hbWUgKGRlcHJlY2F0ZWQpLiBSZXR1cm5zIHRoZSBVUkkgZm9yIGN1cnJlbnQgcGFnZS5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAZGVwcmVjYXRlZFxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IC0gVGhlIFVSSSBmb3IgdGhlIGN1cnJlbnQgcGFnZSBpbWFnZS5cbiAgICAgKiovXG4gICAgZ2V0Q3VycmVudFBhZ2VGaWxlbmFtZSAoKVxuICAgIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdUaGlzIG1ldGhvZCB3aWxsIGJlIGRlcHJlY2F0ZWQgaW4gdGhlIG5leHQgdmVyc2lvbiBvZiBEaXZhLiBQbGVhc2UgdXNlIGdldEN1cnJlbnRQYWdlVVJJIGluc3RlYWQuJyk7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLm1hbmlmZXN0LnBhZ2VzW3RoaXMuc2V0dGluZ3MuYWN0aXZlUGFnZUluZGV4XS5mO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4gYXJyYXkgb2YgcGFnZSBpbmRpY2VzIHRoYXQgYXJlIHZpc2libGUgaW4gdGhlIHZpZXdwb3J0LlxuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHthcnJheX0gLSBUaGUgMC1iYXNlZCBpbmRpY2VzIGFycmF5IGZvciB0aGUgY3VycmVudGx5IHZpc2libGUgcGFnZXMuXG4gICAgICoqL1xuICAgIGdldEN1cnJlbnRQYWdlSW5kaWNlcyAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MuY3VycmVudFBhZ2VJbmRpY2VzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIDAtYmFzZWQgaW5kZXggZm9yIHRoZSBjdXJyZW50IHBhZ2UuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gLSBUaGUgMC1iYXNlZCBpbmRleCBmb3IgdGhlIGN1cnJlbnRseSB2aXNpYmxlIHBhZ2UuXG4gICAgICoqL1xuICAgICBnZXRBY3RpdmVQYWdlSW5kZXggKClcbiAgICAge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5hY3RpdmVQYWdlSW5kZXg7XG4gICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3J0Y3V0IHRvIGdldFBhZ2VPZmZzZXQgZm9yIGN1cnJlbnQgcGFnZS5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7fSAtXG4gICAgICogKi9cbiAgICBnZXRDdXJyZW50UGFnZU9mZnNldCAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UGFnZU9mZnNldCh0aGlzLnNldHRpbmdzLmFjdGl2ZVBhZ2VJbmRleCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgY3VycmVudCBVUkkgZm9yIHRoZSB2aXNpYmxlIHBhZ2UuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gLSBUaGUgVVJJIGZvciB0aGUgY3VycmVudCBwYWdlIGltYWdlLlxuICAgICAqKi9cbiAgICBnZXRDdXJyZW50UGFnZVVSSSAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MubWFuaWZlc3QucGFnZXNbdGhpcy5zZXR0aW5ncy5hY3RpdmVQYWdlSW5kZXhdLmY7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBjdXJyZW50IFVSTCBmb3IgdGhlIHZpZXdlciwgaW5jbHVkaW5nIHRoZSBoYXNoIHBhcmFtZXRlcnMgcmVmbGVjdGluZ1xuICAgICAqIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSB2aWV3ZXIuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gLSBUaGUgVVJMIGZvciB0aGUgY3VycmVudCB2aWV3IHN0YXRlLlxuICAgICAqICovXG4gICAgZ2V0Q3VycmVudFVSTCAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldEN1cnJlbnRVUkwoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIGFsbCBmaWxlbmFtZXMgaW4gdGhlIGRvY3VtZW50LiBEZXByZWNhdGVkLlxuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBkZXByZWNhdGVkXG4gICAgICogQHJldHVybnMge0FycmF5fSAtIEFuIGFycmF5IG9mIGFsbCB0aGUgVVJJcyBpbiB0aGUgZG9jdW1lbnQuXG4gICAgICogKi9cbiAgICBnZXRGaWxlbmFtZXMgKClcbiAgICB7XG4gICAgICAgIGNvbnNvbGUud2FybignVGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gdGhlIG5leHQgdmVyc2lvbiBvZiBEaXZhLiBVc2UgZ2V0QWxsUGFnZVVSSXMgaW5zdGVhZC4nKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5tYW5pZmVzdC5wYWdlcy5tYXAoIChwZykgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHBnLmY7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgbnVtYmVyIG9mIGdyaWQgcGFnZXMgcGVyIHJvdy5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIFRoZSBudW1iZXIgb2YgZ3JpZCBwYWdlcyBwZXIgcm93LlxuICAgICAqKi9cbiAgICBnZXRHcmlkUGFnZXNQZXJSb3cgKClcbiAgICB7XG4gICAgICAgIC8vIFRPRE8od2FiYWluKTogQWRkIHRlc3QgY2FzZVxuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5wYWdlc1BlclJvdztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGluc3RhbmNlIElEIG51bWJlci5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIFRoZSBpbnN0YW5jZSBJRC5cbiAgICAgKiAqL1xuICAgIC8vXG4gICAgZ2V0SW5zdGFuY2VJZCAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MuSUQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBpbnN0YW5jZSBzZWxlY3RvciBmb3IgdGhpcyBpbnN0YW5jZS4gVGhpcyBpcyB0aGUgc2VsZWN0b3IgZm9yIHRoZSBwYXJlbnRcbiAgICAgKiBkaXYuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gLSBUaGUgdmlld3BvcnQgc2VsZWN0b3IuXG4gICAgICogKi9cbiAgICBnZXRJbnN0YW5jZVNlbGVjdG9yICgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5zZWxlY3RvcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB0aXRsZSBvZiB0aGUgZG9jdW1lbnQsIGJhc2VkIG9uIHRoZSBsYWJlbCBpbiB0aGUgSUlJRiBtYW5pZmVzdC5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSAtIFRoZSBjdXJyZW50IHRpdGxlIG9mIHRoZSBvYmplY3QgZnJvbSB0aGUgbGFiZWwga2V5IGluIHRoZSBJSUlGIE1hbmlmZXN0LlxuICAgICAqKi9cbiAgICBnZXRJdGVtVGl0bGUgKClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLm1hbmlmZXN0Lml0ZW1UaXRsZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBtYXhpbXVtIHpvb20gbGV2ZWwgZm9yIHRoZSBlbnRpcmUgZG9jdW1lbnQuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gLSBUaGUgbWF4aW11bSB6b29tIGxldmVsIGZvciB0aGUgZG9jdW1lbnRcbiAgICAgKiAqL1xuICAgIGdldE1heFpvb21MZXZlbCAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MubWF4Wm9vbUxldmVsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIG1heCB6b29tIGxldmVsIGZvciBhIGdpdmVuIHBhZ2UuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBhZ2VJZHggLSBUaGUgMC1iYXNlZCBpbmRleCBudW1iZXIgZm9yIHRoZSBwYWdlLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IC0gVGhlIG1heGltdW0gem9vbSBsZXZlbCBmb3IgdGhhdCBwYWdlLlxuICAgICAqICovXG4gICAgZ2V0TWF4Wm9vbUxldmVsRm9yUGFnZSAocGFnZUlkeClcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5fY2hlY2tMb2FkZWQoKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5tYW5pZmVzdC5wYWdlc1twYWdlSWR4XS5tO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIG1pbmltdW0gem9vbSBsZXZlbCBmb3IgdGhlIGVudGlyZSBkb2N1bWVudC5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIFRoZSBtaW5pbXVtIHpvb20gbGV2ZWwgZm9yIHRoZSBkb2N1bWVudFxuICAgICAqICovXG4gICAgZ2V0TWluWm9vbUxldmVsICgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5taW5ab29tTGV2ZWw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbnVtYmVyIG9mIHBhZ2VzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIFRoZSBudW1iZXIgb2YgcGFnZXMgaW4gdGhlIGRvY3VtZW50LlxuICAgICAqICovXG4gICAgZ2V0TnVtYmVyT2ZQYWdlcyAoKVxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jaGVja0xvYWRlZCgpKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLm51bVBhZ2VzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElmIGEgY2FudmFzIGhhcyBtdWx0aXBsZSBpbWFnZXMgZGVmaW5lZCwgcmV0dXJucyB0aGUgbm9uLXByaW1hcnkgaW1hZ2UuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtcyB7bnVtYmVyfSBwYWdlSW5kZXggLSBUaGUgcGFnZSBpbmRleCBmb3Igd2hpY2ggdG8gcmV0dXJuIHRoZSBvdGhlciBpbWFnZXMuXG4gICAgICogQHJldHVybnMge29iamVjdH0gQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIG90aGVyIGltYWdlcy5cbiAgICAgKiovXG4gICAgZ2V0T3RoZXJJbWFnZXMgKHBhZ2VJbmRleClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLm1hbmlmZXN0LnBhZ2VzW3BhZ2VJbmRleF0ub3RoZXJJbWFnZXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHBhZ2UgZGltZW5zaW9ucyBpbiB0aGUgY3VycmVudCB2aWV3IGFuZCB6b29tIGxldmVsXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtcyB7bnVtYmVyfSBwYWdlSW5kZXggLSBBIHZhbGlkIDAtYmFzZWQgcGFnZSBpbmRleFxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IC0gQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIGRpbWVuc2lvbnMgb2YgdGhlIHBhZ2VcbiAgICAgKiAqL1xuICAgIGdldFBhZ2VEaW1lbnNpb25zIChwYWdlSW5kZXgpXG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuX2NoZWNrTG9hZGVkKCkpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcblxuICAgICAgICByZXR1cm4gdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5nZXRDdXJyZW50TGF5b3V0KCkuZ2V0UGFnZURpbWVuc2lvbnMocGFnZUluZGV4KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBkaW1lbnNpb25zIG9mIGEgZ2l2ZW4gcGFnZSBhdCB0aGUgY3VycmVudCB6b29tIGxldmVsLlxuICAgICAqIEFsc28gd29ya3MgaW4gR3JpZCB2aWV3XG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBhZ2VJbmRleCAtIFRoZSAwLWJhc2VkIHBhZ2UgaW5kZXhcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSAtIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBwYWdlIGRpbWVuc2lvbnMgYXQgdGhlIGN1cnJlbnQgem9vbSBsZXZlbC5cbiAgICAgKiAqL1xuICAgIGdldFBhZ2VEaW1lbnNpb25zQXRDdXJyZW50Wm9vbUxldmVsIChwYWdlSW5kZXgpXG4gICAge1xuICAgICAgICBsZXQgcGlkeCA9IHBhcnNlSW50KHBhZ2VJbmRleCwgMTApO1xuXG4gICAgICAgIGlmICghdGhpcy5faXNQYWdlSW5kZXhWYWxpZChwaWR4KSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBQYWdlIEluZGV4Jyk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZGl2YVN0YXRlLnZpZXdlckNvcmUuZ2V0Q3VycmVudExheW91dCgpLmdldFBhZ2VEaW1lbnNpb25zKHBpZHgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBwYWdlIGRpbWVuc2lvbnMgYXQgYSBnaXZlbiB6b29tIGxldmVsXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtcyB7bnVtYmVyfSBwYWdlSWR4IC0gQSB2YWxpZCAwLWJhc2VkIHBhZ2UgaW5kZXhcbiAgICAgKiBAcGFyYW1zIHtudW1iZXJ9IHpvb21MZXZlbCAtIEEgY2FuZGlkYXRlIHpvb20gbGV2ZWwuXG4gICAgICogQHJldHVybnMge29iamVjdH0gLSBBbiBvYmplY3QgY29udGFpbmluZyB0aGUgZGltZW5zaW9ucyBvZiB0aGUgcGFnZSBhdCB0aGUgZ2l2ZW4gem9vbSBsZXZlbC5cbiAgICAgKiovXG4gICAgZ2V0UGFnZURpbWVuc2lvbnNBdFpvb21MZXZlbCAocGFnZUlkeCwgem9vbUxldmVsKVxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jaGVja0xvYWRlZCgpKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGlmICh6b29tTGV2ZWwgPiB0aGlzLnNldHRpbmdzLm1heFpvb21MZXZlbClcbiAgICAgICAgICAgIHpvb21MZXZlbCA9IHRoaXMuc2V0dGluZ3MubWF4Wm9vbUxldmVsO1xuXG4gICAgICAgIGNvbnN0IHBnID0gdGhpcy5zZXR0aW5ncy5tYW5pZmVzdC5wYWdlc1twYXJzZUludChwYWdlSWR4LCAxMCldO1xuICAgICAgICBjb25zdCBwZ0F0Wm9vbSA9IHBnLmRbcGFyc2VJbnQoem9vbUxldmVsLCAxMCldO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB3aWR0aDogcGdBdFpvb20udyxcbiAgICAgICAgICAgIGhlaWdodDogcGdBdFpvb20uaFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBVUkwgZm9yIHRoZSBpbWFnZSBvZiB0aGUgcGFnZSBhdCB0aGUgZ2l2ZW4gaW5kZXguIFRoZVxuICAgICAqIG9wdGlvbmFsIHNpemUgcGFyYW1ldGVyIHN1cHBvcnRzIHNldHRpbmcgdGhlIGltYWdlIHdpZHRoIG9yIGhlaWdodFxuICAgICAqIChkZWZhdWx0IGlzIGZ1bGwtc2l6ZWQpLlxuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbXMge251bWJlcn0gcGFnZUluZGV4IC0gMC1iYXNlZCBwYWdlIGluZGV4XG4gICAgICogQHBhcmFtcyB7P29iamVjdH0gc2l6ZSAtIGFuIG9iamVjdCBjb250YWluaW5nIHdpZHRoIGFuZCBoZWlnaHQgaW5mb3JtYXRpb25cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSAtIFRoZSBJSUlGIFVSTCBmb3IgYSBnaXZlbiBwYWdlIGF0IGFuIG9wdGlvbmFsIHNpemVcbiAgICAgKi9cbiAgICBnZXRQYWdlSW1hZ2VVUkwgKHBhZ2VJbmRleCwgc2l6ZSlcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLm1hbmlmZXN0LmdldFBhZ2VJbWFnZVVSTChwYWdlSW5kZXgsIHNpemUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdpdmVuIGEgc2V0IG9mIGNvLW9yZGluYXRlcyAoZS5nLiwgZnJvbSBhIG1vdXNlIGNsaWNrKSwgcmV0dXJuIHRoZSAwLWJhc2VkIHBhZ2UgaW5kZXhcbiAgICAgKiBmb3Igd2hpY2ggaXQgbWF0Y2hlcy5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW1zIHtudW1iZXJ9IHBhZ2VYIC0gVGhlIHggY28tb3JkaW5hdGVcbiAgICAgKiBAcGFyYW1zIHtudW1iZXJ9IHBhZ2VZIC0gVGhlIHkgY28tb3JkaW5hdGVcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIFRoZSBwYWdlIGluZGV4IG1hdGNoaW5nIHRoZSBjby1vcmRpbmF0ZXMuXG4gICAgICogKi9cbiAgICBnZXRQYWdlSW5kZXhGb3JQYWdlWFlWYWx1ZXMgKHBhZ2VYLCBwYWdlWSlcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRQYWdlSW5kZXhGb3JQYWdlWFlWYWx1ZXMocGFnZVgsIHBhZ2VZKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGRpc3RhbmNlIGJldHdlZW4gdGhlIG5vcnRod2VzdCBjb3JuZXJzIG9mIGRpdmEtaW5uZXIgYW5kIHBhZ2UgaW5kZXguXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtcyB7bnVtYmVyfSBwYWdlSW5kZXggLSBUaGUgMC1iYXNlZCBwYWdlIGluZGV4XG4gICAgICogQHBhcmFtcyB7P29wdGlvbnN9IG9wdGlvbnMgLSBBIHNldCBvZiBvcHRpb25zIHRvIHBhc3MgaW4uXG4gICAgICogQHJldHVybnMge29iamVjdH0gLSBUaGUgb2Zmc2V0IGJldHdlZW4gdGhlIHVwcGVyIGxlZnQgY29ybmVyIGFuZCB0aGUgcGFnZS5cbiAgICAgKlxuICAgICAqICovXG4gICAgZ2V0UGFnZU9mZnNldCAocGFnZUluZGV4LCBvcHRpb25zKVxuICAgIHtcbiAgICAgICAgY29uc3QgcmVnaW9uID0gdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS5nZXRQYWdlUmVnaW9uKHBhZ2VJbmRleCwgb3B0aW9ucyk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRvcDogcmVnaW9uLnRvcCxcbiAgICAgICAgICAgIGxlZnQ6IHJlZ2lvbi5sZWZ0XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBpbnN0YW5jZSBzZXR0aW5ncy5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSAtIFRoZSBjdXJyZW50IGluc3RhbmNlIHNldHRpbmdzLlxuICAgICAqICovXG4gICAgZ2V0U2V0dGluZ3MgKClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBjb21wbGV0ZSBzdGF0ZSBvZiB0aGUgdmlld2VyLlxuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IC0gVGhlIGN1cnJlbnQgaW5zdGFuY2Ugc3RhdGUuXG4gICAgICogKi9cbiAgICBnZXRTdGF0ZSAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldFN0YXRlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50IHpvb20gbGV2ZWwuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gLSBUaGUgY3VycmVudCB6b29tIGxldmVsLlxuICAgICAqICovXG4gICAgZ2V0Wm9vbUxldmVsICgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy56b29tTGV2ZWw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogIEdvIHRvIGEgcGFydGljdWxhciBwYWdlICh3aXRoIGluZGV4aW5nIHN0YXJ0aW5nIGF0IDApLlxuICAgICAqICBUaGUgKHhBbmNob3IpIHNpZGUgb2YgdGhlIHBhZ2Ugd2lsbCBiZSBhbmNob3JlZCB0byB0aGUgKHhBbmNob3IpIHNpZGUgb2YgdGhlIGRpdmEtb3V0ZXIgZWxlbWVudFxuICAgICAqXG4gICAgICogIEBwdWJsaWNcbiAgICAgKiAgQHBhcmFtcyB7bnVtYmVyfSBwYWdlSW5kZXggLSAwLWJhc2VkIHBhZ2UgaW5kZXguXG4gICAgICogIEBwYXJhbXMgez9zdHJpbmd9IHhBbmNob3IgLSBtYXkgZWl0aGVyIGJlIFwibGVmdFwiLCBcInJpZ2h0XCIsIG9yIGRlZmF1bHQgXCJjZW50ZXJcIlxuICAgICAqICBAcGFyYW1zIHs/c3RyaW5nfSB5QW5jaG9yIC0gbWF5IGVpdGhlciBiZSBcInRvcFwiLCBcImJvdHRvbVwiLCBvciBkZWZhdWx0IFwiY2VudGVyXCI7IHNhbWUgcHJvY2VzcyBhcyB4QW5jaG9yLlxuICAgICAqICBAcmV0dXJucyB7Ym9vbGVhbn0gLSBUcnVlIGlmIHRoZSBwYWdlIGluZGV4IGlzIHZhbGlkOyBmYWxzZSBpZiBpdCBpcyBub3QuXG4gICAgICogKi9cbiAgICBnb3RvUGFnZUJ5SW5kZXggKHBhZ2VJbmRleCwgeEFuY2hvciwgeUFuY2hvcilcbiAgICB7XG4gICAgICAgIHRoaXMuX2dvdG9QYWdlQnlJbmRleChwYWdlSW5kZXgsIHhBbmNob3IsIHlBbmNob3IpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdpdmVuIGEgY2FudmFzIGxhYmVsLCBhdHRlbXB0IHRvIGdvIHRvIHRoYXQgcGFnZS4gSWYgbm8gbGFiZWwgd2FzIGZvdW5kLlxuICAgICAqIHRoZSBsYWJlbCB3aWxsIGJlIGF0dGVtcHRlZCB0byBtYXRjaCBhZ2FpbnN0IHRoZSBwYWdlIGluZGV4LlxuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbXMge3N0cmluZ30gbGFiZWwgLSBUaGUgbGFiZWwgdG8gc2VhcmNoIG9uLlxuICAgICAqIEBwYXJhbXMgez9zdHJpbmd9IHhBbmNob3IgLSBtYXkgZWl0aGVyIGJlIFwibGVmdFwiLCBcInJpZ2h0XCIsIG9yIGRlZmF1bHQgXCJjZW50ZXJcIlxuICAgICAqIEBwYXJhbXMgez9zdHJpbmd9IHlBbmNob3IgLSBtYXkgZWl0aGVyIGJlIFwidG9wXCIsIFwiYm90dG9tXCIsIG9yIGRlZmF1bHQgXCJjZW50ZXJcIlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFRydWUgaWYgdGhlIHBhZ2UgaW5kZXggaXMgdmFsaWQ7IGZhbHNlIGlmIGl0IGlzIG5vdC5cbiAgICAgKiAqL1xuICAgIGdvdG9QYWdlQnlMYWJlbCAobGFiZWwsIHhBbmNob3IsIHlBbmNob3IpXG4gICAge1xuICAgICAgICBjb25zdCBwYWdlcyA9IHRoaXMuc2V0dGluZ3MubWFuaWZlc3QucGFnZXM7XG4gICAgICAgIGxldCBsbGMgPSBsYWJlbC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBwYWdlcy5sZW5ndGg7IGkgPCBsZW47IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHBhZ2VzW2ldLmwudG9Mb3dlckNhc2UoKS5pbmRleE9mKGxsYykgPiAtMSlcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ290b1BhZ2VCeUluZGV4KGksIHhBbmNob3IsIHlBbmNob3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGFnZUluZGV4ID0gcGFyc2VJbnQobGFiZWwsIDEwKSAtIDE7XG4gICAgICAgIHJldHVybiB0aGlzLl9nb3RvUGFnZUJ5SW5kZXgocGFnZUluZGV4LCB4QW5jaG9yLCB5QW5jaG9yKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBKdW1wIHRvIGEgcGFnZSBiYXNlZCBvbiBpdHMgZmlsZW5hbWUuIERlcHJlY2F0ZWQuIFVzZSBnb3RvUGFnZUJ5VVJJIGluc3RlYWQuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtcyB7c3RyaW5nfSBmaWxlbmFtZSAtIFRoZSBmaWxlbmFtZSBvZiB0aGUgaW1hZ2UgdG8ganVtcCB0by5cbiAgICAgKiBAcGFyYW1zIHs/c3RyaW5nfSB4QW5jaG9yIC0gbWF5IGVpdGhlciBiZSBcImxlZnRcIiwgXCJyaWdodFwiLCBvciBkZWZhdWx0IFwiY2VudGVyXCJcbiAgICAgKiBAcGFyYW1zIHs/c3RyaW5nfSB5QW5jaG9yIC0gbWF5IGVpdGhlciBiZSBcInRvcFwiLCBcImJvdHRvbVwiLCBvciBkZWZhdWx0IFwiY2VudGVyXCJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpZiBzdWNjZXNzZnVsIGFuZCBmYWxzZSBpZiB0aGUgZmlsZW5hbWUgaXMgbm90IGZvdW5kLlxuICAgICovXG4gICAgZ290b1BhZ2VCeU5hbWUgKGZpbGVuYW1lLCB4QW5jaG9yLCB5QW5jaG9yKVxuICAgIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdUaGlzIG1ldGhvZCB3aWxsIGJlIHJlbW92ZWQgaW4gdGhlIG5leHQgdmVyc2lvbiBvZiBEaXZhLmpzLiBVc2UgZ290b1BhZ2VCeVVSSSBpbnN0ZWFkLicpO1xuICAgICAgICBjb25zdCBwYWdlSW5kZXggPSB0aGlzLl9nZXRQYWdlSW5kZXgoZmlsZW5hbWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5fZ290b1BhZ2VCeUluZGV4KHBhZ2VJbmRleCwgeEFuY2hvciwgeUFuY2hvcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSnVtcCB0byBhIHBhZ2UgYmFzZWQgb24gaXRzIFVSSS5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW1zIHtzdHJpbmd9IHVyaSAtIFRoZSBVUkkgb2YgdGhlIGltYWdlIHRvIGp1bXAgdG8uXG4gICAgICogQHBhcmFtcyB7P3N0cmluZ30geEFuY2hvciAtIG1heSBlaXRoZXIgYmUgXCJsZWZ0XCIsIFwicmlnaHRcIiwgb3IgZGVmYXVsdCBcImNlbnRlclwiXG4gICAgICogQHBhcmFtcyB7P3N0cmluZ30geUFuY2hvciAtIG1heSBlaXRoZXIgYmUgXCJ0b3BcIiwgXCJib3R0b21cIiwgb3IgZGVmYXVsdCBcImNlbnRlclwiXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHRydWUgaWYgc3VjY2Vzc2Z1bCBhbmQgZmFsc2UgaWYgdGhlIFVSSSBpcyBub3QgZm91bmQuXG4gICAgICovXG4gICAgZ290b1BhZ2VCeVVSSSAodXJpLCB4QW5jaG9yLCB5QW5jaG9yKVxuICAgIHtcbiAgICAgICAgY29uc3QgcGFnZUluZGV4ID0gdGhpcy5fZ2V0UGFnZUluZGV4KHVyaSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9nb3RvUGFnZUJ5SW5kZXgocGFnZUluZGV4LCB4QW5jaG9yLCB5QW5jaG9yKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIHRoZSBwYWdlIGhhcyBvdGhlciBpbWFnZXMgdG8gZGlzcGxheS5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW1zIHtudW1iZXJ9IHBhZ2VJbmRleCAtIFRoZSAwLWJhc2VkIHBhZ2UgaW5kZXhcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gV2hldGhlciB0aGUgcGFnZSBoYXMgb3RoZXIgaW1hZ2VzIHRvIGRpc3BsYXkuXG4gICAgICoqL1xuICAgIGhhc090aGVySW1hZ2VzIChwYWdlSW5kZXgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5tYW5pZmVzdC5wYWdlc1twYWdlSW5kZXhdLm90aGVySW1hZ2VzID09PSB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhpZGVzIHRoZSBwYWdlcyB0aGF0IGFyZSBtYXJrZWQgXCJub24tcGFnZWRcIiBpbiB0aGUgSUlJRiBtYW5pZmVzdC5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiovXG4gICAgaGlkZU5vblBhZ2VkUGFnZXMgKClcbiAgICB7XG4gICAgICAgIHRoaXMuX3JlbG9hZFZpZXdlcih7IHNob3dOb25QYWdlZFBhZ2VzOiBmYWxzZSB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJcyB0aGUgdmlld2VyIGN1cnJlbnRseSBpbiBmdWxsLXNjcmVlbiBtb2RlP1xuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFdoZXRoZXIgdGhlIHZpZXdlciBpcyBpbiBmdWxsc2NyZWVuIG1vZGUuXG4gICAgICoqL1xuICAgIGlzSW5GdWxsc2NyZWVuICgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5pbkZ1bGxzY3JlZW47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgYSBwYWdlIGluZGV4IGlzIHdpdGhpbiB0aGUgcmFuZ2Ugb2YgdGhlIGRvY3VtZW50XG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gV2hldGhlciB0aGUgcGFnZSBpbmRleCBpcyB2YWxpZC5cbiAgICAgKiovXG4gICAgaXNQYWdlSW5kZXhWYWxpZCAocGFnZUluZGV4KVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzUGFnZUluZGV4VmFsaWQocGFnZUluZGV4KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIGlmIGEgcGFnZSBpcyBjdXJyZW50bHkgaW4gdGhlIHZpZXdwb3J0XG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtcyB7bnVtYmVyfSBwYWdlSW5kZXggLSBUaGUgMC1iYXNlZCBwYWdlIGluZGV4XG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gV2hldGhlciB0aGUgcGFnZSBpcyBjdXJyZW50bHkgaW4gdGhlIHZpZXdwb3J0LlxuICAgICAqKi9cbiAgICBpc1BhZ2VJblZpZXdwb3J0IChwYWdlSW5kZXgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3ZXJTdGF0ZS5yZW5kZXJlci5pc1BhZ2VWaXNpYmxlKHBhZ2VJbmRleCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGUgRGl2YSB2aWV3ZXIgaGFzIGJlZW4gZnVsbHkgaW5pdGlhbGl6ZWQuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gVHJ1ZSBpZiB0aGUgdmlld2VyIGlzIGluaXRpYWxpemVkOyBmYWxzZSBvdGhlcndpc2UuXG4gICAgICoqL1xuICAgIGlzUmVhZHkgKClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdlclN0YXRlLmxvYWRlZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBzb21ldGhpbmcgKGUuZy4gYSBoaWdobGlnaHQgYm94IG9uIGEgcGFydGljdWxhciBwYWdlKSBpcyB2aXNpYmxlXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtcyB7bnVtYmVyfSBwYWdlSW5kZXggLSBUaGUgMC1iYXNlZCBwYWdlIGluZGV4XG4gICAgICogQHBhcmFtcyB7bnVtYmVyfSBsZWZ0T2Zmc2V0IC0gVGhlIGRpc3RhbmNlIG9mIHRoZSByZWdpb24gZnJvbSB0aGUgbGVmdCBvZiB0aGUgdmlld3BvcnRcbiAgICAgKiBAcGFyYW1zIHtudW1iZXJ9IHRvcE9mZnNldCAtIFRoZSBkaXN0YW5jZSBvZiB0aGUgcmVnaW9uIGZyb20gdGhlIHRvcCBvZiB0aGUgdmlld3BvcnRcbiAgICAgKiBAcGFyYW1zIHtudW1iZXJ9IHdpZHRoIC0gVGhlIHdpZHRoIG9mIHRoZSByZWdpb25cbiAgICAgKiBAcGFyYW1zIHtudW1iZXJ9IGhlaWdodCAtIFRoZSBoZWlnaHQgb2YgdGhlIHJlZ2lvblxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFdoZXRoZXIgdGhlIHJlZ2lvbiBpcyBpbiB0aGUgdmlld3BvcnQuXG4gICAgICoqL1xuICAgIGlzUmVnaW9uSW5WaWV3cG9ydCAocGFnZUluZGV4LCBsZWZ0T2Zmc2V0LCB0b3BPZmZzZXQsIHdpZHRoLCBoZWlnaHQpXG4gICAge1xuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmRpdmFTdGF0ZS52aWV3ZXJDb3JlLmdldEN1cnJlbnRMYXlvdXQoKTtcblxuICAgICAgICBpZiAoIWxheW91dClcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBvZmZzZXQgPSBsYXlvdXQuZ2V0UGFnZU9mZnNldChwYWdlSW5kZXgpO1xuXG4gICAgICAgIGNvbnN0IHRvcCA9IG9mZnNldC50b3AgKyB0b3BPZmZzZXQ7XG4gICAgICAgIGNvbnN0IGxlZnQgPSBvZmZzZXQubGVmdCArIGxlZnRPZmZzZXQ7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQuaW50ZXJzZWN0c1JlZ2lvbih7XG4gICAgICAgICAgICB0b3A6IHRvcCxcbiAgICAgICAgICAgIGJvdHRvbTogdG9wICsgaGVpZ2h0LFxuICAgICAgICAgICAgbGVmdDogbGVmdCxcbiAgICAgICAgICAgIHJpZ2h0OiBsZWZ0ICsgd2lkdGhcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGUgcGFnZSBsYXlvdXQgaXMgdmVydGljYWxseSBvciBob3Jpem9udGFsbHkgb3JpZW50ZWQuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gVHJ1ZSBpZiB2ZXJ0aWNhbDsgZmFsc2UgaWYgaG9yaXpvbnRhbC5cbiAgICAgKiovXG4gICAgaXNWZXJ0aWNhbGx5T3JpZW50ZWQgKClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLnZlcnRpY2FsbHlPcmllbnRlZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMZWF2ZSBmdWxsc2NyZWVuIG1vZGUgaWYgY3VycmVudGx5IGluIGZ1bGxzY3JlZW4gbW9kZS5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSB0cnVlIGlmIGluIGZ1bGxzY3JlZW4gbW9kZSBpbnRpdGlhbGx5LCBmYWxzZSBvdGhlcndpc2VcbiAgICAgKiovXG4gICAgbGVhdmVGdWxsc2NyZWVuTW9kZSAoKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaW5GdWxsc2NyZWVuKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl90b2dnbGVGdWxsc2NyZWVuKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMZWF2ZSBncmlkIHZpZXcgaWYgY3VycmVudGx5IGluIGdyaWQgdmlldy5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSB0cnVlIGlmIGluIGdyaWQgdmlldyBpbml0aWFsbHksIGZhbHNlIG90aGVyd2lzZVxuICAgICAqKi9cbiAgICBsZWF2ZUdyaWRWaWV3ICgpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5pbkdyaWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3JlbG9hZFZpZXdlcih7IGluR3JpZDogZmFsc2UgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIG51bWJlciBvZiBncmlkIHBhZ2VzIHBlciByb3cuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtcyB7bnVtYmVyfSBwYWdlc1BlclJvdyAtIFRoZSBudW1iZXIgb2YgcGFnZXMgcGVyIHJvd1xuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC5cbiAgICAgKiovXG4gICAgc2V0R3JpZFBhZ2VzUGVyUm93IChwYWdlc1BlclJvdylcbiAgICB7XG4gICAgICAgIC8vIFRPRE8od2FiYWluKTogQWRkIHRlc3QgY2FzZVxuICAgICAgICBpZiAoIXRoaXMuZGl2YVN0YXRlLnZpZXdlckNvcmUuaXNWYWxpZE9wdGlvbigncGFnZXNQZXJSb3cnLCBwYWdlc1BlclJvdykpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlbG9hZFZpZXdlcih7XG4gICAgICAgICAgICBpbkdyaWQ6IHRydWUsXG4gICAgICAgICAgICBwYWdlc1BlclJvdzogcGFnZXNQZXJSb3dcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWxpZ24gdGhpcyBkaXZhIGluc3RhbmNlIHdpdGggYSBzdGF0ZSBvYmplY3QgKGFzIHJldHVybmVkIGJ5IGdldFN0YXRlKVxuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbXMge29iamVjdH0gc3RhdGUgLSBBIERpdmEgc3RhdGUgb2JqZWN0LlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC5cbiAgICAgKiovXG4gICAgc2V0U3RhdGUgKHN0YXRlKVxuICAgIHtcbiAgICAgICAgdGhpcy5fcmVsb2FkVmlld2VyKHRoaXMuX2dldExvYWRPcHRpb25zRm9yU3RhdGUoc3RhdGUpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSB6b29tIGxldmVsLlxuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC5cbiAgICAgKiovXG4gICAgc2V0Wm9vbUxldmVsICh6b29tTGV2ZWwpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5pbkdyaWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3JlbG9hZFZpZXdlcih7XG4gICAgICAgICAgICAgICAgaW5HcmlkOiBmYWxzZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5kaXZhU3RhdGUudmlld2VyQ29yZS56b29tKHpvb21MZXZlbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyBub24tcGFnZWQgcGFnZXMuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLlxuICAgICAqKi9cbiAgICBzaG93Tm9uUGFnZWRQYWdlcyAoKVxuICAgIHtcbiAgICAgICAgdGhpcy5fcmVsb2FkVmlld2VyKHsgc2hvd05vblBhZ2VkUGFnZXM6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVG9nZ2xlIGZ1bGxzY3JlZW4gbW9kZS5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuXG4gICAgICoqL1xuICAgIHRvZ2dsZUZ1bGxzY3JlZW5Nb2RlICgpXG4gICAge1xuICAgICAgICB0aGlzLl90b2dnbGVGdWxsc2NyZWVuKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdy9IaWRlIG5vbi1wYWdlZCBwYWdlc1xuICAgICAqXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC5cbiAgICAgKiovXG4gICAgdG9nZ2xlTm9uUGFnZWRQYWdlc1Zpc2liaWxpdHkgKClcbiAgICB7XG4gICAgICAgIHRoaXMuX3JlbG9hZFZpZXdlcih7XG4gICAgICAgICAgICBzaG93Tm9uUGFnZWRQYWdlczogIXRoaXMuc2V0dGluZ3Muc2hvd05vblBhZ2VkUGFnZXNcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy9DaGFuZ2VzIGJldHdlZW4gaG9yaXpvbnRhbCBsYXlvdXQgYW5kIHZlcnRpY2FsIGxheW91dC4gUmV0dXJucyB0cnVlIGlmIGRvY3VtZW50IGlzIG5vdyB2ZXJ0aWNhbGx5IG9yaWVudGVkLCBmYWxzZSBvdGhlcndpc2UuXG4gICAgdG9nZ2xlT3JpZW50YXRpb24gKClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl90b2dnbGVQYWdlTGF5b3V0T3JpZW50YXRpb24oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmFuc2xhdGVzIGEgbWVhc3VyZW1lbnQgZnJvbSB0aGUgem9vbSBsZXZlbCBvbiB0aGUgbGFyZ2VzdCBzaXplXG4gICAgICogdG8gb25lIG9uIHRoZSBjdXJyZW50IHpvb20gbGV2ZWwuXG4gICAgICpcbiAgICAgKiBGb3IgZXhhbXBsZSwgYSBwb2ludCAxMDAwIG9uIGFuIGltYWdlIHRoYXQgaXMgb24gem9vbSBsZXZlbCAyIG9mIDVcbiAgICAgKiB0cmFuc2xhdGVzIHRvIGEgcG9zaXRpb24gb2YgMTExLjExMS4uLiAoMTAwMCAvICg1IC0gMileMikuXG4gICAgICpcbiAgICAgKiBXb3JrcyBmb3IgYSBzaW5nbGUgcGl4ZWwgY28tb3JkaW5hdGUgb3IgYSBkaW1lbnNpb24gKGUuZy4sIHRyYW5zbGF0ZXMgYSBib3hcbiAgICAgKiB0aGF0IGlzIDEwMDAgcGl4ZWxzIHdpZGUgb24gdGhlIG9yaWdpbmFsIHRvIG9uZSB0aGF0IGlzIDExMS4xMTEgcGl4ZWxzIHdpZGVcbiAgICAgKiBvbiB0aGUgY3VycmVudCB6b29tIGxldmVsKS5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW1zIHtudW1iZXJ9IHBvc2l0aW9uIC0gQSBwb2ludCBvbiB0aGUgbWF4IHpvb20gbGV2ZWxcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIFRoZSBzYW1lIHBvaW50IG9uIHRoZSBjdXJyZW50IHpvb20gbGV2ZWwuXG4gICAgKi9cbiAgICB0cmFuc2xhdGVGcm9tTWF4Wm9vbUxldmVsIChwb3NpdGlvbilcbiAgICB7XG4gICAgICAgIGNvbnN0IHpvb21EaWZmZXJlbmNlID0gdGhpcy5zZXR0aW5ncy5tYXhab29tTGV2ZWwgLSB0aGlzLnNldHRpbmdzLnpvb21MZXZlbDtcbiAgICAgICAgcmV0dXJuIHBvc2l0aW9uIC8gTWF0aC5wb3coMiwgem9vbURpZmZlcmVuY2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyYW5zbGF0ZXMgYSBtZWFzdXJlbWVudCBmcm9tIHRoZSBjdXJyZW50IHpvb20gbGV2ZWwgdG8gdGhlIHBvc2l0aW9uIG9uIHRoZVxuICAgICAqIGxhcmdlc3Qgem9vbSBsZXZlbC5cbiAgICAgKlxuICAgICAqIFdvcmtzIGZvciBhIHNpbmdsZSBwaXhlbCBjby1vcmRpbmF0ZSBvciBhIGRpbWVuc2lvbiAoZS5nLiwgdHJhbnNsYXRlcyBhIGJveFxuICAgICAqIHRoYXQgaXMgMTExLjExMSBwaXhlbHMgd2lkZSBvbiB0aGUgY3VycmVudCBpbWFnZSB0byBvbmUgdGhhdCBpcyAxMDAwIHBpeGVscyB3aWRlXG4gICAgICogb24gdGhlIGN1cnJlbnQgem9vbSBsZXZlbCkuXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtcyB7bnVtYmVyfSBwb3NpdGlvbiAtIEEgcG9pbnQgb24gdGhlIGN1cnJlbnQgem9vbSBsZXZlbFxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IC0gVGhlIHNhbWUgcG9pbnQgb24gdGhlIG1heCB6b29tIGxldmVsLlxuICAgICovXG4gICAgdHJhbnNsYXRlVG9NYXhab29tTGV2ZWwgKHBvc2l0aW9uKVxuICAgIHtcbiAgICAgICAgY29uc3Qgem9vbURpZmZlcmVuY2UgPSB0aGlzLnNldHRpbmdzLm1heFpvb21MZXZlbCAtIHRoaXMuc2V0dGluZ3Muem9vbUxldmVsO1xuXG4gICAgICAgIC8vIGlmIHRoZXJlIGlzIG5vIGRpZmZlcmVuY2UsIGl0J3MgYSBib3ggb24gdGhlIG1heCB6b29tIGxldmVsIGFuZFxuICAgICAgICAvLyB3ZSBjYW4ganVzdCByZXR1cm4gdGhlIHBvc2l0aW9uLlxuICAgICAgICBpZiAoem9vbURpZmZlcmVuY2UgPT09IDApXG4gICAgICAgICAgICByZXR1cm4gcG9zaXRpb247XG5cbiAgICAgICAgcmV0dXJuIHBvc2l0aW9uICogTWF0aC5wb3coMiwgem9vbURpZmZlcmVuY2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFpvb20gaW4uXG4gICAgICpcbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gZmFsc2UgaWYgaXQncyBhdCB0aGUgbWF4aW11bSB6b29tXG4gICAgICoqL1xuICAgIHpvb21JbiAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0Wm9vbUxldmVsKHRoaXMuc2V0dGluZ3Muem9vbUxldmVsICsgMSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogWm9vbSBvdXQuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gZmFsc2UgaWYgaXQncyBhdCB0aGUgbWluaW11bSB6b29tXG4gICAgICoqL1xuICAgIHpvb21PdXQgKClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldFpvb21MZXZlbCh0aGlzLnNldHRpbmdzLnpvb21MZXZlbCAtIDEpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRGl2YTtcblxuLyoqXG4gKiBNYWtlIGBEaXZhYCBhdmFpbGFibGUgaW4gdGhlIGdsb2JhbCBjb250ZXh0LlxuICogKi9cbihmdW5jdGlvbiAoZ2xvYmFsKVxue1xuICAgIGdsb2JhbC5EaXZhID0gZ2xvYmFsLkRpdmEgfHwgRGl2YTtcbiAgICBnbG9iYWwuRGl2YS5FdmVudHMgPSBkaXZhLkV2ZW50cztcbn0pKHdpbmRvdyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/diva.js\n");

/***/ }),

/***/ "./source/js/document-handler.js":
/*!***************************************!*\
  !*** ./source/js/document-handler.js ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DocumentHandler; });\n/* harmony import */ var lodash_maxby__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash.maxby */ \"./node_modules/lodash.maxby/index.js\");\n/* harmony import */ var lodash_maxby__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash_maxby__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _page_tools_overlay__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./page-tools-overlay */ \"./source/js/page-tools-overlay.js\");\n\n\n\n\nclass DocumentHandler\n{\n    constructor (viewerCore)\n    {\n        this._viewerCore = viewerCore;\n        this._viewerState = viewerCore.getInternalState();\n        this._overlays = [];\n\n        if (this._viewerCore.getPageTools().length)\n        {\n            const numPages = viewerCore.getSettings().numPages;\n\n            for (let i = 0; i < numPages; i++)\n            {\n                const overlay = new _page_tools_overlay__WEBPACK_IMPORTED_MODULE_1__[\"default\"](i, viewerCore);\n                this._overlays.push(overlay);\n                this._viewerCore.addPageOverlay(overlay);\n\n                // create dummy label for width calculation\n                // this is necessary because the _pageToolsElem is only created on mount\n                // so there's no other way to get its width before the pages are loaded\n                // (which we need to avoid their width temporarily being 0 while loading)\n                let dummyLabel = document.createElement('span');\n                dummyLabel.innerHTML = viewerCore.settings.manifest.pages[i].l;\n                dummyLabel.classList.add('diva-page-labels');\n                dummyLabel.setAttribute('style', 'display: inline-block;');\n                document.body.appendChild(dummyLabel);\n                let labelWidth = dummyLabel.clientWidth;\n                document.body.removeChild(dummyLabel);\n\n                overlay.labelWidth = labelWidth;\n            }\n        }\n    }\n\n    // USER EVENTS\n    onDoubleClick (event, coords)\n    {\n        const settings = this._viewerCore.getSettings();\n        const newZoomLevel = event.ctrlKey ? settings.zoomLevel - 1 : settings.zoomLevel + 1;\n\n        const position = this._viewerCore.getPagePositionAtViewportOffset(coords);\n        this._viewerCore.zoom(newZoomLevel, position);\n    }\n\n    onPinch (event, coords, startDistance, endDistance)\n    {\n        // FIXME: Do this check in a way which is less spaghetti code-y\n        const viewerState = this._viewerCore.getInternalState();\n        const settings = this._viewerCore.getSettings();\n\n        let newZoomLevel = Math.log(Math.pow(2, settings.zoomLevel) * endDistance / (startDistance * Math.log(2))) / Math.log(2);\n        newZoomLevel = Math.max(settings.minZoomLevel, newZoomLevel);\n        newZoomLevel = Math.min(settings.maxZoomLevel, newZoomLevel);\n\n        if (newZoomLevel === settings.zoomLevel)\n        {\n            return;\n        }\n\n        const position = this._viewerCore.getPagePositionAtViewportOffset(coords);\n\n        const layout = this._viewerCore.getCurrentLayout();\n        const centerOffset = layout.getPageToViewportCenterOffset(position.anchorPage, viewerState.viewport);\n        const scaleRatio = 1 / Math.pow(2, settings.zoomLevel - newZoomLevel);\n\n        this._viewerCore.reload({\n            zoomLevel: newZoomLevel,\n            goDirectlyTo: position.anchorPage,\n            horizontalOffset: (centerOffset.x - position.offset.left) + position.offset.left * scaleRatio,\n            verticalOffset: (centerOffset.y - position.offset.top) + position.offset.top * scaleRatio\n        });\n    }\n\n    // VIEW EVENTS\n    onViewWillLoad ()\n    {\n        this._viewerCore.publish('DocumentWillLoad', this._viewerCore.getSettings());\n    }\n\n    onViewDidLoad ()\n    {\n        // TODO: Should only be necessary to handle changes on view update, not\n        // initial load\n        this._handleZoomLevelChange();\n\n        const currentPageIndex = this._viewerCore.getSettings().activePageIndex;\n        const fileName = this._viewerCore.getPageName(currentPageIndex);\n        this._viewerCore.publish(\"DocumentDidLoad\", currentPageIndex, fileName);\n    }\n\n    onViewDidUpdate (renderedPages, targetPage)\n    {\n        const currentPage = (targetPage !== null) ?\n            targetPage :\n            getCentermostPage(renderedPages, this._viewerCore.getCurrentLayout(), this._viewerCore.getViewport());\n\n        // calculate the visible pages from the rendered pages\n        let temp = this._viewerState.viewport.intersectionTolerance;\n        // without setting to 0, isPageVisible returns true for pages out of viewport by intersectionTolerance\n        this._viewerState.viewport.intersectionTolerance = 0;\n        let visiblePages = renderedPages.filter(index => this._viewerState.renderer.isPageVisible(index));\n        // reset back to original value after getting true visible pages\n        this._viewerState.viewport.intersectionTolerance = temp;\n\n        // Don't change the current page if there is no page in the viewport\n        // FIXME: Would be better to fall back to the page closest to the viewport\n        if (currentPage !== null)\n        {\n            this._viewerCore.setCurrentPages(currentPage, visiblePages);\n        }\n\n        if (targetPage !== null)\n        {\n            this._viewerCore.publish(\"ViewerDidJump\", targetPage);\n        }\n\n        this._handleZoomLevelChange();\n    }\n\n    _handleZoomLevelChange ()\n    {\n        const viewerState = this._viewerState;\n        const zoomLevel = viewerState.options.zoomLevel;\n\n        // If this is not the initial load, trigger the zoom events\n        if (viewerState.oldZoomLevel !== zoomLevel && viewerState.oldZoomLevel >= 0)\n        {\n            if (viewerState.oldZoomLevel < zoomLevel)\n            {\n                this._viewerCore.publish(\"ViewerDidZoomIn\", zoomLevel);\n            }\n            else\n            {\n                this._viewerCore.publish(\"ViewerDidZoomOut\", zoomLevel);\n            }\n\n            this._viewerCore.publish(\"ViewerDidZoom\", zoomLevel);\n        }\n\n        viewerState.oldZoomLevel = zoomLevel;\n    }\n\n    destroy ()\n    {\n        this._overlays.forEach((overlay) =>\n        {\n            this._viewerCore.removePageOverlay(overlay);\n        }, this);\n    }\n}\n\nfunction getCentermostPage (renderedPages, layout, viewport)\n{\n    const centerY = viewport.top + (viewport.height / 2);\n    const centerX = viewport.left + (viewport.width / 2);\n\n    // Find the minimum distance from the viewport center to a page.\n    // Compute minus the squared distance from viewport center to the page's border.\n    // http://gamedev.stackexchange.com/questions/44483/how-do-i-calculate-distance-between-a-point-and-an-axis-aligned-rectangle\n    const centerPage = lodash_maxby__WEBPACK_IMPORTED_MODULE_0___default()(renderedPages, pageIndex =>\n    {\n        const dims = layout.getPageDimensions(pageIndex);\n        const imageOffset = layout.getPageOffset(pageIndex, {includePadding: false});\n\n        const midX = imageOffset.left + (dims.height / 2);\n        const midY = imageOffset.top + (dims.width / 2);\n\n        const dx = Math.max(Math.abs(centerX - midX) - (dims.width / 2), 0);\n        const dy = Math.max(Math.abs(centerY - midY) - (dims.height / 2), 0);\n\n        return -(dx * dx + dy * dy);\n    });\n\n    return centerPage != null ? centerPage : null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvZG9jdW1lbnQtaGFuZGxlci5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9qcy9kb2N1bWVudC1oYW5kbGVyLmpzPzcyNDciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1heEJ5IGZyb20gJ2xvZGFzaC5tYXhieSc7XG5pbXBvcnQgUGFnZVRvb2xzT3ZlcmxheSBmcm9tICcuL3BhZ2UtdG9vbHMtb3ZlcmxheSc7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRG9jdW1lbnRIYW5kbGVyXG57XG4gICAgY29uc3RydWN0b3IgKHZpZXdlckNvcmUpXG4gICAge1xuICAgICAgICB0aGlzLl92aWV3ZXJDb3JlID0gdmlld2VyQ29yZTtcbiAgICAgICAgdGhpcy5fdmlld2VyU3RhdGUgPSB2aWV3ZXJDb3JlLmdldEludGVybmFsU3RhdGUoKTtcbiAgICAgICAgdGhpcy5fb3ZlcmxheXMgPSBbXTtcblxuICAgICAgICBpZiAodGhpcy5fdmlld2VyQ29yZS5nZXRQYWdlVG9vbHMoKS5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IG51bVBhZ2VzID0gdmlld2VyQ29yZS5nZXRTZXR0aW5ncygpLm51bVBhZ2VzO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVBhZ2VzOyBpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3ZlcmxheSA9IG5ldyBQYWdlVG9vbHNPdmVybGF5KGksIHZpZXdlckNvcmUpO1xuICAgICAgICAgICAgICAgIHRoaXMuX292ZXJsYXlzLnB1c2gob3ZlcmxheSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdmlld2VyQ29yZS5hZGRQYWdlT3ZlcmxheShvdmVybGF5KTtcblxuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBkdW1teSBsYWJlbCBmb3Igd2lkdGggY2FsY3VsYXRpb25cbiAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHRoZSBfcGFnZVRvb2xzRWxlbSBpcyBvbmx5IGNyZWF0ZWQgb24gbW91bnRcbiAgICAgICAgICAgICAgICAvLyBzbyB0aGVyZSdzIG5vIG90aGVyIHdheSB0byBnZXQgaXRzIHdpZHRoIGJlZm9yZSB0aGUgcGFnZXMgYXJlIGxvYWRlZFxuICAgICAgICAgICAgICAgIC8vICh3aGljaCB3ZSBuZWVkIHRvIGF2b2lkIHRoZWlyIHdpZHRoIHRlbXBvcmFyaWx5IGJlaW5nIDAgd2hpbGUgbG9hZGluZylcbiAgICAgICAgICAgICAgICBsZXQgZHVtbXlMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgICAgICBkdW1teUxhYmVsLmlubmVySFRNTCA9IHZpZXdlckNvcmUuc2V0dGluZ3MubWFuaWZlc3QucGFnZXNbaV0ubDtcbiAgICAgICAgICAgICAgICBkdW1teUxhYmVsLmNsYXNzTGlzdC5hZGQoJ2RpdmEtcGFnZS1sYWJlbHMnKTtcbiAgICAgICAgICAgICAgICBkdW1teUxhYmVsLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTogaW5saW5lLWJsb2NrOycpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZHVtbXlMYWJlbCk7XG4gICAgICAgICAgICAgICAgbGV0IGxhYmVsV2lkdGggPSBkdW1teUxhYmVsLmNsaWVudFdpZHRoO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZHVtbXlMYWJlbCk7XG5cbiAgICAgICAgICAgICAgICBvdmVybGF5LmxhYmVsV2lkdGggPSBsYWJlbFdpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gVVNFUiBFVkVOVFNcbiAgICBvbkRvdWJsZUNsaWNrIChldmVudCwgY29vcmRzKVxuICAgIHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSB0aGlzLl92aWV3ZXJDb3JlLmdldFNldHRpbmdzKCk7XG4gICAgICAgIGNvbnN0IG5ld1pvb21MZXZlbCA9IGV2ZW50LmN0cmxLZXkgPyBzZXR0aW5ncy56b29tTGV2ZWwgLSAxIDogc2V0dGluZ3Muem9vbUxldmVsICsgMTtcblxuICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHRoaXMuX3ZpZXdlckNvcmUuZ2V0UGFnZVBvc2l0aW9uQXRWaWV3cG9ydE9mZnNldChjb29yZHMpO1xuICAgICAgICB0aGlzLl92aWV3ZXJDb3JlLnpvb20obmV3Wm9vbUxldmVsLCBwb3NpdGlvbik7XG4gICAgfVxuXG4gICAgb25QaW5jaCAoZXZlbnQsIGNvb3Jkcywgc3RhcnREaXN0YW5jZSwgZW5kRGlzdGFuY2UpXG4gICAge1xuICAgICAgICAvLyBGSVhNRTogRG8gdGhpcyBjaGVjayBpbiBhIHdheSB3aGljaCBpcyBsZXNzIHNwYWdoZXR0aSBjb2RlLXlcbiAgICAgICAgY29uc3Qgdmlld2VyU3RhdGUgPSB0aGlzLl92aWV3ZXJDb3JlLmdldEludGVybmFsU3RhdGUoKTtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSB0aGlzLl92aWV3ZXJDb3JlLmdldFNldHRpbmdzKCk7XG5cbiAgICAgICAgbGV0IG5ld1pvb21MZXZlbCA9IE1hdGgubG9nKE1hdGgucG93KDIsIHNldHRpbmdzLnpvb21MZXZlbCkgKiBlbmREaXN0YW5jZSAvIChzdGFydERpc3RhbmNlICogTWF0aC5sb2coMikpKSAvIE1hdGgubG9nKDIpO1xuICAgICAgICBuZXdab29tTGV2ZWwgPSBNYXRoLm1heChzZXR0aW5ncy5taW5ab29tTGV2ZWwsIG5ld1pvb21MZXZlbCk7XG4gICAgICAgIG5ld1pvb21MZXZlbCA9IE1hdGgubWluKHNldHRpbmdzLm1heFpvb21MZXZlbCwgbmV3Wm9vbUxldmVsKTtcblxuICAgICAgICBpZiAobmV3Wm9vbUxldmVsID09PSBzZXR0aW5ncy56b29tTGV2ZWwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5fdmlld2VyQ29yZS5nZXRQYWdlUG9zaXRpb25BdFZpZXdwb3J0T2Zmc2V0KGNvb3Jkcyk7XG5cbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5fdmlld2VyQ29yZS5nZXRDdXJyZW50TGF5b3V0KCk7XG4gICAgICAgIGNvbnN0IGNlbnRlck9mZnNldCA9IGxheW91dC5nZXRQYWdlVG9WaWV3cG9ydENlbnRlck9mZnNldChwb3NpdGlvbi5hbmNob3JQYWdlLCB2aWV3ZXJTdGF0ZS52aWV3cG9ydCk7XG4gICAgICAgIGNvbnN0IHNjYWxlUmF0aW8gPSAxIC8gTWF0aC5wb3coMiwgc2V0dGluZ3Muem9vbUxldmVsIC0gbmV3Wm9vbUxldmVsKTtcblxuICAgICAgICB0aGlzLl92aWV3ZXJDb3JlLnJlbG9hZCh7XG4gICAgICAgICAgICB6b29tTGV2ZWw6IG5ld1pvb21MZXZlbCxcbiAgICAgICAgICAgIGdvRGlyZWN0bHlUbzogcG9zaXRpb24uYW5jaG9yUGFnZSxcbiAgICAgICAgICAgIGhvcml6b250YWxPZmZzZXQ6IChjZW50ZXJPZmZzZXQueCAtIHBvc2l0aW9uLm9mZnNldC5sZWZ0KSArIHBvc2l0aW9uLm9mZnNldC5sZWZ0ICogc2NhbGVSYXRpbyxcbiAgICAgICAgICAgIHZlcnRpY2FsT2Zmc2V0OiAoY2VudGVyT2Zmc2V0LnkgLSBwb3NpdGlvbi5vZmZzZXQudG9wKSArIHBvc2l0aW9uLm9mZnNldC50b3AgKiBzY2FsZVJhdGlvXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFZJRVcgRVZFTlRTXG4gICAgb25WaWV3V2lsbExvYWQgKClcbiAgICB7XG4gICAgICAgIHRoaXMuX3ZpZXdlckNvcmUucHVibGlzaCgnRG9jdW1lbnRXaWxsTG9hZCcsIHRoaXMuX3ZpZXdlckNvcmUuZ2V0U2V0dGluZ3MoKSk7XG4gICAgfVxuXG4gICAgb25WaWV3RGlkTG9hZCAoKVxuICAgIHtcbiAgICAgICAgLy8gVE9ETzogU2hvdWxkIG9ubHkgYmUgbmVjZXNzYXJ5IHRvIGhhbmRsZSBjaGFuZ2VzIG9uIHZpZXcgdXBkYXRlLCBub3RcbiAgICAgICAgLy8gaW5pdGlhbCBsb2FkXG4gICAgICAgIHRoaXMuX2hhbmRsZVpvb21MZXZlbENoYW5nZSgpO1xuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRQYWdlSW5kZXggPSB0aGlzLl92aWV3ZXJDb3JlLmdldFNldHRpbmdzKCkuYWN0aXZlUGFnZUluZGV4O1xuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IHRoaXMuX3ZpZXdlckNvcmUuZ2V0UGFnZU5hbWUoY3VycmVudFBhZ2VJbmRleCk7XG4gICAgICAgIHRoaXMuX3ZpZXdlckNvcmUucHVibGlzaChcIkRvY3VtZW50RGlkTG9hZFwiLCBjdXJyZW50UGFnZUluZGV4LCBmaWxlTmFtZSk7XG4gICAgfVxuXG4gICAgb25WaWV3RGlkVXBkYXRlIChyZW5kZXJlZFBhZ2VzLCB0YXJnZXRQYWdlKVxuICAgIHtcbiAgICAgICAgY29uc3QgY3VycmVudFBhZ2UgPSAodGFyZ2V0UGFnZSAhPT0gbnVsbCkgP1xuICAgICAgICAgICAgdGFyZ2V0UGFnZSA6XG4gICAgICAgICAgICBnZXRDZW50ZXJtb3N0UGFnZShyZW5kZXJlZFBhZ2VzLCB0aGlzLl92aWV3ZXJDb3JlLmdldEN1cnJlbnRMYXlvdXQoKSwgdGhpcy5fdmlld2VyQ29yZS5nZXRWaWV3cG9ydCgpKTtcblxuICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIHZpc2libGUgcGFnZXMgZnJvbSB0aGUgcmVuZGVyZWQgcGFnZXNcbiAgICAgICAgbGV0IHRlbXAgPSB0aGlzLl92aWV3ZXJTdGF0ZS52aWV3cG9ydC5pbnRlcnNlY3Rpb25Ub2xlcmFuY2U7XG4gICAgICAgIC8vIHdpdGhvdXQgc2V0dGluZyB0byAwLCBpc1BhZ2VWaXNpYmxlIHJldHVybnMgdHJ1ZSBmb3IgcGFnZXMgb3V0IG9mIHZpZXdwb3J0IGJ5IGludGVyc2VjdGlvblRvbGVyYW5jZVxuICAgICAgICB0aGlzLl92aWV3ZXJTdGF0ZS52aWV3cG9ydC5pbnRlcnNlY3Rpb25Ub2xlcmFuY2UgPSAwO1xuICAgICAgICBsZXQgdmlzaWJsZVBhZ2VzID0gcmVuZGVyZWRQYWdlcy5maWx0ZXIoaW5kZXggPT4gdGhpcy5fdmlld2VyU3RhdGUucmVuZGVyZXIuaXNQYWdlVmlzaWJsZShpbmRleCkpO1xuICAgICAgICAvLyByZXNldCBiYWNrIHRvIG9yaWdpbmFsIHZhbHVlIGFmdGVyIGdldHRpbmcgdHJ1ZSB2aXNpYmxlIHBhZ2VzXG4gICAgICAgIHRoaXMuX3ZpZXdlclN0YXRlLnZpZXdwb3J0LmludGVyc2VjdGlvblRvbGVyYW5jZSA9IHRlbXA7XG5cbiAgICAgICAgLy8gRG9uJ3QgY2hhbmdlIHRoZSBjdXJyZW50IHBhZ2UgaWYgdGhlcmUgaXMgbm8gcGFnZSBpbiB0aGUgdmlld3BvcnRcbiAgICAgICAgLy8gRklYTUU6IFdvdWxkIGJlIGJldHRlciB0byBmYWxsIGJhY2sgdG8gdGhlIHBhZ2UgY2xvc2VzdCB0byB0aGUgdmlld3BvcnRcbiAgICAgICAgaWYgKGN1cnJlbnRQYWdlICE9PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl92aWV3ZXJDb3JlLnNldEN1cnJlbnRQYWdlcyhjdXJyZW50UGFnZSwgdmlzaWJsZVBhZ2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0YXJnZXRQYWdlICE9PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl92aWV3ZXJDb3JlLnB1Ymxpc2goXCJWaWV3ZXJEaWRKdW1wXCIsIHRhcmdldFBhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5faGFuZGxlWm9vbUxldmVsQ2hhbmdlKCk7XG4gICAgfVxuXG4gICAgX2hhbmRsZVpvb21MZXZlbENoYW5nZSAoKVxuICAgIHtcbiAgICAgICAgY29uc3Qgdmlld2VyU3RhdGUgPSB0aGlzLl92aWV3ZXJTdGF0ZTtcbiAgICAgICAgY29uc3Qgem9vbUxldmVsID0gdmlld2VyU3RhdGUub3B0aW9ucy56b29tTGV2ZWw7XG5cbiAgICAgICAgLy8gSWYgdGhpcyBpcyBub3QgdGhlIGluaXRpYWwgbG9hZCwgdHJpZ2dlciB0aGUgem9vbSBldmVudHNcbiAgICAgICAgaWYgKHZpZXdlclN0YXRlLm9sZFpvb21MZXZlbCAhPT0gem9vbUxldmVsICYmIHZpZXdlclN0YXRlLm9sZFpvb21MZXZlbCA+PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodmlld2VyU3RhdGUub2xkWm9vbUxldmVsIDwgem9vbUxldmVsKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXdlckNvcmUucHVibGlzaChcIlZpZXdlckRpZFpvb21JblwiLCB6b29tTGV2ZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXdlckNvcmUucHVibGlzaChcIlZpZXdlckRpZFpvb21PdXRcIiwgem9vbUxldmVsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fdmlld2VyQ29yZS5wdWJsaXNoKFwiVmlld2VyRGlkWm9vbVwiLCB6b29tTGV2ZWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmlld2VyU3RhdGUub2xkWm9vbUxldmVsID0gem9vbUxldmVsO1xuICAgIH1cblxuICAgIGRlc3Ryb3kgKClcbiAgICB7XG4gICAgICAgIHRoaXMuX292ZXJsYXlzLmZvckVhY2goKG92ZXJsYXkpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3ZpZXdlckNvcmUucmVtb3ZlUGFnZU92ZXJsYXkob3ZlcmxheSk7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0Q2VudGVybW9zdFBhZ2UgKHJlbmRlcmVkUGFnZXMsIGxheW91dCwgdmlld3BvcnQpXG57XG4gICAgY29uc3QgY2VudGVyWSA9IHZpZXdwb3J0LnRvcCArICh2aWV3cG9ydC5oZWlnaHQgLyAyKTtcbiAgICBjb25zdCBjZW50ZXJYID0gdmlld3BvcnQubGVmdCArICh2aWV3cG9ydC53aWR0aCAvIDIpO1xuXG4gICAgLy8gRmluZCB0aGUgbWluaW11bSBkaXN0YW5jZSBmcm9tIHRoZSB2aWV3cG9ydCBjZW50ZXIgdG8gYSBwYWdlLlxuICAgIC8vIENvbXB1dGUgbWludXMgdGhlIHNxdWFyZWQgZGlzdGFuY2UgZnJvbSB2aWV3cG9ydCBjZW50ZXIgdG8gdGhlIHBhZ2UncyBib3JkZXIuXG4gICAgLy8gaHR0cDovL2dhbWVkZXYuc3RhY2tleGNoYW5nZS5jb20vcXVlc3Rpb25zLzQ0NDgzL2hvdy1kby1pLWNhbGN1bGF0ZS1kaXN0YW5jZS1iZXR3ZWVuLWEtcG9pbnQtYW5kLWFuLWF4aXMtYWxpZ25lZC1yZWN0YW5nbGVcbiAgICBjb25zdCBjZW50ZXJQYWdlID0gbWF4QnkocmVuZGVyZWRQYWdlcywgcGFnZUluZGV4ID0+XG4gICAge1xuICAgICAgICBjb25zdCBkaW1zID0gbGF5b3V0LmdldFBhZ2VEaW1lbnNpb25zKHBhZ2VJbmRleCk7XG4gICAgICAgIGNvbnN0IGltYWdlT2Zmc2V0ID0gbGF5b3V0LmdldFBhZ2VPZmZzZXQocGFnZUluZGV4LCB7aW5jbHVkZVBhZGRpbmc6IGZhbHNlfSk7XG5cbiAgICAgICAgY29uc3QgbWlkWCA9IGltYWdlT2Zmc2V0LmxlZnQgKyAoZGltcy5oZWlnaHQgLyAyKTtcbiAgICAgICAgY29uc3QgbWlkWSA9IGltYWdlT2Zmc2V0LnRvcCArIChkaW1zLndpZHRoIC8gMik7XG5cbiAgICAgICAgY29uc3QgZHggPSBNYXRoLm1heChNYXRoLmFicyhjZW50ZXJYIC0gbWlkWCkgLSAoZGltcy53aWR0aCAvIDIpLCAwKTtcbiAgICAgICAgY29uc3QgZHkgPSBNYXRoLm1heChNYXRoLmFicyhjZW50ZXJZIC0gbWlkWSkgLSAoZGltcy5oZWlnaHQgLyAyKSwgMCk7XG5cbiAgICAgICAgcmV0dXJuIC0oZHggKiBkeCArIGR5ICogZHkpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNlbnRlclBhZ2UgIT0gbnVsbCA/IGNlbnRlclBhZ2UgOiBudWxsO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/document-handler.js\n");

/***/ }),

/***/ "./source/js/document-layout.js":
/*!**************************************!*\
  !*** ./source/js/document-layout.js ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DocumentLayout; });\n/**\n * Translate page layouts, as generated by page-layouts, into an\n * object which computes layout information for the document as\n * a whole.\n */\nclass DocumentLayout\n{\n    constructor (config, zoomLevel)\n    {\n        const computedLayout = getComputedLayout(config, zoomLevel);\n\n        this.dimensions = computedLayout.dimensions;\n        this.pageGroups = computedLayout.pageGroups;\n        this._pageLookup = getPageLookup(computedLayout.pageGroups);\n    }\n\n    /**\n     * @typedef {Object} PageInfo\n     * @property {number} index\n     * @property {{index, dimensions, pages, region, padding}} group\n     * @property {{height: number, width: number}} dimensions\n     * @property {{top: number, left: number}} groupOffset\n     */\n\n    /**\n     * @param pageIndex\n     * @returns {PageInfo|null}\n     */\n    getPageInfo (pageIndex)\n    {\n        return this._pageLookup[pageIndex] || null;\n    }\n\n    /**\n     * Get the dimensions of a page\n     *\n     * @param pageIndex\n     * @returns {{height: number, width: number}}\n     */\n    getPageDimensions (pageIndex)\n    {\n        if (!this._pageLookup || !this._pageLookup[pageIndex])\n            return null;\n\n        const region = getPageRegionFromPageInfo(this._pageLookup[pageIndex]);\n\n        return {\n            height: region.bottom - region.top,\n            width: region.right - region.left\n        };\n    }\n\n    // TODO(wabain): Get rid of this; it's a subset of the page region, so\n    // give that instead\n    /**\n     * Get the top-left coordinates of a page, including*** padding\n     *\n     * @param pageIndex\n     * @param options\n     * @returns {{top: number, left: number} | null}\n     */\n    getPageOffset (pageIndex, options)\n    {\n        const region = this.getPageRegion(pageIndex, options);\n\n        if (!region)\n            return null;\n\n        return {\n            top: region.top,\n            left: region.left\n        };\n    }\n\n    getPageRegion (pageIndex, options)\n    {\n        const pageInfo = this._pageLookup[pageIndex];\n\n        if (!pageInfo)\n            return null;\n\n        const region = getPageRegionFromPageInfo(pageInfo);\n        const padding = pageInfo.group.padding;\n\n        if (options && options.includePadding)\n        {\n            return {\n                top: region.top + padding.top,\n                left: region.left + padding.left,\n                bottom: region.bottom,\n                right: region.right\n            };\n        }\n\n        return {\n            top: region.top,\n            left: region.left,\n            // need to account for plugin icons below the page, see \n            // https://github.com/DDMAL/diva.js/issues/436\n            bottom: region.bottom + padding.top, \n            right: region.right\n        };\n    }\n\n    /**\n     * Get the distance from the top-right of the page to the center of the\n     * specified viewport region\n     *\n     * @param pageIndex\n     * @param viewport {{top: number, left: number, bottom: number, right: number}}\n     * @returns {{x: number, y: number}}\n     */\n    getPageToViewportCenterOffset (pageIndex, viewport)\n    {\n        const scrollLeft = viewport.left;\n        const elementWidth = viewport.right - viewport.left;\n\n        const offset = this.getPageOffset(pageIndex);\n\n        const x = scrollLeft - offset.left + parseInt(elementWidth / 2, 10);\n\n        const scrollTop = viewport.top;\n        const elementHeight = viewport.bottom - viewport.top;\n\n        const y = scrollTop - offset.top + parseInt(elementHeight / 2, 10);\n\n        return {\n            x: x,\n            y: y\n        };\n    }\n}\n\nfunction getPageRegionFromPageInfo (page)\n{\n    const top    = page.groupOffset.top  + page.group.region.top;\n    const bottom = top + page.dimensions.height;\n    const left   = page.groupOffset.left + page.group.region.left;\n    const right  = left + page.dimensions.width;\n\n    return {\n        top: top,\n        bottom: bottom,\n        left: left,\n        right: right\n    };\n}\n\nfunction getPageLookup (pageGroups)\n{\n    const pageLookup = {};\n\n    pageGroups.forEach(group => {\n        group.pages.forEach(page => {\n            pageLookup[page.index] = {\n                index: page.index,\n                group: group,\n                dimensions: page.dimensions,\n                groupOffset: page.groupOffset\n            };\n        });\n    });\n\n    return pageLookup;\n}\n\nfunction getComputedLayout (config, zoomLevel)\n{\n    const scaledLayouts = zoomLevel === null ? config.pageLayouts : getScaledPageLayouts(config, zoomLevel);\n\n    const documentSecondaryExtent = getExtentAlongSecondaryAxis(config, scaledLayouts);\n\n    // The current position in the document along the primary axis\n    let primaryDocPosition = config.verticallyOriented ?\n        config.padding.document.top :\n        config.padding.document.left;\n\n    const pageGroups = [];\n\n    // TODO: Use bottom, right as well\n    const pagePadding = {\n        top: config.padding.page.top,\n        left: config.padding.page.left\n    };\n\n    scaledLayouts.forEach((layout, index) => {\n        let top, left;\n\n        if (config.verticallyOriented)\n        {\n            top = primaryDocPosition;\n            left = (documentSecondaryExtent - layout.dimensions.width) / 2;\n        }\n        else\n        {\n            top = (documentSecondaryExtent - layout.dimensions.height) / 2;\n            left = primaryDocPosition;\n        }\n\n        const region = {\n            top: top,\n            bottom: top + pagePadding.top + layout.dimensions.height,\n            left: left,\n            right: left + pagePadding.left + layout.dimensions.width\n        };\n\n        pageGroups.push({\n            index: index,\n            dimensions: layout.dimensions,\n            pages: layout.pages,\n            region: region,\n            padding: pagePadding\n        });\n\n        primaryDocPosition = config.verticallyOriented ? region.bottom : region.right;\n    });\n\n    let height, width;\n\n    if (config.verticallyOriented)\n    {\n        height = primaryDocPosition + pagePadding.top;\n        width = documentSecondaryExtent;\n    }\n    else\n    {\n        height = documentSecondaryExtent;\n        width = primaryDocPosition + pagePadding.left;\n    }\n\n    return {\n        dimensions: {\n            height: height,\n            width: width\n        },\n        pageGroups: pageGroups\n    };\n}\n\nfunction getScaledPageLayouts (config, zoomLevel)\n{\n    const scaleRatio = Math.pow(2, zoomLevel - config.maxZoomLevel);\n\n    return config.pageLayouts.map(group => ({\n        dimensions: scaleDimensions(group.dimensions, scaleRatio),\n\n        pages: group.pages.map(page => ({\n            index: page.index,\n\n            groupOffset: {\n                top: Math.floor(page.groupOffset.top * scaleRatio),\n                left: Math.floor(page.groupOffset.left * scaleRatio)\n            },\n\n            dimensions: scaleDimensions(page.dimensions, scaleRatio)\n        }))\n    }));\n}\n\nfunction scaleDimensions (dimensions, scaleRatio)\n{\n    return {\n        height: Math.floor(dimensions.height * scaleRatio),\n        width: Math.floor(dimensions.width * scaleRatio)\n    };\n}\n\nfunction getExtentAlongSecondaryAxis (config, scaledLayouts)\n{\n    // Get the extent of the document along the secondary axis\n    let secondaryDim, secondaryPadding;\n    const docPadding = config.padding.document;\n\n    if (config.verticallyOriented)\n    {\n        secondaryDim = 'width';\n        secondaryPadding = docPadding.left + docPadding.right;\n    }\n    else\n    {\n        secondaryDim = 'height';\n        secondaryPadding = docPadding.top + docPadding.bottom;\n    }\n\n    return secondaryPadding + scaledLayouts.reduce((maxDim, layout) => Math.max(layout.dimensions[secondaryDim], maxDim), 0);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvZG9jdW1lbnQtbGF5b3V0LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL2RvY3VtZW50LWxheW91dC5qcz9hMGEwIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVHJhbnNsYXRlIHBhZ2UgbGF5b3V0cywgYXMgZ2VuZXJhdGVkIGJ5IHBhZ2UtbGF5b3V0cywgaW50byBhblxuICogb2JqZWN0IHdoaWNoIGNvbXB1dGVzIGxheW91dCBpbmZvcm1hdGlvbiBmb3IgdGhlIGRvY3VtZW50IGFzXG4gKiBhIHdob2xlLlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEb2N1bWVudExheW91dFxue1xuICAgIGNvbnN0cnVjdG9yIChjb25maWcsIHpvb21MZXZlbClcbiAgICB7XG4gICAgICAgIGNvbnN0IGNvbXB1dGVkTGF5b3V0ID0gZ2V0Q29tcHV0ZWRMYXlvdXQoY29uZmlnLCB6b29tTGV2ZWwpO1xuXG4gICAgICAgIHRoaXMuZGltZW5zaW9ucyA9IGNvbXB1dGVkTGF5b3V0LmRpbWVuc2lvbnM7XG4gICAgICAgIHRoaXMucGFnZUdyb3VwcyA9IGNvbXB1dGVkTGF5b3V0LnBhZ2VHcm91cHM7XG4gICAgICAgIHRoaXMuX3BhZ2VMb29rdXAgPSBnZXRQYWdlTG9va3VwKGNvbXB1dGVkTGF5b3V0LnBhZ2VHcm91cHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEB0eXBlZGVmIHtPYmplY3R9IFBhZ2VJbmZvXG4gICAgICogQHByb3BlcnR5IHtudW1iZXJ9IGluZGV4XG4gICAgICogQHByb3BlcnR5IHt7aW5kZXgsIGRpbWVuc2lvbnMsIHBhZ2VzLCByZWdpb24sIHBhZGRpbmd9fSBncm91cFxuICAgICAqIEBwcm9wZXJ0eSB7e2hlaWdodDogbnVtYmVyLCB3aWR0aDogbnVtYmVyfX0gZGltZW5zaW9uc1xuICAgICAqIEBwcm9wZXJ0eSB7e3RvcDogbnVtYmVyLCBsZWZ0OiBudW1iZXJ9fSBncm91cE9mZnNldFxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHBhZ2VJbmRleFxuICAgICAqIEByZXR1cm5zIHtQYWdlSW5mb3xudWxsfVxuICAgICAqL1xuICAgIGdldFBhZ2VJbmZvIChwYWdlSW5kZXgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFnZUxvb2t1cFtwYWdlSW5kZXhdIHx8IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBkaW1lbnNpb25zIG9mIGEgcGFnZVxuICAgICAqXG4gICAgICogQHBhcmFtIHBhZ2VJbmRleFxuICAgICAqIEByZXR1cm5zIHt7aGVpZ2h0OiBudW1iZXIsIHdpZHRoOiBudW1iZXJ9fVxuICAgICAqL1xuICAgIGdldFBhZ2VEaW1lbnNpb25zIChwYWdlSW5kZXgpXG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuX3BhZ2VMb29rdXAgfHwgIXRoaXMuX3BhZ2VMb29rdXBbcGFnZUluZGV4XSlcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuXG4gICAgICAgIGNvbnN0IHJlZ2lvbiA9IGdldFBhZ2VSZWdpb25Gcm9tUGFnZUluZm8odGhpcy5fcGFnZUxvb2t1cFtwYWdlSW5kZXhdKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaGVpZ2h0OiByZWdpb24uYm90dG9tIC0gcmVnaW9uLnRvcCxcbiAgICAgICAgICAgIHdpZHRoOiByZWdpb24ucmlnaHQgLSByZWdpb24ubGVmdFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIFRPRE8od2FiYWluKTogR2V0IHJpZCBvZiB0aGlzOyBpdCdzIGEgc3Vic2V0IG9mIHRoZSBwYWdlIHJlZ2lvbiwgc29cbiAgICAvLyBnaXZlIHRoYXQgaW5zdGVhZFxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgdG9wLWxlZnQgY29vcmRpbmF0ZXMgb2YgYSBwYWdlLCBpbmNsdWRpbmcqKiogcGFkZGluZ1xuICAgICAqXG4gICAgICogQHBhcmFtIHBhZ2VJbmRleFxuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICogQHJldHVybnMge3t0b3A6IG51bWJlciwgbGVmdDogbnVtYmVyfSB8IG51bGx9XG4gICAgICovXG4gICAgZ2V0UGFnZU9mZnNldCAocGFnZUluZGV4LCBvcHRpb25zKVxuICAgIHtcbiAgICAgICAgY29uc3QgcmVnaW9uID0gdGhpcy5nZXRQYWdlUmVnaW9uKHBhZ2VJbmRleCwgb3B0aW9ucyk7XG5cbiAgICAgICAgaWYgKCFyZWdpb24pXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdG9wOiByZWdpb24udG9wLFxuICAgICAgICAgICAgbGVmdDogcmVnaW9uLmxlZnRcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBnZXRQYWdlUmVnaW9uIChwYWdlSW5kZXgsIG9wdGlvbnMpXG4gICAge1xuICAgICAgICBjb25zdCBwYWdlSW5mbyA9IHRoaXMuX3BhZ2VMb29rdXBbcGFnZUluZGV4XTtcblxuICAgICAgICBpZiAoIXBhZ2VJbmZvKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3QgcmVnaW9uID0gZ2V0UGFnZVJlZ2lvbkZyb21QYWdlSW5mbyhwYWdlSW5mbyk7XG4gICAgICAgIGNvbnN0IHBhZGRpbmcgPSBwYWdlSW5mby5ncm91cC5wYWRkaW5nO1xuXG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZVBhZGRpbmcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdG9wOiByZWdpb24udG9wICsgcGFkZGluZy50b3AsXG4gICAgICAgICAgICAgICAgbGVmdDogcmVnaW9uLmxlZnQgKyBwYWRkaW5nLmxlZnQsXG4gICAgICAgICAgICAgICAgYm90dG9tOiByZWdpb24uYm90dG9tLFxuICAgICAgICAgICAgICAgIHJpZ2h0OiByZWdpb24ucmlnaHRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdG9wOiByZWdpb24udG9wLFxuICAgICAgICAgICAgbGVmdDogcmVnaW9uLmxlZnQsXG4gICAgICAgICAgICAvLyBuZWVkIHRvIGFjY291bnQgZm9yIHBsdWdpbiBpY29ucyBiZWxvdyB0aGUgcGFnZSwgc2VlIFxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL0RETUFML2RpdmEuanMvaXNzdWVzLzQzNlxuICAgICAgICAgICAgYm90dG9tOiByZWdpb24uYm90dG9tICsgcGFkZGluZy50b3AsIFxuICAgICAgICAgICAgcmlnaHQ6IHJlZ2lvbi5yaWdodFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgdG9wLXJpZ2h0IG9mIHRoZSBwYWdlIHRvIHRoZSBjZW50ZXIgb2YgdGhlXG4gICAgICogc3BlY2lmaWVkIHZpZXdwb3J0IHJlZ2lvblxuICAgICAqXG4gICAgICogQHBhcmFtIHBhZ2VJbmRleFxuICAgICAqIEBwYXJhbSB2aWV3cG9ydCB7e3RvcDogbnVtYmVyLCBsZWZ0OiBudW1iZXIsIGJvdHRvbTogbnVtYmVyLCByaWdodDogbnVtYmVyfX1cbiAgICAgKiBAcmV0dXJucyB7e3g6IG51bWJlciwgeTogbnVtYmVyfX1cbiAgICAgKi9cbiAgICBnZXRQYWdlVG9WaWV3cG9ydENlbnRlck9mZnNldCAocGFnZUluZGV4LCB2aWV3cG9ydClcbiAgICB7XG4gICAgICAgIGNvbnN0IHNjcm9sbExlZnQgPSB2aWV3cG9ydC5sZWZ0O1xuICAgICAgICBjb25zdCBlbGVtZW50V2lkdGggPSB2aWV3cG9ydC5yaWdodCAtIHZpZXdwb3J0LmxlZnQ7XG5cbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gdGhpcy5nZXRQYWdlT2Zmc2V0KHBhZ2VJbmRleCk7XG5cbiAgICAgICAgY29uc3QgeCA9IHNjcm9sbExlZnQgLSBvZmZzZXQubGVmdCArIHBhcnNlSW50KGVsZW1lbnRXaWR0aCAvIDIsIDEwKTtcblxuICAgICAgICBjb25zdCBzY3JvbGxUb3AgPSB2aWV3cG9ydC50b3A7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRIZWlnaHQgPSB2aWV3cG9ydC5ib3R0b20gLSB2aWV3cG9ydC50b3A7XG5cbiAgICAgICAgY29uc3QgeSA9IHNjcm9sbFRvcCAtIG9mZnNldC50b3AgKyBwYXJzZUludChlbGVtZW50SGVpZ2h0IC8gMiwgMTApO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgeTogeVxuICAgICAgICB9O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0UGFnZVJlZ2lvbkZyb21QYWdlSW5mbyAocGFnZSlcbntcbiAgICBjb25zdCB0b3AgICAgPSBwYWdlLmdyb3VwT2Zmc2V0LnRvcCAgKyBwYWdlLmdyb3VwLnJlZ2lvbi50b3A7XG4gICAgY29uc3QgYm90dG9tID0gdG9wICsgcGFnZS5kaW1lbnNpb25zLmhlaWdodDtcbiAgICBjb25zdCBsZWZ0ICAgPSBwYWdlLmdyb3VwT2Zmc2V0LmxlZnQgKyBwYWdlLmdyb3VwLnJlZ2lvbi5sZWZ0O1xuICAgIGNvbnN0IHJpZ2h0ICA9IGxlZnQgKyBwYWdlLmRpbWVuc2lvbnMud2lkdGg7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICB0b3A6IHRvcCxcbiAgICAgICAgYm90dG9tOiBib3R0b20sXG4gICAgICAgIGxlZnQ6IGxlZnQsXG4gICAgICAgIHJpZ2h0OiByaWdodFxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGdldFBhZ2VMb29rdXAgKHBhZ2VHcm91cHMpXG57XG4gICAgY29uc3QgcGFnZUxvb2t1cCA9IHt9O1xuXG4gICAgcGFnZUdyb3Vwcy5mb3JFYWNoKGdyb3VwID0+IHtcbiAgICAgICAgZ3JvdXAucGFnZXMuZm9yRWFjaChwYWdlID0+IHtcbiAgICAgICAgICAgIHBhZ2VMb29rdXBbcGFnZS5pbmRleF0gPSB7XG4gICAgICAgICAgICAgICAgaW5kZXg6IHBhZ2UuaW5kZXgsXG4gICAgICAgICAgICAgICAgZ3JvdXA6IGdyb3VwLFxuICAgICAgICAgICAgICAgIGRpbWVuc2lvbnM6IHBhZ2UuZGltZW5zaW9ucyxcbiAgICAgICAgICAgICAgICBncm91cE9mZnNldDogcGFnZS5ncm91cE9mZnNldFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcGFnZUxvb2t1cDtcbn1cblxuZnVuY3Rpb24gZ2V0Q29tcHV0ZWRMYXlvdXQgKGNvbmZpZywgem9vbUxldmVsKVxue1xuICAgIGNvbnN0IHNjYWxlZExheW91dHMgPSB6b29tTGV2ZWwgPT09IG51bGwgPyBjb25maWcucGFnZUxheW91dHMgOiBnZXRTY2FsZWRQYWdlTGF5b3V0cyhjb25maWcsIHpvb21MZXZlbCk7XG5cbiAgICBjb25zdCBkb2N1bWVudFNlY29uZGFyeUV4dGVudCA9IGdldEV4dGVudEFsb25nU2Vjb25kYXJ5QXhpcyhjb25maWcsIHNjYWxlZExheW91dHMpO1xuXG4gICAgLy8gVGhlIGN1cnJlbnQgcG9zaXRpb24gaW4gdGhlIGRvY3VtZW50IGFsb25nIHRoZSBwcmltYXJ5IGF4aXNcbiAgICBsZXQgcHJpbWFyeURvY1Bvc2l0aW9uID0gY29uZmlnLnZlcnRpY2FsbHlPcmllbnRlZCA/XG4gICAgICAgIGNvbmZpZy5wYWRkaW5nLmRvY3VtZW50LnRvcCA6XG4gICAgICAgIGNvbmZpZy5wYWRkaW5nLmRvY3VtZW50LmxlZnQ7XG5cbiAgICBjb25zdCBwYWdlR3JvdXBzID0gW107XG5cbiAgICAvLyBUT0RPOiBVc2UgYm90dG9tLCByaWdodCBhcyB3ZWxsXG4gICAgY29uc3QgcGFnZVBhZGRpbmcgPSB7XG4gICAgICAgIHRvcDogY29uZmlnLnBhZGRpbmcucGFnZS50b3AsXG4gICAgICAgIGxlZnQ6IGNvbmZpZy5wYWRkaW5nLnBhZ2UubGVmdFxuICAgIH07XG5cbiAgICBzY2FsZWRMYXlvdXRzLmZvckVhY2goKGxheW91dCwgaW5kZXgpID0+IHtcbiAgICAgICAgbGV0IHRvcCwgbGVmdDtcblxuICAgICAgICBpZiAoY29uZmlnLnZlcnRpY2FsbHlPcmllbnRlZClcbiAgICAgICAge1xuICAgICAgICAgICAgdG9wID0gcHJpbWFyeURvY1Bvc2l0aW9uO1xuICAgICAgICAgICAgbGVmdCA9IChkb2N1bWVudFNlY29uZGFyeUV4dGVudCAtIGxheW91dC5kaW1lbnNpb25zLndpZHRoKSAvIDI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0b3AgPSAoZG9jdW1lbnRTZWNvbmRhcnlFeHRlbnQgLSBsYXlvdXQuZGltZW5zaW9ucy5oZWlnaHQpIC8gMjtcbiAgICAgICAgICAgIGxlZnQgPSBwcmltYXJ5RG9jUG9zaXRpb247XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZWdpb24gPSB7XG4gICAgICAgICAgICB0b3A6IHRvcCxcbiAgICAgICAgICAgIGJvdHRvbTogdG9wICsgcGFnZVBhZGRpbmcudG9wICsgbGF5b3V0LmRpbWVuc2lvbnMuaGVpZ2h0LFxuICAgICAgICAgICAgbGVmdDogbGVmdCxcbiAgICAgICAgICAgIHJpZ2h0OiBsZWZ0ICsgcGFnZVBhZGRpbmcubGVmdCArIGxheW91dC5kaW1lbnNpb25zLndpZHRoXG4gICAgICAgIH07XG5cbiAgICAgICAgcGFnZUdyb3Vwcy5wdXNoKHtcbiAgICAgICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgICAgIGRpbWVuc2lvbnM6IGxheW91dC5kaW1lbnNpb25zLFxuICAgICAgICAgICAgcGFnZXM6IGxheW91dC5wYWdlcyxcbiAgICAgICAgICAgIHJlZ2lvbjogcmVnaW9uLFxuICAgICAgICAgICAgcGFkZGluZzogcGFnZVBhZGRpbmdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcHJpbWFyeURvY1Bvc2l0aW9uID0gY29uZmlnLnZlcnRpY2FsbHlPcmllbnRlZCA/IHJlZ2lvbi5ib3R0b20gOiByZWdpb24ucmlnaHQ7XG4gICAgfSk7XG5cbiAgICBsZXQgaGVpZ2h0LCB3aWR0aDtcblxuICAgIGlmIChjb25maWcudmVydGljYWxseU9yaWVudGVkKVxuICAgIHtcbiAgICAgICAgaGVpZ2h0ID0gcHJpbWFyeURvY1Bvc2l0aW9uICsgcGFnZVBhZGRpbmcudG9wO1xuICAgICAgICB3aWR0aCA9IGRvY3VtZW50U2Vjb25kYXJ5RXh0ZW50O1xuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgICBoZWlnaHQgPSBkb2N1bWVudFNlY29uZGFyeUV4dGVudDtcbiAgICAgICAgd2lkdGggPSBwcmltYXJ5RG9jUG9zaXRpb24gKyBwYWdlUGFkZGluZy5sZWZ0O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGRpbWVuc2lvbnM6IHtcbiAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LFxuICAgICAgICAgICAgd2lkdGg6IHdpZHRoXG4gICAgICAgIH0sXG4gICAgICAgIHBhZ2VHcm91cHM6IHBhZ2VHcm91cHNcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBnZXRTY2FsZWRQYWdlTGF5b3V0cyAoY29uZmlnLCB6b29tTGV2ZWwpXG57XG4gICAgY29uc3Qgc2NhbGVSYXRpbyA9IE1hdGgucG93KDIsIHpvb21MZXZlbCAtIGNvbmZpZy5tYXhab29tTGV2ZWwpO1xuXG4gICAgcmV0dXJuIGNvbmZpZy5wYWdlTGF5b3V0cy5tYXAoZ3JvdXAgPT4gKHtcbiAgICAgICAgZGltZW5zaW9uczogc2NhbGVEaW1lbnNpb25zKGdyb3VwLmRpbWVuc2lvbnMsIHNjYWxlUmF0aW8pLFxuXG4gICAgICAgIHBhZ2VzOiBncm91cC5wYWdlcy5tYXAocGFnZSA9PiAoe1xuICAgICAgICAgICAgaW5kZXg6IHBhZ2UuaW5kZXgsXG5cbiAgICAgICAgICAgIGdyb3VwT2Zmc2V0OiB7XG4gICAgICAgICAgICAgICAgdG9wOiBNYXRoLmZsb29yKHBhZ2UuZ3JvdXBPZmZzZXQudG9wICogc2NhbGVSYXRpbyksXG4gICAgICAgICAgICAgICAgbGVmdDogTWF0aC5mbG9vcihwYWdlLmdyb3VwT2Zmc2V0LmxlZnQgKiBzY2FsZVJhdGlvKVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZGltZW5zaW9uczogc2NhbGVEaW1lbnNpb25zKHBhZ2UuZGltZW5zaW9ucywgc2NhbGVSYXRpbylcbiAgICAgICAgfSkpXG4gICAgfSkpO1xufVxuXG5mdW5jdGlvbiBzY2FsZURpbWVuc2lvbnMgKGRpbWVuc2lvbnMsIHNjYWxlUmF0aW8pXG57XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaGVpZ2h0OiBNYXRoLmZsb29yKGRpbWVuc2lvbnMuaGVpZ2h0ICogc2NhbGVSYXRpbyksXG4gICAgICAgIHdpZHRoOiBNYXRoLmZsb29yKGRpbWVuc2lvbnMud2lkdGggKiBzY2FsZVJhdGlvKVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGdldEV4dGVudEFsb25nU2Vjb25kYXJ5QXhpcyAoY29uZmlnLCBzY2FsZWRMYXlvdXRzKVxue1xuICAgIC8vIEdldCB0aGUgZXh0ZW50IG9mIHRoZSBkb2N1bWVudCBhbG9uZyB0aGUgc2Vjb25kYXJ5IGF4aXNcbiAgICBsZXQgc2Vjb25kYXJ5RGltLCBzZWNvbmRhcnlQYWRkaW5nO1xuICAgIGNvbnN0IGRvY1BhZGRpbmcgPSBjb25maWcucGFkZGluZy5kb2N1bWVudDtcblxuICAgIGlmIChjb25maWcudmVydGljYWxseU9yaWVudGVkKVxuICAgIHtcbiAgICAgICAgc2Vjb25kYXJ5RGltID0gJ3dpZHRoJztcbiAgICAgICAgc2Vjb25kYXJ5UGFkZGluZyA9IGRvY1BhZGRpbmcubGVmdCArIGRvY1BhZGRpbmcucmlnaHQ7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgIHNlY29uZGFyeURpbSA9ICdoZWlnaHQnO1xuICAgICAgICBzZWNvbmRhcnlQYWRkaW5nID0gZG9jUGFkZGluZy50b3AgKyBkb2NQYWRkaW5nLmJvdHRvbTtcbiAgICB9XG5cbiAgICByZXR1cm4gc2Vjb25kYXJ5UGFkZGluZyArIHNjYWxlZExheW91dHMucmVkdWNlKChtYXhEaW0sIGxheW91dCkgPT4gTWF0aC5tYXgobGF5b3V0LmRpbWVuc2lvbnNbc2Vjb25kYXJ5RGltXSwgbWF4RGltKSwgMCk7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/document-layout.js\n");

/***/ }),

/***/ "./source/js/exceptions.js":
/*!*********************************!*\
  !*** ./source/js/exceptions.js ***!
  \*********************************/
/*! exports provided: DivaParentElementNotFoundException, NotAnIIIFManifestException, ObjectDataNotSuppliedException */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DivaParentElementNotFoundException\", function() { return DivaParentElementNotFoundException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NotAnIIIFManifestException\", function() { return NotAnIIIFManifestException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ObjectDataNotSuppliedException\", function() { return ObjectDataNotSuppliedException; });\nfunction DivaParentElementNotFoundException (message)\n{\n    this.name = \"DivaParentElementNotFoundException\";\n    this.message = message;\n    this.stack = (new Error()).stack;\n}\n\nDivaParentElementNotFoundException.prototype = new Error();\n\nfunction NotAnIIIFManifestException (message)\n{\n    this.name = \"NotAnIIIFManifestException\";\n    this.message = message;\n    this.stack = (new Error()).stack;\n}\n\nNotAnIIIFManifestException.prototype = new Error();\n\nfunction ObjectDataNotSuppliedException (message)\n{\n    this.name = \"ObjectDataNotSuppliedException\";\n    this.message = message;\n    this.stack = (new Error()).stack;\n}\n\nObjectDataNotSuppliedException.prototype = new Error();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvZXhjZXB0aW9ucy5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9qcy9leGNlcHRpb25zLmpzP2ZhMmQiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIERpdmFQYXJlbnRFbGVtZW50Tm90Rm91bmRFeGNlcHRpb24gKG1lc3NhZ2UpXG57XG4gICAgdGhpcy5uYW1lID0gXCJEaXZhUGFyZW50RWxlbWVudE5vdEZvdW5kRXhjZXB0aW9uXCI7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICB0aGlzLnN0YWNrID0gKG5ldyBFcnJvcigpKS5zdGFjaztcbn1cblxuRGl2YVBhcmVudEVsZW1lbnROb3RGb3VuZEV4Y2VwdGlvbi5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTtcblxuZXhwb3J0IGZ1bmN0aW9uIE5vdEFuSUlJRk1hbmlmZXN0RXhjZXB0aW9uIChtZXNzYWdlKVxue1xuICAgIHRoaXMubmFtZSA9IFwiTm90QW5JSUlGTWFuaWZlc3RFeGNlcHRpb25cIjtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHRoaXMuc3RhY2sgPSAobmV3IEVycm9yKCkpLnN0YWNrO1xufVxuXG5Ob3RBbklJSUZNYW5pZmVzdEV4Y2VwdGlvbi5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTtcblxuZXhwb3J0IGZ1bmN0aW9uIE9iamVjdERhdGFOb3RTdXBwbGllZEV4Y2VwdGlvbiAobWVzc2FnZSlcbntcbiAgICB0aGlzLm5hbWUgPSBcIk9iamVjdERhdGFOb3RTdXBwbGllZEV4Y2VwdGlvblwiO1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy5zdGFjayA9IChuZXcgRXJyb3IoKSkuc3RhY2s7XG59XG5cbk9iamVjdERhdGFOb3RTdXBwbGllZEV4Y2VwdGlvbi5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/exceptions.js\n");

/***/ }),

/***/ "./source/js/gesture-events.js":
/*!*************************************!*\
  !*** ./source/js/gesture-events.js ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    onDoubleClick,\n    onPinch,\n    onDoubleTap\n});\n\nconst DOUBLE_CLICK_TIMEOUT = 500;\nconst DOUBLE_TAP_DISTANCE_THRESHOLD = 50;\nconst DOUBLE_TAP_TIMEOUT = 250;\n\nfunction onDoubleClick(elem, callback)\n{\n    elem.addEventListener('dblclick', function (event)\n    {\n        if (!event.ctrlKey)\n        {\n            callback(event, getRelativeOffset(event.currentTarget, event));\n        }\n    });\n\n    // Handle the control key for macs (in conjunction with double-clicking)\n    // FIXME: Does a click get handled with ctrl pressed on non-Macs?\n    const tracker = createDoubleEventTracker(DOUBLE_CLICK_TIMEOUT);\n\n    elem.addEventListener('contextmenu', function (event)\n    {\n        event.preventDefault();\n\n        if (event.ctrlKey)\n        {\n            if (tracker.isTriggered())\n            {\n                tracker.reset();\n                callback(event, getRelativeOffset(event.currentTarget, event));\n            }\n            else\n            {\n                tracker.trigger();\n            }\n        }\n    });\n}\n\nfunction onPinch(elem, callback)\n{\n    let startDistance = 0;\n\n    elem.addEventListener('touchstart', function (event)\n    {\n        // Prevent mouse event from firing\n        event.preventDefault();\n\n        if (event.originalEvent.touches.length === 2)\n        {\n            startDistance = distance(\n                event.originalEvent.touches[0].clientX,\n                event.originalEvent.touches[0].clientY,\n                event.originalEvent.touches[1].clientX,\n                event.originalEvent.touches[1].clientY\n            );\n        }\n    });\n\n    elem.addEventListener('touchmove', function(event)\n    {\n        // Prevent mouse event from firing\n        event.preventDefault();\n\n        if (event.originalEvent.touches.length === 2)\n        {\n            const touches = event.originalEvent.touches;\n\n            const moveDistance = distance(\n                touches[0].clientX,\n                touches[0].clientY,\n                touches[1].clientX,\n                touches[1].clientY\n            );\n\n            const zoomDelta = moveDistance - startDistance;\n\n            if (Math.abs(zoomDelta) > 0)\n            {\n                const touchCenter = {\n                    pageX: (touches[0].clientX + touches[1].clientX) / 2,\n                    pageY: (touches[0].clientY + touches[1].clientY) / 2\n                };\n\n                callback(event, getRelativeOffset(event.currentTarget, touchCenter), startDistance, moveDistance);\n            }\n        }\n    });\n}\n\nfunction onDoubleTap(elem, callback)\n{\n    const tracker = createDoubleEventTracker(DOUBLE_TAP_TIMEOUT);\n    let firstTap = null;\n\n    elem.addEventListener('touchend', (event) =>\n    {\n        // Prevent mouse event from firing\n        event.preventDefault();\n\n        if (tracker.isTriggered())\n        {\n            tracker.reset();\n\n            // Doubletap has occurred\n            const secondTap = {\n                pageX: event.originalEvent.changedTouches[0].clientX,\n                pageY: event.originalEvent.changedTouches[0].clientY\n            };\n\n            // If first tap is close to second tap (prevents interference with scale event)\n            const tapDistance = distance(firstTap.pageX, firstTap.pageY, secondTap.pageX, secondTap.pageY);\n\n            // TODO: Could give something higher-level than secondTap to callback\n            if (tapDistance < DOUBLE_TAP_DISTANCE_THRESHOLD)\n                callback(event, getRelativeOffset(event.currentTarget, secondTap));\n\n            firstTap = null;\n        }\n        else\n        {\n            firstTap = {\n                pageX: event.originalEvent.changedTouches[0].clientX,\n                pageY: event.originalEvent.changedTouches[0].clientY\n            };\n\n            tracker.trigger();\n        }\n    });\n}\n\n// Pythagorean theorem to get the distance between two points (used for\n// calculating finger distance for double-tap and pinch-zoom)\nfunction distance(x1, y1, x2, y2)\n{\n    return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n}\n\n// Utility to keep track of whether an event has been triggered twice\n// during a a given duration\nfunction createDoubleEventTracker(timeoutDuration)\n{\n    let triggered = false;\n    let timeoutId = null;\n\n    return {\n        trigger()\n        {\n            triggered = true;\n            resetTimeout();\n            timeoutId = setTimeout(function ()\n            {\n                triggered = false;\n                timeoutId = null;\n            }, timeoutDuration);\n        },\n        isTriggered()\n        {\n            return triggered;\n        },\n        reset()\n        {\n            triggered = false;\n            resetTimeout();\n        }\n    };\n\n    function resetTimeout()\n    {\n        if (timeoutId !== null)\n        {\n            clearTimeout(timeoutId);\n            timeoutId = null;\n        }\n    }\n}\n\nfunction getRelativeOffset(elem, pageCoords)\n{\n    const bounds = elem.getBoundingClientRect();\n\n    return {\n        left: pageCoords.pageX - bounds.left,\n        top: pageCoords.pageY - bounds.top\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvZ2VzdHVyZS1ldmVudHMuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvZ2VzdHVyZS1ldmVudHMuanM/MDVmNyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCB7XG4gICAgb25Eb3VibGVDbGljayxcbiAgICBvblBpbmNoLFxuICAgIG9uRG91YmxlVGFwXG59O1xuXG5jb25zdCBET1VCTEVfQ0xJQ0tfVElNRU9VVCA9IDUwMDtcbmNvbnN0IERPVUJMRV9UQVBfRElTVEFOQ0VfVEhSRVNIT0xEID0gNTA7XG5jb25zdCBET1VCTEVfVEFQX1RJTUVPVVQgPSAyNTA7XG5cbmZ1bmN0aW9uIG9uRG91YmxlQ2xpY2soZWxlbSwgY2FsbGJhY2spXG57XG4gICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCdkYmxjbGljaycsIGZ1bmN0aW9uIChldmVudClcbiAgICB7XG4gICAgICAgIGlmICghZXZlbnQuY3RybEtleSlcbiAgICAgICAge1xuICAgICAgICAgICAgY2FsbGJhY2soZXZlbnQsIGdldFJlbGF0aXZlT2Zmc2V0KGV2ZW50LmN1cnJlbnRUYXJnZXQsIGV2ZW50KSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEhhbmRsZSB0aGUgY29udHJvbCBrZXkgZm9yIG1hY3MgKGluIGNvbmp1bmN0aW9uIHdpdGggZG91YmxlLWNsaWNraW5nKVxuICAgIC8vIEZJWE1FOiBEb2VzIGEgY2xpY2sgZ2V0IGhhbmRsZWQgd2l0aCBjdHJsIHByZXNzZWQgb24gbm9uLU1hY3M/XG4gICAgY29uc3QgdHJhY2tlciA9IGNyZWF0ZURvdWJsZUV2ZW50VHJhY2tlcihET1VCTEVfQ0xJQ0tfVElNRU9VVCk7XG5cbiAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgZnVuY3Rpb24gKGV2ZW50KVxuICAgIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBpZiAoZXZlbnQuY3RybEtleSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHRyYWNrZXIuaXNUcmlnZ2VyZWQoKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0cmFja2VyLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXZlbnQsIGdldFJlbGF0aXZlT2Zmc2V0KGV2ZW50LmN1cnJlbnRUYXJnZXQsIGV2ZW50KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdHJhY2tlci50cmlnZ2VyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gb25QaW5jaChlbGVtLCBjYWxsYmFjaylcbntcbiAgICBsZXQgc3RhcnREaXN0YW5jZSA9IDA7XG5cbiAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQpXG4gICAge1xuICAgICAgICAvLyBQcmV2ZW50IG1vdXNlIGV2ZW50IGZyb20gZmlyaW5nXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgaWYgKGV2ZW50Lm9yaWdpbmFsRXZlbnQudG91Y2hlcy5sZW5ndGggPT09IDIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHN0YXJ0RGlzdGFuY2UgPSBkaXN0YW5jZShcbiAgICAgICAgICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WCxcbiAgICAgICAgICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WSxcbiAgICAgICAgICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMV0uY2xpZW50WCxcbiAgICAgICAgICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMV0uY2xpZW50WVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBmdW5jdGlvbihldmVudClcbiAgICB7XG4gICAgICAgIC8vIFByZXZlbnQgbW91c2UgZXZlbnQgZnJvbSBmaXJpbmdcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBpZiAoZXZlbnQub3JpZ2luYWxFdmVudC50b3VjaGVzLmxlbmd0aCA9PT0gMilcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdG91Y2hlcyA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQudG91Y2hlcztcblxuICAgICAgICAgICAgY29uc3QgbW92ZURpc3RhbmNlID0gZGlzdGFuY2UoXG4gICAgICAgICAgICAgICAgdG91Y2hlc1swXS5jbGllbnRYLFxuICAgICAgICAgICAgICAgIHRvdWNoZXNbMF0uY2xpZW50WSxcbiAgICAgICAgICAgICAgICB0b3VjaGVzWzFdLmNsaWVudFgsXG4gICAgICAgICAgICAgICAgdG91Y2hlc1sxXS5jbGllbnRZXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjb25zdCB6b29tRGVsdGEgPSBtb3ZlRGlzdGFuY2UgLSBzdGFydERpc3RhbmNlO1xuXG4gICAgICAgICAgICBpZiAoTWF0aC5hYnMoem9vbURlbHRhKSA+IDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgdG91Y2hDZW50ZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2VYOiAodG91Y2hlc1swXS5jbGllbnRYICsgdG91Y2hlc1sxXS5jbGllbnRYKSAvIDIsXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VZOiAodG91Y2hlc1swXS5jbGllbnRZICsgdG91Y2hlc1sxXS5jbGllbnRZKSAvIDJcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXZlbnQsIGdldFJlbGF0aXZlT2Zmc2V0KGV2ZW50LmN1cnJlbnRUYXJnZXQsIHRvdWNoQ2VudGVyKSwgc3RhcnREaXN0YW5jZSwgbW92ZURpc3RhbmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBvbkRvdWJsZVRhcChlbGVtLCBjYWxsYmFjaylcbntcbiAgICBjb25zdCB0cmFja2VyID0gY3JlYXRlRG91YmxlRXZlbnRUcmFja2VyKERPVUJMRV9UQVBfVElNRU9VVCk7XG4gICAgbGV0IGZpcnN0VGFwID0gbnVsbDtcblxuICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoZXZlbnQpID0+XG4gICAge1xuICAgICAgICAvLyBQcmV2ZW50IG1vdXNlIGV2ZW50IGZyb20gZmlyaW5nXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgaWYgKHRyYWNrZXIuaXNUcmlnZ2VyZWQoKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdHJhY2tlci5yZXNldCgpO1xuXG4gICAgICAgICAgICAvLyBEb3VibGV0YXAgaGFzIG9jY3VycmVkXG4gICAgICAgICAgICBjb25zdCBzZWNvbmRUYXAgPSB7XG4gICAgICAgICAgICAgICAgcGFnZVg6IGV2ZW50Lm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WCxcbiAgICAgICAgICAgICAgICBwYWdlWTogZXZlbnQub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBJZiBmaXJzdCB0YXAgaXMgY2xvc2UgdG8gc2Vjb25kIHRhcCAocHJldmVudHMgaW50ZXJmZXJlbmNlIHdpdGggc2NhbGUgZXZlbnQpXG4gICAgICAgICAgICBjb25zdCB0YXBEaXN0YW5jZSA9IGRpc3RhbmNlKGZpcnN0VGFwLnBhZ2VYLCBmaXJzdFRhcC5wYWdlWSwgc2Vjb25kVGFwLnBhZ2VYLCBzZWNvbmRUYXAucGFnZVkpO1xuXG4gICAgICAgICAgICAvLyBUT0RPOiBDb3VsZCBnaXZlIHNvbWV0aGluZyBoaWdoZXItbGV2ZWwgdGhhbiBzZWNvbmRUYXAgdG8gY2FsbGJhY2tcbiAgICAgICAgICAgIGlmICh0YXBEaXN0YW5jZSA8IERPVUJMRV9UQVBfRElTVEFOQ0VfVEhSRVNIT0xEKVxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGV2ZW50LCBnZXRSZWxhdGl2ZU9mZnNldChldmVudC5jdXJyZW50VGFyZ2V0LCBzZWNvbmRUYXApKTtcblxuICAgICAgICAgICAgZmlyc3RUYXAgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgZmlyc3RUYXAgPSB7XG4gICAgICAgICAgICAgICAgcGFnZVg6IGV2ZW50Lm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WCxcbiAgICAgICAgICAgICAgICBwYWdlWTogZXZlbnQub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0cmFja2VyLnRyaWdnZXIoKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG4vLyBQeXRoYWdvcmVhbiB0aGVvcmVtIHRvIGdldCB0aGUgZGlzdGFuY2UgYmV0d2VlbiB0d28gcG9pbnRzICh1c2VkIGZvclxuLy8gY2FsY3VsYXRpbmcgZmluZ2VyIGRpc3RhbmNlIGZvciBkb3VibGUtdGFwIGFuZCBwaW5jaC16b29tKVxuZnVuY3Rpb24gZGlzdGFuY2UoeDEsIHkxLCB4MiwgeTIpXG57XG4gICAgcmV0dXJuIE1hdGguc3FydCgoeDIgLSB4MSkgKiAoeDIgLSB4MSkgKyAoeTIgLSB5MSkgKiAoeTIgLSB5MSkpO1xufVxuXG4vLyBVdGlsaXR5IHRvIGtlZXAgdHJhY2sgb2Ygd2hldGhlciBhbiBldmVudCBoYXMgYmVlbiB0cmlnZ2VyZWQgdHdpY2Vcbi8vIGR1cmluZyBhIGEgZ2l2ZW4gZHVyYXRpb25cbmZ1bmN0aW9uIGNyZWF0ZURvdWJsZUV2ZW50VHJhY2tlcih0aW1lb3V0RHVyYXRpb24pXG57XG4gICAgbGV0IHRyaWdnZXJlZCA9IGZhbHNlO1xuICAgIGxldCB0aW1lb3V0SWQgPSBudWxsO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHJpZ2dlcigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRyaWdnZXJlZCA9IHRydWU7XG4gICAgICAgICAgICByZXNldFRpbWVvdXQoKTtcbiAgICAgICAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aW1lb3V0SWQgPSBudWxsO1xuICAgICAgICAgICAgfSwgdGltZW91dER1cmF0aW9uKTtcbiAgICAgICAgfSxcbiAgICAgICAgaXNUcmlnZ2VyZWQoKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gdHJpZ2dlcmVkO1xuICAgICAgICB9LFxuICAgICAgICByZXNldCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRyaWdnZXJlZCA9IGZhbHNlO1xuICAgICAgICAgICAgcmVzZXRUaW1lb3V0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcmVzZXRUaW1lb3V0KClcbiAgICB7XG4gICAgICAgIGlmICh0aW1lb3V0SWQgIT09IG51bGwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICAgICAgdGltZW91dElkID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0UmVsYXRpdmVPZmZzZXQoZWxlbSwgcGFnZUNvb3JkcylcbntcbiAgICBjb25zdCBib3VuZHMgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgbGVmdDogcGFnZUNvb3Jkcy5wYWdlWCAtIGJvdW5kcy5sZWZ0LFxuICAgICAgICB0b3A6IHBhZ2VDb29yZHMucGFnZVkgLSBib3VuZHMudG9wXG4gICAgfTtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/gesture-events.js\n");

/***/ }),

/***/ "./source/js/grid-handler.js":
/*!***********************************!*\
  !*** ./source/js/grid-handler.js ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return GridHandler; });\n/* harmony import */ var lodash_maxby__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash.maxby */ \"./node_modules/lodash.maxby/index.js\");\n/* harmony import */ var lodash_maxby__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash_maxby__WEBPACK_IMPORTED_MODULE_0__);\n\n\nclass GridHandler\n{\n    constructor (viewerCore)\n    {\n        this._viewerCore = viewerCore;\n    }\n\n    // USER EVENTS\n    onDoubleClick (event, coords)\n    {\n        const position = this._viewerCore.getPagePositionAtViewportOffset(coords);\n\n        const layout = this._viewerCore.getCurrentLayout();\n        const viewport = this._viewerCore.getViewport();\n        const pageToViewportCenterOffset = layout.getPageToViewportCenterOffset(position.anchorPage, viewport);\n\n        this._viewerCore.reload({\n            inGrid: false,\n            goDirectlyTo: position.anchorPage,\n            horizontalOffset: pageToViewportCenterOffset.x + position.offset.left,\n            verticalOffset: pageToViewportCenterOffset.y + position.offset.top\n        });\n    }\n\n    onPinch ()\n    {\n        this._viewerCore.reload({inGrid: false});\n    }\n\n    // VIEW EVENTS\n    onViewWillLoad ()\n    {\n        // FIXME(wabain): Should something happen here?\n        /* No-op */\n    }\n\n    onViewDidLoad ()\n    {\n        // FIXME(wabain): Should something happen here?\n        /* No-op */\n    }\n\n    onViewDidUpdate (renderedPages, targetPage)\n    {\n        // return early if there are no rendered pages in view.\n        if (renderedPages.length === 0) return;\n\n        // calculate the visible pages from the rendered pages\n        let temp = this._viewerCore.viewerState.viewport.intersectionTolerance;\n        // without setting to 0, isPageVisible returns true for pages out of viewport by intersectionTolerance\n        this._viewerCore.viewerState.viewport.intersectionTolerance = 0;\n        let visiblePages = renderedPages.filter(index => this._viewerCore.viewerState.renderer.isPageVisible(index));\n        // reset back to original value after getting true visible pages\n        this._viewerCore.viewerState.viewport.intersectionTolerance = temp;\n\n        if (targetPage !== null)\n        {\n            this._viewerCore.setCurrentPages(targetPage, visiblePages);\n            return;\n        }\n\n        // Select the current page from the first row if it is fully visible, or from\n        // the second row if it is fully visible, or from the centermost row otherwise.\n        // If the current page is in that group then don't change it. Otherwise, set\n        // the current page to the group's first page.\n\n        const layout = this._viewerCore.getCurrentLayout();\n        const groups = [];\n\n        renderedPages.forEach(pageIndex =>\n        {\n            const group = layout.getPageInfo(pageIndex).group;\n            if (groups.length === 0 || group !== groups[groups.length - 1])\n            {\n                groups.push(group);\n            }\n        });\n\n        const viewport = this._viewerCore.getViewport();\n        let chosenGroup;\n\n        if (groups.length === 1 || groups[0].region.top >= viewport.top)\n        {\n            chosenGroup = groups[0];\n        }\n        else if (groups[1].region.bottom <= viewport.bottom)\n        {\n            chosenGroup = groups[1];\n        }\n        else\n        {\n            chosenGroup = getCentermostGroup(groups, viewport);\n        }\n\n        const currentPage = this._viewerCore.getSettings().activePageIndex;\n\n        const hasCurrentPage = chosenGroup.pages.some(page => page.index === currentPage);\n\n        if (!hasCurrentPage)\n        {\n            this._viewerCore.setCurrentPages(chosenGroup.pages[0].index, visiblePages);\n        }\n    }\n\n    destroy ()\n    {\n        // No-op\n    }\n}\n\nfunction getCentermostGroup (groups, viewport)\n{\n    const viewportMiddle = viewport.top + viewport.height / 2;\n\n    return lodash_maxby__WEBPACK_IMPORTED_MODULE_0___default()(groups, group =>\n    {\n        const groupMiddle = group.region.top + group.dimensions.height / 2;\n        return -Math.abs(viewportMiddle - groupMiddle);\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvZ3JpZC1oYW5kbGVyLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL2dyaWQtaGFuZGxlci5qcz9hMjI0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtYXhCeSBmcm9tICdsb2Rhc2gubWF4YnknO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHcmlkSGFuZGxlclxue1xuICAgIGNvbnN0cnVjdG9yICh2aWV3ZXJDb3JlKVxuICAgIHtcbiAgICAgICAgdGhpcy5fdmlld2VyQ29yZSA9IHZpZXdlckNvcmU7XG4gICAgfVxuXG4gICAgLy8gVVNFUiBFVkVOVFNcbiAgICBvbkRvdWJsZUNsaWNrIChldmVudCwgY29vcmRzKVxuICAgIHtcbiAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLl92aWV3ZXJDb3JlLmdldFBhZ2VQb3NpdGlvbkF0Vmlld3BvcnRPZmZzZXQoY29vcmRzKTtcblxuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLl92aWV3ZXJDb3JlLmdldEN1cnJlbnRMYXlvdXQoKTtcbiAgICAgICAgY29uc3Qgdmlld3BvcnQgPSB0aGlzLl92aWV3ZXJDb3JlLmdldFZpZXdwb3J0KCk7XG4gICAgICAgIGNvbnN0IHBhZ2VUb1ZpZXdwb3J0Q2VudGVyT2Zmc2V0ID0gbGF5b3V0LmdldFBhZ2VUb1ZpZXdwb3J0Q2VudGVyT2Zmc2V0KHBvc2l0aW9uLmFuY2hvclBhZ2UsIHZpZXdwb3J0KTtcblxuICAgICAgICB0aGlzLl92aWV3ZXJDb3JlLnJlbG9hZCh7XG4gICAgICAgICAgICBpbkdyaWQ6IGZhbHNlLFxuICAgICAgICAgICAgZ29EaXJlY3RseVRvOiBwb3NpdGlvbi5hbmNob3JQYWdlLFxuICAgICAgICAgICAgaG9yaXpvbnRhbE9mZnNldDogcGFnZVRvVmlld3BvcnRDZW50ZXJPZmZzZXQueCArIHBvc2l0aW9uLm9mZnNldC5sZWZ0LFxuICAgICAgICAgICAgdmVydGljYWxPZmZzZXQ6IHBhZ2VUb1ZpZXdwb3J0Q2VudGVyT2Zmc2V0LnkgKyBwb3NpdGlvbi5vZmZzZXQudG9wXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uUGluY2ggKClcbiAgICB7XG4gICAgICAgIHRoaXMuX3ZpZXdlckNvcmUucmVsb2FkKHtpbkdyaWQ6IGZhbHNlfSk7XG4gICAgfVxuXG4gICAgLy8gVklFVyBFVkVOVFNcbiAgICBvblZpZXdXaWxsTG9hZCAoKVxuICAgIHtcbiAgICAgICAgLy8gRklYTUUod2FiYWluKTogU2hvdWxkIHNvbWV0aGluZyBoYXBwZW4gaGVyZT9cbiAgICAgICAgLyogTm8tb3AgKi9cbiAgICB9XG5cbiAgICBvblZpZXdEaWRMb2FkICgpXG4gICAge1xuICAgICAgICAvLyBGSVhNRSh3YWJhaW4pOiBTaG91bGQgc29tZXRoaW5nIGhhcHBlbiBoZXJlP1xuICAgICAgICAvKiBOby1vcCAqL1xuICAgIH1cblxuICAgIG9uVmlld0RpZFVwZGF0ZSAocmVuZGVyZWRQYWdlcywgdGFyZ2V0UGFnZSlcbiAgICB7XG4gICAgICAgIC8vIHJldHVybiBlYXJseSBpZiB0aGVyZSBhcmUgbm8gcmVuZGVyZWQgcGFnZXMgaW4gdmlldy5cbiAgICAgICAgaWYgKHJlbmRlcmVkUGFnZXMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICAgICAgLy8gY2FsY3VsYXRlIHRoZSB2aXNpYmxlIHBhZ2VzIGZyb20gdGhlIHJlbmRlcmVkIHBhZ2VzXG4gICAgICAgIGxldCB0ZW1wID0gdGhpcy5fdmlld2VyQ29yZS52aWV3ZXJTdGF0ZS52aWV3cG9ydC5pbnRlcnNlY3Rpb25Ub2xlcmFuY2U7XG4gICAgICAgIC8vIHdpdGhvdXQgc2V0dGluZyB0byAwLCBpc1BhZ2VWaXNpYmxlIHJldHVybnMgdHJ1ZSBmb3IgcGFnZXMgb3V0IG9mIHZpZXdwb3J0IGJ5IGludGVyc2VjdGlvblRvbGVyYW5jZVxuICAgICAgICB0aGlzLl92aWV3ZXJDb3JlLnZpZXdlclN0YXRlLnZpZXdwb3J0LmludGVyc2VjdGlvblRvbGVyYW5jZSA9IDA7XG4gICAgICAgIGxldCB2aXNpYmxlUGFnZXMgPSByZW5kZXJlZFBhZ2VzLmZpbHRlcihpbmRleCA9PiB0aGlzLl92aWV3ZXJDb3JlLnZpZXdlclN0YXRlLnJlbmRlcmVyLmlzUGFnZVZpc2libGUoaW5kZXgpKTtcbiAgICAgICAgLy8gcmVzZXQgYmFjayB0byBvcmlnaW5hbCB2YWx1ZSBhZnRlciBnZXR0aW5nIHRydWUgdmlzaWJsZSBwYWdlc1xuICAgICAgICB0aGlzLl92aWV3ZXJDb3JlLnZpZXdlclN0YXRlLnZpZXdwb3J0LmludGVyc2VjdGlvblRvbGVyYW5jZSA9IHRlbXA7XG5cbiAgICAgICAgaWYgKHRhcmdldFBhZ2UgIT09IG51bGwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3ZpZXdlckNvcmUuc2V0Q3VycmVudFBhZ2VzKHRhcmdldFBhZ2UsIHZpc2libGVQYWdlcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZWxlY3QgdGhlIGN1cnJlbnQgcGFnZSBmcm9tIHRoZSBmaXJzdCByb3cgaWYgaXQgaXMgZnVsbHkgdmlzaWJsZSwgb3IgZnJvbVxuICAgICAgICAvLyB0aGUgc2Vjb25kIHJvdyBpZiBpdCBpcyBmdWxseSB2aXNpYmxlLCBvciBmcm9tIHRoZSBjZW50ZXJtb3N0IHJvdyBvdGhlcndpc2UuXG4gICAgICAgIC8vIElmIHRoZSBjdXJyZW50IHBhZ2UgaXMgaW4gdGhhdCBncm91cCB0aGVuIGRvbid0IGNoYW5nZSBpdC4gT3RoZXJ3aXNlLCBzZXRcbiAgICAgICAgLy8gdGhlIGN1cnJlbnQgcGFnZSB0byB0aGUgZ3JvdXAncyBmaXJzdCBwYWdlLlxuXG4gICAgICAgIGNvbnN0IGxheW91dCA9IHRoaXMuX3ZpZXdlckNvcmUuZ2V0Q3VycmVudExheW91dCgpO1xuICAgICAgICBjb25zdCBncm91cHMgPSBbXTtcblxuICAgICAgICByZW5kZXJlZFBhZ2VzLmZvckVhY2gocGFnZUluZGV4ID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gbGF5b3V0LmdldFBhZ2VJbmZvKHBhZ2VJbmRleCkuZ3JvdXA7XG4gICAgICAgICAgICBpZiAoZ3JvdXBzLmxlbmd0aCA9PT0gMCB8fCBncm91cCAhPT0gZ3JvdXBzW2dyb3Vwcy5sZW5ndGggLSAxXSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBncm91cHMucHVzaChncm91cCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHZpZXdwb3J0ID0gdGhpcy5fdmlld2VyQ29yZS5nZXRWaWV3cG9ydCgpO1xuICAgICAgICBsZXQgY2hvc2VuR3JvdXA7XG5cbiAgICAgICAgaWYgKGdyb3Vwcy5sZW5ndGggPT09IDEgfHwgZ3JvdXBzWzBdLnJlZ2lvbi50b3AgPj0gdmlld3BvcnQudG9wKVxuICAgICAgICB7XG4gICAgICAgICAgICBjaG9zZW5Hcm91cCA9IGdyb3Vwc1swXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChncm91cHNbMV0ucmVnaW9uLmJvdHRvbSA8PSB2aWV3cG9ydC5ib3R0b20pXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNob3Nlbkdyb3VwID0gZ3JvdXBzWzFdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgY2hvc2VuR3JvdXAgPSBnZXRDZW50ZXJtb3N0R3JvdXAoZ3JvdXBzLCB2aWV3cG9ydCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjdXJyZW50UGFnZSA9IHRoaXMuX3ZpZXdlckNvcmUuZ2V0U2V0dGluZ3MoKS5hY3RpdmVQYWdlSW5kZXg7XG5cbiAgICAgICAgY29uc3QgaGFzQ3VycmVudFBhZ2UgPSBjaG9zZW5Hcm91cC5wYWdlcy5zb21lKHBhZ2UgPT4gcGFnZS5pbmRleCA9PT0gY3VycmVudFBhZ2UpO1xuXG4gICAgICAgIGlmICghaGFzQ3VycmVudFBhZ2UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3ZpZXdlckNvcmUuc2V0Q3VycmVudFBhZ2VzKGNob3Nlbkdyb3VwLnBhZ2VzWzBdLmluZGV4LCB2aXNpYmxlUGFnZXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGVzdHJveSAoKVxuICAgIHtcbiAgICAgICAgLy8gTm8tb3BcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldENlbnRlcm1vc3RHcm91cCAoZ3JvdXBzLCB2aWV3cG9ydClcbntcbiAgICBjb25zdCB2aWV3cG9ydE1pZGRsZSA9IHZpZXdwb3J0LnRvcCArIHZpZXdwb3J0LmhlaWdodCAvIDI7XG5cbiAgICByZXR1cm4gbWF4QnkoZ3JvdXBzLCBncm91cCA9PlxuICAgIHtcbiAgICAgICAgY29uc3QgZ3JvdXBNaWRkbGUgPSBncm91cC5yZWdpb24udG9wICsgZ3JvdXAuZGltZW5zaW9ucy5oZWlnaHQgLyAyO1xuICAgICAgICByZXR1cm4gLU1hdGguYWJzKHZpZXdwb3J0TWlkZGxlIC0gZ3JvdXBNaWRkbGUpO1xuICAgIH0pO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./source/js/grid-handler.js\n");

/***/ }),

/***/ "./source/js/iiif-source-adapter.js":
/*!******************************************!*\
  !*** ./source/js/iiif-source-adapter.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return IIIFSourceAdapter; });\nclass IIIFSourceAdapter\n{\n    getPageImageURL (manifest, pageIndex, size)\n    {\n        let dimens;\n\n        if (!size || (size.width == null && size.height == null))\n        {\n            dimens = 'full';\n        }\n        else\n        {\n            dimens = (size.width == null ? '' : size.width) + ',' + (size.height == null ? '' : size.height);\n        }\n\n        const page = manifest.pages[pageIndex];\n        const quality = (page.api > 1.1) ? 'default' : 'native';\n\n        return encodeURI(page.url + 'full/' + dimens + '/0/' + quality + '.jpg');\n    }\n\n    getTileImageURL (manifest, pageIndex, params)\n    {\n        const page = manifest.pages[pageIndex];\n\n        let height, width;\n\n        if (params.row === params.rowCount - 1)\n        {\n            height = page.d[params.zoomLevel].h - (params.rowCount - 1) * params.tileDimensions.height;\n        }\n        else\n        {\n            height = params.tileDimensions.height;\n        }\n\n        if (params.col === params.colCount - 1)\n        {\n            width = page.d[params.zoomLevel].w - (params.colCount - 1) * params.tileDimensions.width;\n        }\n        else\n        {\n            width = params.tileDimensions.width;\n        }\n\n        const zoomDifference = Math.pow(2, manifest.maxZoom - params.zoomLevel);\n\n        let x = params.col * params.tileDimensions.width * zoomDifference;\n        let y = params.row * params.tileDimensions.height * zoomDifference;\n\n        if (page.hasOwnProperty('xoffset'))\n        {\n            x += page.xoffset;\n            y += page.yoffset;\n        }\n\n        const region = [x, y, width * zoomDifference, height * zoomDifference].join(',');\n\n        const quality = (page.api > 1.1) ? 'default' : 'native';\n\n        return encodeURI(page.url + region + '/' + width + ',' + height + '/0/' + quality + '.jpg');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvaWlpZi1zb3VyY2UtYWRhcHRlci5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9qcy9paWlmLXNvdXJjZS1hZGFwdGVyLmpzP2JmMzciXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgSUlJRlNvdXJjZUFkYXB0ZXJcbntcbiAgICBnZXRQYWdlSW1hZ2VVUkwgKG1hbmlmZXN0LCBwYWdlSW5kZXgsIHNpemUpXG4gICAge1xuICAgICAgICBsZXQgZGltZW5zO1xuXG4gICAgICAgIGlmICghc2l6ZSB8fCAoc2l6ZS53aWR0aCA9PSBudWxsICYmIHNpemUuaGVpZ2h0ID09IG51bGwpKVxuICAgICAgICB7XG4gICAgICAgICAgICBkaW1lbnMgPSAnZnVsbCc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBkaW1lbnMgPSAoc2l6ZS53aWR0aCA9PSBudWxsID8gJycgOiBzaXplLndpZHRoKSArICcsJyArIChzaXplLmhlaWdodCA9PSBudWxsID8gJycgOiBzaXplLmhlaWdodCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwYWdlID0gbWFuaWZlc3QucGFnZXNbcGFnZUluZGV4XTtcbiAgICAgICAgY29uc3QgcXVhbGl0eSA9IChwYWdlLmFwaSA+IDEuMSkgPyAnZGVmYXVsdCcgOiAnbmF0aXZlJztcblxuICAgICAgICByZXR1cm4gZW5jb2RlVVJJKHBhZ2UudXJsICsgJ2Z1bGwvJyArIGRpbWVucyArICcvMC8nICsgcXVhbGl0eSArICcuanBnJyk7XG4gICAgfVxuXG4gICAgZ2V0VGlsZUltYWdlVVJMIChtYW5pZmVzdCwgcGFnZUluZGV4LCBwYXJhbXMpXG4gICAge1xuICAgICAgICBjb25zdCBwYWdlID0gbWFuaWZlc3QucGFnZXNbcGFnZUluZGV4XTtcblxuICAgICAgICBsZXQgaGVpZ2h0LCB3aWR0aDtcblxuICAgICAgICBpZiAocGFyYW1zLnJvdyA9PT0gcGFyYW1zLnJvd0NvdW50IC0gMSlcbiAgICAgICAge1xuICAgICAgICAgICAgaGVpZ2h0ID0gcGFnZS5kW3BhcmFtcy56b29tTGV2ZWxdLmggLSAocGFyYW1zLnJvd0NvdW50IC0gMSkgKiBwYXJhbXMudGlsZURpbWVuc2lvbnMuaGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgaGVpZ2h0ID0gcGFyYW1zLnRpbGVEaW1lbnNpb25zLmhlaWdodDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYXJhbXMuY29sID09PSBwYXJhbXMuY29sQ291bnQgLSAxKVxuICAgICAgICB7XG4gICAgICAgICAgICB3aWR0aCA9IHBhZ2UuZFtwYXJhbXMuem9vbUxldmVsXS53IC0gKHBhcmFtcy5jb2xDb3VudCAtIDEpICogcGFyYW1zLnRpbGVEaW1lbnNpb25zLndpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgd2lkdGggPSBwYXJhbXMudGlsZURpbWVuc2lvbnMud2lkdGg7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB6b29tRGlmZmVyZW5jZSA9IE1hdGgucG93KDIsIG1hbmlmZXN0Lm1heFpvb20gLSBwYXJhbXMuem9vbUxldmVsKTtcblxuICAgICAgICBsZXQgeCA9IHBhcmFtcy5jb2wgKiBwYXJhbXMudGlsZURpbWVuc2lvbnMud2lkdGggKiB6b29tRGlmZmVyZW5jZTtcbiAgICAgICAgbGV0IHkgPSBwYXJhbXMucm93ICogcGFyYW1zLnRpbGVEaW1lbnNpb25zLmhlaWdodCAqIHpvb21EaWZmZXJlbmNlO1xuXG4gICAgICAgIGlmIChwYWdlLmhhc093blByb3BlcnR5KCd4b2Zmc2V0JykpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHggKz0gcGFnZS54b2Zmc2V0O1xuICAgICAgICAgICAgeSArPSBwYWdlLnlvZmZzZXQ7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZWdpb24gPSBbeCwgeSwgd2lkdGggKiB6b29tRGlmZmVyZW5jZSwgaGVpZ2h0ICogem9vbURpZmZlcmVuY2VdLmpvaW4oJywnKTtcblxuICAgICAgICBjb25zdCBxdWFsaXR5ID0gKHBhZ2UuYXBpID4gMS4xKSA/ICdkZWZhdWx0JyA6ICduYXRpdmUnO1xuXG4gICAgICAgIHJldHVybiBlbmNvZGVVUkkocGFnZS51cmwgKyByZWdpb24gKyAnLycgKyB3aWR0aCArICcsJyArIGhlaWdodCArICcvMC8nICsgcXVhbGl0eSArICcuanBnJyk7XG4gICAgfVxufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/iiif-source-adapter.js\n");

/***/ }),

/***/ "./source/js/image-cache.js":
/*!**********************************!*\
  !*** ./source/js/image-cache.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ImageCache; });\nconst debug = __webpack_require__(/*! debug */ \"./node_modules/debug/src/browser.js\")('diva:ImageCache');\n\n/* FIXME(wabain): The caching strategy here is completely\n * arbitrary and the implementation isn't especially efficient.\n */\nconst DEFAULT_MAX_KEYS = 100;\n\nclass ImageCache\n{\n    constructor (options)\n    {\n        options = options || { maxKeys: DEFAULT_MAX_KEYS };\n        this.maxKeys = options.maxKeys || DEFAULT_MAX_KEYS;\n\n        this._held = {};\n        this._urls = {};\n        this._lru = [];\n    }\n\n    get (url)\n    {\n        const record = this._urls[url];\n        return record ? record.img : null;\n    }\n\n    has (url)\n    {\n        return !!this._urls[url];\n    }\n\n    put (url, img)\n    {\n        let record = this._urls[url];\n        if (record)\n        {\n            // FIXME: Does this make sense for this use case?\n            record.img = img;\n            this._promote(record);\n        }\n        else\n        {\n            record = {\n                img: img,\n                url: url\n            };\n\n            this._urls[url] = record;\n            this._tryEvict(1);\n            this._lru.unshift(record);\n        }\n    }\n\n    _promote (record)\n    {\n        const index = this._lru.indexOf(record);\n        this._lru.splice(index, 1);\n        this._lru.unshift(record);\n    }\n\n    _tryEvict (extraCapacity)\n    {\n        const allowedEntryCount = this.maxKeys - extraCapacity;\n\n        if (this._lru.length <= allowedEntryCount)\n            return;\n\n        let evictionIndex = this._lru.length - 1;\n\n        for (;;)\n        {\n            const target = this._lru[evictionIndex];\n\n            if (!this._held[target.url])\n            {\n                debug('Evicting image %s', target.url);\n                this._lru.splice(evictionIndex, 1);\n                delete this._urls[target.url];\n\n                if (this._lru.length <= allowedEntryCount)\n                    break;\n            }\n\n            if (evictionIndex === 0)\n            {\n                /* istanbul ignore next */\n                debug.enabled && debug('Cache overfull by %s (all entries are being held)',\n                    this._lru.length - allowedEntryCount);\n\n                break;\n            }\n\n            evictionIndex--;\n        }\n    }\n\n    acquire (url)\n    {\n        this._held[url] = (this._held[url] || 0) + 1;\n        this._promote(this._urls[url]);\n    }\n\n    release (url)\n    {\n        const count = this._held[url];\n\n        if (count > 1)\n            this._held[url]--;\n        else\n            delete this._held[url];\n\n        this._tryEvict(0);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvaW1hZ2UtY2FjaGUuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvaW1hZ2UtY2FjaGUuanM/ZTU4NiJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkZWJ1ZyA9IHJlcXVpcmUoJ2RlYnVnJykoJ2RpdmE6SW1hZ2VDYWNoZScpO1xuXG4vKiBGSVhNRSh3YWJhaW4pOiBUaGUgY2FjaGluZyBzdHJhdGVneSBoZXJlIGlzIGNvbXBsZXRlbHlcbiAqIGFyYml0cmFyeSBhbmQgdGhlIGltcGxlbWVudGF0aW9uIGlzbid0IGVzcGVjaWFsbHkgZWZmaWNpZW50LlxuICovXG5jb25zdCBERUZBVUxUX01BWF9LRVlTID0gMTAwO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbWFnZUNhY2hlXG57XG4gICAgY29uc3RydWN0b3IgKG9wdGlvbnMpXG4gICAge1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7IG1heEtleXM6IERFRkFVTFRfTUFYX0tFWVMgfTtcbiAgICAgICAgdGhpcy5tYXhLZXlzID0gb3B0aW9ucy5tYXhLZXlzIHx8IERFRkFVTFRfTUFYX0tFWVM7XG5cbiAgICAgICAgdGhpcy5faGVsZCA9IHt9O1xuICAgICAgICB0aGlzLl91cmxzID0ge307XG4gICAgICAgIHRoaXMuX2xydSA9IFtdO1xuICAgIH1cblxuICAgIGdldCAodXJsKVxuICAgIHtcbiAgICAgICAgY29uc3QgcmVjb3JkID0gdGhpcy5fdXJsc1t1cmxdO1xuICAgICAgICByZXR1cm4gcmVjb3JkID8gcmVjb3JkLmltZyA6IG51bGw7XG4gICAgfVxuXG4gICAgaGFzICh1cmwpXG4gICAge1xuICAgICAgICByZXR1cm4gISF0aGlzLl91cmxzW3VybF07XG4gICAgfVxuXG4gICAgcHV0ICh1cmwsIGltZylcbiAgICB7XG4gICAgICAgIGxldCByZWNvcmQgPSB0aGlzLl91cmxzW3VybF07XG4gICAgICAgIGlmIChyZWNvcmQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIEZJWE1FOiBEb2VzIHRoaXMgbWFrZSBzZW5zZSBmb3IgdGhpcyB1c2UgY2FzZT9cbiAgICAgICAgICAgIHJlY29yZC5pbWcgPSBpbWc7XG4gICAgICAgICAgICB0aGlzLl9wcm9tb3RlKHJlY29yZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICByZWNvcmQgPSB7XG4gICAgICAgICAgICAgICAgaW1nOiBpbWcsXG4gICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuX3VybHNbdXJsXSA9IHJlY29yZDtcbiAgICAgICAgICAgIHRoaXMuX3RyeUV2aWN0KDEpO1xuICAgICAgICAgICAgdGhpcy5fbHJ1LnVuc2hpZnQocmVjb3JkKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9wcm9tb3RlIChyZWNvcmQpXG4gICAge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuX2xydS5pbmRleE9mKHJlY29yZCk7XG4gICAgICAgIHRoaXMuX2xydS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB0aGlzLl9scnUudW5zaGlmdChyZWNvcmQpO1xuICAgIH1cblxuICAgIF90cnlFdmljdCAoZXh0cmFDYXBhY2l0eSlcbiAgICB7XG4gICAgICAgIGNvbnN0IGFsbG93ZWRFbnRyeUNvdW50ID0gdGhpcy5tYXhLZXlzIC0gZXh0cmFDYXBhY2l0eTtcblxuICAgICAgICBpZiAodGhpcy5fbHJ1Lmxlbmd0aCA8PSBhbGxvd2VkRW50cnlDb3VudClcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICBsZXQgZXZpY3Rpb25JbmRleCA9IHRoaXMuX2xydS5sZW5ndGggLSAxO1xuXG4gICAgICAgIGZvciAoOzspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuX2xydVtldmljdGlvbkluZGV4XTtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLl9oZWxkW3RhcmdldC51cmxdKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlYnVnKCdFdmljdGluZyBpbWFnZSAlcycsIHRhcmdldC51cmwpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xydS5zcGxpY2UoZXZpY3Rpb25JbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3VybHNbdGFyZ2V0LnVybF07XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbHJ1Lmxlbmd0aCA8PSBhbGxvd2VkRW50cnlDb3VudClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChldmljdGlvbkluZGV4ID09PSAwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgICAgICAgICAgICAgZGVidWcuZW5hYmxlZCAmJiBkZWJ1ZygnQ2FjaGUgb3ZlcmZ1bGwgYnkgJXMgKGFsbCBlbnRyaWVzIGFyZSBiZWluZyBoZWxkKScsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xydS5sZW5ndGggLSBhbGxvd2VkRW50cnlDb3VudCk7XG5cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXZpY3Rpb25JbmRleC0tO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYWNxdWlyZSAodXJsKVxuICAgIHtcbiAgICAgICAgdGhpcy5faGVsZFt1cmxdID0gKHRoaXMuX2hlbGRbdXJsXSB8fCAwKSArIDE7XG4gICAgICAgIHRoaXMuX3Byb21vdGUodGhpcy5fdXJsc1t1cmxdKTtcbiAgICB9XG5cbiAgICByZWxlYXNlICh1cmwpXG4gICAge1xuICAgICAgICBjb25zdCBjb3VudCA9IHRoaXMuX2hlbGRbdXJsXTtcblxuICAgICAgICBpZiAoY291bnQgPiAxKVxuICAgICAgICAgICAgdGhpcy5faGVsZFt1cmxdLS07XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9oZWxkW3VybF07XG5cbiAgICAgICAgdGhpcy5fdHJ5RXZpY3QoMCk7XG4gICAgfVxufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/image-cache.js\n");

/***/ }),

/***/ "./source/js/image-manifest.js":
/*!*************************************!*\
  !*** ./source/js/image-manifest.js ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ImageManifest; });\n/* harmony import */ var _parse_iiif_manifest__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./parse-iiif-manifest */ \"./source/js/parse-iiif-manifest.js\");\n/* harmony import */ var _iiif_source_adapter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./iiif-source-adapter */ \"./source/js/iiif-source-adapter.js\");\n\n\n\n\nclass ImageManifest\n{\n    constructor (data, urlAdapter)\n    {\n        // Save all the data we need\n        this.pages = data.pgs;\n        this.maxZoom = data.max_zoom;\n        this.maxRatio = data.dims.max_ratio;\n        this.minRatio = data.dims.min_ratio;\n        this.itemTitle = data.item_title;\n        this.metadata = data.metadata;\n\n        // Only given for IIIF manifests\n        this.paged = !!data.paged;\n\n        // These are arrays, the index corresponding to the zoom level\n        this._maxWidths = data.dims.max_w;\n        this._maxHeights = data.dims.max_h;\n        this._averageWidths = data.dims.a_wid;\n        this._averageHeights = data.dims.a_hei;\n        this._totalHeights = data.dims.t_hei;\n        this._totalWidths = data.dims.t_wid;\n\n        this._urlAdapter = urlAdapter;\n    }\n\n    static fromIIIF (iiifManifest)\n    {\n        const data = Object(_parse_iiif_manifest__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(iiifManifest);\n        return new ImageManifest(data, new _iiif_source_adapter__WEBPACK_IMPORTED_MODULE_1__[\"default\"]());\n    }\n\n    isPageValid (pageIndex, showNonPagedPages)\n    {\n        if (!showNonPagedPages && this.paged && !this.pages[pageIndex].paged)\n        {\n            return false;\n        }\n\n        return pageIndex >= 0 && pageIndex < this.pages.length;\n    }\n\n    getMaxPageDimensions (pageIndex)\n    {\n        const maxDims = this.pages[pageIndex].d[this.maxZoom];\n\n        return {\n            height: maxDims.h,\n            width: maxDims.w\n        };\n    }\n\n    getPageDimensionsAtZoomLevel (pageIndex, zoomLevel)\n    {\n        const maxDims = this.pages[pageIndex].d[this.maxZoom];\n\n        const scaleRatio = getScaleRatio(this.maxZoom, zoomLevel);\n\n        return {\n            height: maxDims.h * scaleRatio,\n            width: maxDims.w * scaleRatio\n        };\n    }\n\n    /**\n     * Returns a URL for the image of the given page. The optional size\n     * parameter supports setting the image width or height (default is\n     * full-sized).\n     */\n    getPageImageURL (pageIndex, size)\n    {\n        return this._urlAdapter.getPageImageURL(this, pageIndex, size);\n    }\n\n    /**\n     * Return an array of tile objects for the specified page and integer zoom level\n     */\n    getPageImageTiles (pageIndex, zoomLevel, tileDimensions)\n    {\n        const page = this.pages[pageIndex];\n\n        if (!isFinite(zoomLevel) || zoomLevel % 1 !== 0)\n        {\n            throw new TypeError('Zoom level must be an integer: ' + zoomLevel);\n        }\n\n        const rows = Math.ceil(page.d[zoomLevel].h / tileDimensions.height);\n        const cols = Math.ceil(page.d[zoomLevel].w / tileDimensions.width);\n\n        const tiles = [];\n\n        let row, col, url;\n\n        for (row = 0; row < rows; row++)\n        {\n            for (col = 0; col < cols; col++)\n            {\n                url = this._urlAdapter.getTileImageURL(this, pageIndex, {\n                    row: row,\n                    col: col,\n                    rowCount: rows,\n                    colCount: cols,\n                    zoomLevel: zoomLevel,\n                    tileDimensions: tileDimensions\n                });\n\n                // FIXME: Dimensions should account for partial tiles (e.g. the\n                // last row and column in a tiled image)\n                tiles.push({\n                    row: row,\n                    col: col,\n                    zoomLevel: zoomLevel,\n                    dimensions: {\n                        height: tileDimensions.height,\n                        width: tileDimensions.width\n                    },\n                    offset: {\n                        top: row * tileDimensions.height,\n                        left: col * tileDimensions.width\n                    },\n                    url: url\n                });\n            }\n        }\n\n        return {\n            zoomLevel: zoomLevel,\n            rows: rows,\n            cols: cols,\n            tiles: tiles\n        };\n    }\n}\n\nImageManifest.prototype.getMaxWidth = zoomedPropertyGetter('_maxWidths');\nImageManifest.prototype.getMaxHeight = zoomedPropertyGetter('_maxHeights');\nImageManifest.prototype.getAverageWidth = zoomedPropertyGetter('_averageWidths');\nImageManifest.prototype.getAverageHeight = zoomedPropertyGetter('_averageHeights');\nImageManifest.prototype.getTotalWidth = zoomedPropertyGetter('_totalWidths');\nImageManifest.prototype.getTotalHeight = zoomedPropertyGetter('_totalHeights');\n\nfunction zoomedPropertyGetter (privateName)\n{\n    return function (zoomLevel)\n    {\n        return this[privateName][zoomLevel];\n    };\n}\n\nfunction getScaleRatio (sourceZoomLevel, targetZoomLevel)\n{\n    return 1 / Math.pow(2, sourceZoomLevel - targetZoomLevel);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvaW1hZ2UtbWFuaWZlc3QuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvaW1hZ2UtbWFuaWZlc3QuanM/ZGYxYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGFyc2VJSUlGTWFuaWZlc3QgZnJvbSAnLi9wYXJzZS1paWlmLW1hbmlmZXN0JztcbmltcG9ydCBJSUlGU291cmNlQWRhcHRlciBmcm9tIFwiLi9paWlmLXNvdXJjZS1hZGFwdGVyXCI7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW1hZ2VNYW5pZmVzdFxue1xuICAgIGNvbnN0cnVjdG9yIChkYXRhLCB1cmxBZGFwdGVyKVxuICAgIHtcbiAgICAgICAgLy8gU2F2ZSBhbGwgdGhlIGRhdGEgd2UgbmVlZFxuICAgICAgICB0aGlzLnBhZ2VzID0gZGF0YS5wZ3M7XG4gICAgICAgIHRoaXMubWF4Wm9vbSA9IGRhdGEubWF4X3pvb207XG4gICAgICAgIHRoaXMubWF4UmF0aW8gPSBkYXRhLmRpbXMubWF4X3JhdGlvO1xuICAgICAgICB0aGlzLm1pblJhdGlvID0gZGF0YS5kaW1zLm1pbl9yYXRpbztcbiAgICAgICAgdGhpcy5pdGVtVGl0bGUgPSBkYXRhLml0ZW1fdGl0bGU7XG4gICAgICAgIHRoaXMubWV0YWRhdGEgPSBkYXRhLm1ldGFkYXRhO1xuXG4gICAgICAgIC8vIE9ubHkgZ2l2ZW4gZm9yIElJSUYgbWFuaWZlc3RzXG4gICAgICAgIHRoaXMucGFnZWQgPSAhIWRhdGEucGFnZWQ7XG5cbiAgICAgICAgLy8gVGhlc2UgYXJlIGFycmF5cywgdGhlIGluZGV4IGNvcnJlc3BvbmRpbmcgdG8gdGhlIHpvb20gbGV2ZWxcbiAgICAgICAgdGhpcy5fbWF4V2lkdGhzID0gZGF0YS5kaW1zLm1heF93O1xuICAgICAgICB0aGlzLl9tYXhIZWlnaHRzID0gZGF0YS5kaW1zLm1heF9oO1xuICAgICAgICB0aGlzLl9hdmVyYWdlV2lkdGhzID0gZGF0YS5kaW1zLmFfd2lkO1xuICAgICAgICB0aGlzLl9hdmVyYWdlSGVpZ2h0cyA9IGRhdGEuZGltcy5hX2hlaTtcbiAgICAgICAgdGhpcy5fdG90YWxIZWlnaHRzID0gZGF0YS5kaW1zLnRfaGVpO1xuICAgICAgICB0aGlzLl90b3RhbFdpZHRocyA9IGRhdGEuZGltcy50X3dpZDtcblxuICAgICAgICB0aGlzLl91cmxBZGFwdGVyID0gdXJsQWRhcHRlcjtcbiAgICB9XG5cbiAgICBzdGF0aWMgZnJvbUlJSUYgKGlpaWZNYW5pZmVzdClcbiAgICB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBwYXJzZUlJSUZNYW5pZmVzdChpaWlmTWFuaWZlc3QpO1xuICAgICAgICByZXR1cm4gbmV3IEltYWdlTWFuaWZlc3QoZGF0YSwgbmV3IElJSUZTb3VyY2VBZGFwdGVyKCkpO1xuICAgIH1cblxuICAgIGlzUGFnZVZhbGlkIChwYWdlSW5kZXgsIHNob3dOb25QYWdlZFBhZ2VzKVxuICAgIHtcbiAgICAgICAgaWYgKCFzaG93Tm9uUGFnZWRQYWdlcyAmJiB0aGlzLnBhZ2VkICYmICF0aGlzLnBhZ2VzW3BhZ2VJbmRleF0ucGFnZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwYWdlSW5kZXggPj0gMCAmJiBwYWdlSW5kZXggPCB0aGlzLnBhZ2VzLmxlbmd0aDtcbiAgICB9XG5cbiAgICBnZXRNYXhQYWdlRGltZW5zaW9ucyAocGFnZUluZGV4KVxuICAgIHtcbiAgICAgICAgY29uc3QgbWF4RGltcyA9IHRoaXMucGFnZXNbcGFnZUluZGV4XS5kW3RoaXMubWF4Wm9vbV07XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGhlaWdodDogbWF4RGltcy5oLFxuICAgICAgICAgICAgd2lkdGg6IG1heERpbXMud1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGdldFBhZ2VEaW1lbnNpb25zQXRab29tTGV2ZWwgKHBhZ2VJbmRleCwgem9vbUxldmVsKVxuICAgIHtcbiAgICAgICAgY29uc3QgbWF4RGltcyA9IHRoaXMucGFnZXNbcGFnZUluZGV4XS5kW3RoaXMubWF4Wm9vbV07XG5cbiAgICAgICAgY29uc3Qgc2NhbGVSYXRpbyA9IGdldFNjYWxlUmF0aW8odGhpcy5tYXhab29tLCB6b29tTGV2ZWwpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoZWlnaHQ6IG1heERpbXMuaCAqIHNjYWxlUmF0aW8sXG4gICAgICAgICAgICB3aWR0aDogbWF4RGltcy53ICogc2NhbGVSYXRpb1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBVUkwgZm9yIHRoZSBpbWFnZSBvZiB0aGUgZ2l2ZW4gcGFnZS4gVGhlIG9wdGlvbmFsIHNpemVcbiAgICAgKiBwYXJhbWV0ZXIgc3VwcG9ydHMgc2V0dGluZyB0aGUgaW1hZ2Ugd2lkdGggb3IgaGVpZ2h0IChkZWZhdWx0IGlzXG4gICAgICogZnVsbC1zaXplZCkuXG4gICAgICovXG4gICAgZ2V0UGFnZUltYWdlVVJMIChwYWdlSW5kZXgsIHNpemUpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fdXJsQWRhcHRlci5nZXRQYWdlSW1hZ2VVUkwodGhpcywgcGFnZUluZGV4LCBzaXplKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgb2YgdGlsZSBvYmplY3RzIGZvciB0aGUgc3BlY2lmaWVkIHBhZ2UgYW5kIGludGVnZXIgem9vbSBsZXZlbFxuICAgICAqL1xuICAgIGdldFBhZ2VJbWFnZVRpbGVzIChwYWdlSW5kZXgsIHpvb21MZXZlbCwgdGlsZURpbWVuc2lvbnMpXG4gICAge1xuICAgICAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlc1twYWdlSW5kZXhdO1xuXG4gICAgICAgIGlmICghaXNGaW5pdGUoem9vbUxldmVsKSB8fCB6b29tTGV2ZWwgJSAxICE9PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdab29tIGxldmVsIG11c3QgYmUgYW4gaW50ZWdlcjogJyArIHpvb21MZXZlbCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByb3dzID0gTWF0aC5jZWlsKHBhZ2UuZFt6b29tTGV2ZWxdLmggLyB0aWxlRGltZW5zaW9ucy5oZWlnaHQpO1xuICAgICAgICBjb25zdCBjb2xzID0gTWF0aC5jZWlsKHBhZ2UuZFt6b29tTGV2ZWxdLncgLyB0aWxlRGltZW5zaW9ucy53aWR0aCk7XG5cbiAgICAgICAgY29uc3QgdGlsZXMgPSBbXTtcblxuICAgICAgICBsZXQgcm93LCBjb2wsIHVybDtcblxuICAgICAgICBmb3IgKHJvdyA9IDA7IHJvdyA8IHJvd3M7IHJvdysrKVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKGNvbCA9IDA7IGNvbCA8IGNvbHM7IGNvbCsrKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHVybCA9IHRoaXMuX3VybEFkYXB0ZXIuZ2V0VGlsZUltYWdlVVJMKHRoaXMsIHBhZ2VJbmRleCwge1xuICAgICAgICAgICAgICAgICAgICByb3c6IHJvdyxcbiAgICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICAgIHJvd0NvdW50OiByb3dzLFxuICAgICAgICAgICAgICAgICAgICBjb2xDb3VudDogY29scyxcbiAgICAgICAgICAgICAgICAgICAgem9vbUxldmVsOiB6b29tTGV2ZWwsXG4gICAgICAgICAgICAgICAgICAgIHRpbGVEaW1lbnNpb25zOiB0aWxlRGltZW5zaW9uc1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gRklYTUU6IERpbWVuc2lvbnMgc2hvdWxkIGFjY291bnQgZm9yIHBhcnRpYWwgdGlsZXMgKGUuZy4gdGhlXG4gICAgICAgICAgICAgICAgLy8gbGFzdCByb3cgYW5kIGNvbHVtbiBpbiBhIHRpbGVkIGltYWdlKVxuICAgICAgICAgICAgICAgIHRpbGVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICByb3c6IHJvdyxcbiAgICAgICAgICAgICAgICAgICAgY29sOiBjb2wsXG4gICAgICAgICAgICAgICAgICAgIHpvb21MZXZlbDogem9vbUxldmVsLFxuICAgICAgICAgICAgICAgICAgICBkaW1lbnNpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHRpbGVEaW1lbnNpb25zLmhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0aWxlRGltZW5zaW9ucy53aWR0aFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogcm93ICogdGlsZURpbWVuc2lvbnMuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogY29sICogdGlsZURpbWVuc2lvbnMud2lkdGhcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB6b29tTGV2ZWw6IHpvb21MZXZlbCxcbiAgICAgICAgICAgIHJvd3M6IHJvd3MsXG4gICAgICAgICAgICBjb2xzOiBjb2xzLFxuICAgICAgICAgICAgdGlsZXM6IHRpbGVzXG4gICAgICAgIH07XG4gICAgfVxufVxuXG5JbWFnZU1hbmlmZXN0LnByb3RvdHlwZS5nZXRNYXhXaWR0aCA9IHpvb21lZFByb3BlcnR5R2V0dGVyKCdfbWF4V2lkdGhzJyk7XG5JbWFnZU1hbmlmZXN0LnByb3RvdHlwZS5nZXRNYXhIZWlnaHQgPSB6b29tZWRQcm9wZXJ0eUdldHRlcignX21heEhlaWdodHMnKTtcbkltYWdlTWFuaWZlc3QucHJvdG90eXBlLmdldEF2ZXJhZ2VXaWR0aCA9IHpvb21lZFByb3BlcnR5R2V0dGVyKCdfYXZlcmFnZVdpZHRocycpO1xuSW1hZ2VNYW5pZmVzdC5wcm90b3R5cGUuZ2V0QXZlcmFnZUhlaWdodCA9IHpvb21lZFByb3BlcnR5R2V0dGVyKCdfYXZlcmFnZUhlaWdodHMnKTtcbkltYWdlTWFuaWZlc3QucHJvdG90eXBlLmdldFRvdGFsV2lkdGggPSB6b29tZWRQcm9wZXJ0eUdldHRlcignX3RvdGFsV2lkdGhzJyk7XG5JbWFnZU1hbmlmZXN0LnByb3RvdHlwZS5nZXRUb3RhbEhlaWdodCA9IHpvb21lZFByb3BlcnR5R2V0dGVyKCdfdG90YWxIZWlnaHRzJyk7XG5cbmZ1bmN0aW9uIHpvb21lZFByb3BlcnR5R2V0dGVyIChwcml2YXRlTmFtZSlcbntcbiAgICByZXR1cm4gZnVuY3Rpb24gKHpvb21MZXZlbClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzW3ByaXZhdGVOYW1lXVt6b29tTGV2ZWxdO1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGdldFNjYWxlUmF0aW8gKHNvdXJjZVpvb21MZXZlbCwgdGFyZ2V0Wm9vbUxldmVsKVxue1xuICAgIHJldHVybiAxIC8gTWF0aC5wb3coMiwgc291cmNlWm9vbUxldmVsIC0gdGFyZ2V0Wm9vbUxldmVsKTtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/image-manifest.js\n");

/***/ }),

/***/ "./source/js/image-request-handler.js":
/*!********************************************!*\
  !*** ./source/js/image-request-handler.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ImageRequestHandler; });\nconst debug = __webpack_require__(/*! debug */ \"./node_modules/debug/src/browser.js\")('diva:ImageRequestHandler');\n/**\n * Handler for the request for an image tile\n *\n * @param url\n * @param callback\n * @constructor\n */\nclass ImageRequestHandler\n{\n    constructor (options)\n    {\n        this._url = options.url;\n        this._callback = options.load;\n        this._errorCallback = options.error;\n        this.timeoutTime = options.timeoutTime || 0;\n        this._aborted = this._complete = false;\n\n        //Use a timeout to allow the requests to be debounced (as they are in renderer)\n        this.timeout = setTimeout(() => {\n            // Initiate the request\n            this._image = new Image();\n            this._image.crossOrigin = \"anonymous\";\n            this._image.onload = this._handleLoad.bind(this);\n            this._image.onerror = this._handleError.bind(this);\n            this._image.src = options.url;\n\n            debug('Requesting image %s', options.url);\n        }, this.timeoutTime);\n    }\n\n    abort ()\n    {\n        debug('Aborting request to %s', this._url);\n\n        clearTimeout(this.timeout);\n\n        // FIXME\n        // People on the Internet say that doing this {{should/should not}} abort the request. I believe\n        // it corresponds to what the WHATWG HTML spec says should happen when the UA\n        // updates the image data if selected source is null.\n        //\n        // Sources:\n        //\n        // https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element\n        // http://stackoverflow.com/questions/7390888/does-changing-the-src-attribute-of-an-image-stop-the-image-from-downloading\n        if (this._image)\n        {\n            this._image.onload = this._image.onerror = null;\n\n            this._image.src = '';\n        }\n\n        this._aborted = true;\n    }\n\n    _handleLoad ()\n    {\n        if (this._aborted)\n        {\n            console.error('ImageRequestHandler invoked on cancelled request for ' + this._url);\n            return;\n        }\n\n        if (this._complete)\n        {\n            console.error('ImageRequestHandler invoked on completed request for ' + this._url);\n            return;\n        }\n\n        this._complete = true;\n\n        debug('Received image %s', this._url);\n        this._callback(this._image);\n    }\n\n    _handleError ()\n    {\n        debug('Failed to load image %s', this._url);\n        this._errorCallback(this._image);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvaW1hZ2UtcmVxdWVzdC1oYW5kbGVyLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL2ltYWdlLXJlcXVlc3QtaGFuZGxlci5qcz85N2NlIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGRlYnVnID0gcmVxdWlyZSgnZGVidWcnKSgnZGl2YTpJbWFnZVJlcXVlc3RIYW5kbGVyJyk7XG4vKipcbiAqIEhhbmRsZXIgZm9yIHRoZSByZXF1ZXN0IGZvciBhbiBpbWFnZSB0aWxlXG4gKlxuICogQHBhcmFtIHVybFxuICogQHBhcmFtIGNhbGxiYWNrXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW1hZ2VSZXF1ZXN0SGFuZGxlclxue1xuICAgIGNvbnN0cnVjdG9yIChvcHRpb25zKVxuICAgIHtcbiAgICAgICAgdGhpcy5fdXJsID0gb3B0aW9ucy51cmw7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gb3B0aW9ucy5sb2FkO1xuICAgICAgICB0aGlzLl9lcnJvckNhbGxiYWNrID0gb3B0aW9ucy5lcnJvcjtcbiAgICAgICAgdGhpcy50aW1lb3V0VGltZSA9IG9wdGlvbnMudGltZW91dFRpbWUgfHwgMDtcbiAgICAgICAgdGhpcy5fYWJvcnRlZCA9IHRoaXMuX2NvbXBsZXRlID0gZmFsc2U7XG5cbiAgICAgICAgLy9Vc2UgYSB0aW1lb3V0IHRvIGFsbG93IHRoZSByZXF1ZXN0cyB0byBiZSBkZWJvdW5jZWQgKGFzIHRoZXkgYXJlIGluIHJlbmRlcmVyKVxuICAgICAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIC8vIEluaXRpYXRlIHRoZSByZXF1ZXN0XG4gICAgICAgICAgICB0aGlzLl9pbWFnZSA9IG5ldyBJbWFnZSgpO1xuICAgICAgICAgICAgdGhpcy5faW1hZ2UuY3Jvc3NPcmlnaW4gPSBcImFub255bW91c1wiO1xuICAgICAgICAgICAgdGhpcy5faW1hZ2Uub25sb2FkID0gdGhpcy5faGFuZGxlTG9hZC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5faW1hZ2Uub25lcnJvciA9IHRoaXMuX2hhbmRsZUVycm9yLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSBvcHRpb25zLnVybDtcblxuICAgICAgICAgICAgZGVidWcoJ1JlcXVlc3RpbmcgaW1hZ2UgJXMnLCBvcHRpb25zLnVybCk7XG4gICAgICAgIH0sIHRoaXMudGltZW91dFRpbWUpO1xuICAgIH1cblxuICAgIGFib3J0ICgpXG4gICAge1xuICAgICAgICBkZWJ1ZygnQWJvcnRpbmcgcmVxdWVzdCB0byAlcycsIHRoaXMuX3VybCk7XG5cbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG5cbiAgICAgICAgLy8gRklYTUVcbiAgICAgICAgLy8gUGVvcGxlIG9uIHRoZSBJbnRlcm5ldCBzYXkgdGhhdCBkb2luZyB0aGlzIHt7c2hvdWxkL3Nob3VsZCBub3R9fSBhYm9ydCB0aGUgcmVxdWVzdC4gSSBiZWxpZXZlXG4gICAgICAgIC8vIGl0IGNvcnJlc3BvbmRzIHRvIHdoYXQgdGhlIFdIQVRXRyBIVE1MIHNwZWMgc2F5cyBzaG91bGQgaGFwcGVuIHdoZW4gdGhlIFVBXG4gICAgICAgIC8vIHVwZGF0ZXMgdGhlIGltYWdlIGRhdGEgaWYgc2VsZWN0ZWQgc291cmNlIGlzIG51bGwuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFNvdXJjZXM6XG4gICAgICAgIC8vXG4gICAgICAgIC8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2VtYmVkZGVkLWNvbnRlbnQuaHRtbCN0aGUtaW1nLWVsZW1lbnRcbiAgICAgICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy83MzkwODg4L2RvZXMtY2hhbmdpbmctdGhlLXNyYy1hdHRyaWJ1dGUtb2YtYW4taW1hZ2Utc3RvcC10aGUtaW1hZ2UtZnJvbS1kb3dubG9hZGluZ1xuICAgICAgICBpZiAodGhpcy5faW1hZ2UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2ltYWdlLm9ubG9hZCA9IHRoaXMuX2ltYWdlLm9uZXJyb3IgPSBudWxsO1xuXG4gICAgICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2Fib3J0ZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIF9oYW5kbGVMb2FkICgpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fYWJvcnRlZClcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignSW1hZ2VSZXF1ZXN0SGFuZGxlciBpbnZva2VkIG9uIGNhbmNlbGxlZCByZXF1ZXN0IGZvciAnICsgdGhpcy5fdXJsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9jb21wbGV0ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignSW1hZ2VSZXF1ZXN0SGFuZGxlciBpbnZva2VkIG9uIGNvbXBsZXRlZCByZXF1ZXN0IGZvciAnICsgdGhpcy5fdXJsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2NvbXBsZXRlID0gdHJ1ZTtcblxuICAgICAgICBkZWJ1ZygnUmVjZWl2ZWQgaW1hZ2UgJXMnLCB0aGlzLl91cmwpO1xuICAgICAgICB0aGlzLl9jYWxsYmFjayh0aGlzLl9pbWFnZSk7XG4gICAgfVxuXG4gICAgX2hhbmRsZUVycm9yICgpXG4gICAge1xuICAgICAgICBkZWJ1ZygnRmFpbGVkIHRvIGxvYWQgaW1hZ2UgJXMnLCB0aGlzLl91cmwpO1xuICAgICAgICB0aGlzLl9lcnJvckNhbGxiYWNrKHRoaXMuX2ltYWdlKTtcbiAgICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/image-request-handler.js\n");

/***/ }),

/***/ "./source/js/interpolate-animation.js":
/*!********************************************!*\
  !*** ./source/js/interpolate-animation.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n// TODO: requestAnimationFrame fallback\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    animate,\n    easing: {\n        linear: linearEasing,\n        cubic: inOutCubicEasing\n    }\n});\n\nlet now;\n\nif (typeof performance !== 'undefined' && performance.now)\n{\n    now = () => { return performance.now(); };\n}\nelse\n{\n    now = () => { return Date.now(); };\n}\n\n\nfunction animate (options)\n{\n    const durationMs = options.duration;\n    const parameters = options.parameters;\n    const onUpdate = options.onUpdate;\n    const onEnd = options.onEnd;\n\n    // Setup\n    // Times are in milliseconds from a basically arbitrary start\n    const start = now();\n    const end = start + durationMs;\n\n    const tweenFns = {};\n    const values = {};\n    const paramKeys = Object.keys(parameters);\n\n    paramKeys.forEach(key => {\n        const config = parameters[key];\n        tweenFns[key] = interpolate(config.from, config.to, config.easing || inOutCubicEasing);\n    });\n\n    // Run it!\n    let requestId = requestAnimationFrame(update);\n\n    return {\n        cancel()\n        {\n            if (requestId !== null)\n            {\n                cancelAnimationFrame(requestId);\n                handleAnimationCompletion({\n                    interrupted: true\n                });\n            }\n        }\n    };\n\n    function update()\n    {\n        const current = now();\n        const elapsed = Math.min((current - start) / durationMs, 1);\n\n        updateValues(elapsed);\n        onUpdate(values);\n\n        if (current < end)\n        {\n            requestId = requestAnimationFrame(update);\n        }\n        else\n        {\n            handleAnimationCompletion({\n                interrupted: false\n            });\n        }\n    }\n\n    function updateValues(elapsed)\n    {\n        paramKeys.forEach(key => {\n            values[key] = tweenFns[key](elapsed);\n        });\n    }\n\n    function handleAnimationCompletion(info)\n    {\n        requestId = null;\n\n        if (onEnd)\n            onEnd(info);\n    }\n}\n\nfunction interpolate(start, end, easing)\n{\n    return (elapsed) => { return start + (end - start) * easing(elapsed); };\n}\n\n/**\n * Easing functions. inOutCubicEasing is the default, but\n * others are given for convenience.\n *\n **/\nfunction linearEasing(e)\n{\n    return e;\n}\n\n/* jshint ignore:start */\nfunction inOutQuadEasing (e)\n{\n    return e < .5 ? 2 * e * e : -1+(4-2 * e) * e\n}\n/* jshint ignore:end */\n\n\nfunction inOutCubicEasing (t)\n{\n    return t < 0.5 ? 4 * t * t * t : ( t - 1 ) * ( 2 * t - 2 ) * ( 2 * t - 2 ) + 1;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvaW50ZXJwb2xhdGUtYW5pbWF0aW9uLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL2ludGVycG9sYXRlLWFuaW1hdGlvbi5qcz8zYzRhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRPRE86IHJlcXVlc3RBbmltYXRpb25GcmFtZSBmYWxsYmFja1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgYW5pbWF0ZSxcbiAgICBlYXNpbmc6IHtcbiAgICAgICAgbGluZWFyOiBsaW5lYXJFYXNpbmcsXG4gICAgICAgIGN1YmljOiBpbk91dEN1YmljRWFzaW5nXG4gICAgfVxufTtcblxubGV0IG5vdztcblxuaWYgKHR5cGVvZiBwZXJmb3JtYW5jZSAhPT0gJ3VuZGVmaW5lZCcgJiYgcGVyZm9ybWFuY2Uubm93KVxue1xuICAgIG5vdyA9ICgpID0+IHsgcmV0dXJuIHBlcmZvcm1hbmNlLm5vdygpOyB9O1xufVxuZWxzZVxue1xuICAgIG5vdyA9ICgpID0+IHsgcmV0dXJuIERhdGUubm93KCk7IH07XG59XG5cblxuZnVuY3Rpb24gYW5pbWF0ZSAob3B0aW9ucylcbntcbiAgICBjb25zdCBkdXJhdGlvbk1zID0gb3B0aW9ucy5kdXJhdGlvbjtcbiAgICBjb25zdCBwYXJhbWV0ZXJzID0gb3B0aW9ucy5wYXJhbWV0ZXJzO1xuICAgIGNvbnN0IG9uVXBkYXRlID0gb3B0aW9ucy5vblVwZGF0ZTtcbiAgICBjb25zdCBvbkVuZCA9IG9wdGlvbnMub25FbmQ7XG5cbiAgICAvLyBTZXR1cFxuICAgIC8vIFRpbWVzIGFyZSBpbiBtaWxsaXNlY29uZHMgZnJvbSBhIGJhc2ljYWxseSBhcmJpdHJhcnkgc3RhcnRcbiAgICBjb25zdCBzdGFydCA9IG5vdygpO1xuICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgZHVyYXRpb25NcztcblxuICAgIGNvbnN0IHR3ZWVuRm5zID0ge307XG4gICAgY29uc3QgdmFsdWVzID0ge307XG4gICAgY29uc3QgcGFyYW1LZXlzID0gT2JqZWN0LmtleXMocGFyYW1ldGVycyk7XG5cbiAgICBwYXJhbUtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBjb25zdCBjb25maWcgPSBwYXJhbWV0ZXJzW2tleV07XG4gICAgICAgIHR3ZWVuRm5zW2tleV0gPSBpbnRlcnBvbGF0ZShjb25maWcuZnJvbSwgY29uZmlnLnRvLCBjb25maWcuZWFzaW5nIHx8IGluT3V0Q3ViaWNFYXNpbmcpO1xuICAgIH0pO1xuXG4gICAgLy8gUnVuIGl0IVxuICAgIGxldCByZXF1ZXN0SWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGNhbmNlbCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0SWQgIT09IG51bGwpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUocmVxdWVzdElkKTtcbiAgICAgICAgICAgICAgICBoYW5kbGVBbmltYXRpb25Db21wbGV0aW9uKHtcbiAgICAgICAgICAgICAgICAgICAgaW50ZXJydXB0ZWQ6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiB1cGRhdGUoKVxuICAgIHtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IG5vdygpO1xuICAgICAgICBjb25zdCBlbGFwc2VkID0gTWF0aC5taW4oKGN1cnJlbnQgLSBzdGFydCkgLyBkdXJhdGlvbk1zLCAxKTtcblxuICAgICAgICB1cGRhdGVWYWx1ZXMoZWxhcHNlZCk7XG4gICAgICAgIG9uVXBkYXRlKHZhbHVlcyk7XG5cbiAgICAgICAgaWYgKGN1cnJlbnQgPCBlbmQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlcXVlc3RJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh1cGRhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgaGFuZGxlQW5pbWF0aW9uQ29tcGxldGlvbih7XG4gICAgICAgICAgICAgICAgaW50ZXJydXB0ZWQ6IGZhbHNlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVZhbHVlcyhlbGFwc2VkKVxuICAgIHtcbiAgICAgICAgcGFyYW1LZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIHZhbHVlc1trZXldID0gdHdlZW5GbnNba2V5XShlbGFwc2VkKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFuZGxlQW5pbWF0aW9uQ29tcGxldGlvbihpbmZvKVxuICAgIHtcbiAgICAgICAgcmVxdWVzdElkID0gbnVsbDtcblxuICAgICAgICBpZiAob25FbmQpXG4gICAgICAgICAgICBvbkVuZChpbmZvKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGludGVycG9sYXRlKHN0YXJ0LCBlbmQsIGVhc2luZylcbntcbiAgICByZXR1cm4gKGVsYXBzZWQpID0+IHsgcmV0dXJuIHN0YXJ0ICsgKGVuZCAtIHN0YXJ0KSAqIGVhc2luZyhlbGFwc2VkKTsgfTtcbn1cblxuLyoqXG4gKiBFYXNpbmcgZnVuY3Rpb25zLiBpbk91dEN1YmljRWFzaW5nIGlzIHRoZSBkZWZhdWx0LCBidXRcbiAqIG90aGVycyBhcmUgZ2l2ZW4gZm9yIGNvbnZlbmllbmNlLlxuICpcbiAqKi9cbmZ1bmN0aW9uIGxpbmVhckVhc2luZyhlKVxue1xuICAgIHJldHVybiBlO1xufVxuXG4vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG5mdW5jdGlvbiBpbk91dFF1YWRFYXNpbmcgKGUpXG57XG4gICAgcmV0dXJuIGUgPCAuNSA/IDIgKiBlICogZSA6IC0xKyg0LTIgKiBlKSAqIGVcbn1cbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG5cblxuZnVuY3Rpb24gaW5PdXRDdWJpY0Vhc2luZyAodClcbntcbiAgICByZXR1cm4gdCA8IDAuNSA/IDQgKiB0ICogdCAqIHQgOiAoIHQgLSAxICkgKiAoIDIgKiB0IC0gMiApICogKCAyICogdCAtIDIgKSArIDE7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/interpolate-animation.js\n");

/***/ }),

/***/ "./source/js/page-layouts/book-layout.js":
/*!***********************************************!*\
  !*** ./source/js/page-layouts/book-layout.js ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return getBookLayoutGroups; });\n/* harmony import */ var _page_dimensions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./page-dimensions */ \"./source/js/page-layouts/page-dimensions.js\");\n\n\nfunction getBookLayoutGroups (viewerConfig)\n{\n    const groupings = getGroupings(viewerConfig);\n\n    return groupings.map(grouping => getGroupLayoutsFromPageGrouping(viewerConfig, grouping));\n}\n\nfunction getGroupings(viewerConfig)\n{\n    const manifest = viewerConfig.manifest;\n\n    const pagesByGroup = [];\n    let leftPage = null;\n    let nonPagedPages = []; // Pages to display below the current group\n\n    const _addNonPagedPages = () =>\n    {\n        for (let i = 0, nlen = nonPagedPages.length; i < nlen; i++)\n        {\n            pagesByGroup.push([ nonPagedPages[i] ]);\n        }\n        nonPagedPages = [];\n    };\n\n    manifest.pages.forEach( (page, index) =>\n    {\n        const pageRecord = {\n            index: index,\n            dimensions: Object(_page_dimensions__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(index, manifest),\n            paged: (!manifest.paged || page.paged)\n        };\n\n        // Only display non-paged pages if specified in the settings\n        if (!viewerConfig.showNonPagedPages && !pageRecord.paged)\n            return;\n\n        if (!pageRecord.paged)\n        {\n            nonPagedPages.push(pageRecord);\n        }\n        else if (index === 0 || page.facingPages)\n        {\n            // The first page is placed on its own\n            pagesByGroup.push([pageRecord]);\n            _addNonPagedPages();\n        }\n        else if (leftPage === null)\n        {\n            leftPage = pageRecord;\n        }\n        else\n        {\n            pagesByGroup.push([leftPage, pageRecord]);\n            leftPage = null;\n            _addNonPagedPages();\n        }\n    });\n\n    // Flush a final left page\n    if (leftPage !== null)\n    {\n        pagesByGroup.push([leftPage]);\n        _addNonPagedPages();\n    }\n\n    return pagesByGroup;\n}\n\nfunction getGroupLayoutsFromPageGrouping(viewerConfig, grouping)\n{\n    const verticallyOriented = viewerConfig.verticallyOriented;\n\n    if (grouping.length === 2)\n        return getFacingPageGroup(grouping[0], grouping[1], verticallyOriented);\n\n    const page = grouping[0];\n    const pageDims = page.dimensions;\n\n    // The first page is placed on its own to the right in vertical orientation.\n    // NB that this needs to be the page with index 0; if the first page is excluded\n    // from the layout then this special case shouldn't apply.\n    // If the page is tagged as 'non-paged', center it horizontally\n    let leftOffset;\n    if (page.paged)\n        leftOffset = (page.index === 0 && verticallyOriented) ? pageDims.width : 0;\n    else\n        leftOffset = (verticallyOriented) ? pageDims.width / 2 : 0;\n\n    const shouldBeHorizontallyAdjusted =\n        verticallyOriented && !viewerConfig.manifest.pages[page.index].facingPages;\n\n    // We need to left-align the page in vertical orientation, so we double\n    // the group width\n    return {\n        dimensions: {\n            height: pageDims.height,\n            width: shouldBeHorizontallyAdjusted ? pageDims.width * 2 : pageDims.width\n        },\n        pages: [{\n            index: page.index,\n            groupOffset: {\n                top: 0,\n                left: leftOffset\n            },\n            dimensions: pageDims\n        }]\n    };\n}\n\nfunction getFacingPageGroup(leftPage, rightPage, verticallyOriented)\n{\n    const leftDims = leftPage.dimensions;\n    const rightDims = rightPage.dimensions;\n\n    const height = Math.max(leftDims.height, rightDims.height);\n\n    let width, firstLeftOffset, secondLeftOffset;\n\n    if (verticallyOriented)\n    {\n        const midWidth = Math.max(leftDims.width, rightDims.width);\n\n        width = midWidth * 2;\n\n        firstLeftOffset = midWidth - leftDims.width;\n        secondLeftOffset = midWidth;\n    }\n    else\n    {\n        width = leftDims.width + rightDims.width;\n        firstLeftOffset = 0;\n        secondLeftOffset = leftDims.width;\n    }\n\n    return {\n        dimensions: {\n            height: height,\n            width: width\n        },\n        pages: [\n            {\n                index: leftPage.index,\n                dimensions: leftDims,\n                groupOffset: {\n                    top: 0,\n                    left: firstLeftOffset\n                }\n            },\n            {\n                index: rightPage.index,\n                dimensions: rightDims,\n                groupOffset: {\n                    top: 0,\n                    left: secondLeftOffset\n                }\n            }\n        ]\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvcGFnZS1sYXlvdXRzL2Jvb2stbGF5b3V0LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL3BhZ2UtbGF5b3V0cy9ib29rLWxheW91dC5qcz83YWJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBnZXRQYWdlRGltZW5zaW9ucyBmcm9tICcuL3BhZ2UtZGltZW5zaW9ucyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEJvb2tMYXlvdXRHcm91cHMgKHZpZXdlckNvbmZpZylcbntcbiAgICBjb25zdCBncm91cGluZ3MgPSBnZXRHcm91cGluZ3Modmlld2VyQ29uZmlnKTtcblxuICAgIHJldHVybiBncm91cGluZ3MubWFwKGdyb3VwaW5nID0+IGdldEdyb3VwTGF5b3V0c0Zyb21QYWdlR3JvdXBpbmcodmlld2VyQ29uZmlnLCBncm91cGluZykpO1xufVxuXG5mdW5jdGlvbiBnZXRHcm91cGluZ3Modmlld2VyQ29uZmlnKVxue1xuICAgIGNvbnN0IG1hbmlmZXN0ID0gdmlld2VyQ29uZmlnLm1hbmlmZXN0O1xuXG4gICAgY29uc3QgcGFnZXNCeUdyb3VwID0gW107XG4gICAgbGV0IGxlZnRQYWdlID0gbnVsbDtcbiAgICBsZXQgbm9uUGFnZWRQYWdlcyA9IFtdOyAvLyBQYWdlcyB0byBkaXNwbGF5IGJlbG93IHRoZSBjdXJyZW50IGdyb3VwXG5cbiAgICBjb25zdCBfYWRkTm9uUGFnZWRQYWdlcyA9ICgpID0+XG4gICAge1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbmxlbiA9IG5vblBhZ2VkUGFnZXMubGVuZ3RoOyBpIDwgbmxlbjsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBwYWdlc0J5R3JvdXAucHVzaChbIG5vblBhZ2VkUGFnZXNbaV0gXSk7XG4gICAgICAgIH1cbiAgICAgICAgbm9uUGFnZWRQYWdlcyA9IFtdO1xuICAgIH07XG5cbiAgICBtYW5pZmVzdC5wYWdlcy5mb3JFYWNoKCAocGFnZSwgaW5kZXgpID0+XG4gICAge1xuICAgICAgICBjb25zdCBwYWdlUmVjb3JkID0ge1xuICAgICAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgZGltZW5zaW9uczogZ2V0UGFnZURpbWVuc2lvbnMoaW5kZXgsIG1hbmlmZXN0KSxcbiAgICAgICAgICAgIHBhZ2VkOiAoIW1hbmlmZXN0LnBhZ2VkIHx8IHBhZ2UucGFnZWQpXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gT25seSBkaXNwbGF5IG5vbi1wYWdlZCBwYWdlcyBpZiBzcGVjaWZpZWQgaW4gdGhlIHNldHRpbmdzXG4gICAgICAgIGlmICghdmlld2VyQ29uZmlnLnNob3dOb25QYWdlZFBhZ2VzICYmICFwYWdlUmVjb3JkLnBhZ2VkKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIGlmICghcGFnZVJlY29yZC5wYWdlZClcbiAgICAgICAge1xuICAgICAgICAgICAgbm9uUGFnZWRQYWdlcy5wdXNoKHBhZ2VSZWNvcmQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGluZGV4ID09PSAwIHx8IHBhZ2UuZmFjaW5nUGFnZXMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIFRoZSBmaXJzdCBwYWdlIGlzIHBsYWNlZCBvbiBpdHMgb3duXG4gICAgICAgICAgICBwYWdlc0J5R3JvdXAucHVzaChbcGFnZVJlY29yZF0pO1xuICAgICAgICAgICAgX2FkZE5vblBhZ2VkUGFnZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChsZWZ0UGFnZSA9PT0gbnVsbClcbiAgICAgICAge1xuICAgICAgICAgICAgbGVmdFBhZ2UgPSBwYWdlUmVjb3JkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgcGFnZXNCeUdyb3VwLnB1c2goW2xlZnRQYWdlLCBwYWdlUmVjb3JkXSk7XG4gICAgICAgICAgICBsZWZ0UGFnZSA9IG51bGw7XG4gICAgICAgICAgICBfYWRkTm9uUGFnZWRQYWdlcygpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBGbHVzaCBhIGZpbmFsIGxlZnQgcGFnZVxuICAgIGlmIChsZWZ0UGFnZSAhPT0gbnVsbClcbiAgICB7XG4gICAgICAgIHBhZ2VzQnlHcm91cC5wdXNoKFtsZWZ0UGFnZV0pO1xuICAgICAgICBfYWRkTm9uUGFnZWRQYWdlcygpO1xuICAgIH1cblxuICAgIHJldHVybiBwYWdlc0J5R3JvdXA7XG59XG5cbmZ1bmN0aW9uIGdldEdyb3VwTGF5b3V0c0Zyb21QYWdlR3JvdXBpbmcodmlld2VyQ29uZmlnLCBncm91cGluZylcbntcbiAgICBjb25zdCB2ZXJ0aWNhbGx5T3JpZW50ZWQgPSB2aWV3ZXJDb25maWcudmVydGljYWxseU9yaWVudGVkO1xuXG4gICAgaWYgKGdyb3VwaW5nLmxlbmd0aCA9PT0gMilcbiAgICAgICAgcmV0dXJuIGdldEZhY2luZ1BhZ2VHcm91cChncm91cGluZ1swXSwgZ3JvdXBpbmdbMV0sIHZlcnRpY2FsbHlPcmllbnRlZCk7XG5cbiAgICBjb25zdCBwYWdlID0gZ3JvdXBpbmdbMF07XG4gICAgY29uc3QgcGFnZURpbXMgPSBwYWdlLmRpbWVuc2lvbnM7XG5cbiAgICAvLyBUaGUgZmlyc3QgcGFnZSBpcyBwbGFjZWQgb24gaXRzIG93biB0byB0aGUgcmlnaHQgaW4gdmVydGljYWwgb3JpZW50YXRpb24uXG4gICAgLy8gTkIgdGhhdCB0aGlzIG5lZWRzIHRvIGJlIHRoZSBwYWdlIHdpdGggaW5kZXggMDsgaWYgdGhlIGZpcnN0IHBhZ2UgaXMgZXhjbHVkZWRcbiAgICAvLyBmcm9tIHRoZSBsYXlvdXQgdGhlbiB0aGlzIHNwZWNpYWwgY2FzZSBzaG91bGRuJ3QgYXBwbHkuXG4gICAgLy8gSWYgdGhlIHBhZ2UgaXMgdGFnZ2VkIGFzICdub24tcGFnZWQnLCBjZW50ZXIgaXQgaG9yaXpvbnRhbGx5XG4gICAgbGV0IGxlZnRPZmZzZXQ7XG4gICAgaWYgKHBhZ2UucGFnZWQpXG4gICAgICAgIGxlZnRPZmZzZXQgPSAocGFnZS5pbmRleCA9PT0gMCAmJiB2ZXJ0aWNhbGx5T3JpZW50ZWQpID8gcGFnZURpbXMud2lkdGggOiAwO1xuICAgIGVsc2VcbiAgICAgICAgbGVmdE9mZnNldCA9ICh2ZXJ0aWNhbGx5T3JpZW50ZWQpID8gcGFnZURpbXMud2lkdGggLyAyIDogMDtcblxuICAgIGNvbnN0IHNob3VsZEJlSG9yaXpvbnRhbGx5QWRqdXN0ZWQgPVxuICAgICAgICB2ZXJ0aWNhbGx5T3JpZW50ZWQgJiYgIXZpZXdlckNvbmZpZy5tYW5pZmVzdC5wYWdlc1twYWdlLmluZGV4XS5mYWNpbmdQYWdlcztcblxuICAgIC8vIFdlIG5lZWQgdG8gbGVmdC1hbGlnbiB0aGUgcGFnZSBpbiB2ZXJ0aWNhbCBvcmllbnRhdGlvbiwgc28gd2UgZG91YmxlXG4gICAgLy8gdGhlIGdyb3VwIHdpZHRoXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZGltZW5zaW9uczoge1xuICAgICAgICAgICAgaGVpZ2h0OiBwYWdlRGltcy5oZWlnaHQsXG4gICAgICAgICAgICB3aWR0aDogc2hvdWxkQmVIb3Jpem9udGFsbHlBZGp1c3RlZCA/IHBhZ2VEaW1zLndpZHRoICogMiA6IHBhZ2VEaW1zLndpZHRoXG4gICAgICAgIH0sXG4gICAgICAgIHBhZ2VzOiBbe1xuICAgICAgICAgICAgaW5kZXg6IHBhZ2UuaW5kZXgsXG4gICAgICAgICAgICBncm91cE9mZnNldDoge1xuICAgICAgICAgICAgICAgIHRvcDogMCxcbiAgICAgICAgICAgICAgICBsZWZ0OiBsZWZ0T2Zmc2V0XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGltZW5zaW9uczogcGFnZURpbXNcbiAgICAgICAgfV1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBnZXRGYWNpbmdQYWdlR3JvdXAobGVmdFBhZ2UsIHJpZ2h0UGFnZSwgdmVydGljYWxseU9yaWVudGVkKVxue1xuICAgIGNvbnN0IGxlZnREaW1zID0gbGVmdFBhZ2UuZGltZW5zaW9ucztcbiAgICBjb25zdCByaWdodERpbXMgPSByaWdodFBhZ2UuZGltZW5zaW9ucztcblxuICAgIGNvbnN0IGhlaWdodCA9IE1hdGgubWF4KGxlZnREaW1zLmhlaWdodCwgcmlnaHREaW1zLmhlaWdodCk7XG5cbiAgICBsZXQgd2lkdGgsIGZpcnN0TGVmdE9mZnNldCwgc2Vjb25kTGVmdE9mZnNldDtcblxuICAgIGlmICh2ZXJ0aWNhbGx5T3JpZW50ZWQpXG4gICAge1xuICAgICAgICBjb25zdCBtaWRXaWR0aCA9IE1hdGgubWF4KGxlZnREaW1zLndpZHRoLCByaWdodERpbXMud2lkdGgpO1xuXG4gICAgICAgIHdpZHRoID0gbWlkV2lkdGggKiAyO1xuXG4gICAgICAgIGZpcnN0TGVmdE9mZnNldCA9IG1pZFdpZHRoIC0gbGVmdERpbXMud2lkdGg7XG4gICAgICAgIHNlY29uZExlZnRPZmZzZXQgPSBtaWRXaWR0aDtcbiAgICB9XG4gICAgZWxzZVxuICAgIHtcbiAgICAgICAgd2lkdGggPSBsZWZ0RGltcy53aWR0aCArIHJpZ2h0RGltcy53aWR0aDtcbiAgICAgICAgZmlyc3RMZWZ0T2Zmc2V0ID0gMDtcbiAgICAgICAgc2Vjb25kTGVmdE9mZnNldCA9IGxlZnREaW1zLndpZHRoO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGRpbWVuc2lvbnM6IHtcbiAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LFxuICAgICAgICAgICAgd2lkdGg6IHdpZHRoXG4gICAgICAgIH0sXG4gICAgICAgIHBhZ2VzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5kZXg6IGxlZnRQYWdlLmluZGV4LFxuICAgICAgICAgICAgICAgIGRpbWVuc2lvbnM6IGxlZnREaW1zLFxuICAgICAgICAgICAgICAgIGdyb3VwT2Zmc2V0OiB7XG4gICAgICAgICAgICAgICAgICAgIHRvcDogMCxcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogZmlyc3RMZWZ0T2Zmc2V0XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbmRleDogcmlnaHRQYWdlLmluZGV4LFxuICAgICAgICAgICAgICAgIGRpbWVuc2lvbnM6IHJpZ2h0RGltcyxcbiAgICAgICAgICAgICAgICBncm91cE9mZnNldDoge1xuICAgICAgICAgICAgICAgICAgICB0b3A6IDAsXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6IHNlY29uZExlZnRPZmZzZXRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICB9O1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/page-layouts/book-layout.js\n");

/***/ }),

/***/ "./source/js/page-layouts/grid-layout.js":
/*!***********************************************!*\
  !*** ./source/js/page-layouts/grid-layout.js ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return getGridLayoutGroups; });\n\nfunction getGridLayoutGroups (viewerConfig)\n{\n    const viewportWidth = viewerConfig.viewport.width;\n    const manifest = viewerConfig.manifest;\n    const pagesPerRow = viewerConfig.pagesPerRow;\n    const fixedHeightGrid = viewerConfig.fixedHeightGrid;\n    const fixedPadding = viewerConfig.fixedPadding;\n    const showNonPagedPages = viewerConfig.showNonPagedPages;\n\n    const horizontalPadding = fixedPadding * (pagesPerRow + 1);\n    const pageWidth = (viewportWidth - horizontalPadding) / pagesPerRow;\n    const gridPageWidth = pageWidth;\n\n    // Calculate the row height depending on whether we want to fix the width or the height\n    const rowHeight = (fixedHeightGrid) ? fixedPadding + manifest.minRatio * pageWidth : fixedPadding + manifest.maxRatio * pageWidth;\n\n    const groups = [];\n    let currentPages = [];\n\n    const getGridPageDimensions = pageData =>\n    {\n        // Calculate the width, height and horizontal placement of this page\n        // Get dimensions at max zoom level, although any level should be fine\n        const pageDimenData = pageData.d[pageData.d.length - 1];\n        const heightToWidthRatio = pageDimenData.h / pageDimenData.w;\n\n        let pageWidth, pageHeight;\n\n        if (fixedHeightGrid)\n        {\n            pageWidth = (rowHeight - fixedPadding) / heightToWidthRatio;\n            pageHeight = rowHeight - fixedPadding;\n        }\n        else\n        {\n            pageWidth = gridPageWidth;\n            pageHeight = pageWidth * heightToWidthRatio;\n        }\n\n        return {\n            width: Math.round(pageWidth),\n            height: Math.round(pageHeight)\n        };\n    };\n\n    const rowDimensions = {\n        height: rowHeight,\n        width: viewportWidth\n    };\n\n    manifest.pages.forEach( (page, pageIndex) =>\n    {\n        if (!showNonPagedPages && manifest.paged && !page.paged)\n            return;\n\n        // Calculate the width, height and horizontal placement of this page\n        const pageDimens = getGridPageDimensions(page);\n        let leftOffset = Math.floor(currentPages.length * (fixedPadding + gridPageWidth) + fixedPadding);\n\n        // Center the page if the height is fixed (otherwise, there is no horizontal padding)\n        if (fixedHeightGrid)\n        {\n            leftOffset += (gridPageWidth - pageDimens.width) / 2;\n        }\n\n        // TODO: Precompute page dimensions everywhere\n        currentPages.push({\n            index: pageIndex,\n            dimensions: pageDimens,\n            groupOffset: {\n                top: 0,\n                left: leftOffset\n            }\n        });\n\n        if (currentPages.length === pagesPerRow)\n        {\n            groups.push({\n                dimensions: rowDimensions,\n                pages: currentPages\n            });\n\n            currentPages = [];\n        }\n    });\n\n    if (currentPages.length > 0)\n    {\n        groups.push({\n            dimensions: rowDimensions,\n            pages: currentPages\n        });\n    }\n\n    return groups;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvcGFnZS1sYXlvdXRzL2dyaWQtbGF5b3V0LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL3BhZ2UtbGF5b3V0cy9ncmlkLWxheW91dC5qcz8zMzg3Il0sInNvdXJjZXNDb250ZW50IjpbIlxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0R3JpZExheW91dEdyb3VwcyAodmlld2VyQ29uZmlnKVxue1xuICAgIGNvbnN0IHZpZXdwb3J0V2lkdGggPSB2aWV3ZXJDb25maWcudmlld3BvcnQud2lkdGg7XG4gICAgY29uc3QgbWFuaWZlc3QgPSB2aWV3ZXJDb25maWcubWFuaWZlc3Q7XG4gICAgY29uc3QgcGFnZXNQZXJSb3cgPSB2aWV3ZXJDb25maWcucGFnZXNQZXJSb3c7XG4gICAgY29uc3QgZml4ZWRIZWlnaHRHcmlkID0gdmlld2VyQ29uZmlnLmZpeGVkSGVpZ2h0R3JpZDtcbiAgICBjb25zdCBmaXhlZFBhZGRpbmcgPSB2aWV3ZXJDb25maWcuZml4ZWRQYWRkaW5nO1xuICAgIGNvbnN0IHNob3dOb25QYWdlZFBhZ2VzID0gdmlld2VyQ29uZmlnLnNob3dOb25QYWdlZFBhZ2VzO1xuXG4gICAgY29uc3QgaG9yaXpvbnRhbFBhZGRpbmcgPSBmaXhlZFBhZGRpbmcgKiAocGFnZXNQZXJSb3cgKyAxKTtcbiAgICBjb25zdCBwYWdlV2lkdGggPSAodmlld3BvcnRXaWR0aCAtIGhvcml6b250YWxQYWRkaW5nKSAvIHBhZ2VzUGVyUm93O1xuICAgIGNvbnN0IGdyaWRQYWdlV2lkdGggPSBwYWdlV2lkdGg7XG5cbiAgICAvLyBDYWxjdWxhdGUgdGhlIHJvdyBoZWlnaHQgZGVwZW5kaW5nIG9uIHdoZXRoZXIgd2Ugd2FudCB0byBmaXggdGhlIHdpZHRoIG9yIHRoZSBoZWlnaHRcbiAgICBjb25zdCByb3dIZWlnaHQgPSAoZml4ZWRIZWlnaHRHcmlkKSA/IGZpeGVkUGFkZGluZyArIG1hbmlmZXN0Lm1pblJhdGlvICogcGFnZVdpZHRoIDogZml4ZWRQYWRkaW5nICsgbWFuaWZlc3QubWF4UmF0aW8gKiBwYWdlV2lkdGg7XG5cbiAgICBjb25zdCBncm91cHMgPSBbXTtcbiAgICBsZXQgY3VycmVudFBhZ2VzID0gW107XG5cbiAgICBjb25zdCBnZXRHcmlkUGFnZURpbWVuc2lvbnMgPSBwYWdlRGF0YSA9PlxuICAgIHtcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSB3aWR0aCwgaGVpZ2h0IGFuZCBob3Jpem9udGFsIHBsYWNlbWVudCBvZiB0aGlzIHBhZ2VcbiAgICAgICAgLy8gR2V0IGRpbWVuc2lvbnMgYXQgbWF4IHpvb20gbGV2ZWwsIGFsdGhvdWdoIGFueSBsZXZlbCBzaG91bGQgYmUgZmluZVxuICAgICAgICBjb25zdCBwYWdlRGltZW5EYXRhID0gcGFnZURhdGEuZFtwYWdlRGF0YS5kLmxlbmd0aCAtIDFdO1xuICAgICAgICBjb25zdCBoZWlnaHRUb1dpZHRoUmF0aW8gPSBwYWdlRGltZW5EYXRhLmggLyBwYWdlRGltZW5EYXRhLnc7XG5cbiAgICAgICAgbGV0IHBhZ2VXaWR0aCwgcGFnZUhlaWdodDtcblxuICAgICAgICBpZiAoZml4ZWRIZWlnaHRHcmlkKVxuICAgICAgICB7XG4gICAgICAgICAgICBwYWdlV2lkdGggPSAocm93SGVpZ2h0IC0gZml4ZWRQYWRkaW5nKSAvIGhlaWdodFRvV2lkdGhSYXRpbztcbiAgICAgICAgICAgIHBhZ2VIZWlnaHQgPSByb3dIZWlnaHQgLSBmaXhlZFBhZGRpbmc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBwYWdlV2lkdGggPSBncmlkUGFnZVdpZHRoO1xuICAgICAgICAgICAgcGFnZUhlaWdodCA9IHBhZ2VXaWR0aCAqIGhlaWdodFRvV2lkdGhSYXRpbztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB3aWR0aDogTWF0aC5yb3VuZChwYWdlV2lkdGgpLFxuICAgICAgICAgICAgaGVpZ2h0OiBNYXRoLnJvdW5kKHBhZ2VIZWlnaHQpXG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGNvbnN0IHJvd0RpbWVuc2lvbnMgPSB7XG4gICAgICAgIGhlaWdodDogcm93SGVpZ2h0LFxuICAgICAgICB3aWR0aDogdmlld3BvcnRXaWR0aFxuICAgIH07XG5cbiAgICBtYW5pZmVzdC5wYWdlcy5mb3JFYWNoKCAocGFnZSwgcGFnZUluZGV4KSA9PlxuICAgIHtcbiAgICAgICAgaWYgKCFzaG93Tm9uUGFnZWRQYWdlcyAmJiBtYW5pZmVzdC5wYWdlZCAmJiAhcGFnZS5wYWdlZClcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHdpZHRoLCBoZWlnaHQgYW5kIGhvcml6b250YWwgcGxhY2VtZW50IG9mIHRoaXMgcGFnZVxuICAgICAgICBjb25zdCBwYWdlRGltZW5zID0gZ2V0R3JpZFBhZ2VEaW1lbnNpb25zKHBhZ2UpO1xuICAgICAgICBsZXQgbGVmdE9mZnNldCA9IE1hdGguZmxvb3IoY3VycmVudFBhZ2VzLmxlbmd0aCAqIChmaXhlZFBhZGRpbmcgKyBncmlkUGFnZVdpZHRoKSArIGZpeGVkUGFkZGluZyk7XG5cbiAgICAgICAgLy8gQ2VudGVyIHRoZSBwYWdlIGlmIHRoZSBoZWlnaHQgaXMgZml4ZWQgKG90aGVyd2lzZSwgdGhlcmUgaXMgbm8gaG9yaXpvbnRhbCBwYWRkaW5nKVxuICAgICAgICBpZiAoZml4ZWRIZWlnaHRHcmlkKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZWZ0T2Zmc2V0ICs9IChncmlkUGFnZVdpZHRoIC0gcGFnZURpbWVucy53aWR0aCkgLyAyO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVE9ETzogUHJlY29tcHV0ZSBwYWdlIGRpbWVuc2lvbnMgZXZlcnl3aGVyZVxuICAgICAgICBjdXJyZW50UGFnZXMucHVzaCh7XG4gICAgICAgICAgICBpbmRleDogcGFnZUluZGV4LFxuICAgICAgICAgICAgZGltZW5zaW9uczogcGFnZURpbWVucyxcbiAgICAgICAgICAgIGdyb3VwT2Zmc2V0OiB7XG4gICAgICAgICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgICAgICAgIGxlZnQ6IGxlZnRPZmZzZXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRQYWdlcy5sZW5ndGggPT09IHBhZ2VzUGVyUm93KVxuICAgICAgICB7XG4gICAgICAgICAgICBncm91cHMucHVzaCh7XG4gICAgICAgICAgICAgICAgZGltZW5zaW9uczogcm93RGltZW5zaW9ucyxcbiAgICAgICAgICAgICAgICBwYWdlczogY3VycmVudFBhZ2VzXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY3VycmVudFBhZ2VzID0gW107XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChjdXJyZW50UGFnZXMubGVuZ3RoID4gMClcbiAgICB7XG4gICAgICAgIGdyb3Vwcy5wdXNoKHtcbiAgICAgICAgICAgIGRpbWVuc2lvbnM6IHJvd0RpbWVuc2lvbnMsXG4gICAgICAgICAgICBwYWdlczogY3VycmVudFBhZ2VzXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBncm91cHM7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/page-layouts/grid-layout.js\n");

/***/ }),

/***/ "./source/js/page-layouts/index.js":
/*!*****************************************!*\
  !*** ./source/js/page-layouts/index.js ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return getPageLayouts; });\n/* harmony import */ var _book_layout__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./book-layout */ \"./source/js/page-layouts/book-layout.js\");\n/* harmony import */ var _singles_layout__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./singles-layout */ \"./source/js/page-layouts/singles-layout.js\");\n/* harmony import */ var _grid_layout__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./grid-layout */ \"./source/js/page-layouts/grid-layout.js\");\n\n\n\n\n/** Get the relative positioning of pages for the current view */\nfunction getPageLayouts (settings)\n{\n    if (settings.inGrid)\n    {\n        return Object(_grid_layout__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(pluck(settings, [\n            'manifest',\n            'viewport',\n            'pagesPerRow',\n            'fixedHeightGrid',\n            'fixedPadding',\n            'showNonPagedPages'\n        ]));\n    }\n    else\n    {\n        const config = pluck(settings, ['manifest', 'verticallyOriented', 'showNonPagedPages']);\n\n        if (settings.inBookLayout)\n            return Object(_book_layout__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(config);\n        else\n            return Object(_singles_layout__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(config);\n    }\n}\n\nfunction pluck (obj, keys)\n{\n    const out = {};\n    keys.forEach(function (key)\n    {\n        out[key] = obj[key];\n    });\n    return out;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvcGFnZS1sYXlvdXRzL2luZGV4LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL3BhZ2UtbGF5b3V0cy9pbmRleC5qcz9lMTRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBnZXRCb29rTGF5b3V0R3JvdXBzIGZyb20gJy4vYm9vay1sYXlvdXQnO1xuaW1wb3J0IGdldFNpbmdsZXNMYXlvdXRHcm91cHMgZnJvbSAnLi9zaW5nbGVzLWxheW91dCc7XG5pbXBvcnQgZ2V0R3JpZExheW91dEdyb3VwcyBmcm9tICcuL2dyaWQtbGF5b3V0JztcblxuLyoqIEdldCB0aGUgcmVsYXRpdmUgcG9zaXRpb25pbmcgb2YgcGFnZXMgZm9yIHRoZSBjdXJyZW50IHZpZXcgKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFBhZ2VMYXlvdXRzIChzZXR0aW5ncylcbntcbiAgICBpZiAoc2V0dGluZ3MuaW5HcmlkKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIGdldEdyaWRMYXlvdXRHcm91cHMocGx1Y2soc2V0dGluZ3MsIFtcbiAgICAgICAgICAgICdtYW5pZmVzdCcsXG4gICAgICAgICAgICAndmlld3BvcnQnLFxuICAgICAgICAgICAgJ3BhZ2VzUGVyUm93JyxcbiAgICAgICAgICAgICdmaXhlZEhlaWdodEdyaWQnLFxuICAgICAgICAgICAgJ2ZpeGVkUGFkZGluZycsXG4gICAgICAgICAgICAnc2hvd05vblBhZ2VkUGFnZXMnXG4gICAgICAgIF0pKTtcbiAgICB9XG4gICAgZWxzZVxuICAgIHtcbiAgICAgICAgY29uc3QgY29uZmlnID0gcGx1Y2soc2V0dGluZ3MsIFsnbWFuaWZlc3QnLCAndmVydGljYWxseU9yaWVudGVkJywgJ3Nob3dOb25QYWdlZFBhZ2VzJ10pO1xuXG4gICAgICAgIGlmIChzZXR0aW5ncy5pbkJvb2tMYXlvdXQpXG4gICAgICAgICAgICByZXR1cm4gZ2V0Qm9va0xheW91dEdyb3Vwcyhjb25maWcpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gZ2V0U2luZ2xlc0xheW91dEdyb3Vwcyhjb25maWcpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcGx1Y2sgKG9iaiwga2V5cylcbntcbiAgICBjb25zdCBvdXQgPSB7fTtcbiAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSlcbiAgICB7XG4gICAgICAgIG91dFtrZXldID0gb2JqW2tleV07XG4gICAgfSk7XG4gICAgcmV0dXJuIG91dDtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./source/js/page-layouts/index.js\n");

/***/ }),

/***/ "./source/js/page-layouts/page-dimensions.js":
/*!***************************************************!*\
  !*** ./source/js/page-layouts/page-dimensions.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return getPageDimensions; });\nfunction getPageDimensions (pageIndex, manifest)\n{\n    const dims = manifest.getMaxPageDimensions(pageIndex);\n\n    return {\n        width: Math.floor(dims.width),\n        height: Math.floor(dims.height)\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvcGFnZS1sYXlvdXRzL3BhZ2UtZGltZW5zaW9ucy5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9qcy9wYWdlLWxheW91dHMvcGFnZS1kaW1lbnNpb25zLmpzPzBjZmYiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0UGFnZURpbWVuc2lvbnMgKHBhZ2VJbmRleCwgbWFuaWZlc3QpXG57XG4gICAgY29uc3QgZGltcyA9IG1hbmlmZXN0LmdldE1heFBhZ2VEaW1lbnNpb25zKHBhZ2VJbmRleCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogTWF0aC5mbG9vcihkaW1zLndpZHRoKSxcbiAgICAgICAgaGVpZ2h0OiBNYXRoLmZsb29yKGRpbXMuaGVpZ2h0KVxuICAgIH07XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./source/js/page-layouts/page-dimensions.js\n");

/***/ }),

/***/ "./source/js/page-layouts/singles-layout.js":
/*!**************************************************!*\
  !*** ./source/js/page-layouts/singles-layout.js ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return getSinglesLayoutGroups; });\n/* harmony import */ var _page_dimensions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./page-dimensions */ \"./source/js/page-layouts/page-dimensions.js\");\n\n\nfunction getSinglesLayoutGroups (viewerConfig)\n{\n    const manifest = viewerConfig.manifest;\n\n    // Render each page alone in a group\n    const pages = [];\n    manifest.pages.forEach( (page, index) =>\n    {\n        if (!viewerConfig.showNonPagedPages && manifest.paged && !page.paged)\n            return;\n\n        const pageDims = Object(_page_dimensions__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(index, manifest);\n\n        pages.push({\n            dimensions: pageDims,\n            pages: [{\n                index: index,\n                groupOffset: { top: 0, left: 0 },\n                dimensions: pageDims\n            }]\n        });\n    });\n\n    return pages;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvcGFnZS1sYXlvdXRzL3NpbmdsZXMtbGF5b3V0LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL3BhZ2UtbGF5b3V0cy9zaW5nbGVzLWxheW91dC5qcz9jNjFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBnZXRQYWdlRGltZW5zaW9ucyBmcm9tICcuL3BhZ2UtZGltZW5zaW9ucyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFNpbmdsZXNMYXlvdXRHcm91cHMgKHZpZXdlckNvbmZpZylcbntcbiAgICBjb25zdCBtYW5pZmVzdCA9IHZpZXdlckNvbmZpZy5tYW5pZmVzdDtcblxuICAgIC8vIFJlbmRlciBlYWNoIHBhZ2UgYWxvbmUgaW4gYSBncm91cFxuICAgIGNvbnN0IHBhZ2VzID0gW107XG4gICAgbWFuaWZlc3QucGFnZXMuZm9yRWFjaCggKHBhZ2UsIGluZGV4KSA9PlxuICAgIHtcbiAgICAgICAgaWYgKCF2aWV3ZXJDb25maWcuc2hvd05vblBhZ2VkUGFnZXMgJiYgbWFuaWZlc3QucGFnZWQgJiYgIXBhZ2UucGFnZWQpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgY29uc3QgcGFnZURpbXMgPSBnZXRQYWdlRGltZW5zaW9ucyhpbmRleCwgbWFuaWZlc3QpO1xuXG4gICAgICAgIHBhZ2VzLnB1c2goe1xuICAgICAgICAgICAgZGltZW5zaW9uczogcGFnZURpbXMsXG4gICAgICAgICAgICBwYWdlczogW3tcbiAgICAgICAgICAgICAgICBpbmRleDogaW5kZXgsXG4gICAgICAgICAgICAgICAgZ3JvdXBPZmZzZXQ6IHsgdG9wOiAwLCBsZWZ0OiAwIH0sXG4gICAgICAgICAgICAgICAgZGltZW5zaW9uczogcGFnZURpbXNcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHBhZ2VzO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./source/js/page-layouts/singles-layout.js\n");

/***/ }),

/***/ "./source/js/page-overlay-manager.js":
/*!*******************************************!*\
  !*** ./source/js/page-overlay-manager.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return PageOverlayManager; });\n/**\n * Manages a collection of page overlays, which implement a low-level\n * API for synchronizing HTML pages to the canvas. Each overlay needs\n * to implement the following protocol:\n *\n *   mount(): Called when a page is first rendered\n *   refresh(): Called when a page is moved\n *   unmount(): Called when a previously rendered page has stopped being rendered\n *\n * @class\n */\n\nclass PageOverlayManager\n{\n    constructor ()\n    {\n        this._pages = {};\n        this._renderedPages = [];\n        this._renderedPageMap = {};\n    }\n\n    addOverlay (overlay)\n    {\n        const overlaysByPage = this._pages[overlay.page] || (this._pages[overlay.page] = []);\n\n        overlaysByPage.push(overlay);\n\n        if (this._renderedPageMap[overlay.page])\n            overlay.mount();\n    }\n\n    removeOverlay (overlay)\n    {\n        const page = overlay.page;\n        const overlaysByPage = this._pages[page];\n\n        if (!overlaysByPage)\n            return;\n\n        const overlayIndex = overlaysByPage.indexOf(overlay);\n\n        if (overlayIndex === -1)\n            return;\n\n        if (this._renderedPageMap[page])\n            overlaysByPage[overlayIndex].unmount();\n\n        overlaysByPage.splice(overlayIndex, 1);\n\n        if (overlaysByPage.length === 0)\n            delete this._pages[page];\n    }\n\n    updateOverlays (renderedPages)\n    {\n        const previouslyRendered = this._renderedPages;\n        const newRenderedMap = {};\n\n        renderedPages.map( (pageIndex) =>\n        {\n            newRenderedMap[pageIndex] = true;\n\n            if (!this._renderedPageMap[pageIndex])\n            {\n                this._renderedPageMap[pageIndex] = true;\n\n                this._invokeOnOverlays(pageIndex, overlay =>\n                {\n                    overlay.mount();\n                });\n            }\n        });\n\n        previouslyRendered.map( (pageIndex) =>\n        {\n            if (newRenderedMap[pageIndex])\n            {\n                this._invokeOnOverlays(pageIndex, (overlay) =>\n                {\n                    overlay.refresh();\n                });\n            }\n            else\n            {\n                delete this._renderedPageMap[pageIndex];\n                this._invokeOnOverlays(pageIndex, overlay =>\n                {\n                    overlay.unmount();\n                });\n            }\n        });\n\n        this._renderedPages = renderedPages;\n    }\n\n    _invokeOnOverlays (pageIndex, func)\n    {\n        const overlays = this._pages[pageIndex];\n        if (overlays)\n            overlays.map( (o) => func(o) );\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvcGFnZS1vdmVybGF5LW1hbmFnZXIuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvcGFnZS1vdmVybGF5LW1hbmFnZXIuanM/YmQ2OCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1hbmFnZXMgYSBjb2xsZWN0aW9uIG9mIHBhZ2Ugb3ZlcmxheXMsIHdoaWNoIGltcGxlbWVudCBhIGxvdy1sZXZlbFxuICogQVBJIGZvciBzeW5jaHJvbml6aW5nIEhUTUwgcGFnZXMgdG8gdGhlIGNhbnZhcy4gRWFjaCBvdmVybGF5IG5lZWRzXG4gKiB0byBpbXBsZW1lbnQgdGhlIGZvbGxvd2luZyBwcm90b2NvbDpcbiAqXG4gKiAgIG1vdW50KCk6IENhbGxlZCB3aGVuIGEgcGFnZSBpcyBmaXJzdCByZW5kZXJlZFxuICogICByZWZyZXNoKCk6IENhbGxlZCB3aGVuIGEgcGFnZSBpcyBtb3ZlZFxuICogICB1bm1vdW50KCk6IENhbGxlZCB3aGVuIGEgcHJldmlvdXNseSByZW5kZXJlZCBwYWdlIGhhcyBzdG9wcGVkIGJlaW5nIHJlbmRlcmVkXG4gKlxuICogQGNsYXNzXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFnZU92ZXJsYXlNYW5hZ2VyXG57XG4gICAgY29uc3RydWN0b3IgKClcbiAgICB7XG4gICAgICAgIHRoaXMuX3BhZ2VzID0ge307XG4gICAgICAgIHRoaXMuX3JlbmRlcmVkUGFnZXMgPSBbXTtcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRQYWdlTWFwID0ge307XG4gICAgfVxuXG4gICAgYWRkT3ZlcmxheSAob3ZlcmxheSlcbiAgICB7XG4gICAgICAgIGNvbnN0IG92ZXJsYXlzQnlQYWdlID0gdGhpcy5fcGFnZXNbb3ZlcmxheS5wYWdlXSB8fCAodGhpcy5fcGFnZXNbb3ZlcmxheS5wYWdlXSA9IFtdKTtcblxuICAgICAgICBvdmVybGF5c0J5UGFnZS5wdXNoKG92ZXJsYXkpO1xuXG4gICAgICAgIGlmICh0aGlzLl9yZW5kZXJlZFBhZ2VNYXBbb3ZlcmxheS5wYWdlXSlcbiAgICAgICAgICAgIG92ZXJsYXkubW91bnQoKTtcbiAgICB9XG5cbiAgICByZW1vdmVPdmVybGF5IChvdmVybGF5KVxuICAgIHtcbiAgICAgICAgY29uc3QgcGFnZSA9IG92ZXJsYXkucGFnZTtcbiAgICAgICAgY29uc3Qgb3ZlcmxheXNCeVBhZ2UgPSB0aGlzLl9wYWdlc1twYWdlXTtcblxuICAgICAgICBpZiAoIW92ZXJsYXlzQnlQYWdlKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IG92ZXJsYXlJbmRleCA9IG92ZXJsYXlzQnlQYWdlLmluZGV4T2Yob3ZlcmxheSk7XG5cbiAgICAgICAgaWYgKG92ZXJsYXlJbmRleCA9PT0gLTEpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgaWYgKHRoaXMuX3JlbmRlcmVkUGFnZU1hcFtwYWdlXSlcbiAgICAgICAgICAgIG92ZXJsYXlzQnlQYWdlW292ZXJsYXlJbmRleF0udW5tb3VudCgpO1xuXG4gICAgICAgIG92ZXJsYXlzQnlQYWdlLnNwbGljZShvdmVybGF5SW5kZXgsIDEpO1xuXG4gICAgICAgIGlmIChvdmVybGF5c0J5UGFnZS5sZW5ndGggPT09IDApXG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fcGFnZXNbcGFnZV07XG4gICAgfVxuXG4gICAgdXBkYXRlT3ZlcmxheXMgKHJlbmRlcmVkUGFnZXMpXG4gICAge1xuICAgICAgICBjb25zdCBwcmV2aW91c2x5UmVuZGVyZWQgPSB0aGlzLl9yZW5kZXJlZFBhZ2VzO1xuICAgICAgICBjb25zdCBuZXdSZW5kZXJlZE1hcCA9IHt9O1xuXG4gICAgICAgIHJlbmRlcmVkUGFnZXMubWFwKCAocGFnZUluZGV4KSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBuZXdSZW5kZXJlZE1hcFtwYWdlSW5kZXhdID0gdHJ1ZTtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLl9yZW5kZXJlZFBhZ2VNYXBbcGFnZUluZGV4XSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlZFBhZ2VNYXBbcGFnZUluZGV4XSA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9pbnZva2VPbk92ZXJsYXlzKHBhZ2VJbmRleCwgb3ZlcmxheSA9PlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmxheS5tb3VudCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBwcmV2aW91c2x5UmVuZGVyZWQubWFwKCAocGFnZUluZGV4KSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAobmV3UmVuZGVyZWRNYXBbcGFnZUluZGV4XSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnZva2VPbk92ZXJsYXlzKHBhZ2VJbmRleCwgKG92ZXJsYXkpID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBvdmVybGF5LnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcmVuZGVyZWRQYWdlTWFwW3BhZ2VJbmRleF07XG4gICAgICAgICAgICAgICAgdGhpcy5faW52b2tlT25PdmVybGF5cyhwYWdlSW5kZXgsIG92ZXJsYXkgPT5cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG92ZXJsYXkudW5tb3VudCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9yZW5kZXJlZFBhZ2VzID0gcmVuZGVyZWRQYWdlcztcbiAgICB9XG5cbiAgICBfaW52b2tlT25PdmVybGF5cyAocGFnZUluZGV4LCBmdW5jKVxuICAgIHtcbiAgICAgICAgY29uc3Qgb3ZlcmxheXMgPSB0aGlzLl9wYWdlc1twYWdlSW5kZXhdO1xuICAgICAgICBpZiAob3ZlcmxheXMpXG4gICAgICAgICAgICBvdmVybGF5cy5tYXAoIChvKSA9PiBmdW5jKG8pICk7XG4gICAgfVxufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/page-overlay-manager.js\n");

/***/ }),

/***/ "./source/js/page-tools-overlay.js":
/*!*****************************************!*\
  !*** ./source/js/page-tools-overlay.js ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return PageToolsOverlay; });\n/* harmony import */ var _utils_elt__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/elt */ \"./source/js/utils/elt.js\");\n\n/**\n*\n*\n**/\nclass PageToolsOverlay\n{\n    constructor (pageIndex, viewerCore)\n    {\n        this.page = pageIndex;\n\n        this._viewerCore = viewerCore;\n\n        this._innerElement = this._viewerCore.getSettings().innerElement;\n        this._pageToolsElem = null;\n    }\n\n    mount ()\n    {\n        if (this._pageToolsElem === null)\n        {\n            this._buttons = this._initializePageToolButtons();\n\n            this._pageToolsElem = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'diva-page-tools-wrapper' },\n                Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'diva-page-tools' }, this._buttons)\n            );\n\n            this._pageLabelsElem = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'diva-page-labels-wrapper'},\n                Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'diva-page-labels' }, this._viewerCore.settings.manifest.pages[this.page].l)\n            );\n        }\n\n        this.refresh();\n        this._innerElement.appendChild(this._pageToolsElem);\n        this._innerElement.appendChild(this._pageLabelsElem);\n    }\n\n    _initializePageToolButtons ()\n    {\n        // Callback parameters\n        const settings = this._viewerCore.getSettings();\n        const publicInstance = this._viewerCore.getPublicInstance();\n        const pageIndex = this.page;\n\n        return this._viewerCore.getPageTools().map( (plugin) =>\n        {\n            // !!! The node needs to be cloned otherwise it is detached from\n            //  one and reattached to the other.\n            const button = plugin.pageToolsIcon.cloneNode(true);\n\n            // ensure the plugin instance is handed as the first argument to call;\n            // this will set the context (i.e., `this`) of the handleClick call to the plugin instance\n            // itself.\n            button.addEventListener('click', (event) =>\n            {\n                plugin.handleClick.call(plugin, event, settings, publicInstance, pageIndex);\n            }, false);\n\n            button.addEventListener('touchend', (event) =>\n            {\n                // Prevent firing of emulated mouse events\n                event.preventDefault();\n\n                plugin.handleClick.call(plugin, event, settings, publicInstance, pageIndex);\n            }, false);\n\n            return button;\n\n        });\n    }\n\n    unmount ()\n    {\n        this._innerElement.removeChild(this._pageToolsElem);\n        this._innerElement.removeChild(this._pageLabelsElem);\n    }\n\n    refresh ()\n    {\n        const pos = this._viewerCore.getPageRegion(this.page, {\n            includePadding: true,\n            incorporateViewport: true\n        });\n\n        // if window is resized larger, a margin is created - need to subtract this from offsets\n        let marginLeft = window.getComputedStyle(this._innerElement, null).getPropertyValue('margin-left');\n\n        this._pageToolsElem.style.top = pos.top + 'px';\n        this._pageToolsElem.style.left = pos.left - parseFloat(marginLeft) + 'px';\n\n        this._pageLabelsElem.style.top = pos.top + 'px';\n        this._pageLabelsElem.style.left = pos.right - parseFloat(marginLeft) - this.labelWidth - 5 + 'px';\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvcGFnZS10b29scy1vdmVybGF5LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL3BhZ2UtdG9vbHMtb3ZlcmxheS5qcz81NTI2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGVsdCB9IGZyb20gJy4vdXRpbHMvZWx0Jztcbi8qKlxuKlxuKlxuKiovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQYWdlVG9vbHNPdmVybGF5XG57XG4gICAgY29uc3RydWN0b3IgKHBhZ2VJbmRleCwgdmlld2VyQ29yZSlcbiAgICB7XG4gICAgICAgIHRoaXMucGFnZSA9IHBhZ2VJbmRleDtcblxuICAgICAgICB0aGlzLl92aWV3ZXJDb3JlID0gdmlld2VyQ29yZTtcblxuICAgICAgICB0aGlzLl9pbm5lckVsZW1lbnQgPSB0aGlzLl92aWV3ZXJDb3JlLmdldFNldHRpbmdzKCkuaW5uZXJFbGVtZW50O1xuICAgICAgICB0aGlzLl9wYWdlVG9vbHNFbGVtID0gbnVsbDtcbiAgICB9XG5cbiAgICBtb3VudCAoKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX3BhZ2VUb29sc0VsZW0gPT09IG51bGwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbnMgPSB0aGlzLl9pbml0aWFsaXplUGFnZVRvb2xCdXR0b25zKCk7XG5cbiAgICAgICAgICAgIHRoaXMuX3BhZ2VUb29sc0VsZW0gPSBlbHQoJ2RpdicsIHsgY2xhc3M6ICdkaXZhLXBhZ2UtdG9vbHMtd3JhcHBlcicgfSxcbiAgICAgICAgICAgICAgICBlbHQoJ2RpdicsIHsgY2xhc3M6ICdkaXZhLXBhZ2UtdG9vbHMnIH0sIHRoaXMuX2J1dHRvbnMpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0aGlzLl9wYWdlTGFiZWxzRWxlbSA9IGVsdCgnZGl2JywgeyBjbGFzczogJ2RpdmEtcGFnZS1sYWJlbHMtd3JhcHBlcid9LFxuICAgICAgICAgICAgICAgIGVsdCgnZGl2JywgeyBjbGFzczogJ2RpdmEtcGFnZS1sYWJlbHMnIH0sIHRoaXMuX3ZpZXdlckNvcmUuc2V0dGluZ3MubWFuaWZlc3QucGFnZXNbdGhpcy5wYWdlXS5sKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICB0aGlzLl9pbm5lckVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5fcGFnZVRvb2xzRWxlbSk7XG4gICAgICAgIHRoaXMuX2lubmVyRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLl9wYWdlTGFiZWxzRWxlbSk7XG4gICAgfVxuXG4gICAgX2luaXRpYWxpemVQYWdlVG9vbEJ1dHRvbnMgKClcbiAgICB7XG4gICAgICAgIC8vIENhbGxiYWNrIHBhcmFtZXRlcnNcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSB0aGlzLl92aWV3ZXJDb3JlLmdldFNldHRpbmdzKCk7XG4gICAgICAgIGNvbnN0IHB1YmxpY0luc3RhbmNlID0gdGhpcy5fdmlld2VyQ29yZS5nZXRQdWJsaWNJbnN0YW5jZSgpO1xuICAgICAgICBjb25zdCBwYWdlSW5kZXggPSB0aGlzLnBhZ2U7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZXdlckNvcmUuZ2V0UGFnZVRvb2xzKCkubWFwKCAocGx1Z2luKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICAvLyAhISEgVGhlIG5vZGUgbmVlZHMgdG8gYmUgY2xvbmVkIG90aGVyd2lzZSBpdCBpcyBkZXRhY2hlZCBmcm9tXG4gICAgICAgICAgICAvLyAgb25lIGFuZCByZWF0dGFjaGVkIHRvIHRoZSBvdGhlci5cbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IHBsdWdpbi5wYWdlVG9vbHNJY29uLmNsb25lTm9kZSh0cnVlKTtcblxuICAgICAgICAgICAgLy8gZW5zdXJlIHRoZSBwbHVnaW4gaW5zdGFuY2UgaXMgaGFuZGVkIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byBjYWxsO1xuICAgICAgICAgICAgLy8gdGhpcyB3aWxsIHNldCB0aGUgY29udGV4dCAoaS5lLiwgYHRoaXNgKSBvZiB0aGUgaGFuZGxlQ2xpY2sgY2FsbCB0byB0aGUgcGx1Z2luIGluc3RhbmNlXG4gICAgICAgICAgICAvLyBpdHNlbGYuXG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGx1Z2luLmhhbmRsZUNsaWNrLmNhbGwocGx1Z2luLCBldmVudCwgc2V0dGluZ3MsIHB1YmxpY0luc3RhbmNlLCBwYWdlSW5kZXgpO1xuICAgICAgICAgICAgfSwgZmFsc2UpO1xuXG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoZXZlbnQpID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gUHJldmVudCBmaXJpbmcgb2YgZW11bGF0ZWQgbW91c2UgZXZlbnRzXG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgIHBsdWdpbi5oYW5kbGVDbGljay5jYWxsKHBsdWdpbiwgZXZlbnQsIHNldHRpbmdzLCBwdWJsaWNJbnN0YW5jZSwgcGFnZUluZGV4KTtcbiAgICAgICAgICAgIH0sIGZhbHNlKTtcblxuICAgICAgICAgICAgcmV0dXJuIGJ1dHRvbjtcblxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB1bm1vdW50ICgpXG4gICAge1xuICAgICAgICB0aGlzLl9pbm5lckVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fcGFnZVRvb2xzRWxlbSk7XG4gICAgICAgIHRoaXMuX2lubmVyRWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLl9wYWdlTGFiZWxzRWxlbSk7XG4gICAgfVxuXG4gICAgcmVmcmVzaCAoKVxuICAgIHtcbiAgICAgICAgY29uc3QgcG9zID0gdGhpcy5fdmlld2VyQ29yZS5nZXRQYWdlUmVnaW9uKHRoaXMucGFnZSwge1xuICAgICAgICAgICAgaW5jbHVkZVBhZGRpbmc6IHRydWUsXG4gICAgICAgICAgICBpbmNvcnBvcmF0ZVZpZXdwb3J0OiB0cnVlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGlmIHdpbmRvdyBpcyByZXNpemVkIGxhcmdlciwgYSBtYXJnaW4gaXMgY3JlYXRlZCAtIG5lZWQgdG8gc3VidHJhY3QgdGhpcyBmcm9tIG9mZnNldHNcbiAgICAgICAgbGV0IG1hcmdpbkxlZnQgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLl9pbm5lckVsZW1lbnQsIG51bGwpLmdldFByb3BlcnR5VmFsdWUoJ21hcmdpbi1sZWZ0Jyk7XG5cbiAgICAgICAgdGhpcy5fcGFnZVRvb2xzRWxlbS5zdHlsZS50b3AgPSBwb3MudG9wICsgJ3B4JztcbiAgICAgICAgdGhpcy5fcGFnZVRvb2xzRWxlbS5zdHlsZS5sZWZ0ID0gcG9zLmxlZnQgLSBwYXJzZUZsb2F0KG1hcmdpbkxlZnQpICsgJ3B4JztcblxuICAgICAgICB0aGlzLl9wYWdlTGFiZWxzRWxlbS5zdHlsZS50b3AgPSBwb3MudG9wICsgJ3B4JztcbiAgICAgICAgdGhpcy5fcGFnZUxhYmVsc0VsZW0uc3R5bGUubGVmdCA9IHBvcy5yaWdodCAtIHBhcnNlRmxvYXQobWFyZ2luTGVmdCkgLSB0aGlzLmxhYmVsV2lkdGggLSA1ICsgJ3B4JztcbiAgICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/page-tools-overlay.js\n");

/***/ }),

/***/ "./source/js/parse-iiif-manifest.js":
/*!******************************************!*\
  !*** ./source/js/parse-iiif-manifest.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return parseIIIFManifest; });\n/* harmony import */ var _utils_parse_label_value__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/parse-label-value */ \"./source/js/utils/parse-label-value.js\");\n\n\nconst getMaxZoomLevel = (width, height) =>\n{\n    const largestDimension = Math.max(width, height);\n    if (largestDimension < 128) \n        return 0;\n    return Math.ceil(Math.log((largestDimension + 1) / (256 + 1)) / Math.log(2));\n};\n\nconst incorporateZoom = (imageDimension, zoomDifference) => imageDimension / (Math.pow(2, zoomDifference));\n\nconst getOtherImageData = (otherImages, lowestMaxZoom) =>\n{\n    return otherImages.map( (itm) =>\n    {\n        const w = itm.width;\n        const h = itm.height;\n        const info = parseImageInfo(itm);\n        const url = info.url.slice(-1) !== '/' ? info.url + '/' : info.url;  // append trailing slash to url if it's not there.\n\n        const dims = new Array(lowestMaxZoom + 1);\n        for (let j = 0; j < lowestMaxZoom + 1; j++)\n        {\n            dims[j] = {\n                h: Math.floor(incorporateZoom(h, lowestMaxZoom - j)),\n                w: Math.floor(incorporateZoom(w, lowestMaxZoom - j))\n            };\n        }\n\n        return {\n            f: info.url,\n            url: url,\n            il: itm.label || \"\",\n            d: dims\n        };\n    });\n};\n\nconst getIIIFPresentationVersion = (context) =>\n{\n    if (context === \"http://iiif.io/api/presentation/2/context.json\")\n        return 2;\n    else if (Array.isArray(context) && context.includes(\"http://iiif.io/api/presentation/2/context.json\"))\n        return 2;\n    else if (Array.isArray(context) && context.includes(\"http://iiif.io/api/presentation/3/context.json\"))\n        return 3;\n    else\n        return 2; // Assume a v2 manifest.\n};\n\n/**\n * Parses an IIIF Presentation API Manifest and converts it into a Diva.js-format object\n * (See https://github.com/DDMAL/diva.js/wiki/Development-notes#data-received-through-ajax-request)\n *\n * @param {Object} manifest - an object that represents a valid IIIF manifest\n * @returns {Object} divaServiceBlock - the data needed by Diva to show a view of a single document\n */\nfunction parseIIIFManifest (manifest)\n{\n    let ctx = manifest[\"@context\"];\n\n    if (!ctx)\n    {\n        console.error(\"Invalid IIIF Manifest; No @context found.\");\n        return null;\n    }\n\n    const version = getIIIFPresentationVersion(ctx);\n    const sequence = manifest.sequences ? manifest.sequences[0] : null;\n    const canvases = sequence ? sequence.canvases : manifest.items;\n    const numCanvases = canvases.length;\n\n    const pages = new Array(canvases.length);\n\n    let thisCanvas, \n        thisResource, \n        thisImage,\n        secondaryImages,\n        otherImages = [],\n        context, \n        url, \n        info, \n        imageAPIVersion, \n        width, \n        height, \n        maxZoom, \n        canvas, \n        label, \n        imageLabel, \n        zoomDimensions, \n        widthAtCurrentZoomLevel, \n        heightAtCurrentZoomLevel;\n\n    let lowestMaxZoom = 100;\n    let maxRatio = 0;\n    let minRatio = 100;\n\n    // quickly determine the lowest possible max zoom level (i.e., the upper bound for images) across all canvases.\n    // while we're here, compute the global ratios as well.\n    for (let z = 0; z < numCanvases; z++)\n    {\n        const c = canvases[z];\n        const w = c.width;\n        const h = c.height;\n        const mz = getMaxZoomLevel(w, h);\n        const ratio = h / w;\n        maxRatio = Math.max(ratio, maxRatio);\n        minRatio = Math.min(ratio, minRatio);\n\n        lowestMaxZoom = Math.min(lowestMaxZoom, mz);\n    }\n\n    /*\n        These arrays need to be pre-initialized since we will do arithmetic and value checking on them\n    */\n    const totalWidths = new Array(lowestMaxZoom + 1).fill(0);\n    const totalHeights = new Array(lowestMaxZoom + 1).fill(0);\n    const maxWidths = new Array(lowestMaxZoom + 1).fill(0);\n    const maxHeights = new Array(lowestMaxZoom + 1).fill(0);\n\n    for (let i = 0; i < numCanvases; i++)\n    {\n        thisCanvas = canvases[i];\n        canvas = thisCanvas['@id'] || thisCanvas.id;\n        label = thisCanvas.label;\n        thisResource = thisCanvas.images ? thisCanvas.images[0].resource : thisCanvas.items[0].items[0].body;\n\n        /*\n         * If a canvas has multiple images it will be encoded\n         * with a resource type of \"oa:Choice\" (v2) or \"Choice\" (v3).\n         **/\n        otherImages = []; // reset array\n        if (thisResource['@type'] === \"oa:Choice\" || thisResource.type === \"Choice\")\n        {\n            thisImage = thisResource.default || thisResource.items[0];\n            secondaryImages = thisResource.item || thisResource.items.slice(1);\n            otherImages = getOtherImageData(secondaryImages, lowestMaxZoom);\n        }\n        else\n        {\n            thisImage = thisResource;\n        }\n\n        // Prioritize the canvas height / width first, since images may not have h/w\n        width = thisCanvas.width || thisImage.width;\n        height = thisCanvas.height || thisImage.height;\n\n        if (width <= 0 || height <= 0)\n        {\n            console.warn('Invalid width or height for canvas ' + label + '. Skipping');\n            continue;\n        }\n\n        maxZoom = getMaxZoomLevel(width, height);\n\n        imageLabel = thisImage.label || null;\n\n        info = parseImageInfo(thisImage);\n        url = info.url.slice(-1) !== '/' ? info.url + '/' : info.url;  // append trailing slash to url if it's not there.\n\n        context = thisImage.service['@context'] || thisImage.service.type;\n\n        if (context === 'http://iiif.io/api/image/2/context.json' || context === \"ImageService2\")\n        {\n            imageAPIVersion = 2;\n        }\n        else if (context === 'http://library.stanford.edu/iiif/image-api/1.1/context.json')\n        {\n            imageAPIVersion = 1.1;\n        }\n        else\n        {\n            imageAPIVersion = 1.0;\n        }\n\n        zoomDimensions = new Array(lowestMaxZoom + 1);\n\n        for (let k = 0; k < lowestMaxZoom + 1; k++)\n        {\n            widthAtCurrentZoomLevel = Math.floor(incorporateZoom(width, lowestMaxZoom - k));\n            heightAtCurrentZoomLevel = Math.floor(incorporateZoom(height, lowestMaxZoom - k));\n            zoomDimensions[k] = {\n                h: heightAtCurrentZoomLevel,\n                w: widthAtCurrentZoomLevel\n            };\n\n            totalWidths[k] += widthAtCurrentZoomLevel;\n            totalHeights[k] += heightAtCurrentZoomLevel;\n            maxWidths[k] = Math.max(widthAtCurrentZoomLevel, maxWidths[k]);\n            maxHeights[k] = Math.max(heightAtCurrentZoomLevel, maxHeights[k]);\n        }\n\n        let isPaged = thisCanvas.viewingHint !== 'non-paged' || (thisCanvas.behavior ? thisCanvas.behavior[0] !== 'non-paged' : false);\n        let isFacing = thisCanvas.viewingHint === 'facing-pages' || (thisCanvas.behavior ? thisCanvas.behavior[0] === 'facing-pages' : false);\n\n        pages[i] = {\n            d: zoomDimensions,\n            m: maxZoom,\n            l: label,         // canvas label ('page 1, page 2', etc.)\n            il: imageLabel,   // default image label ('primary image', 'UV light', etc.)\n            f: info.url,\n            url: url,\n            api: imageAPIVersion,\n            paged: isPaged,\n            facingPages: isFacing,\n            canvas: canvas,\n            otherImages: otherImages,\n            xoffset: info.x || null,\n            yoffset: info.y || null\n        };\n    }\n\n    const averageWidths = new Array(lowestMaxZoom + 1);\n    const averageHeights = new Array(lowestMaxZoom + 1);\n\n    for (let a = 0; a < lowestMaxZoom + 1; a++)\n    {\n        averageWidths[a] = totalWidths[a] / numCanvases;\n        averageHeights[a] = totalHeights[a] / numCanvases;\n    }\n\n    const dims = {\n        a_wid: averageWidths,\n        a_hei: averageHeights,\n        max_w: maxWidths,\n        max_h: maxHeights,\n        max_ratio: maxRatio,\n        min_ratio: minRatio,\n        t_hei: totalHeights,\n        t_wid: totalWidths\n    };\n\n    // assumes paged is false for non-paged values\n    return {\n        version: version,\n        item_title: Object(_utils_parse_label_value__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(manifest).label,\n        metadata: manifest.metadata || null,\n        dims: dims,\n        max_zoom: lowestMaxZoom,\n        pgs: pages,\n        paged: manifest.viewingHint === 'paged' || (manifest.behaviour ? manifest.behaviour[0] === 'paged' : false) || (sequence ? sequence.viewingHint === 'paged' : false)\n    };\n}\n\n/**\n * Takes in a resource block from a canvas and outputs the following information associated with that resource:\n * - Image URL\n * - Image region to be displayed\n *\n * @param {Object} resource - an object representing the resource block of a canvas section in a IIIF manifest\n * @returns {Object} imageInfo - an object containing image URL and region\n */\nfunction parseImageInfo (resource)\n{\n    let url = resource['@id'] || resource.id;\n    const fragmentRegex = /#xywh=([0-9]+,[0-9]+,[0-9]+,[0-9]+)/;\n    let xywh = '';\n    let stripURL = true;\n\n    if (/\\/([0-9]+,[0-9]+,[0-9]+,[0-9]+)\\//.test(url))\n    {\n        // if resource in image API format, extract region x,y,w,h from URL (after 4th slash from last)\n        // matches coordinates in URLs of the form http://www.example.org/iiif/book1-page1/40,50,1200,1800/full/0/default.jpg\n        const urlArray = url.split('/');\n        xywh = urlArray[urlArray.length - 4];\n    }\n    else if (fragmentRegex.test(url))\n    {\n        // matches coordinates of the style http://www.example.org/iiif/book1/canvas/p1#xywh=50,50,320,240\n        const result = fragmentRegex.exec(url);\n        xywh = result[1];\n    }\n    else if (resource.service && (resource.service['@id'] || resource.service.id))\n    {\n        // this URL excludes region parameters so we don't need to remove them\n        url = resource.service['@id'] || resource.service.id;\n        stripURL = false;\n    }\n\n    if (stripURL)\n    {\n        // extract URL up to identifier (we eliminate the last 5 parameters: /region/size/rotation/quality.format)\n        url = url.split('/').slice(0, -4).join('/');\n    }\n\n    const imageInfo = {\n        url: url\n    };\n\n    if (xywh.length)\n    {\n        // parse into separate components\n        const dimensions = xywh.split(',');\n        imageInfo.x = parseInt(dimensions[0], 10);\n        imageInfo.y = parseInt(dimensions[1], 10);\n        imageInfo.w = parseInt(dimensions[2], 10);\n        imageInfo.h = parseInt(dimensions[3], 10);\n    }\n\n    return imageInfo;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvcGFyc2UtaWlpZi1tYW5pZmVzdC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9qcy9wYXJzZS1paWlmLW1hbmlmZXN0LmpzP2Q0ODYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhcnNlTGFiZWxWYWx1ZSBmcm9tICcuL3V0aWxzL3BhcnNlLWxhYmVsLXZhbHVlJztcblxuY29uc3QgZ2V0TWF4Wm9vbUxldmVsID0gKHdpZHRoLCBoZWlnaHQpID0+XG57XG4gICAgY29uc3QgbGFyZ2VzdERpbWVuc2lvbiA9IE1hdGgubWF4KHdpZHRoLCBoZWlnaHQpO1xuICAgIGlmIChsYXJnZXN0RGltZW5zaW9uIDwgMTI4KSBcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgcmV0dXJuIE1hdGguY2VpbChNYXRoLmxvZygobGFyZ2VzdERpbWVuc2lvbiArIDEpIC8gKDI1NiArIDEpKSAvIE1hdGgubG9nKDIpKTtcbn07XG5cbmNvbnN0IGluY29ycG9yYXRlWm9vbSA9IChpbWFnZURpbWVuc2lvbiwgem9vbURpZmZlcmVuY2UpID0+IGltYWdlRGltZW5zaW9uIC8gKE1hdGgucG93KDIsIHpvb21EaWZmZXJlbmNlKSk7XG5cbmNvbnN0IGdldE90aGVySW1hZ2VEYXRhID0gKG90aGVySW1hZ2VzLCBsb3dlc3RNYXhab29tKSA9Plxue1xuICAgIHJldHVybiBvdGhlckltYWdlcy5tYXAoIChpdG0pID0+XG4gICAge1xuICAgICAgICBjb25zdCB3ID0gaXRtLndpZHRoO1xuICAgICAgICBjb25zdCBoID0gaXRtLmhlaWdodDtcbiAgICAgICAgY29uc3QgaW5mbyA9IHBhcnNlSW1hZ2VJbmZvKGl0bSk7XG4gICAgICAgIGNvbnN0IHVybCA9IGluZm8udXJsLnNsaWNlKC0xKSAhPT0gJy8nID8gaW5mby51cmwgKyAnLycgOiBpbmZvLnVybDsgIC8vIGFwcGVuZCB0cmFpbGluZyBzbGFzaCB0byB1cmwgaWYgaXQncyBub3QgdGhlcmUuXG5cbiAgICAgICAgY29uc3QgZGltcyA9IG5ldyBBcnJheShsb3dlc3RNYXhab29tICsgMSk7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbG93ZXN0TWF4Wm9vbSArIDE7IGorKylcbiAgICAgICAge1xuICAgICAgICAgICAgZGltc1tqXSA9IHtcbiAgICAgICAgICAgICAgICBoOiBNYXRoLmZsb29yKGluY29ycG9yYXRlWm9vbShoLCBsb3dlc3RNYXhab29tIC0gaikpLFxuICAgICAgICAgICAgICAgIHc6IE1hdGguZmxvb3IoaW5jb3Jwb3JhdGVab29tKHcsIGxvd2VzdE1heFpvb20gLSBqKSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZjogaW5mby51cmwsXG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIGlsOiBpdG0ubGFiZWwgfHwgXCJcIixcbiAgICAgICAgICAgIGQ6IGRpbXNcbiAgICAgICAgfTtcbiAgICB9KTtcbn07XG5cbmNvbnN0IGdldElJSUZQcmVzZW50YXRpb25WZXJzaW9uID0gKGNvbnRleHQpID0+XG57XG4gICAgaWYgKGNvbnRleHQgPT09IFwiaHR0cDovL2lpaWYuaW8vYXBpL3ByZXNlbnRhdGlvbi8yL2NvbnRleHQuanNvblwiKVxuICAgICAgICByZXR1cm4gMjtcbiAgICBlbHNlIGlmIChBcnJheS5pc0FycmF5KGNvbnRleHQpICYmIGNvbnRleHQuaW5jbHVkZXMoXCJodHRwOi8vaWlpZi5pby9hcGkvcHJlc2VudGF0aW9uLzIvY29udGV4dC5qc29uXCIpKVxuICAgICAgICByZXR1cm4gMjtcbiAgICBlbHNlIGlmIChBcnJheS5pc0FycmF5KGNvbnRleHQpICYmIGNvbnRleHQuaW5jbHVkZXMoXCJodHRwOi8vaWlpZi5pby9hcGkvcHJlc2VudGF0aW9uLzMvY29udGV4dC5qc29uXCIpKVxuICAgICAgICByZXR1cm4gMztcbiAgICBlbHNlXG4gICAgICAgIHJldHVybiAyOyAvLyBBc3N1bWUgYSB2MiBtYW5pZmVzdC5cbn07XG5cbi8qKlxuICogUGFyc2VzIGFuIElJSUYgUHJlc2VudGF0aW9uIEFQSSBNYW5pZmVzdCBhbmQgY29udmVydHMgaXQgaW50byBhIERpdmEuanMtZm9ybWF0IG9iamVjdFxuICogKFNlZSBodHRwczovL2dpdGh1Yi5jb20vRERNQUwvZGl2YS5qcy93aWtpL0RldmVsb3BtZW50LW5vdGVzI2RhdGEtcmVjZWl2ZWQtdGhyb3VnaC1hamF4LXJlcXVlc3QpXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG1hbmlmZXN0IC0gYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhIHZhbGlkIElJSUYgbWFuaWZlc3RcbiAqIEByZXR1cm5zIHtPYmplY3R9IGRpdmFTZXJ2aWNlQmxvY2sgLSB0aGUgZGF0YSBuZWVkZWQgYnkgRGl2YSB0byBzaG93IGEgdmlldyBvZiBhIHNpbmdsZSBkb2N1bWVudFxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBwYXJzZUlJSUZNYW5pZmVzdCAobWFuaWZlc3QpXG57XG4gICAgbGV0IGN0eCA9IG1hbmlmZXN0W1wiQGNvbnRleHRcIl07XG5cbiAgICBpZiAoIWN0eClcbiAgICB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJJbnZhbGlkIElJSUYgTWFuaWZlc3Q7IE5vIEBjb250ZXh0IGZvdW5kLlwiKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgdmVyc2lvbiA9IGdldElJSUZQcmVzZW50YXRpb25WZXJzaW9uKGN0eCk7XG4gICAgY29uc3Qgc2VxdWVuY2UgPSBtYW5pZmVzdC5zZXF1ZW5jZXMgPyBtYW5pZmVzdC5zZXF1ZW5jZXNbMF0gOiBudWxsO1xuICAgIGNvbnN0IGNhbnZhc2VzID0gc2VxdWVuY2UgPyBzZXF1ZW5jZS5jYW52YXNlcyA6IG1hbmlmZXN0Lml0ZW1zO1xuICAgIGNvbnN0IG51bUNhbnZhc2VzID0gY2FudmFzZXMubGVuZ3RoO1xuXG4gICAgY29uc3QgcGFnZXMgPSBuZXcgQXJyYXkoY2FudmFzZXMubGVuZ3RoKTtcblxuICAgIGxldCB0aGlzQ2FudmFzLCBcbiAgICAgICAgdGhpc1Jlc291cmNlLCBcbiAgICAgICAgdGhpc0ltYWdlLFxuICAgICAgICBzZWNvbmRhcnlJbWFnZXMsXG4gICAgICAgIG90aGVySW1hZ2VzID0gW10sXG4gICAgICAgIGNvbnRleHQsIFxuICAgICAgICB1cmwsIFxuICAgICAgICBpbmZvLCBcbiAgICAgICAgaW1hZ2VBUElWZXJzaW9uLCBcbiAgICAgICAgd2lkdGgsIFxuICAgICAgICBoZWlnaHQsIFxuICAgICAgICBtYXhab29tLCBcbiAgICAgICAgY2FudmFzLCBcbiAgICAgICAgbGFiZWwsIFxuICAgICAgICBpbWFnZUxhYmVsLCBcbiAgICAgICAgem9vbURpbWVuc2lvbnMsIFxuICAgICAgICB3aWR0aEF0Q3VycmVudFpvb21MZXZlbCwgXG4gICAgICAgIGhlaWdodEF0Q3VycmVudFpvb21MZXZlbDtcblxuICAgIGxldCBsb3dlc3RNYXhab29tID0gMTAwO1xuICAgIGxldCBtYXhSYXRpbyA9IDA7XG4gICAgbGV0IG1pblJhdGlvID0gMTAwO1xuXG4gICAgLy8gcXVpY2tseSBkZXRlcm1pbmUgdGhlIGxvd2VzdCBwb3NzaWJsZSBtYXggem9vbSBsZXZlbCAoaS5lLiwgdGhlIHVwcGVyIGJvdW5kIGZvciBpbWFnZXMpIGFjcm9zcyBhbGwgY2FudmFzZXMuXG4gICAgLy8gd2hpbGUgd2UncmUgaGVyZSwgY29tcHV0ZSB0aGUgZ2xvYmFsIHJhdGlvcyBhcyB3ZWxsLlxuICAgIGZvciAobGV0IHogPSAwOyB6IDwgbnVtQ2FudmFzZXM7IHorKylcbiAgICB7XG4gICAgICAgIGNvbnN0IGMgPSBjYW52YXNlc1t6XTtcbiAgICAgICAgY29uc3QgdyA9IGMud2lkdGg7XG4gICAgICAgIGNvbnN0IGggPSBjLmhlaWdodDtcbiAgICAgICAgY29uc3QgbXogPSBnZXRNYXhab29tTGV2ZWwodywgaCk7XG4gICAgICAgIGNvbnN0IHJhdGlvID0gaCAvIHc7XG4gICAgICAgIG1heFJhdGlvID0gTWF0aC5tYXgocmF0aW8sIG1heFJhdGlvKTtcbiAgICAgICAgbWluUmF0aW8gPSBNYXRoLm1pbihyYXRpbywgbWluUmF0aW8pO1xuXG4gICAgICAgIGxvd2VzdE1heFpvb20gPSBNYXRoLm1pbihsb3dlc3RNYXhab29tLCBteik7XG4gICAgfVxuXG4gICAgLypcbiAgICAgICAgVGhlc2UgYXJyYXlzIG5lZWQgdG8gYmUgcHJlLWluaXRpYWxpemVkIHNpbmNlIHdlIHdpbGwgZG8gYXJpdGhtZXRpYyBhbmQgdmFsdWUgY2hlY2tpbmcgb24gdGhlbVxuICAgICovXG4gICAgY29uc3QgdG90YWxXaWR0aHMgPSBuZXcgQXJyYXkobG93ZXN0TWF4Wm9vbSArIDEpLmZpbGwoMCk7XG4gICAgY29uc3QgdG90YWxIZWlnaHRzID0gbmV3IEFycmF5KGxvd2VzdE1heFpvb20gKyAxKS5maWxsKDApO1xuICAgIGNvbnN0IG1heFdpZHRocyA9IG5ldyBBcnJheShsb3dlc3RNYXhab29tICsgMSkuZmlsbCgwKTtcbiAgICBjb25zdCBtYXhIZWlnaHRzID0gbmV3IEFycmF5KGxvd2VzdE1heFpvb20gKyAxKS5maWxsKDApO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1DYW52YXNlczsgaSsrKVxuICAgIHtcbiAgICAgICAgdGhpc0NhbnZhcyA9IGNhbnZhc2VzW2ldO1xuICAgICAgICBjYW52YXMgPSB0aGlzQ2FudmFzWydAaWQnXSB8fCB0aGlzQ2FudmFzLmlkO1xuICAgICAgICBsYWJlbCA9IHRoaXNDYW52YXMubGFiZWw7XG4gICAgICAgIHRoaXNSZXNvdXJjZSA9IHRoaXNDYW52YXMuaW1hZ2VzID8gdGhpc0NhbnZhcy5pbWFnZXNbMF0ucmVzb3VyY2UgOiB0aGlzQ2FudmFzLml0ZW1zWzBdLml0ZW1zWzBdLmJvZHk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogSWYgYSBjYW52YXMgaGFzIG11bHRpcGxlIGltYWdlcyBpdCB3aWxsIGJlIGVuY29kZWRcbiAgICAgICAgICogd2l0aCBhIHJlc291cmNlIHR5cGUgb2YgXCJvYTpDaG9pY2VcIiAodjIpIG9yIFwiQ2hvaWNlXCIgKHYzKS5cbiAgICAgICAgICoqL1xuICAgICAgICBvdGhlckltYWdlcyA9IFtdOyAvLyByZXNldCBhcnJheVxuICAgICAgICBpZiAodGhpc1Jlc291cmNlWydAdHlwZSddID09PSBcIm9hOkNob2ljZVwiIHx8IHRoaXNSZXNvdXJjZS50eXBlID09PSBcIkNob2ljZVwiKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzSW1hZ2UgPSB0aGlzUmVzb3VyY2UuZGVmYXVsdCB8fCB0aGlzUmVzb3VyY2UuaXRlbXNbMF07XG4gICAgICAgICAgICBzZWNvbmRhcnlJbWFnZXMgPSB0aGlzUmVzb3VyY2UuaXRlbSB8fCB0aGlzUmVzb3VyY2UuaXRlbXMuc2xpY2UoMSk7XG4gICAgICAgICAgICBvdGhlckltYWdlcyA9IGdldE90aGVySW1hZ2VEYXRhKHNlY29uZGFyeUltYWdlcywgbG93ZXN0TWF4Wm9vbSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzSW1hZ2UgPSB0aGlzUmVzb3VyY2U7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQcmlvcml0aXplIHRoZSBjYW52YXMgaGVpZ2h0IC8gd2lkdGggZmlyc3QsIHNpbmNlIGltYWdlcyBtYXkgbm90IGhhdmUgaC93XG4gICAgICAgIHdpZHRoID0gdGhpc0NhbnZhcy53aWR0aCB8fCB0aGlzSW1hZ2Uud2lkdGg7XG4gICAgICAgIGhlaWdodCA9IHRoaXNDYW52YXMuaGVpZ2h0IHx8IHRoaXNJbWFnZS5oZWlnaHQ7XG5cbiAgICAgICAgaWYgKHdpZHRoIDw9IDAgfHwgaGVpZ2h0IDw9IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignSW52YWxpZCB3aWR0aCBvciBoZWlnaHQgZm9yIGNhbnZhcyAnICsgbGFiZWwgKyAnLiBTa2lwcGluZycpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBtYXhab29tID0gZ2V0TWF4Wm9vbUxldmVsKHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgIGltYWdlTGFiZWwgPSB0aGlzSW1hZ2UubGFiZWwgfHwgbnVsbDtcblxuICAgICAgICBpbmZvID0gcGFyc2VJbWFnZUluZm8odGhpc0ltYWdlKTtcbiAgICAgICAgdXJsID0gaW5mby51cmwuc2xpY2UoLTEpICE9PSAnLycgPyBpbmZvLnVybCArICcvJyA6IGluZm8udXJsOyAgLy8gYXBwZW5kIHRyYWlsaW5nIHNsYXNoIHRvIHVybCBpZiBpdCdzIG5vdCB0aGVyZS5cblxuICAgICAgICBjb250ZXh0ID0gdGhpc0ltYWdlLnNlcnZpY2VbJ0Bjb250ZXh0J10gfHwgdGhpc0ltYWdlLnNlcnZpY2UudHlwZTtcblxuICAgICAgICBpZiAoY29udGV4dCA9PT0gJ2h0dHA6Ly9paWlmLmlvL2FwaS9pbWFnZS8yL2NvbnRleHQuanNvbicgfHwgY29udGV4dCA9PT0gXCJJbWFnZVNlcnZpY2UyXCIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGltYWdlQVBJVmVyc2lvbiA9IDI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29udGV4dCA9PT0gJ2h0dHA6Ly9saWJyYXJ5LnN0YW5mb3JkLmVkdS9paWlmL2ltYWdlLWFwaS8xLjEvY29udGV4dC5qc29uJylcbiAgICAgICAge1xuICAgICAgICAgICAgaW1hZ2VBUElWZXJzaW9uID0gMS4xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgaW1hZ2VBUElWZXJzaW9uID0gMS4wO1xuICAgICAgICB9XG5cbiAgICAgICAgem9vbURpbWVuc2lvbnMgPSBuZXcgQXJyYXkobG93ZXN0TWF4Wm9vbSArIDEpO1xuXG4gICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgbG93ZXN0TWF4Wm9vbSArIDE7IGsrKylcbiAgICAgICAge1xuICAgICAgICAgICAgd2lkdGhBdEN1cnJlbnRab29tTGV2ZWwgPSBNYXRoLmZsb29yKGluY29ycG9yYXRlWm9vbSh3aWR0aCwgbG93ZXN0TWF4Wm9vbSAtIGspKTtcbiAgICAgICAgICAgIGhlaWdodEF0Q3VycmVudFpvb21MZXZlbCA9IE1hdGguZmxvb3IoaW5jb3Jwb3JhdGVab29tKGhlaWdodCwgbG93ZXN0TWF4Wm9vbSAtIGspKTtcbiAgICAgICAgICAgIHpvb21EaW1lbnNpb25zW2tdID0ge1xuICAgICAgICAgICAgICAgIGg6IGhlaWdodEF0Q3VycmVudFpvb21MZXZlbCxcbiAgICAgICAgICAgICAgICB3OiB3aWR0aEF0Q3VycmVudFpvb21MZXZlbFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdG90YWxXaWR0aHNba10gKz0gd2lkdGhBdEN1cnJlbnRab29tTGV2ZWw7XG4gICAgICAgICAgICB0b3RhbEhlaWdodHNba10gKz0gaGVpZ2h0QXRDdXJyZW50Wm9vbUxldmVsO1xuICAgICAgICAgICAgbWF4V2lkdGhzW2tdID0gTWF0aC5tYXgod2lkdGhBdEN1cnJlbnRab29tTGV2ZWwsIG1heFdpZHRoc1trXSk7XG4gICAgICAgICAgICBtYXhIZWlnaHRzW2tdID0gTWF0aC5tYXgoaGVpZ2h0QXRDdXJyZW50Wm9vbUxldmVsLCBtYXhIZWlnaHRzW2tdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpc1BhZ2VkID0gdGhpc0NhbnZhcy52aWV3aW5nSGludCAhPT0gJ25vbi1wYWdlZCcgfHwgKHRoaXNDYW52YXMuYmVoYXZpb3IgPyB0aGlzQ2FudmFzLmJlaGF2aW9yWzBdICE9PSAnbm9uLXBhZ2VkJyA6IGZhbHNlKTtcbiAgICAgICAgbGV0IGlzRmFjaW5nID0gdGhpc0NhbnZhcy52aWV3aW5nSGludCA9PT0gJ2ZhY2luZy1wYWdlcycgfHwgKHRoaXNDYW52YXMuYmVoYXZpb3IgPyB0aGlzQ2FudmFzLmJlaGF2aW9yWzBdID09PSAnZmFjaW5nLXBhZ2VzJyA6IGZhbHNlKTtcblxuICAgICAgICBwYWdlc1tpXSA9IHtcbiAgICAgICAgICAgIGQ6IHpvb21EaW1lbnNpb25zLFxuICAgICAgICAgICAgbTogbWF4Wm9vbSxcbiAgICAgICAgICAgIGw6IGxhYmVsLCAgICAgICAgIC8vIGNhbnZhcyBsYWJlbCAoJ3BhZ2UgMSwgcGFnZSAyJywgZXRjLilcbiAgICAgICAgICAgIGlsOiBpbWFnZUxhYmVsLCAgIC8vIGRlZmF1bHQgaW1hZ2UgbGFiZWwgKCdwcmltYXJ5IGltYWdlJywgJ1VWIGxpZ2h0JywgZXRjLilcbiAgICAgICAgICAgIGY6IGluZm8udXJsLFxuICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICBhcGk6IGltYWdlQVBJVmVyc2lvbixcbiAgICAgICAgICAgIHBhZ2VkOiBpc1BhZ2VkLFxuICAgICAgICAgICAgZmFjaW5nUGFnZXM6IGlzRmFjaW5nLFxuICAgICAgICAgICAgY2FudmFzOiBjYW52YXMsXG4gICAgICAgICAgICBvdGhlckltYWdlczogb3RoZXJJbWFnZXMsXG4gICAgICAgICAgICB4b2Zmc2V0OiBpbmZvLnggfHwgbnVsbCxcbiAgICAgICAgICAgIHlvZmZzZXQ6IGluZm8ueSB8fCBudWxsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgYXZlcmFnZVdpZHRocyA9IG5ldyBBcnJheShsb3dlc3RNYXhab29tICsgMSk7XG4gICAgY29uc3QgYXZlcmFnZUhlaWdodHMgPSBuZXcgQXJyYXkobG93ZXN0TWF4Wm9vbSArIDEpO1xuXG4gICAgZm9yIChsZXQgYSA9IDA7IGEgPCBsb3dlc3RNYXhab29tICsgMTsgYSsrKVxuICAgIHtcbiAgICAgICAgYXZlcmFnZVdpZHRoc1thXSA9IHRvdGFsV2lkdGhzW2FdIC8gbnVtQ2FudmFzZXM7XG4gICAgICAgIGF2ZXJhZ2VIZWlnaHRzW2FdID0gdG90YWxIZWlnaHRzW2FdIC8gbnVtQ2FudmFzZXM7XG4gICAgfVxuXG4gICAgY29uc3QgZGltcyA9IHtcbiAgICAgICAgYV93aWQ6IGF2ZXJhZ2VXaWR0aHMsXG4gICAgICAgIGFfaGVpOiBhdmVyYWdlSGVpZ2h0cyxcbiAgICAgICAgbWF4X3c6IG1heFdpZHRocyxcbiAgICAgICAgbWF4X2g6IG1heEhlaWdodHMsXG4gICAgICAgIG1heF9yYXRpbzogbWF4UmF0aW8sXG4gICAgICAgIG1pbl9yYXRpbzogbWluUmF0aW8sXG4gICAgICAgIHRfaGVpOiB0b3RhbEhlaWdodHMsXG4gICAgICAgIHRfd2lkOiB0b3RhbFdpZHRoc1xuICAgIH07XG5cbiAgICAvLyBhc3N1bWVzIHBhZ2VkIGlzIGZhbHNlIGZvciBub24tcGFnZWQgdmFsdWVzXG4gICAgcmV0dXJuIHtcbiAgICAgICAgdmVyc2lvbjogdmVyc2lvbixcbiAgICAgICAgaXRlbV90aXRsZTogcGFyc2VMYWJlbFZhbHVlKG1hbmlmZXN0KS5sYWJlbCxcbiAgICAgICAgbWV0YWRhdGE6IG1hbmlmZXN0Lm1ldGFkYXRhIHx8IG51bGwsXG4gICAgICAgIGRpbXM6IGRpbXMsXG4gICAgICAgIG1heF96b29tOiBsb3dlc3RNYXhab29tLFxuICAgICAgICBwZ3M6IHBhZ2VzLFxuICAgICAgICBwYWdlZDogbWFuaWZlc3Qudmlld2luZ0hpbnQgPT09ICdwYWdlZCcgfHwgKG1hbmlmZXN0LmJlaGF2aW91ciA/IG1hbmlmZXN0LmJlaGF2aW91clswXSA9PT0gJ3BhZ2VkJyA6IGZhbHNlKSB8fCAoc2VxdWVuY2UgPyBzZXF1ZW5jZS52aWV3aW5nSGludCA9PT0gJ3BhZ2VkJyA6IGZhbHNlKVxuICAgIH07XG59XG5cbi8qKlxuICogVGFrZXMgaW4gYSByZXNvdXJjZSBibG9jayBmcm9tIGEgY2FudmFzIGFuZCBvdXRwdXRzIHRoZSBmb2xsb3dpbmcgaW5mb3JtYXRpb24gYXNzb2NpYXRlZCB3aXRoIHRoYXQgcmVzb3VyY2U6XG4gKiAtIEltYWdlIFVSTFxuICogLSBJbWFnZSByZWdpb24gdG8gYmUgZGlzcGxheWVkXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHJlc291cmNlIC0gYW4gb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgcmVzb3VyY2UgYmxvY2sgb2YgYSBjYW52YXMgc2VjdGlvbiBpbiBhIElJSUYgbWFuaWZlc3RcbiAqIEByZXR1cm5zIHtPYmplY3R9IGltYWdlSW5mbyAtIGFuIG9iamVjdCBjb250YWluaW5nIGltYWdlIFVSTCBhbmQgcmVnaW9uXG4gKi9cbmZ1bmN0aW9uIHBhcnNlSW1hZ2VJbmZvIChyZXNvdXJjZSlcbntcbiAgICBsZXQgdXJsID0gcmVzb3VyY2VbJ0BpZCddIHx8IHJlc291cmNlLmlkO1xuICAgIGNvbnN0IGZyYWdtZW50UmVnZXggPSAvI3h5d2g9KFswLTldKyxbMC05XSssWzAtOV0rLFswLTldKykvO1xuICAgIGxldCB4eXdoID0gJyc7XG4gICAgbGV0IHN0cmlwVVJMID0gdHJ1ZTtcblxuICAgIGlmICgvXFwvKFswLTldKyxbMC05XSssWzAtOV0rLFswLTldKylcXC8vLnRlc3QodXJsKSlcbiAgICB7XG4gICAgICAgIC8vIGlmIHJlc291cmNlIGluIGltYWdlIEFQSSBmb3JtYXQsIGV4dHJhY3QgcmVnaW9uIHgseSx3LGggZnJvbSBVUkwgKGFmdGVyIDR0aCBzbGFzaCBmcm9tIGxhc3QpXG4gICAgICAgIC8vIG1hdGNoZXMgY29vcmRpbmF0ZXMgaW4gVVJMcyBvZiB0aGUgZm9ybSBodHRwOi8vd3d3LmV4YW1wbGUub3JnL2lpaWYvYm9vazEtcGFnZTEvNDAsNTAsMTIwMCwxODAwL2Z1bGwvMC9kZWZhdWx0LmpwZ1xuICAgICAgICBjb25zdCB1cmxBcnJheSA9IHVybC5zcGxpdCgnLycpO1xuICAgICAgICB4eXdoID0gdXJsQXJyYXlbdXJsQXJyYXkubGVuZ3RoIC0gNF07XG4gICAgfVxuICAgIGVsc2UgaWYgKGZyYWdtZW50UmVnZXgudGVzdCh1cmwpKVxuICAgIHtcbiAgICAgICAgLy8gbWF0Y2hlcyBjb29yZGluYXRlcyBvZiB0aGUgc3R5bGUgaHR0cDovL3d3dy5leGFtcGxlLm9yZy9paWlmL2Jvb2sxL2NhbnZhcy9wMSN4eXdoPTUwLDUwLDMyMCwyNDBcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZnJhZ21lbnRSZWdleC5leGVjKHVybCk7XG4gICAgICAgIHh5d2ggPSByZXN1bHRbMV07XG4gICAgfVxuICAgIGVsc2UgaWYgKHJlc291cmNlLnNlcnZpY2UgJiYgKHJlc291cmNlLnNlcnZpY2VbJ0BpZCddIHx8IHJlc291cmNlLnNlcnZpY2UuaWQpKVxuICAgIHtcbiAgICAgICAgLy8gdGhpcyBVUkwgZXhjbHVkZXMgcmVnaW9uIHBhcmFtZXRlcnMgc28gd2UgZG9uJ3QgbmVlZCB0byByZW1vdmUgdGhlbVxuICAgICAgICB1cmwgPSByZXNvdXJjZS5zZXJ2aWNlWydAaWQnXSB8fCByZXNvdXJjZS5zZXJ2aWNlLmlkO1xuICAgICAgICBzdHJpcFVSTCA9IGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChzdHJpcFVSTClcbiAgICB7XG4gICAgICAgIC8vIGV4dHJhY3QgVVJMIHVwIHRvIGlkZW50aWZpZXIgKHdlIGVsaW1pbmF0ZSB0aGUgbGFzdCA1IHBhcmFtZXRlcnM6IC9yZWdpb24vc2l6ZS9yb3RhdGlvbi9xdWFsaXR5LmZvcm1hdClcbiAgICAgICAgdXJsID0gdXJsLnNwbGl0KCcvJykuc2xpY2UoMCwgLTQpLmpvaW4oJy8nKTtcbiAgICB9XG5cbiAgICBjb25zdCBpbWFnZUluZm8gPSB7XG4gICAgICAgIHVybDogdXJsXG4gICAgfTtcblxuICAgIGlmICh4eXdoLmxlbmd0aClcbiAgICB7XG4gICAgICAgIC8vIHBhcnNlIGludG8gc2VwYXJhdGUgY29tcG9uZW50c1xuICAgICAgICBjb25zdCBkaW1lbnNpb25zID0geHl3aC5zcGxpdCgnLCcpO1xuICAgICAgICBpbWFnZUluZm8ueCA9IHBhcnNlSW50KGRpbWVuc2lvbnNbMF0sIDEwKTtcbiAgICAgICAgaW1hZ2VJbmZvLnkgPSBwYXJzZUludChkaW1lbnNpb25zWzFdLCAxMCk7XG4gICAgICAgIGltYWdlSW5mby53ID0gcGFyc2VJbnQoZGltZW5zaW9uc1syXSwgMTApO1xuICAgICAgICBpbWFnZUluZm8uaCA9IHBhcnNlSW50KGRpbWVuc2lvbnNbM10sIDEwKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW1hZ2VJbmZvO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/parse-iiif-manifest.js\n");

/***/ }),

/***/ "./source/js/renderer.js":
/*!*******************************!*\
  !*** ./source/js/renderer.js ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Renderer; });\n/* harmony import */ var _utils_elt__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/elt */ \"./source/js/utils/elt.js\");\n/* harmony import */ var _composite_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./composite-image */ \"./source/js/composite-image.js\");\n/* harmony import */ var _document_layout__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./document-layout */ \"./source/js/document-layout.js\");\n/* harmony import */ var _image_cache__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./image-cache */ \"./source/js/image-cache.js\");\n/* harmony import */ var _image_request_handler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./image-request-handler */ \"./source/js/image-request-handler.js\");\n/* harmony import */ var _interpolate_animation__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./interpolate-animation */ \"./source/js/interpolate-animation.js\");\nconst debug = __webpack_require__(/*! debug */ \"./node_modules/debug/src/browser.js\")('diva:Renderer');\nconst debugPaints = __webpack_require__(/*! debug */ \"./node_modules/debug/src/browser.js\")('diva:Renderer:paints');\n\n\n\n\n\n\n\n\nconst REQUEST_DEBOUNCE_INTERVAL = 250;\n\nclass Renderer\n{\n    constructor (options, hooks)\n    {\n        this._viewport = options.viewport;\n        this._outerElement = options.outerElement;\n        this._documentElement = options.innerElement;\n\n        this._hooks = hooks || {};\n\n        this._canvas = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('canvas', { class: 'diva-viewer-canvas' });\n        this._ctx = this._canvas.getContext('2d');\n\n        this.layout = null;\n\n        this._sourceResolver = null;\n        this._renderedPages = null;\n        this._config = null;\n        this._zoomLevel = null;\n        this._compositeImages = null;\n        this._renderedTiles = null;\n        this._animation = null;\n\n        // FIXME(wabain): What level should this be maintained at?\n        // Diva global?\n        this._cache = new _image_cache__WEBPACK_IMPORTED_MODULE_3__[\"default\"]();\n        this._pendingRequests = {};\n    }\n\n    static getCompatibilityErrors ()\n    {\n        if (typeof HTMLCanvasElement !== 'undefined')\n        {\n            return null;\n        }\n\n        return [\n            'Your browser lacks support for the ', Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('pre', 'canvas'),\n            ' element. Please upgrade your browser.'\n        ];\n    }\n\n    load (config, viewportPosition, sourceResolver)\n    {\n        this._clearAnimation();\n\n        if (this._hooks.onViewWillLoad)\n        {\n            this._hooks.onViewWillLoad();\n        }\n\n        this._sourceResolver = sourceResolver;\n        this._config = config;\n        this._compositeImages = {};\n        this._setLayoutToZoomLevel(viewportPosition.zoomLevel);\n\n        // FIXME(wabain): Remove this when there's more confidence the check shouldn't be needed\n        if (!this.layout.getPageInfo(viewportPosition.anchorPage))\n        {\n            throw new Error('invalid page: ' + viewportPosition.anchorPage);\n        }\n\n        if (this._canvas.width !== this._viewport.width || this._canvas.height !== this._viewport.height)\n        {\n            debug('Canvas dimension change: (%s, %s) -> (%s, %s)', this._canvas.width, this._canvas.height,\n                this._viewport.width, this._viewport.height);\n\n            this._canvas.width = this._viewport.width;\n            this._canvas.height = this._viewport.height;\n        }\n        else\n        {\n            debug('Reload, no size change');\n        }\n\n        // FIXME: What hooks should be called here?\n        this.goto(viewportPosition.anchorPage, viewportPosition.verticalOffset, viewportPosition.horizontalOffset);\n\n        if (this._canvas.parentNode !== this._outerElement)\n        {\n            this._outerElement.insertBefore(this._canvas, this._outerElement.firstChild);\n        }\n\n        if (this._hooks.onViewDidLoad)\n        {\n            this._hooks.onViewDidLoad();\n        }\n    }\n\n    _setViewportPosition (viewportPosition)\n    {\n        if (viewportPosition.zoomLevel !== this._zoomLevel)\n        {\n            if (this._zoomLevel === null)\n            {\n                throw new TypeError('The current view is not zoomable');\n            }\n            else if (viewportPosition.zoomLevel === null)\n            {\n                throw new TypeError('The current view requires a zoom level');\n            }\n\n            this._setLayoutToZoomLevel(viewportPosition.zoomLevel);\n        }\n\n        this._goto(viewportPosition.anchorPage, viewportPosition.verticalOffset, viewportPosition.horizontalOffset);\n    }\n\n    _setLayoutToZoomLevel (zoomLevel)\n    {\n        this.layout = new _document_layout__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this._config, zoomLevel);\n        this._zoomLevel = zoomLevel;\n\n        Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"setAttributes\"])(this._documentElement, {\n            style: {\n                height: this.layout.dimensions.height + 'px',\n                width: this.layout.dimensions.width + 'px'\n            }\n        });\n\n        this._viewport.setInnerDimensions(this.layout.dimensions);\n    }\n\n    adjust ()\n    {\n        this._clearAnimation();\n\n        this._render();\n\n        if (this._hooks.onViewDidUpdate)\n        {\n            this._hooks.onViewDidUpdate(this._renderedPages.slice(), null);\n        }\n    }\n\n    _render ()\n    {\n        const newRenderedPages = [];\n        this.layout.pageGroups.forEach((group) =>\n        {\n            if (!this._viewport.intersectsRegion(group.region))\n            {\n                return;\n            }\n\n            const visiblePages = group.pages\n                .filter(function (page)\n                {\n                    return this.isPageVisible(page.index);\n                }, this)\n                .map(page => page.index);\n\n            newRenderedPages.push.apply(newRenderedPages, visiblePages);\n        }, this);\n\n        this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\n        this._paintOutline(newRenderedPages);\n\n        newRenderedPages.forEach((pageIndex) =>\n        {\n            if (!this._compositeImages[pageIndex])\n            {\n                const page = this.layout.getPageInfo(pageIndex);\n                const zoomLevels = this._sourceResolver.getAllZoomLevelsForPage(page);\n                const composite = new _composite_image__WEBPACK_IMPORTED_MODULE_1__[\"default\"](zoomLevels);\n                composite.updateFromCache(this._cache);\n                this._compositeImages[pageIndex] = composite;\n            }\n        }, this);\n\n        this._initiateTileRequests(newRenderedPages);\n\n        const changes = findChanges(this._renderedPages || [], newRenderedPages);\n\n        changes.removed.forEach((pageIndex) =>\n        {\n            delete this._compositeImages[pageIndex];\n        }, this);\n\n        this._renderedPages = newRenderedPages;\n        this._paint();\n\n        if (this._hooks.onPageWillLoad)\n        {\n            changes.added.forEach((pageIndex) =>\n            {\n                this._hooks.onPageWillLoad(pageIndex);\n            }, this);\n        }\n    }\n\n    _paint ()\n    {\n        debug('Repainting');\n\n        const renderedTiles = [];\n\n        this._renderedPages.forEach(function (pageIndex)\n        {\n            this._compositeImages[pageIndex].getTiles(this._zoomLevel).forEach((source) =>\n            {\n                const scaled = getScaledTileRecord(source, this._zoomLevel);\n\n                if (this._isTileVisible(pageIndex, scaled))\n                {\n                    renderedTiles.push(source.url);\n                    this._drawTile(pageIndex, scaled, this._cache.get(source.url));\n                }\n            }, this);\n        }, this);\n\n        const cache = this._cache;\n\n        const changes = findChanges(this._renderedTiles || [], renderedTiles);\n\n        changes.added.forEach(url =>\n        {\n            cache.acquire(url);\n        });\n\n        changes.removed.forEach(url =>\n        {\n            cache.release(url);\n        });\n\n        if (changes.removed)\n        {\n            // FIXME: Should only need to update the composite images\n            // for which tiles were removed\n            this._renderedPages.forEach((pageIndex) =>\n            {\n                this._compositeImages[pageIndex].updateFromCache(this._cache);\n            }, this);\n        }\n\n        this._renderedTiles = renderedTiles;\n    }\n\n    // Paint a page outline while the tiles are loading.\n    _paintOutline (pages)\n    {\n        pages.forEach(function (pageIndex)\n        {\n            const pageInfo = this.layout.getPageInfo(pageIndex);\n            const pageOffset = this._getImageOffset(pageIndex);\n\n            // Ensure the document is drawn to the center of the viewport\n            const viewportPaddingX = Math.max(0, (this._viewport.width - this.layout.dimensions.width) / 2);\n            const viewportPaddingY = Math.max(0, (this._viewport.height - this.layout.dimensions.height) / 2);\n\n            const viewportOffsetX = pageOffset.left - this._viewport.left + viewportPaddingX;\n            const viewportOffsetY = pageOffset.top - this._viewport.top + viewportPaddingY;\n\n            const destXOffset = viewportOffsetX < 0 ? -viewportOffsetX : 0;\n            const destYOffset = viewportOffsetY < 0 ? -viewportOffsetY : 0;\n\n            const canvasX = Math.max(0, viewportOffsetX);\n            const canvasY = Math.max(0, viewportOffsetY);\n\n            const destWidth = pageInfo.dimensions.width - destXOffset;\n            const destHeight = pageInfo.dimensions.height - destYOffset;\n\n            this._ctx.strokeStyle = '#AAA';\n            // In order to get a 1px wide line using strokes, we need to start at a 'half pixel'\n            this._ctx.strokeRect(canvasX + 0.5, canvasY + 0.5, destWidth, destHeight);\n        }, this);\n    }\n\n    // This method should be sent all visible pages at once because it will initiate\n    // all image requests and cancel any remaining image requests. In the case that\n    // a request is ongoing and the tile is still visible in the viewport, the old request\n    // is kept active instead of restarting it. The image requests are given a timeout\n    // before loading in order to debounce them and have a small reaction time\n    // to cancel them and avoid useless requests.\n    _initiateTileRequests (pages)\n    {\n        // Only requests in this object are kept alive, since all others are not visible in the viewport\n        const newPendingRequests = {};\n\n        // Used later as a closure to initiate the image requests with the right source and pageIndex\n        const initiateRequest = (source, pageIndex) =>\n        {\n            const composite = this._compositeImages[pageIndex];\n\n            newPendingRequests[source.url] = new _image_request_handler__WEBPACK_IMPORTED_MODULE_4__[\"default\"]({\n                url: source.url,\n                timeoutTime: REQUEST_DEBOUNCE_INTERVAL,\n                load: img =>\n                {\n                    delete this._pendingRequests[source.url];\n                    this._cache.put(source.url, img);\n\n                    // Awkward way to check for updates\n                    if (composite === this._compositeImages[pageIndex])\n                    {\n                        composite.updateWithLoadedUrls([source.url]);\n\n                        if (this._isTileForSourceVisible(pageIndex, source))\n                        {\n                            this._paint();\n                        }\n                        else\n                        {\n                            debugPaints('Page %s, tile %s no longer visible on image load', pageIndex, source.url);\n                        }\n                    }\n                    else\n                    {\n                        if (this._isTileForSourceVisible(pageIndex, source))\n                            this._paint();\n                        else\n                            debugPaints('Page %s, tile %s no longer visible on image load', pageIndex, source.url);\n                    }\n                },\n                error: () =>\n                {\n                    // TODO: Could make a limited number of retries, etc.\n                    delete this._pendingRequests[source.url];\n                }\n            });\n        };\n\n        for (let i = 0; i < pages.length; i++)\n        {\n            const pageIndex = pages[i];\n            const tiles = this._sourceResolver.getBestZoomLevelForPage(this.layout.getPageInfo(pageIndex)).tiles;\n\n            for (let j = 0; j < tiles.length; j++)\n            {\n                const source = tiles[j];\n                if (this._cache.has(source.url) || !this._isTileForSourceVisible(pageIndex, source))\n                {\n                    continue;\n                }\n\n                // Don't create a new request if the tile is already being loaded\n                if (this._pendingRequests[source.url])\n                {\n                    newPendingRequests[source.url] = this._pendingRequests[source.url];\n                    delete this._pendingRequests[source.url];\n                    continue;\n                }\n\n                // Use a closure since the load and error methods are going to be called later and\n                // we need to keep the right reference to the source and the page index\n                initiateRequest(source, pageIndex);\n            }\n        }\n\n        for (const url in this._pendingRequests)\n        {\n            this._pendingRequests[url].abort();\n        }\n        this._pendingRequests = newPendingRequests;\n    }\n\n    _drawTile (pageIndex, scaledTile, img)\n    {\n        const tileOffset = this._getTileToDocumentOffset(pageIndex, scaledTile);\n\n        // Ensure the document is drawn to the center of the viewport\n        const viewportPaddingX = Math.max(0, (this._viewport.width - this.layout.dimensions.width) / 2);\n        const viewportPaddingY = Math.max(0, (this._viewport.height - this.layout.dimensions.height) / 2);\n\n        const viewportOffsetX = tileOffset.left - this._viewport.left + viewportPaddingX;\n        const viewportOffsetY = tileOffset.top - this._viewport.top + viewportPaddingY;\n\n        const destXOffset = viewportOffsetX < 0 ? -viewportOffsetX : 0;\n        const destYOffset = viewportOffsetY < 0 ? -viewportOffsetY : 0;\n\n        const sourceXOffset = destXOffset / scaledTile.scaleRatio;\n        const sourceYOffset = destYOffset / scaledTile.scaleRatio;\n\n        const canvasX = Math.max(0, viewportOffsetX);\n        const canvasY = Math.max(0, viewportOffsetY);\n\n        // Ensure that the specified dimensions are no greater than the actual\n        // size of the image. Safari won't display the tile if they are.\n        const destWidth = Math.min(scaledTile.dimensions.width, img.width * scaledTile.scaleRatio) - destXOffset;\n        const destHeight = Math.min(scaledTile.dimensions.height, img.height * scaledTile.scaleRatio) - destYOffset;\n\n        const sourceWidth = destWidth / scaledTile.scaleRatio;\n        const sourceHeight = destHeight / scaledTile.scaleRatio;\n\n        if (debugPaints.enabled)\n        {\n            debugPaints('Drawing page %s, tile %sx (%s, %s) from %s, %s to viewport at %s, %s, scale %s%%',\n                pageIndex,\n                scaledTile.sourceZoomLevel, scaledTile.row, scaledTile.col,\n                sourceXOffset, sourceYOffset,\n                canvasX, canvasY,\n                Math.round(scaledTile.scaleRatio * 100));\n        }\n\n        this._ctx.drawImage(\n            img,\n            sourceXOffset, sourceYOffset,\n            sourceWidth, sourceHeight,\n            canvasX, canvasY,\n            destWidth, destHeight);\n    }\n\n    _isTileForSourceVisible (pageIndex, tileSource)\n    {\n        return this._isTileVisible(pageIndex, getScaledTileRecord(tileSource, this._zoomLevel));\n    }\n\n    _isTileVisible (pageIndex, scaledTile)\n    {\n        const tileOffset = this._getTileToDocumentOffset(pageIndex, scaledTile);\n\n        // FIXME(wabain): This check is insufficient during a zoom transition\n        return this._viewport.intersectsRegion({\n            top: tileOffset.top,\n            bottom: tileOffset.top + scaledTile.dimensions.height,\n            left: tileOffset.left,\n            right: tileOffset.left + scaledTile.dimensions.width\n        });\n    }\n\n    _getTileToDocumentOffset (pageIndex, scaledTile)\n    {\n        const imageOffset = this._getImageOffset(pageIndex);\n\n        return {\n            top: imageOffset.top + scaledTile.offset.top,\n            left: imageOffset.left + scaledTile.offset.left\n        };\n    }\n\n    _getImageOffset (pageIndex)\n    {\n        return this.layout.getPageOffset(pageIndex, {includePadding: true});\n    }\n\n    // TODO: Update signature\n    goto (pageIndex, verticalOffset, horizontalOffset)\n    {\n        this._clearAnimation();\n        this._goto(pageIndex, verticalOffset, horizontalOffset);\n        if (this._hooks.onViewDidUpdate)\n        {\n            this._hooks.onViewDidUpdate(this._renderedPages.slice(), pageIndex);\n        }\n    }\n\n    _goto (pageIndex, verticalOffset, horizontalOffset)\n    {\n        // FIXME(wabain): Move this logic to the viewer\n        const pageOffset = this.layout.getPageOffset(pageIndex);\n\n        const desiredVerticalCenter = pageOffset.top + verticalOffset;\n        const top = desiredVerticalCenter - parseInt(this._viewport.height / 2, 10);\n\n        const desiredHorizontalCenter = pageOffset.left + horizontalOffset;\n        const left = desiredHorizontalCenter - parseInt(this._viewport.width / 2, 10);\n\n        this._viewport.top = top;\n        this._viewport.left = left;\n\n        this._render();\n    }\n\n    transitionViewportPosition (options)\n    {\n        this._clearAnimation();\n\n        const getPosition = options.getPosition;\n        const onViewDidTransition = this._hooks.onViewDidTransition;\n\n        this._animation = _interpolate_animation__WEBPACK_IMPORTED_MODULE_5__[\"default\"].animate({\n            duration: options.duration,\n            parameters: options.parameters,\n            onUpdate: (values) =>\n            {\n                // TODO: Do image preloading, work with that\n                this._setViewportPosition(getPosition(values));\n                this._hooks.onZoomLevelWillChange(values.zoomLevel);\n\n                if (onViewDidTransition)\n                {\n                    onViewDidTransition();\n                }\n            },\n            onEnd: (info) =>\n            {\n                if (options.onEnd)\n                {\n                    options.onEnd(info);\n                }\n\n                if (this._hooks.onViewDidUpdate && !info.interrupted)\n                {\n                    this._hooks.onViewDidUpdate(this._renderedPages.slice(), null);\n                }\n            }\n        });\n    }\n\n    _clearAnimation ()\n    {\n        if (this._animation)\n        {\n            this._animation.cancel();\n            this._animation = null;\n        }\n    }\n\n    preload ()\n    {\n        // TODO\n    }\n\n    isPageVisible (pageIndex)\n    {\n        if (!this.layout)\n        {\n            return false;\n        }\n\n        const page = this.layout.getPageInfo(pageIndex);\n\n        if (!page)\n        {\n            return false;\n        }\n\n        return this._viewport.intersectsRegion(this.layout.getPageRegion(pageIndex));\n    }\n\n    getRenderedPages ()\n    {\n        return this._renderedPages.slice();\n    }\n\n    destroy ()\n    {\n        this._clearAnimation();\n\n        // FIXME(wabain): I don't know if we should actually do this\n        Object.keys(this._pendingRequests).forEach((req) =>\n        {\n            const handler = this._pendingRequests[req];\n            delete this._pendingRequests[req];\n\n            handler.abort();\n        }, this);\n\n        this._canvas.parentNode.removeChild(this._canvas);\n    }\n}\n\nfunction getScaledTileRecord (source, scaleFactor)\n{\n    let scaleRatio;\n\n    if (scaleFactor === null)\n    {\n        scaleRatio = 1;\n    }\n    else\n    {\n        scaleRatio = Math.pow(2, scaleFactor - source.zoomLevel);\n    }\n\n    return {\n        sourceZoomLevel: source.zoomLevel,\n        scaleRatio: scaleRatio,\n        row: source.row,\n        col: source.col,\n        dimensions: {\n            width: source.dimensions.width * scaleRatio,\n            height: source.dimensions.height * scaleRatio\n        },\n        offset: {\n            left: source.offset.left * scaleRatio,\n            top: source.offset.top * scaleRatio\n        },\n        url: source.url\n    };\n}\n\nfunction findChanges (oldArray, newArray)\n{\n    if (oldArray === newArray)\n    {\n        return {\n            added: [],\n            removed: []\n        };\n    }\n\n    const removed = oldArray.filter(oldEntry => newArray.indexOf(oldEntry) === -1);\n\n    const added = newArray.filter(newEntry => oldArray.indexOf(newEntry) === -1);\n\n    return {\n        added: added,\n        removed: removed\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvcmVuZGVyZXIuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvcmVuZGVyZXIuanM/YmFhZCJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkZWJ1ZyA9IHJlcXVpcmUoJ2RlYnVnJykoJ2RpdmE6UmVuZGVyZXInKTtcbmNvbnN0IGRlYnVnUGFpbnRzID0gcmVxdWlyZSgnZGVidWcnKSgnZGl2YTpSZW5kZXJlcjpwYWludHMnKTtcblxuaW1wb3J0IHsgZWx0LCBzZXRBdHRyaWJ1dGVzIH0gZnJvbSAnLi91dGlscy9lbHQnO1xuaW1wb3J0IENvbXBvc2l0ZUltYWdlIGZyb20gJy4vY29tcG9zaXRlLWltYWdlJztcbmltcG9ydCBEb2N1bWVudExheW91dCBmcm9tICcuL2RvY3VtZW50LWxheW91dCc7XG5pbXBvcnQgSW1hZ2VDYWNoZSBmcm9tICcuL2ltYWdlLWNhY2hlJztcbmltcG9ydCBJbWFnZVJlcXVlc3RIYW5kbGVyIGZyb20gJy4vaW1hZ2UtcmVxdWVzdC1oYW5kbGVyJztcbmltcG9ydCBJbnRlcnBvbGF0ZUFuaW1hdGlvbiBmcm9tICcuL2ludGVycG9sYXRlLWFuaW1hdGlvbic7XG5cbmNvbnN0IFJFUVVFU1RfREVCT1VOQ0VfSU5URVJWQUwgPSAyNTA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlbmRlcmVyXG57XG4gICAgY29uc3RydWN0b3IgKG9wdGlvbnMsIGhvb2tzKVxuICAgIHtcbiAgICAgICAgdGhpcy5fdmlld3BvcnQgPSBvcHRpb25zLnZpZXdwb3J0O1xuICAgICAgICB0aGlzLl9vdXRlckVsZW1lbnQgPSBvcHRpb25zLm91dGVyRWxlbWVudDtcbiAgICAgICAgdGhpcy5fZG9jdW1lbnRFbGVtZW50ID0gb3B0aW9ucy5pbm5lckVsZW1lbnQ7XG5cbiAgICAgICAgdGhpcy5faG9va3MgPSBob29rcyB8fCB7fTtcblxuICAgICAgICB0aGlzLl9jYW52YXMgPSBlbHQoJ2NhbnZhcycsIHsgY2xhc3M6ICdkaXZhLXZpZXdlci1jYW52YXMnIH0pO1xuICAgICAgICB0aGlzLl9jdHggPSB0aGlzLl9jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgICAgICB0aGlzLmxheW91dCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fc291cmNlUmVzb2x2ZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9yZW5kZXJlZFBhZ2VzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY29uZmlnID0gbnVsbDtcbiAgICAgICAgdGhpcy5fem9vbUxldmVsID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY29tcG9zaXRlSW1hZ2VzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRUaWxlcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX2FuaW1hdGlvbiA9IG51bGw7XG5cbiAgICAgICAgLy8gRklYTUUod2FiYWluKTogV2hhdCBsZXZlbCBzaG91bGQgdGhpcyBiZSBtYWludGFpbmVkIGF0P1xuICAgICAgICAvLyBEaXZhIGdsb2JhbD9cbiAgICAgICAgdGhpcy5fY2FjaGUgPSBuZXcgSW1hZ2VDYWNoZSgpO1xuICAgICAgICB0aGlzLl9wZW5kaW5nUmVxdWVzdHMgPSB7fTtcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0Q29tcGF0aWJpbGl0eUVycm9ycyAoKVxuICAgIHtcbiAgICAgICAgaWYgKHR5cGVvZiBIVE1MQ2FudmFzRWxlbWVudCAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICdZb3VyIGJyb3dzZXIgbGFja3Mgc3VwcG9ydCBmb3IgdGhlICcsIGVsdCgncHJlJywgJ2NhbnZhcycpLFxuICAgICAgICAgICAgJyBlbGVtZW50LiBQbGVhc2UgdXBncmFkZSB5b3VyIGJyb3dzZXIuJ1xuICAgICAgICBdO1xuICAgIH1cblxuICAgIGxvYWQgKGNvbmZpZywgdmlld3BvcnRQb3NpdGlvbiwgc291cmNlUmVzb2x2ZXIpXG4gICAge1xuICAgICAgICB0aGlzLl9jbGVhckFuaW1hdGlvbigpO1xuXG4gICAgICAgIGlmICh0aGlzLl9ob29rcy5vblZpZXdXaWxsTG9hZClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5faG9va3Mub25WaWV3V2lsbExvYWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3NvdXJjZVJlc29sdmVyID0gc291cmNlUmVzb2x2ZXI7XG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgdGhpcy5fY29tcG9zaXRlSW1hZ2VzID0ge307XG4gICAgICAgIHRoaXMuX3NldExheW91dFRvWm9vbUxldmVsKHZpZXdwb3J0UG9zaXRpb24uem9vbUxldmVsKTtcblxuICAgICAgICAvLyBGSVhNRSh3YWJhaW4pOiBSZW1vdmUgdGhpcyB3aGVuIHRoZXJlJ3MgbW9yZSBjb25maWRlbmNlIHRoZSBjaGVjayBzaG91bGRuJ3QgYmUgbmVlZGVkXG4gICAgICAgIGlmICghdGhpcy5sYXlvdXQuZ2V0UGFnZUluZm8odmlld3BvcnRQb3NpdGlvbi5hbmNob3JQYWdlKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIHBhZ2U6ICcgKyB2aWV3cG9ydFBvc2l0aW9uLmFuY2hvclBhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2NhbnZhcy53aWR0aCAhPT0gdGhpcy5fdmlld3BvcnQud2lkdGggfHwgdGhpcy5fY2FudmFzLmhlaWdodCAhPT0gdGhpcy5fdmlld3BvcnQuaGVpZ2h0KVxuICAgICAgICB7XG4gICAgICAgICAgICBkZWJ1ZygnQ2FudmFzIGRpbWVuc2lvbiBjaGFuZ2U6ICglcywgJXMpIC0+ICglcywgJXMpJywgdGhpcy5fY2FudmFzLndpZHRoLCB0aGlzLl9jYW52YXMuaGVpZ2h0LFxuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXdwb3J0LndpZHRoLCB0aGlzLl92aWV3cG9ydC5oZWlnaHQpO1xuXG4gICAgICAgICAgICB0aGlzLl9jYW52YXMud2lkdGggPSB0aGlzLl92aWV3cG9ydC53aWR0aDtcbiAgICAgICAgICAgIHRoaXMuX2NhbnZhcy5oZWlnaHQgPSB0aGlzLl92aWV3cG9ydC5oZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBkZWJ1ZygnUmVsb2FkLCBubyBzaXplIGNoYW5nZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRklYTUU6IFdoYXQgaG9va3Mgc2hvdWxkIGJlIGNhbGxlZCBoZXJlP1xuICAgICAgICB0aGlzLmdvdG8odmlld3BvcnRQb3NpdGlvbi5hbmNob3JQYWdlLCB2aWV3cG9ydFBvc2l0aW9uLnZlcnRpY2FsT2Zmc2V0LCB2aWV3cG9ydFBvc2l0aW9uLmhvcml6b250YWxPZmZzZXQpO1xuXG4gICAgICAgIGlmICh0aGlzLl9jYW52YXMucGFyZW50Tm9kZSAhPT0gdGhpcy5fb3V0ZXJFbGVtZW50KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9vdXRlckVsZW1lbnQuaW5zZXJ0QmVmb3JlKHRoaXMuX2NhbnZhcywgdGhpcy5fb3V0ZXJFbGVtZW50LmZpcnN0Q2hpbGQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2hvb2tzLm9uVmlld0RpZExvYWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2hvb2tzLm9uVmlld0RpZExvYWQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9zZXRWaWV3cG9ydFBvc2l0aW9uICh2aWV3cG9ydFBvc2l0aW9uKVxuICAgIHtcbiAgICAgICAgaWYgKHZpZXdwb3J0UG9zaXRpb24uem9vbUxldmVsICE9PSB0aGlzLl96b29tTGV2ZWwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl96b29tTGV2ZWwgPT09IG51bGwpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIGN1cnJlbnQgdmlldyBpcyBub3Qgem9vbWFibGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHZpZXdwb3J0UG9zaXRpb24uem9vbUxldmVsID09PSBudWxsKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBjdXJyZW50IHZpZXcgcmVxdWlyZXMgYSB6b29tIGxldmVsJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3NldExheW91dFRvWm9vbUxldmVsKHZpZXdwb3J0UG9zaXRpb24uem9vbUxldmVsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2dvdG8odmlld3BvcnRQb3NpdGlvbi5hbmNob3JQYWdlLCB2aWV3cG9ydFBvc2l0aW9uLnZlcnRpY2FsT2Zmc2V0LCB2aWV3cG9ydFBvc2l0aW9uLmhvcml6b250YWxPZmZzZXQpO1xuICAgIH1cblxuICAgIF9zZXRMYXlvdXRUb1pvb21MZXZlbCAoem9vbUxldmVsKVxuICAgIHtcbiAgICAgICAgdGhpcy5sYXlvdXQgPSBuZXcgRG9jdW1lbnRMYXlvdXQodGhpcy5fY29uZmlnLCB6b29tTGV2ZWwpO1xuICAgICAgICB0aGlzLl96b29tTGV2ZWwgPSB6b29tTGV2ZWw7XG5cbiAgICAgICAgc2V0QXR0cmlidXRlcyh0aGlzLl9kb2N1bWVudEVsZW1lbnQsIHtcbiAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmxheW91dC5kaW1lbnNpb25zLmhlaWdodCArICdweCcsXG4gICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMubGF5b3V0LmRpbWVuc2lvbnMud2lkdGggKyAncHgnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX3ZpZXdwb3J0LnNldElubmVyRGltZW5zaW9ucyh0aGlzLmxheW91dC5kaW1lbnNpb25zKTtcbiAgICB9XG5cbiAgICBhZGp1c3QgKClcbiAgICB7XG4gICAgICAgIHRoaXMuX2NsZWFyQW5pbWF0aW9uKCk7XG5cbiAgICAgICAgdGhpcy5fcmVuZGVyKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2hvb2tzLm9uVmlld0RpZFVwZGF0ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5faG9va3Mub25WaWV3RGlkVXBkYXRlKHRoaXMuX3JlbmRlcmVkUGFnZXMuc2xpY2UoKSwgbnVsbCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfcmVuZGVyICgpXG4gICAge1xuICAgICAgICBjb25zdCBuZXdSZW5kZXJlZFBhZ2VzID0gW107XG4gICAgICAgIHRoaXMubGF5b3V0LnBhZ2VHcm91cHMuZm9yRWFjaCgoZ3JvdXApID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fdmlld3BvcnQuaW50ZXJzZWN0c1JlZ2lvbihncm91cC5yZWdpb24pKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgdmlzaWJsZVBhZ2VzID0gZ3JvdXAucGFnZXNcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChwYWdlKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNQYWdlVmlzaWJsZShwYWdlLmluZGV4KTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzKVxuICAgICAgICAgICAgICAgIC5tYXAocGFnZSA9PiBwYWdlLmluZGV4KTtcblxuICAgICAgICAgICAgbmV3UmVuZGVyZWRQYWdlcy5wdXNoLmFwcGx5KG5ld1JlbmRlcmVkUGFnZXMsIHZpc2libGVQYWdlcyk7XG4gICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgIHRoaXMuX2N0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5fY2FudmFzLndpZHRoLCB0aGlzLl9jYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5fcGFpbnRPdXRsaW5lKG5ld1JlbmRlcmVkUGFnZXMpO1xuXG4gICAgICAgIG5ld1JlbmRlcmVkUGFnZXMuZm9yRWFjaCgocGFnZUluZGV4KSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2NvbXBvc2l0ZUltYWdlc1twYWdlSW5kZXhdKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhZ2UgPSB0aGlzLmxheW91dC5nZXRQYWdlSW5mbyhwYWdlSW5kZXgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHpvb21MZXZlbHMgPSB0aGlzLl9zb3VyY2VSZXNvbHZlci5nZXRBbGxab29tTGV2ZWxzRm9yUGFnZShwYWdlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb21wb3NpdGUgPSBuZXcgQ29tcG9zaXRlSW1hZ2Uoem9vbUxldmVscyk7XG4gICAgICAgICAgICAgICAgY29tcG9zaXRlLnVwZGF0ZUZyb21DYWNoZSh0aGlzLl9jYWNoZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29tcG9zaXRlSW1hZ2VzW3BhZ2VJbmRleF0gPSBjb21wb3NpdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgIHRoaXMuX2luaXRpYXRlVGlsZVJlcXVlc3RzKG5ld1JlbmRlcmVkUGFnZXMpO1xuXG4gICAgICAgIGNvbnN0IGNoYW5nZXMgPSBmaW5kQ2hhbmdlcyh0aGlzLl9yZW5kZXJlZFBhZ2VzIHx8IFtdLCBuZXdSZW5kZXJlZFBhZ2VzKTtcblxuICAgICAgICBjaGFuZ2VzLnJlbW92ZWQuZm9yRWFjaCgocGFnZUluZGV4KSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fY29tcG9zaXRlSW1hZ2VzW3BhZ2VJbmRleF07XG4gICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgIHRoaXMuX3JlbmRlcmVkUGFnZXMgPSBuZXdSZW5kZXJlZFBhZ2VzO1xuICAgICAgICB0aGlzLl9wYWludCgpO1xuXG4gICAgICAgIGlmICh0aGlzLl9ob29rcy5vblBhZ2VXaWxsTG9hZClcbiAgICAgICAge1xuICAgICAgICAgICAgY2hhbmdlcy5hZGRlZC5mb3JFYWNoKChwYWdlSW5kZXgpID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5faG9va3Mub25QYWdlV2lsbExvYWQocGFnZUluZGV4KTtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3BhaW50ICgpXG4gICAge1xuICAgICAgICBkZWJ1ZygnUmVwYWludGluZycpO1xuXG4gICAgICAgIGNvbnN0IHJlbmRlcmVkVGlsZXMgPSBbXTtcblxuICAgICAgICB0aGlzLl9yZW5kZXJlZFBhZ2VzLmZvckVhY2goZnVuY3Rpb24gKHBhZ2VJbmRleClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fY29tcG9zaXRlSW1hZ2VzW3BhZ2VJbmRleF0uZ2V0VGlsZXModGhpcy5fem9vbUxldmVsKS5mb3JFYWNoKChzb3VyY2UpID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2NhbGVkID0gZ2V0U2NhbGVkVGlsZVJlY29yZChzb3VyY2UsIHRoaXMuX3pvb21MZXZlbCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNUaWxlVmlzaWJsZShwYWdlSW5kZXgsIHNjYWxlZCkpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZW5kZXJlZFRpbGVzLnB1c2goc291cmNlLnVybCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RyYXdUaWxlKHBhZ2VJbmRleCwgc2NhbGVkLCB0aGlzLl9jYWNoZS5nZXQoc291cmNlLnVybCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuX2NhY2hlO1xuXG4gICAgICAgIGNvbnN0IGNoYW5nZXMgPSBmaW5kQ2hhbmdlcyh0aGlzLl9yZW5kZXJlZFRpbGVzIHx8IFtdLCByZW5kZXJlZFRpbGVzKTtcblxuICAgICAgICBjaGFuZ2VzLmFkZGVkLmZvckVhY2godXJsID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNhY2hlLmFjcXVpcmUodXJsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2hhbmdlcy5yZW1vdmVkLmZvckVhY2godXJsID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNhY2hlLnJlbGVhc2UodXJsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGNoYW5nZXMucmVtb3ZlZClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gRklYTUU6IFNob3VsZCBvbmx5IG5lZWQgdG8gdXBkYXRlIHRoZSBjb21wb3NpdGUgaW1hZ2VzXG4gICAgICAgICAgICAvLyBmb3Igd2hpY2ggdGlsZXMgd2VyZSByZW1vdmVkXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlZFBhZ2VzLmZvckVhY2goKHBhZ2VJbmRleCkgPT5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb21wb3NpdGVJbWFnZXNbcGFnZUluZGV4XS51cGRhdGVGcm9tQ2FjaGUodGhpcy5fY2FjaGUpO1xuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9yZW5kZXJlZFRpbGVzID0gcmVuZGVyZWRUaWxlcztcbiAgICB9XG5cbiAgICAvLyBQYWludCBhIHBhZ2Ugb3V0bGluZSB3aGlsZSB0aGUgdGlsZXMgYXJlIGxvYWRpbmcuXG4gICAgX3BhaW50T3V0bGluZSAocGFnZXMpXG4gICAge1xuICAgICAgICBwYWdlcy5mb3JFYWNoKGZ1bmN0aW9uIChwYWdlSW5kZXgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHBhZ2VJbmZvID0gdGhpcy5sYXlvdXQuZ2V0UGFnZUluZm8ocGFnZUluZGV4KTtcbiAgICAgICAgICAgIGNvbnN0IHBhZ2VPZmZzZXQgPSB0aGlzLl9nZXRJbWFnZU9mZnNldChwYWdlSW5kZXgpO1xuXG4gICAgICAgICAgICAvLyBFbnN1cmUgdGhlIGRvY3VtZW50IGlzIGRyYXduIHRvIHRoZSBjZW50ZXIgb2YgdGhlIHZpZXdwb3J0XG4gICAgICAgICAgICBjb25zdCB2aWV3cG9ydFBhZGRpbmdYID0gTWF0aC5tYXgoMCwgKHRoaXMuX3ZpZXdwb3J0LndpZHRoIC0gdGhpcy5sYXlvdXQuZGltZW5zaW9ucy53aWR0aCkgLyAyKTtcbiAgICAgICAgICAgIGNvbnN0IHZpZXdwb3J0UGFkZGluZ1kgPSBNYXRoLm1heCgwLCAodGhpcy5fdmlld3BvcnQuaGVpZ2h0IC0gdGhpcy5sYXlvdXQuZGltZW5zaW9ucy5oZWlnaHQpIC8gMik7XG5cbiAgICAgICAgICAgIGNvbnN0IHZpZXdwb3J0T2Zmc2V0WCA9IHBhZ2VPZmZzZXQubGVmdCAtIHRoaXMuX3ZpZXdwb3J0LmxlZnQgKyB2aWV3cG9ydFBhZGRpbmdYO1xuICAgICAgICAgICAgY29uc3Qgdmlld3BvcnRPZmZzZXRZID0gcGFnZU9mZnNldC50b3AgLSB0aGlzLl92aWV3cG9ydC50b3AgKyB2aWV3cG9ydFBhZGRpbmdZO1xuXG4gICAgICAgICAgICBjb25zdCBkZXN0WE9mZnNldCA9IHZpZXdwb3J0T2Zmc2V0WCA8IDAgPyAtdmlld3BvcnRPZmZzZXRYIDogMDtcbiAgICAgICAgICAgIGNvbnN0IGRlc3RZT2Zmc2V0ID0gdmlld3BvcnRPZmZzZXRZIDwgMCA/IC12aWV3cG9ydE9mZnNldFkgOiAwO1xuXG4gICAgICAgICAgICBjb25zdCBjYW52YXNYID0gTWF0aC5tYXgoMCwgdmlld3BvcnRPZmZzZXRYKTtcbiAgICAgICAgICAgIGNvbnN0IGNhbnZhc1kgPSBNYXRoLm1heCgwLCB2aWV3cG9ydE9mZnNldFkpO1xuXG4gICAgICAgICAgICBjb25zdCBkZXN0V2lkdGggPSBwYWdlSW5mby5kaW1lbnNpb25zLndpZHRoIC0gZGVzdFhPZmZzZXQ7XG4gICAgICAgICAgICBjb25zdCBkZXN0SGVpZ2h0ID0gcGFnZUluZm8uZGltZW5zaW9ucy5oZWlnaHQgLSBkZXN0WU9mZnNldDtcblxuICAgICAgICAgICAgdGhpcy5fY3R4LnN0cm9rZVN0eWxlID0gJyNBQUEnO1xuICAgICAgICAgICAgLy8gSW4gb3JkZXIgdG8gZ2V0IGEgMXB4IHdpZGUgbGluZSB1c2luZyBzdHJva2VzLCB3ZSBuZWVkIHRvIHN0YXJ0IGF0IGEgJ2hhbGYgcGl4ZWwnXG4gICAgICAgICAgICB0aGlzLl9jdHguc3Ryb2tlUmVjdChjYW52YXNYICsgMC41LCBjYW52YXNZICsgMC41LCBkZXN0V2lkdGgsIGRlc3RIZWlnaHQpO1xuICAgICAgICB9LCB0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBUaGlzIG1ldGhvZCBzaG91bGQgYmUgc2VudCBhbGwgdmlzaWJsZSBwYWdlcyBhdCBvbmNlIGJlY2F1c2UgaXQgd2lsbCBpbml0aWF0ZVxuICAgIC8vIGFsbCBpbWFnZSByZXF1ZXN0cyBhbmQgY2FuY2VsIGFueSByZW1haW5pbmcgaW1hZ2UgcmVxdWVzdHMuIEluIHRoZSBjYXNlIHRoYXRcbiAgICAvLyBhIHJlcXVlc3QgaXMgb25nb2luZyBhbmQgdGhlIHRpbGUgaXMgc3RpbGwgdmlzaWJsZSBpbiB0aGUgdmlld3BvcnQsIHRoZSBvbGQgcmVxdWVzdFxuICAgIC8vIGlzIGtlcHQgYWN0aXZlIGluc3RlYWQgb2YgcmVzdGFydGluZyBpdC4gVGhlIGltYWdlIHJlcXVlc3RzIGFyZSBnaXZlbiBhIHRpbWVvdXRcbiAgICAvLyBiZWZvcmUgbG9hZGluZyBpbiBvcmRlciB0byBkZWJvdW5jZSB0aGVtIGFuZCBoYXZlIGEgc21hbGwgcmVhY3Rpb24gdGltZVxuICAgIC8vIHRvIGNhbmNlbCB0aGVtIGFuZCBhdm9pZCB1c2VsZXNzIHJlcXVlc3RzLlxuICAgIF9pbml0aWF0ZVRpbGVSZXF1ZXN0cyAocGFnZXMpXG4gICAge1xuICAgICAgICAvLyBPbmx5IHJlcXVlc3RzIGluIHRoaXMgb2JqZWN0IGFyZSBrZXB0IGFsaXZlLCBzaW5jZSBhbGwgb3RoZXJzIGFyZSBub3QgdmlzaWJsZSBpbiB0aGUgdmlld3BvcnRcbiAgICAgICAgY29uc3QgbmV3UGVuZGluZ1JlcXVlc3RzID0ge307XG5cbiAgICAgICAgLy8gVXNlZCBsYXRlciBhcyBhIGNsb3N1cmUgdG8gaW5pdGlhdGUgdGhlIGltYWdlIHJlcXVlc3RzIHdpdGggdGhlIHJpZ2h0IHNvdXJjZSBhbmQgcGFnZUluZGV4XG4gICAgICAgIGNvbnN0IGluaXRpYXRlUmVxdWVzdCA9IChzb3VyY2UsIHBhZ2VJbmRleCkgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgY29tcG9zaXRlID0gdGhpcy5fY29tcG9zaXRlSW1hZ2VzW3BhZ2VJbmRleF07XG5cbiAgICAgICAgICAgIG5ld1BlbmRpbmdSZXF1ZXN0c1tzb3VyY2UudXJsXSA9IG5ldyBJbWFnZVJlcXVlc3RIYW5kbGVyKHtcbiAgICAgICAgICAgICAgICB1cmw6IHNvdXJjZS51cmwsXG4gICAgICAgICAgICAgICAgdGltZW91dFRpbWU6IFJFUVVFU1RfREVCT1VOQ0VfSU5URVJWQUwsXG4gICAgICAgICAgICAgICAgbG9hZDogaW1nID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcGVuZGluZ1JlcXVlc3RzW3NvdXJjZS51cmxdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZS5wdXQoc291cmNlLnVybCwgaW1nKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBBd2t3YXJkIHdheSB0byBjaGVjayBmb3IgdXBkYXRlc1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29tcG9zaXRlID09PSB0aGlzLl9jb21wb3NpdGVJbWFnZXNbcGFnZUluZGV4XSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9zaXRlLnVwZGF0ZVdpdGhMb2FkZWRVcmxzKFtzb3VyY2UudXJsXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc1RpbGVGb3JTb3VyY2VWaXNpYmxlKHBhZ2VJbmRleCwgc291cmNlKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYWludCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnUGFpbnRzKCdQYWdlICVzLCB0aWxlICVzIG5vIGxvbmdlciB2aXNpYmxlIG9uIGltYWdlIGxvYWQnLCBwYWdlSW5kZXgsIHNvdXJjZS51cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzVGlsZUZvclNvdXJjZVZpc2libGUocGFnZUluZGV4LCBzb3VyY2UpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BhaW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidWdQYWludHMoJ1BhZ2UgJXMsIHRpbGUgJXMgbm8gbG9uZ2VyIHZpc2libGUgb24gaW1hZ2UgbG9hZCcsIHBhZ2VJbmRleCwgc291cmNlLnVybCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiAoKSA9PlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogQ291bGQgbWFrZSBhIGxpbWl0ZWQgbnVtYmVyIG9mIHJldHJpZXMsIGV0Yy5cbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3BlbmRpbmdSZXF1ZXN0c1tzb3VyY2UudXJsXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZ2VzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBwYWdlSW5kZXggPSBwYWdlc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IHRpbGVzID0gdGhpcy5fc291cmNlUmVzb2x2ZXIuZ2V0QmVzdFpvb21MZXZlbEZvclBhZ2UodGhpcy5sYXlvdXQuZ2V0UGFnZUluZm8ocGFnZUluZGV4KSkudGlsZXM7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGlsZXMubGVuZ3RoOyBqKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc291cmNlID0gdGlsZXNbal07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NhY2hlLmhhcyhzb3VyY2UudXJsKSB8fCAhdGhpcy5faXNUaWxlRm9yU291cmNlVmlzaWJsZShwYWdlSW5kZXgsIHNvdXJjZSkpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBEb24ndCBjcmVhdGUgYSBuZXcgcmVxdWVzdCBpZiB0aGUgdGlsZSBpcyBhbHJlYWR5IGJlaW5nIGxvYWRlZFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nUmVxdWVzdHNbc291cmNlLnVybF0pXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuZXdQZW5kaW5nUmVxdWVzdHNbc291cmNlLnVybF0gPSB0aGlzLl9wZW5kaW5nUmVxdWVzdHNbc291cmNlLnVybF07XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9wZW5kaW5nUmVxdWVzdHNbc291cmNlLnVybF07XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFVzZSBhIGNsb3N1cmUgc2luY2UgdGhlIGxvYWQgYW5kIGVycm9yIG1ldGhvZHMgYXJlIGdvaW5nIHRvIGJlIGNhbGxlZCBsYXRlciBhbmRcbiAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGtlZXAgdGhlIHJpZ2h0IHJlZmVyZW5jZSB0byB0aGUgc291cmNlIGFuZCB0aGUgcGFnZSBpbmRleFxuICAgICAgICAgICAgICAgIGluaXRpYXRlUmVxdWVzdChzb3VyY2UsIHBhZ2VJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IHVybCBpbiB0aGlzLl9wZW5kaW5nUmVxdWVzdHMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdSZXF1ZXN0c1t1cmxdLmFib3J0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcGVuZGluZ1JlcXVlc3RzID0gbmV3UGVuZGluZ1JlcXVlc3RzO1xuICAgIH1cblxuICAgIF9kcmF3VGlsZSAocGFnZUluZGV4LCBzY2FsZWRUaWxlLCBpbWcpXG4gICAge1xuICAgICAgICBjb25zdCB0aWxlT2Zmc2V0ID0gdGhpcy5fZ2V0VGlsZVRvRG9jdW1lbnRPZmZzZXQocGFnZUluZGV4LCBzY2FsZWRUaWxlKTtcblxuICAgICAgICAvLyBFbnN1cmUgdGhlIGRvY3VtZW50IGlzIGRyYXduIHRvIHRoZSBjZW50ZXIgb2YgdGhlIHZpZXdwb3J0XG4gICAgICAgIGNvbnN0IHZpZXdwb3J0UGFkZGluZ1ggPSBNYXRoLm1heCgwLCAodGhpcy5fdmlld3BvcnQud2lkdGggLSB0aGlzLmxheW91dC5kaW1lbnNpb25zLndpZHRoKSAvIDIpO1xuICAgICAgICBjb25zdCB2aWV3cG9ydFBhZGRpbmdZID0gTWF0aC5tYXgoMCwgKHRoaXMuX3ZpZXdwb3J0LmhlaWdodCAtIHRoaXMubGF5b3V0LmRpbWVuc2lvbnMuaGVpZ2h0KSAvIDIpO1xuXG4gICAgICAgIGNvbnN0IHZpZXdwb3J0T2Zmc2V0WCA9IHRpbGVPZmZzZXQubGVmdCAtIHRoaXMuX3ZpZXdwb3J0LmxlZnQgKyB2aWV3cG9ydFBhZGRpbmdYO1xuICAgICAgICBjb25zdCB2aWV3cG9ydE9mZnNldFkgPSB0aWxlT2Zmc2V0LnRvcCAtIHRoaXMuX3ZpZXdwb3J0LnRvcCArIHZpZXdwb3J0UGFkZGluZ1k7XG5cbiAgICAgICAgY29uc3QgZGVzdFhPZmZzZXQgPSB2aWV3cG9ydE9mZnNldFggPCAwID8gLXZpZXdwb3J0T2Zmc2V0WCA6IDA7XG4gICAgICAgIGNvbnN0IGRlc3RZT2Zmc2V0ID0gdmlld3BvcnRPZmZzZXRZIDwgMCA/IC12aWV3cG9ydE9mZnNldFkgOiAwO1xuXG4gICAgICAgIGNvbnN0IHNvdXJjZVhPZmZzZXQgPSBkZXN0WE9mZnNldCAvIHNjYWxlZFRpbGUuc2NhbGVSYXRpbztcbiAgICAgICAgY29uc3Qgc291cmNlWU9mZnNldCA9IGRlc3RZT2Zmc2V0IC8gc2NhbGVkVGlsZS5zY2FsZVJhdGlvO1xuXG4gICAgICAgIGNvbnN0IGNhbnZhc1ggPSBNYXRoLm1heCgwLCB2aWV3cG9ydE9mZnNldFgpO1xuICAgICAgICBjb25zdCBjYW52YXNZID0gTWF0aC5tYXgoMCwgdmlld3BvcnRPZmZzZXRZKTtcblxuICAgICAgICAvLyBFbnN1cmUgdGhhdCB0aGUgc3BlY2lmaWVkIGRpbWVuc2lvbnMgYXJlIG5vIGdyZWF0ZXIgdGhhbiB0aGUgYWN0dWFsXG4gICAgICAgIC8vIHNpemUgb2YgdGhlIGltYWdlLiBTYWZhcmkgd29uJ3QgZGlzcGxheSB0aGUgdGlsZSBpZiB0aGV5IGFyZS5cbiAgICAgICAgY29uc3QgZGVzdFdpZHRoID0gTWF0aC5taW4oc2NhbGVkVGlsZS5kaW1lbnNpb25zLndpZHRoLCBpbWcud2lkdGggKiBzY2FsZWRUaWxlLnNjYWxlUmF0aW8pIC0gZGVzdFhPZmZzZXQ7XG4gICAgICAgIGNvbnN0IGRlc3RIZWlnaHQgPSBNYXRoLm1pbihzY2FsZWRUaWxlLmRpbWVuc2lvbnMuaGVpZ2h0LCBpbWcuaGVpZ2h0ICogc2NhbGVkVGlsZS5zY2FsZVJhdGlvKSAtIGRlc3RZT2Zmc2V0O1xuXG4gICAgICAgIGNvbnN0IHNvdXJjZVdpZHRoID0gZGVzdFdpZHRoIC8gc2NhbGVkVGlsZS5zY2FsZVJhdGlvO1xuICAgICAgICBjb25zdCBzb3VyY2VIZWlnaHQgPSBkZXN0SGVpZ2h0IC8gc2NhbGVkVGlsZS5zY2FsZVJhdGlvO1xuXG4gICAgICAgIGlmIChkZWJ1Z1BhaW50cy5lbmFibGVkKVxuICAgICAgICB7XG4gICAgICAgICAgICBkZWJ1Z1BhaW50cygnRHJhd2luZyBwYWdlICVzLCB0aWxlICVzeCAoJXMsICVzKSBmcm9tICVzLCAlcyB0byB2aWV3cG9ydCBhdCAlcywgJXMsIHNjYWxlICVzJSUnLFxuICAgICAgICAgICAgICAgIHBhZ2VJbmRleCxcbiAgICAgICAgICAgICAgICBzY2FsZWRUaWxlLnNvdXJjZVpvb21MZXZlbCwgc2NhbGVkVGlsZS5yb3csIHNjYWxlZFRpbGUuY29sLFxuICAgICAgICAgICAgICAgIHNvdXJjZVhPZmZzZXQsIHNvdXJjZVlPZmZzZXQsXG4gICAgICAgICAgICAgICAgY2FudmFzWCwgY2FudmFzWSxcbiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKHNjYWxlZFRpbGUuc2NhbGVSYXRpbyAqIDEwMCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fY3R4LmRyYXdJbWFnZShcbiAgICAgICAgICAgIGltZyxcbiAgICAgICAgICAgIHNvdXJjZVhPZmZzZXQsIHNvdXJjZVlPZmZzZXQsXG4gICAgICAgICAgICBzb3VyY2VXaWR0aCwgc291cmNlSGVpZ2h0LFxuICAgICAgICAgICAgY2FudmFzWCwgY2FudmFzWSxcbiAgICAgICAgICAgIGRlc3RXaWR0aCwgZGVzdEhlaWdodCk7XG4gICAgfVxuXG4gICAgX2lzVGlsZUZvclNvdXJjZVZpc2libGUgKHBhZ2VJbmRleCwgdGlsZVNvdXJjZSlcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc1RpbGVWaXNpYmxlKHBhZ2VJbmRleCwgZ2V0U2NhbGVkVGlsZVJlY29yZCh0aWxlU291cmNlLCB0aGlzLl96b29tTGV2ZWwpKTtcbiAgICB9XG5cbiAgICBfaXNUaWxlVmlzaWJsZSAocGFnZUluZGV4LCBzY2FsZWRUaWxlKVxuICAgIHtcbiAgICAgICAgY29uc3QgdGlsZU9mZnNldCA9IHRoaXMuX2dldFRpbGVUb0RvY3VtZW50T2Zmc2V0KHBhZ2VJbmRleCwgc2NhbGVkVGlsZSk7XG5cbiAgICAgICAgLy8gRklYTUUod2FiYWluKTogVGhpcyBjaGVjayBpcyBpbnN1ZmZpY2llbnQgZHVyaW5nIGEgem9vbSB0cmFuc2l0aW9uXG4gICAgICAgIHJldHVybiB0aGlzLl92aWV3cG9ydC5pbnRlcnNlY3RzUmVnaW9uKHtcbiAgICAgICAgICAgIHRvcDogdGlsZU9mZnNldC50b3AsXG4gICAgICAgICAgICBib3R0b206IHRpbGVPZmZzZXQudG9wICsgc2NhbGVkVGlsZS5kaW1lbnNpb25zLmhlaWdodCxcbiAgICAgICAgICAgIGxlZnQ6IHRpbGVPZmZzZXQubGVmdCxcbiAgICAgICAgICAgIHJpZ2h0OiB0aWxlT2Zmc2V0LmxlZnQgKyBzY2FsZWRUaWxlLmRpbWVuc2lvbnMud2lkdGhcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2dldFRpbGVUb0RvY3VtZW50T2Zmc2V0IChwYWdlSW5kZXgsIHNjYWxlZFRpbGUpXG4gICAge1xuICAgICAgICBjb25zdCBpbWFnZU9mZnNldCA9IHRoaXMuX2dldEltYWdlT2Zmc2V0KHBhZ2VJbmRleCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRvcDogaW1hZ2VPZmZzZXQudG9wICsgc2NhbGVkVGlsZS5vZmZzZXQudG9wLFxuICAgICAgICAgICAgbGVmdDogaW1hZ2VPZmZzZXQubGVmdCArIHNjYWxlZFRpbGUub2Zmc2V0LmxlZnRcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBfZ2V0SW1hZ2VPZmZzZXQgKHBhZ2VJbmRleClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmxheW91dC5nZXRQYWdlT2Zmc2V0KHBhZ2VJbmRleCwge2luY2x1ZGVQYWRkaW5nOiB0cnVlfSk7XG4gICAgfVxuXG4gICAgLy8gVE9ETzogVXBkYXRlIHNpZ25hdHVyZVxuICAgIGdvdG8gKHBhZ2VJbmRleCwgdmVydGljYWxPZmZzZXQsIGhvcml6b250YWxPZmZzZXQpXG4gICAge1xuICAgICAgICB0aGlzLl9jbGVhckFuaW1hdGlvbigpO1xuICAgICAgICB0aGlzLl9nb3RvKHBhZ2VJbmRleCwgdmVydGljYWxPZmZzZXQsIGhvcml6b250YWxPZmZzZXQpO1xuICAgICAgICBpZiAodGhpcy5faG9va3Mub25WaWV3RGlkVXBkYXRlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9ob29rcy5vblZpZXdEaWRVcGRhdGUodGhpcy5fcmVuZGVyZWRQYWdlcy5zbGljZSgpLCBwYWdlSW5kZXgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2dvdG8gKHBhZ2VJbmRleCwgdmVydGljYWxPZmZzZXQsIGhvcml6b250YWxPZmZzZXQpXG4gICAge1xuICAgICAgICAvLyBGSVhNRSh3YWJhaW4pOiBNb3ZlIHRoaXMgbG9naWMgdG8gdGhlIHZpZXdlclxuICAgICAgICBjb25zdCBwYWdlT2Zmc2V0ID0gdGhpcy5sYXlvdXQuZ2V0UGFnZU9mZnNldChwYWdlSW5kZXgpO1xuXG4gICAgICAgIGNvbnN0IGRlc2lyZWRWZXJ0aWNhbENlbnRlciA9IHBhZ2VPZmZzZXQudG9wICsgdmVydGljYWxPZmZzZXQ7XG4gICAgICAgIGNvbnN0IHRvcCA9IGRlc2lyZWRWZXJ0aWNhbENlbnRlciAtIHBhcnNlSW50KHRoaXMuX3ZpZXdwb3J0LmhlaWdodCAvIDIsIDEwKTtcblxuICAgICAgICBjb25zdCBkZXNpcmVkSG9yaXpvbnRhbENlbnRlciA9IHBhZ2VPZmZzZXQubGVmdCArIGhvcml6b250YWxPZmZzZXQ7XG4gICAgICAgIGNvbnN0IGxlZnQgPSBkZXNpcmVkSG9yaXpvbnRhbENlbnRlciAtIHBhcnNlSW50KHRoaXMuX3ZpZXdwb3J0LndpZHRoIC8gMiwgMTApO1xuXG4gICAgICAgIHRoaXMuX3ZpZXdwb3J0LnRvcCA9IHRvcDtcbiAgICAgICAgdGhpcy5fdmlld3BvcnQubGVmdCA9IGxlZnQ7XG5cbiAgICAgICAgdGhpcy5fcmVuZGVyKCk7XG4gICAgfVxuXG4gICAgdHJhbnNpdGlvblZpZXdwb3J0UG9zaXRpb24gKG9wdGlvbnMpXG4gICAge1xuICAgICAgICB0aGlzLl9jbGVhckFuaW1hdGlvbigpO1xuXG4gICAgICAgIGNvbnN0IGdldFBvc2l0aW9uID0gb3B0aW9ucy5nZXRQb3NpdGlvbjtcbiAgICAgICAgY29uc3Qgb25WaWV3RGlkVHJhbnNpdGlvbiA9IHRoaXMuX2hvb2tzLm9uVmlld0RpZFRyYW5zaXRpb247XG5cbiAgICAgICAgdGhpcy5fYW5pbWF0aW9uID0gSW50ZXJwb2xhdGVBbmltYXRpb24uYW5pbWF0ZSh7XG4gICAgICAgICAgICBkdXJhdGlvbjogb3B0aW9ucy5kdXJhdGlvbixcbiAgICAgICAgICAgIHBhcmFtZXRlcnM6IG9wdGlvbnMucGFyYW1ldGVycyxcbiAgICAgICAgICAgIG9uVXBkYXRlOiAodmFsdWVzKSA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IERvIGltYWdlIHByZWxvYWRpbmcsIHdvcmsgd2l0aCB0aGF0XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0Vmlld3BvcnRQb3NpdGlvbihnZXRQb3NpdGlvbih2YWx1ZXMpKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9ob29rcy5vblpvb21MZXZlbFdpbGxDaGFuZ2UodmFsdWVzLnpvb21MZXZlbCk7XG5cbiAgICAgICAgICAgICAgICBpZiAob25WaWV3RGlkVHJhbnNpdGlvbilcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG9uVmlld0RpZFRyYW5zaXRpb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25FbmQ6IChpbmZvKSA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm9uRW5kKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5vbkVuZChpbmZvKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faG9va3Mub25WaWV3RGlkVXBkYXRlICYmICFpbmZvLmludGVycnVwdGVkKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faG9va3Mub25WaWV3RGlkVXBkYXRlKHRoaXMuX3JlbmRlcmVkUGFnZXMuc2xpY2UoKSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfY2xlYXJBbmltYXRpb24gKClcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9hbmltYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2FuaW1hdGlvbi5jYW5jZWwoKTtcbiAgICAgICAgICAgIHRoaXMuX2FuaW1hdGlvbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcmVsb2FkICgpXG4gICAge1xuICAgICAgICAvLyBUT0RPXG4gICAgfVxuXG4gICAgaXNQYWdlVmlzaWJsZSAocGFnZUluZGV4KVxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLmxheW91dClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGFnZSA9IHRoaXMubGF5b3V0LmdldFBhZ2VJbmZvKHBhZ2VJbmRleCk7XG5cbiAgICAgICAgaWYgKCFwYWdlKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5fdmlld3BvcnQuaW50ZXJzZWN0c1JlZ2lvbih0aGlzLmxheW91dC5nZXRQYWdlUmVnaW9uKHBhZ2VJbmRleCkpO1xuICAgIH1cblxuICAgIGdldFJlbmRlcmVkUGFnZXMgKClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZW5kZXJlZFBhZ2VzLnNsaWNlKCk7XG4gICAgfVxuXG4gICAgZGVzdHJveSAoKVxuICAgIHtcbiAgICAgICAgdGhpcy5fY2xlYXJBbmltYXRpb24oKTtcblxuICAgICAgICAvLyBGSVhNRSh3YWJhaW4pOiBJIGRvbid0IGtub3cgaWYgd2Ugc2hvdWxkIGFjdHVhbGx5IGRvIHRoaXNcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5fcGVuZGluZ1JlcXVlc3RzKS5mb3JFYWNoKChyZXEpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZXIgPSB0aGlzLl9wZW5kaW5nUmVxdWVzdHNbcmVxXTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9wZW5kaW5nUmVxdWVzdHNbcmVxXTtcblxuICAgICAgICAgICAgaGFuZGxlci5hYm9ydCgpO1xuICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICB0aGlzLl9jYW52YXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLl9jYW52YXMpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0U2NhbGVkVGlsZVJlY29yZCAoc291cmNlLCBzY2FsZUZhY3RvcilcbntcbiAgICBsZXQgc2NhbGVSYXRpbztcblxuICAgIGlmIChzY2FsZUZhY3RvciA9PT0gbnVsbClcbiAgICB7XG4gICAgICAgIHNjYWxlUmF0aW8gPSAxO1xuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgICBzY2FsZVJhdGlvID0gTWF0aC5wb3coMiwgc2NhbGVGYWN0b3IgLSBzb3VyY2Uuem9vbUxldmVsKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBzb3VyY2Vab29tTGV2ZWw6IHNvdXJjZS56b29tTGV2ZWwsXG4gICAgICAgIHNjYWxlUmF0aW86IHNjYWxlUmF0aW8sXG4gICAgICAgIHJvdzogc291cmNlLnJvdyxcbiAgICAgICAgY29sOiBzb3VyY2UuY29sLFxuICAgICAgICBkaW1lbnNpb25zOiB7XG4gICAgICAgICAgICB3aWR0aDogc291cmNlLmRpbWVuc2lvbnMud2lkdGggKiBzY2FsZVJhdGlvLFxuICAgICAgICAgICAgaGVpZ2h0OiBzb3VyY2UuZGltZW5zaW9ucy5oZWlnaHQgKiBzY2FsZVJhdGlvXG4gICAgICAgIH0sXG4gICAgICAgIG9mZnNldDoge1xuICAgICAgICAgICAgbGVmdDogc291cmNlLm9mZnNldC5sZWZ0ICogc2NhbGVSYXRpbyxcbiAgICAgICAgICAgIHRvcDogc291cmNlLm9mZnNldC50b3AgKiBzY2FsZVJhdGlvXG4gICAgICAgIH0sXG4gICAgICAgIHVybDogc291cmNlLnVybFxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGZpbmRDaGFuZ2VzIChvbGRBcnJheSwgbmV3QXJyYXkpXG57XG4gICAgaWYgKG9sZEFycmF5ID09PSBuZXdBcnJheSlcbiAgICB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhZGRlZDogW10sXG4gICAgICAgICAgICByZW1vdmVkOiBbXVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHJlbW92ZWQgPSBvbGRBcnJheS5maWx0ZXIob2xkRW50cnkgPT4gbmV3QXJyYXkuaW5kZXhPZihvbGRFbnRyeSkgPT09IC0xKTtcblxuICAgIGNvbnN0IGFkZGVkID0gbmV3QXJyYXkuZmlsdGVyKG5ld0VudHJ5ID0+IG9sZEFycmF5LmluZGV4T2YobmV3RW50cnkpID09PSAtMSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBhZGRlZDogYWRkZWQsXG4gICAgICAgIHJlbW92ZWQ6IHJlbW92ZWRcbiAgICB9O1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./source/js/renderer.js\n");

/***/ }),

/***/ "./source/js/settings-view.js":
/*!************************************!*\
  !*** ./source/js/settings-view.js ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return createSettingsView; });\n\nfunction createSettingsView(sources)\n{\n    const obj = {};\n\n    sources.forEach( (source) =>\n    {\n        registerMixin(obj, source);\n    });\n\n    return obj;\n}\n\nfunction registerMixin(obj, mixin)\n{\n    Object.keys(mixin).forEach( (key) =>\n    {\n        Object.defineProperty(obj, key, {\n            get: () =>\n            {\n                return mixin[key];\n            },\n            set: () =>\n            {\n                // TODO: Make everything strict mode so this isn't needed\n                throw new TypeError('Cannot set settings.' + key);\n            }\n        });\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvc2V0dGluZ3Mtdmlldy5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9qcy9zZXR0aW5ncy12aWV3LmpzPzRjM2IiXSwic291cmNlc0NvbnRlbnQiOlsiXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjcmVhdGVTZXR0aW5nc1ZpZXcoc291cmNlcylcbntcbiAgICBjb25zdCBvYmogPSB7fTtcblxuICAgIHNvdXJjZXMuZm9yRWFjaCggKHNvdXJjZSkgPT5cbiAgICB7XG4gICAgICAgIHJlZ2lzdGVyTWl4aW4ob2JqLCBzb3VyY2UpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIG9iajtcbn1cblxuZnVuY3Rpb24gcmVnaXN0ZXJNaXhpbihvYmosIG1peGluKVxue1xuICAgIE9iamVjdC5rZXlzKG1peGluKS5mb3JFYWNoKCAoa2V5KSA9PlxuICAgIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICAgICAgICBnZXQ6ICgpID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1peGluW2tleV07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiAoKSA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IE1ha2UgZXZlcnl0aGluZyBzdHJpY3QgbW9kZSBzbyB0aGlzIGlzbid0IG5lZWRlZFxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBzZXQgc2V0dGluZ3MuJyArIGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/settings-view.js\n");

/***/ }),

/***/ "./source/js/tile-coverage-map.js":
/*!****************************************!*\
  !*** ./source/js/tile-coverage-map.js ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return TileCoverageMap; });\nclass TileCoverageMap\n{\n    constructor (rows, cols)\n    {\n        this._rows = rows;\n        this._cols = cols;\n        this._map = new Array(rows).fill(null).map(() => new Array(cols).fill(false));\n    }\n\n    isLoaded (row, col)\n    {\n        // Return true for out of bounds tiles because they\n        // don't need to load. (Unfortunately this will also\n        // mask logical errors.)\n        if (row >= this._rows || col >= this._cols)\n            return true;\n\n        return this._map[row][col];\n    }\n\n    set(row, col, value)\n    {\n        this._map[row][col] = value;\n    }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdGlsZS1jb3ZlcmFnZS1tYXAuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvdGlsZS1jb3ZlcmFnZS1tYXAuanM/M2U5ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBUaWxlQ292ZXJhZ2VNYXBcbntcbiAgICBjb25zdHJ1Y3RvciAocm93cywgY29scylcbiAgICB7XG4gICAgICAgIHRoaXMuX3Jvd3MgPSByb3dzO1xuICAgICAgICB0aGlzLl9jb2xzID0gY29scztcbiAgICAgICAgdGhpcy5fbWFwID0gbmV3IEFycmF5KHJvd3MpLmZpbGwobnVsbCkubWFwKCgpID0+IG5ldyBBcnJheShjb2xzKS5maWxsKGZhbHNlKSk7XG4gICAgfVxuXG4gICAgaXNMb2FkZWQgKHJvdywgY29sKVxuICAgIHtcbiAgICAgICAgLy8gUmV0dXJuIHRydWUgZm9yIG91dCBvZiBib3VuZHMgdGlsZXMgYmVjYXVzZSB0aGV5XG4gICAgICAgIC8vIGRvbid0IG5lZWQgdG8gbG9hZC4gKFVuZm9ydHVuYXRlbHkgdGhpcyB3aWxsIGFsc29cbiAgICAgICAgLy8gbWFzayBsb2dpY2FsIGVycm9ycy4pXG4gICAgICAgIGlmIChyb3cgPj0gdGhpcy5fcm93cyB8fCBjb2wgPj0gdGhpcy5fY29scylcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgIHJldHVybiB0aGlzLl9tYXBbcm93XVtjb2xdO1xuICAgIH1cblxuICAgIHNldChyb3csIGNvbCwgdmFsdWUpXG4gICAge1xuICAgICAgICB0aGlzLl9tYXBbcm93XVtjb2xdID0gdmFsdWU7XG4gICAgfVxufSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./source/js/tile-coverage-map.js\n");

/***/ }),

/***/ "./source/js/toolbar.js":
/*!******************************!*\
  !*** ./source/js/toolbar.js ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Toolbar; });\n/* harmony import */ var _diva_global__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./diva-global */ \"./source/js/diva-global.js\");\n/* harmony import */ var _utils_elt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/elt */ \"./source/js/utils/elt.js\");\n\n\n\nclass Toolbar\n{\n    constructor (viewer)\n    {\n        this.viewer = viewer;\n        this.settings = viewer.settings;\n    }\n\n    _elemAttrs (ident, base)\n    {\n        const attrs = {\n            id: this.settings.ID + ident,\n            class: 'diva-' + ident\n        };\n\n        if (base)\n            return Object.assign(attrs, base);\n        else\n            return attrs;\n    }\n\n\n    /** Convenience function to subscribe to a Diva event */\n    _subscribe (event, callback)\n    {\n        _diva_global__WEBPACK_IMPORTED_MODULE_0__[\"default\"].Events.subscribe(event, callback, this.settings.ID);\n    }\n\n\n    createButton (name, label, callback, icon)\n    {\n        const button = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('button', {\n            type: 'button',\n            id: this.settings.ID + name,\n            class: 'diva-' + name + ' diva-button',\n            title: label\n        });\n\n        if (icon)\n            button.appendChild(icon);\n\n        if (callback)\n            button.addEventListener('click', callback);\n\n        return button;\n    }\n\n    createLabel (name, id, label, innerName, innerValue)\n    {\n        return Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('div', { id: this.settings.ID + id, class: name + ' diva-label'},\n                    [ label, Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('span', { id: this.settings.ID + innerName }, innerValue)\n                    ]);\n    }\n\n    createZoomButtons ()\n    {\n        let zoomOutIcon = this._createZoomOutIcon();\n        let zoomInIcon = this._createZoomInIcon();\n\n        let zoomButtons = [\n            this.createButton('zoom-out-button', 'Zoom Out', () => {\n                this.viewer.setZoomLevel(this.settings.zoomLevel - 1);\n            }, zoomOutIcon),\n            this.createButton('zoom-in-button', 'Zoom In', () => {\n                this.viewer.setZoomLevel(this.settings.zoomLevel + 1);\n            }, zoomInIcon),\n            this.createLabel('diva-zoom-label', 'zoom-label', 'Zoom level: ', 'zoom-level', this.settings.zoomLevel + 1)\n        ];\n\n        let zoomHandler = function ()\n        {\n            let labelEl = document.getElementById(this.settings.ID + 'zoom-level');\n            labelEl.textContent = this.settings.zoomLevel + 1;\n        };\n\n        this._subscribe('ZoomLevelDidChange', zoomHandler);\n        this._subscribe('ViewerDidLoad', zoomHandler);\n\n        return Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('div', { id: this.settings.ID + \"zoom-controls\", style: \"display: none\"}, zoomButtons);\n    }\n\n    createGridControls ()\n    {\n        let gridMoreIcon = this._createGridMoreIcon();\n        let gridFewerIcon = this._createGridFewerIcon();\n\n        let gridButtons = [\n            this.createButton('grid-out-button', 'Fewer', () => {\n                this.viewer.setGridPagesPerRow(this.settings.pagesPerRow - 1);\n            }, gridFewerIcon),\n            this.createButton('grid-in-button', 'More', () => {\n                this.viewer.setGridPagesPerRow(this.settings.pagesPerRow + 1);\n            }, gridMoreIcon),\n            this.createLabel('diva-grid-label', 'grid-label', 'Pages per row: ', 'pages-per-row', this.settings.pagesPerRow)\n        ];\n\n        let gridChangeHandler = function ()\n        {\n            let labelEl = document.getElementById(this.settings.ID + 'pages-per-row');\n            labelEl.textContent = this.settings.pagesPerRow;\n        };\n\n        this._subscribe('GridRowNumberDidChange', gridChangeHandler);\n\n        return Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('div', {id: this.settings.ID + \"grid-controls\", style: \"display:none\" }, gridButtons);\n    }\n\n    createPageLabel ()\n    {\n        // Current page\n        const currentPage = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('span', {\n            id: this.settings.ID + 'current-page'\n        });\n\n        const updateCurrentPage = () => \n        {\n            // get labels for index range\n            let indices = this.viewer.getCurrentPageIndices();\n            let startIndex = indices[0];\n            let endIndex = indices[indices.length - 1];\n            let startLabel = this.settings.manifest.pages[startIndex].l;\n            let endLabel = this.settings.manifest.pages[endIndex].l;\n\n            if (startIndex !== endIndex) \n            {\n            \tif (this.settings.enableIndexAsLabel)\n                \tcurrentPage.textContent = startIndex + \" - \" + endIndex;\n            \telse\n            \t\tcurrentPage.textContent = startLabel + \" - \" + endLabel;\n            }\n            else\n        \t{\n            \tif (this.settings.enableIndexAsLabel)\n            \t\tcurrentPage.textContent = startIndex;\n            \telse\n            \t\tcurrentPage.textContent = startLabel;\n        \t}\n        };\n\n        this._subscribe('VisiblePageDidChange', updateCurrentPage);\n        this._subscribe('ViewerDidLoad', updateCurrentPage);\n        this._subscribe('ViewDidSwitch', updateCurrentPage);\n\n        return Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('span', {\n                class: 'diva-page-label diva-label'\n            },\n            currentPage\n        );\n    }\n\n    createGotoPageForm ()  \n    {\n        const gotoPageInput = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('input', {\n            id: this.settings.ID + 'goto-page-input',\n            class: 'diva-input diva-goto-page-input',\n            autocomplete: 'off',\n            type: 'text'\n        });\n\n        const gotoPageSubmit = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('input', {\n            id: this.settings.ID + 'goto-page-submit',\n            class: 'diva-button diva-button-text',\n            type: 'submit',\n            value: 'Go'\n        });\n\n        const inputSuggestions = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('div', {\n                id: this.settings.ID + 'input-suggestions',\n                class: 'diva-input-suggestions'\n            }\n        );\n\n        const gotoForm = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('form', {\n                id: this.settings.ID + 'goto-page',\n                class: 'diva-goto-form'\n            },\n            gotoPageInput,\n            gotoPageSubmit,\n            inputSuggestions\n        );\n\n        gotoForm.addEventListener('submit', (e) => \n        {\n            e.preventDefault();\n\n            const desiredPageLabel = gotoPageInput.value;\n\n            if (this.settings.onGotoSubmit && typeof this.settings.onGotoSubmit === \"function\")\n            {\n                const pageIndex = this.settings.onGotoSubmit(desiredPageLabel);\n                if (!this.viewer.gotoPageByIndex(pageIndex))\n                    window.alert(\"No page could be found with that label or page number\");\n\n            }\n            else // Default if no function is specified in the settings\n            {\n                if (!this.viewer.gotoPageByLabel(desiredPageLabel))\n                    window.alert(\"No page could be found with that label or page number\");\n            }\n\n            // Hide the suggestions\n            inputSuggestions.style.display = 'none';\n\n            // Prevent the default action of reloading the page\n            return false;\n        });\n\n        ['input', 'focus'].forEach(event => \n        {\n            gotoPageInput.addEventListener(event, () => {\n                inputSuggestions.innerHTML = ''; // Remove all previous suggestions\n\n                const value = gotoPageInput.value;\n                let numSuggestions = 0;\n                if (this.settings.enableGotoSuggestions && value)\n                {\n                    const pages = this.settings.manifest.pages;\n                    for (let i = 0, len = pages.length; i < len && numSuggestions < 10; i++)\n                    {\n                        if (pages[i].l.toLowerCase().indexOf(value.toLowerCase()) > -1)\n                        {\n                            const newInputSuggestion = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('div', {\n                                    class: 'diva-input-suggestion'\n                                },\n                                pages[i].l\n                            );\n\n                            inputSuggestions.appendChild(newInputSuggestion);\n\n                            numSuggestions++;\n                        }\n                    }\n\n                    // Show label suggestions\n                    if (numSuggestions > 0)\n                        inputSuggestions.style.display = 'block';\n                }\n                else\n                    inputSuggestions.style.display = 'none';\n            });\n        });\n\n        gotoPageInput.addEventListener('keydown', e => {\n            let el;\n            if (e.keyCode === 13) // 'Enter' key\n            {\n                const active = document.getElementsByClassName('active')[0];\n                if (typeof active !== 'undefined')\n                    gotoPageInput.value = active.innerText;\n            }\n            if (e.keyCode === 38) // Up arrow key\n            {\n                el = document.getElementsByClassName('active')[0];\n                const prevEl = el ? el.previousSibling : undefined;\n                if (typeof prevEl !== 'undefined')\n                {\n                    el.classList.remove('active');\n                    if (prevEl !== null)\n                        prevEl.classList.add('active');\n                }\n                else\n                {\n                    let last = document.getElementsByClassName('diva-input-suggestion').length - 1;\n                    document.getElementsByClassName('diva-input-suggestion')[last].classList.add('active');\n                }\n            }\n            else if (e.keyCode === 40) // Down arrow key\n            {\n                el = document.getElementsByClassName('active')[0];\n                const nextEl = el ? el.nextSibling : undefined;\n                if (typeof nextEl !== 'undefined')\n                {\n                    el.classList.remove('active');\n                    if (nextEl !== null)\n                        nextEl.classList.add('active');\n                }\n                else\n                {\n                    document.getElementsByClassName('diva-input-suggestion')[0].classList.add('active');\n                }\n            }\n        });\n\n        onEvent(inputSuggestions, 'mousedown', '.diva-input-suggestion', function ()\n        {\n            gotoPageInput.value = this.textContent;\n            inputSuggestions.style.display = 'none';\n\n            let submitEvent = new Event('submit');\n            gotoForm.dispatchEvent(submitEvent);\n        });\n\n        // javascript equivalent to jquery .on(event, selector, function)\n        function onEvent (elem, evt, sel, handler) \n        {\n            elem.addEventListener(evt, function (event) \n            {\n                var t = event.target;\n                while (t && t !== this) \n                {\n                    if (t.matches(sel)) \n                        handler.call(t, event);\n                    t = t.parentNode;\n                }\n            });\n        }\n\n        gotoPageInput.addEventListener('blur', () => {\n            // Hide label suggestions\n            inputSuggestions.style.display = 'none';\n        });\n\n        return gotoForm;\n    }\n\n    createViewMenu ()\n    {\n        const viewOptionsList = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('div', this._elemAttrs('view-options'));\n        const gridViewIcon = this._createGridViewIcon();\n        const bookViewIcon = this._createBookViewIcon();\n        const pageViewIcon = this._createPageViewIcon();\n\n        const viewOptionsToggle = () =>\n        {\n            viewOptionsList.style.display = viewOptionsList.style.display === \"none\" ? \"block\" : \"none\";\n        };\n\n        const changeViewButton = this.createButton('view-icon', 'Change view', viewOptionsToggle);\n\n        const selectView = (view) =>\n        {\n            this.viewer.changeView(view);\n\n            //hide view menu\n            viewOptionsList.style.display = \"none\";\n        };\n\n        const updateViewMenu = () =>\n        {\n            const viewIconClasses = ' diva-view-icon diva-button';\n\n\n            // display the icon of the mode we're currently in (?)\n            if (this.settings.inGrid)\n            {\n                changeViewButton.appendChild(gridViewIcon);\n                changeViewButton.className = 'diva-grid-icon' + viewIconClasses;\n            }\n            else if (this.settings.inBookLayout)\n            {\n                changeViewButton.appendChild(bookViewIcon);\n                changeViewButton.className = 'diva-book-icon' + viewIconClasses;\n            }\n            else\n            {\n                changeViewButton.appendChild(pageViewIcon);\n                changeViewButton.className = 'diva-document-icon' + viewIconClasses;\n            }\n\n            const viewOptions = document.createDocumentFragment();\n\n            // then display document, book, and grid buttons in that order, excluding the current view\n            if (this.settings.inGrid || this.settings.inBookLayout)\n                viewOptions.appendChild(this.createButton('document-icon', 'Document View', selectView.bind(null, 'document'), pageViewIcon));\n\n            if (this.settings.inGrid || !this.settings.inBookLayout)\n                viewOptions.appendChild(this.createButton('book-icon', 'Book View', selectView.bind(null, 'book'), bookViewIcon));\n\n            if (!this.settings.inGrid)\n                viewOptions.appendChild(this.createButton('grid-icon', 'Grid View', selectView.bind(null, 'grid'), gridViewIcon));\n\n            // remove old menu\n            while (viewOptionsList.firstChild)\n            {\n                viewOptionsList.removeChild(viewOptionsList.firstChild);\n            }\n\n            // insert new menu\n            viewOptionsList.appendChild(viewOptions);\n        };\n\n        document.addEventListener('mouseup', event =>\n        {\n            if (viewOptionsList !== event.target)\n            {\n                viewOptionsList.style.display = 'none';\n            }\n        });\n\n        this._subscribe('ViewDidSwitch', updateViewMenu);\n        this._subscribe('ObjectDidLoad', updateViewMenu);\n\n        return Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('div', this._elemAttrs('view-menu'),\n            changeViewButton,\n            viewOptionsList\n        );\n    }\n\n    createFullscreenButton ()\n    {\n        let fullscreenIcon = this._createFullscreenIcon();\n\n        return this.createButton('fullscreen-icon', 'Toggle fullscreen mode', () => {\n            this.viewer.toggleFullscreenMode();\n        }, fullscreenIcon);\n    }\n\n    toggleZoomGridControls ()\n    {\n        if (!this.settings.inGrid)\n        {\n            document.getElementById(this.settings.ID + \"zoom-controls\").style.display = \"block\";\n            document.getElementById(this.settings.ID + \"grid-controls\").style.display = \"none\";\n        }\n        else\n        {\n            document.getElementById(this.settings.ID + \"zoom-controls\").style.display = \"none\";\n            document.getElementById(this.settings.ID + \"grid-controls\").style.display = \"block\";\n        }\n\n    }\n\n    render ()\n    {\n        this._subscribe(\"ViewDidSwitch\", this.toggleZoomGridControls);\n        this._subscribe(\"ObjectDidLoad\", this.toggleZoomGridControls);\n\n        let leftTools = [\n            this.createZoomButtons(),\n            this.createGridControls()\n        ];\n        let rightTools = [\n            this.createPageLabel(),\n            this.createViewMenu()\n        ];\n        if (this.settings.enableFullscreen)\n            rightTools.push(this.createFullscreenButton());\n        if (this.settings.enableGotoPage)\n            rightTools.splice(1, 0, this.createGotoPageForm());\n\n        // assign toolbar plugins to proper side\n        let plugins = this.viewer.viewerState.pluginInstances;\n        for (var i = 0, len = plugins.length; i < len; i++) \n        {\n            let plugin = plugins[i];\n\n            if (!plugin.toolbarSide) // not a toolbar tool\n                continue;\n\n            plugin.toolbarIcon = plugin.createIcon(); \n            if (!plugin.toolbarIcon) // icon couldn't be created\n                continue;\n\n            // add plugin tools after the go-to-page and page-label tools\n            if (plugin.toolbarSide === 'right') \n                rightTools.splice(2, 0, plugin.toolbarIcon);\n            else if (plugin.toolbarSide === 'left') \n                leftTools.splice(2, 0, plugin.toolbarIcon);\n\n            plugin.toolbarIcon.addEventListener('click', handlePluginClick.bind(this, plugin));\n        }\n\n        function handlePluginClick (plugin) \n        {\n            plugin.handleClick(this.viewer);\n        }\n\n        const tools = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('div', this._elemAttrs('tools'),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('div', this._elemAttrs('tools-left'), leftTools),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_1__[\"elt\"])('div', this._elemAttrs('tools-right'), rightTools)\n                );\n\n        this.settings.toolbarParentObject.insertBefore(\n            tools,\n            this.settings.toolbarParentObject.firstChild\n        );\n    }\n\n    _createToolbarIcon (paths)\n    {\n        let icon = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n        icon.setAttributeNS(null, 'viewBox', \"0 0 25 25\");\n        icon.setAttributeNS(null, 'x', '0px');\n        icon.setAttributeNS(null, 'y', '0px');\n        icon.setAttributeNS(null, 'style', \"enable-background:new 0 0 48 48;\");\n\n        let glyph = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n        glyph.setAttributeNS(null, \"transform\", \"matrix(1, 0, 0, 1, -12, -12)\");\n\n        paths.forEach( (path) =>\n        {\n            let pEl = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n            pEl.setAttributeNS(null, \"d\", path);\n            glyph.appendChild(pEl);\n        });\n\n        icon.appendChild(glyph);\n        return icon;\n    }\n\n    _createZoomOutIcon ()\n    {\n        let paths = [\n            \"M19.5,23c-0.275,0-0.5-0.225-0.5-0.5v-1c0-0.275,0.225-0.5,0.5-0.5h7c0.275,0,0.5,0.225,0.5,0.5v1c0,0.275-0.225,0.5-0.5,0.5H19.5z\",\n            \"M37.219,34.257l-2.213,2.212c-0.202,0.202-0.534,0.202-0.736,0l-6.098-6.099c-1.537,0.993-3.362,1.577-5.323,1.577c-5.431,0-9.849-4.418-9.849-9.849c0-5.431,4.418-9.849,9.849-9.849c5.431,0,9.849,4.418,9.849,9.849c0,1.961-0.584,3.786-1.576,5.323l6.098,6.098C37.422,33.722,37.422,34.054,37.219,34.257z M29.568,22.099c0-3.706-3.014-6.72-6.72-6.72c-3.706,0-6.72,3.014-6.72,6.72c0,3.706,3.014,6.72,6.72,6.72C26.555,28.818,29.568,25.805,29.568,22.099z\"\n        ];\n\n        return this._createToolbarIcon(paths);\n    }\n\n    _createZoomInIcon ()\n    {\n        let paths = [\n            \"M37.469,34.257l-2.213,2.212c-0.202,0.202-0.534,0.202-0.736,0l-6.098-6.099c-1.537,0.993-3.362,1.577-5.323,1.577c-5.431,0-9.849-4.418-9.849-9.849c0-5.431,4.418-9.849,9.849-9.849c5.431,0,9.849,4.418,9.849,9.849c0,1.961-0.584,3.786-1.576,5.323l6.098,6.098C37.672,33.722,37.672,34.054,37.469,34.257z M29.818,22.099c0-3.706-3.014-6.72-6.72-6.72c-3.706,0-6.72,3.014-6.72,6.72c0,3.706,3.014,6.72,6.72,6.72C26.805,28.818,29.818,25.805,29.818,22.099z M26.5,21H24v-2.5c0-0.275-0.225-0.5-0.5-0.5h-1c-0.275,0-0.5,0.225-0.5,0.5V21h-2.5c-0.275,0-0.5,0.225-0.5,0.5v1c0,0.275,0.225,0.5,0.5,0.5H22v2.5c0,0.275,0.225,0.5,0.5,0.5h1c0.275,0,0.5-0.225,0.5-0.5V23h2.5c0.275,0,0.5-0.225,0.5-0.5v-1C27,21.225,26.775,21,26.5,21z\"\n        ];\n        return this._createToolbarIcon(paths);\n    }\n\n    _createGridMoreIcon ()\n    {\n        let paths = [\n            \"M29.5,35c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H29.5z M21.5,35c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H21.5z M13.5,35c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H13.5z M29.5,27c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H29.5z M21.5,27c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H21.5z M13.5,27c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H13.5z M29.5,19c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H29.5z M21.5,19c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H21.5z M13.5,19c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H13.5z\"\n        ];\n        return this._createToolbarIcon(paths);\n    }\n\n    _createGridFewerIcon ()\n    {\n        let paths = [\n            \"M25.5,35c-0.275,0-0.5-0.225-0.5-0.5v-9c0-0.275,0.225-0.5,0.5-0.5h9c0.275,0,0.5,0.225,0.5,0.5v9c0,0.275-0.225,0.5-0.5,0.5H25.5z M22.5,35c0.275,0,0.5-0.225,0.5-0.5v-9c0-0.275-0.225-0.5-0.5-0.5h-9c-0.275,0-0.5,0.225-0.5,0.5v9c0,0.275,0.225,0.5,0.5,0.5H22.5z M34.5,23c0.275,0,0.5-0.225,0.5-0.5v-9c0-0.275-0.225-0.5-0.5-0.5h-9c-0.275,0-0.5,0.225-0.5,0.5v9c0,0.275,0.225,0.5,0.5,0.5H34.5z M22.5,23c0.275,0,0.5-0.225,0.5-0.5v-9c0-0.275-0.225-0.5-0.5-0.5h-9c-0.275,0-0.5,0.225-0.5,0.5v9c0,0.275,0.225,0.5,0.5,0.5H22.5z\"\n        ];\n        return this._createToolbarIcon(paths);\n    }\n\n    _createGridViewIcon ()\n    {\n        let paths = [\n            \"M29.5,35c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H29.5z M21.5,35c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H21.5z M13.5,35c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H13.5z M29.5,27c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H29.5z M21.5,27c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H21.5z M13.5,27c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H13.5z M29.5,19c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H29.5z M21.5,19c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H21.5z M13.5,19c-0.275,0-0.5-0.225-0.5-0.5v-5c0-0.275,0.225-0.5,0.5-0.5h5c0.275,0,0.5,0.225,0.5,0.5v5c0,0.275-0.225,0.5-0.5,0.5H13.5z\"\n        ];\n        return this._createToolbarIcon(paths);\n    }\n\n    _createBookViewIcon ()\n    {\n        let paths = [\n            \"M35,16.8v-1.323c0,0-2.292-1.328-5.74-1.328c-3.448,0-5.26,1.25-5.26,1.25s-1.813-1.25-5.26-1.25c-3.448,0-5.74,1.328-5.74,1.328V16.8l-1,0.531v0.021v15.687c0,0,4.531-1.578,6.999-1.578c2.468,0,5.001,0.885,5.001,0.885s2.532-0.885,5-0.885c0.306,0,0.643,0.024,1,0.066v4.325l1.531-2.016L33,35.852v-3.72c2,0.43,3,0.906,3,0.906V17.352v-0.021L35,16.8z M23,29.03c-1-0.292-2.584-0.679-3.981-0.679c-2.246,0-3.019,0.404-4.019,0.699V16.634c0,0,1.125-0.699,4.019-0.699c1.694,0,2.981,0.417,3.981,1.126V29.03z M33,29.051c-1-0.295-1.773-0.699-4.02-0.699c-1.396,0-2.981,0.387-3.98,0.679V17.06c1-0.709,2.286-1.126,3.98-1.126c2.895,0,4.02,0.699,4.02,0.699V29.051z\"\n        ];\n        return this._createToolbarIcon(paths);\n    }\n\n    _createPageViewIcon ()\n    {\n        let paths = [\n            \"M29.425,29h4.47L29,33.934v-4.47C29,29.19,29.151,29,29.425,29z M34,14.563V28h-5.569C28.157,28,28,28.196,28,28.47V34H14.497C14.223,34,14,33.71,14,33.437V14.563C14,14.29,14.223,14,14.497,14h18.9C33.672,14,34,14.29,34,14.563z M25.497,26.497C25.497,26.223,25.275,26,25,26h-7c-0.275,0-0.497,0.223-0.497,0.497v1.006C17.503,27.777,17.725,28,18,28h7c0.275,0,0.497-0.223,0.497-0.497V26.497z M30.497,22.497C30.497,22.223,30.275,22,30,22H18c-0.275,0-0.497,0.223-0.497,0.497v1.006C17.503,23.777,17.725,24,18,24h12c0.275,0,0.497-0.223,0.497-0.497V22.497z M30.497,18.497C30.497,18.223,30.275,18,30,18H18c-0.275,0-0.497,0.223-0.497,0.497v1.006C17.503,19.777,17.725,20,18,20h12c0.275,0,0.497-0.223,0.497-0.497V18.497z\"\n        ];\n\n        return this._createToolbarIcon(paths);\n    }\n\n    _createFullscreenIcon ()\n    {\n        let paths = [\n            \"M35,12H13c-0.55,0-1,0.45-1,1v22c0,0.55,0.45,1,1,1h22c0.55,0,1-0.45,1-1V13C36,12.45,35.55,12,35,12z M34,34H14V14h20V34z\",\n            \"M17,21.75v-4.5c0-0.138,0.112-0.25,0.25-0.25h4.5c0.138,0,0.17,0.08,0.073,0.177l-1.616,1.616l1.823,1.823c0.097,0.097,0.097,0.256,0,0.354l-1.061,1.06c-0.097,0.097-0.256,0.097-0.354,0l-1.823-1.823l-1.616,1.616C17.08,21.92,17,21.888,17,21.75z M20.97,25.97c-0.097-0.097-0.256-0.097-0.354,0l-1.823,1.823l-1.616-1.616C17.08,26.08,17,26.112,17,26.25v4.5c0,0.138,0.112,0.25,0.25,0.25h4.5c0.138,0,0.17-0.08,0.073-0.177l-1.616-1.616l1.823-1.823c0.097-0.097,0.097-0.256,0-0.354L20.97,25.97z M30.75,17h-4.5c-0.138,0-0.17,0.08-0.073,0.177l1.616,1.616l-1.823,1.823c-0.097,0.097-0.097,0.256,0,0.354l1.061,1.06c0.097,0.097,0.256,0.097,0.354,0l1.823-1.823l1.616,1.616C30.92,21.92,31,21.888,31,21.75v-4.5C31,17.112,30.888,17,30.75,17z M30.823,26.177l-1.616,1.616l-1.823-1.823c-0.097-0.097-0.256-0.097-0.354,0l-1.061,1.06c-0.097,0.097-0.097,0.256,0,0.354l1.823,1.823l-1.616,1.616C26.08,30.92,26.112,31,26.25,31h4.5c0.138,0,0.25-0.112,0.25-0.25v-4.5C31,26.112,30.92,26.08,30.823,26.177z M26,22.5c0-0.275-0.225-0.5-0.5-0.5h-3c-0.275,0-0.5,0.225-0.5,0.5v3c0,0.275,0.225,0.5,0.5,0.5h3c0.275,0,0.5-0.225,0.5-0.5V22.5z\"\n        ];\n\n        return this._createToolbarIcon(paths);\n    }\n\n\n}\n\n\n// export default function createToolbar (viewer)\n// {\n//     const settings = viewer.getSettings();\n//\n//     // FIXME(wabain): Temporarily copied from within Diva\n//     const elemAttrs = (ident, base) => {\n//         const attrs = {\n//             id: settings.ID + ident,\n//             class: 'diva-' + ident\n//         };\n//\n//         if (base)\n//             return Object.assign(attrs, base);\n//         else\n//             return attrs;\n//     };\n//\n//     /** Convenience function to subscribe to a Diva event */\n//     const subscribe = (event, callback) => {\n//         diva.Events.subscribe(event, callback, settings.ID);\n//     };\n//\n//     // Creates a toolbar button\n//     const createButtonElement = (name, label, callback) => {\n//         const button = elt('button', {\n//             type: 'button',\n//             id: settings.ID + name,\n//             class: 'diva-' + name + ' diva-button',\n//             title: label\n//         });\n//\n//         if (callback)\n//             button.addEventListener('click', callback, false);\n//\n//         return button;\n//     };\n//\n//     // Higher-level function for creators of zoom and grid controls\n//     const getResolutionControlCreator = config => () => {\n//         let controls;\n//\n//         switch (settings[config.controllerSetting])\n//         {\n//             case 'slider':\n//                 controls = config.createSlider();\n//                 break;\n//\n//             case 'buttons':\n//                 controls = config.createButtons();\n//                 break;\n//\n//             default:\n//                 // Don't display anything\n//                 return null;\n//         }\n//\n//         const wrapper = elt('span',\n//             controls,\n//             config.createLabel()\n//         );\n//\n//         const updateWrapper = () => {\n//             if (settings.inGrid === config.showInGrid)\n//                 wrapper.style.display = 'inline';\n//             else\n//                 wrapper.style.display = 'none';\n//         };\n//\n//         subscribe('ViewDidSwitch', updateWrapper);\n//         subscribe('ObjectDidLoad', updateWrapper);\n//\n//         // Set initial value\n//         updateWrapper();\n//\n//         return wrapper;\n//     };\n//\n//     // Zoom controls\n//     const createZoomControls = getResolutionControlCreator({\n//         controllerSetting: 'enableZoomControls',\n//         showInGrid: false,\n//\n//         createSlider: function ()\n//         {\n//             const elem = createSlider('zoom-slider', {\n//                 step: 0.1,\n//                 value: settings.zoomLevel,\n//                 min: settings.minZoomLevel,\n//                 max: settings.maxZoomLevel\n//             });\n//\n//             elem.addEventListener('input', () =>\n//             {\n//                 const floatValue = parseFloat(this.value);\n//                 viewer.setZoomLevel(floatValue);\n//             });\n//\n//             elem.addEventListener('change', () =>\n//             {\n//                 const floatValue = parseFloat(this.value);\n//                 if (floatValue !== settings.zoomLevel)\n//                     viewer.setZoomLevel(floatValue);\n//             });\n//\n//             const updateSlider = () => {\n//                 if (settings.zoomLevel !== $elem.val())\n//                     $elem.val(settings.zoomLevel);\n//             };\n//\n//             subscribe('ZoomLevelDidChange', updateSlider);\n//             subscribe('ViewerDidLoad', () => {\n//                 elt.setAttributes(elem, {\n//                     min: settings.minZoomLevel,\n//                     max: settings.maxZoomLevel\n//                 });\n//\n//                 updateSlider();\n//             });\n//\n//             return elem;\n//         },\n//\n//         createButtons: function ()\n//         {\n//             return elt('span',\n//                 createButtonElement('zoom-out-button', 'Zoom Out', () => {\n//                     viewer.setZoomLevel(settings.zoomLevel - 1);\n//                 }),\n//                 createButtonElement('zoom-in-button', 'Zoom In', () => {\n//                     viewer.setZoomLevel(settings.zoomLevel + 1);\n//                 })\n//             );\n//         },\n//\n//         createLabel: function ()\n//         {\n//             const elem = createLabel('diva-zoom-label', 'zoom-label', 'Zoom level: ', 'zoom-level', settings.zoomLevel);\n//             const textSpan = $(elem).find(settings.selector + 'zoom-level')[0];\n//\n//             const updateText = () => {\n//                 textSpan.textContent = settings.zoomLevel.toFixed(2);\n//             };\n//\n//             subscribe('ZoomLevelDidChange', updateText);\n//             subscribe('ViewerDidLoad', updateText);\n//\n//             return elem;\n//         }\n//     });\n//\n//     // Grid controls\n//     const createGridControls = getResolutionControlCreator({\n//         controllerSetting: 'enableGridControls',\n//         showInGrid: true,\n//\n//         createSlider: function ()\n//         {\n//             const elem = createSlider('grid-slider', {\n//                 value: settings.pagesPerRow,\n//                 min: settings.minPagesPerRow,\n//                 max: settings.maxPagesPerRow\n//             });\n//\n//             elem.addEventListener('input', () => {\n//                 const intValue = parseInt(elem.value, 10);\n//                 viewer.setGridPagesPerRow(intValue);\n//             });\n//\n//             elem.addEventListener('change', () => {\n//                 const intValue = parseInt(elem.value, 10);\n//                 if (intValue !== settings.pagesPerRow)\n//                     viewer.setGridPagesPerRow(intValue);\n//             });\n//\n//             subscribe('GridRowNumberDidChange', () => {\n//                 // Update the position of the handle within the slider\n//                 if (settings.pagesPerRow !== $elem.val())\n//                     $elem.val(settings.pagesPerRow);\n//             });\n//\n//             return elem;\n//         },\n//\n//         createButtons: function ()\n//         {\n//             return elt('span',\n//                 createButtonElement('grid-out-button', 'Zoom Out', () => {\n//                     viewer.setGridPagesPerRow(settings.pagesPerRow - 1);\n//                 }),\n//                 createButtonElement('grid-in-button', 'Zoom In', () => {\n//                     viewer.setGridPagesPerRow(settings.pagesPerRow + 1);\n//                 })\n//             );\n//         },\n//\n//         createLabel: function ()\n//         {\n//             const elem = createLabel('diva-grid-label', 'grid-label', 'Pages per row: ', 'pages-per-row', settings.pagesPerRow);\n//             const textSpan = $(elem).find(settings.selector + 'pages-per-row')[0];\n//\n//             subscribe('GridRowNumberDidChange', () => {\n//                 textSpan.textContent = settings.pagesPerRow;\n//             });\n//\n//             return elem;\n//         }\n//     });\n//\n//     const createViewMenu = () => {\n//         const viewOptionsList = elt('div', elemAttrs('view-options'));\n//\n//         const changeViewButton = createButtonElement('view-icon', 'Change view', () => {\n//             $(viewOptionsList).toggle();\n//         });\n//\n//         document.addEventListener('mouseup', event => {\n//             const container = $(viewOptionsList);\n//\n//             if (!container.is(event.target) && container.has(event.target).length === 0 && event.target.id !== settings.ID + 'view-icon')\n//             {\n//                 container.hide();\n//             }\n//         });\n//\n//         const selectView = view => {\n//             viewer.changeView(view);\n//\n//             //hide view menu\n//             $(viewOptionsList).hide();\n//         };\n//\n//         const updateViewMenu = () => {\n//             const viewIconClasses = ' diva-view-icon diva-button';\n//\n//             // display the icon of the mode we're currently in (?)\n//             if (settings.inGrid)\n//             {\n//                 changeViewButton.className = 'diva-grid-icon' + viewIconClasses;\n//             }\n//             else if (settings.inBookLayout)\n//             {\n//                 changeViewButton.className = 'diva-book-icon' + viewIconClasses;\n//             }\n//             else\n//             {\n//                 changeViewButton.className = 'diva-document-icon' + viewIconClasses;\n//             }\n//\n//             const viewOptions = document.createDocumentFragment();\n//\n//             // then display document, book, and grid buttons in that order, excluding the current view\n//             if (settings.inGrid || settings.inBookLayout)\n//                 viewOptions.appendChild(createButtonElement('document-icon', 'Document View', selectView.bind(null, 'document')));\n//\n//             if (settings.inGrid || !settings.inBookLayout)\n//                 viewOptions.appendChild(createButtonElement('book-icon', 'Book View', selectView.bind(null, 'book')));\n//\n//             if (!settings.inGrid)\n//                 viewOptions.appendChild(createButtonElement('grid-icon', 'Grid View', selectView.bind(null, 'grid')));\n//\n//             // remove old menu\n//             while (viewOptionsList.firstChild)\n//             {\n//                 viewOptionsList.removeChild(viewOptionsList.firstChild);\n//             }\n//\n//             // insert new menu\n//             viewOptionsList.appendChild(viewOptions);\n//         };\n//\n//         subscribe('ViewDidSwitch', updateViewMenu);\n//         subscribe('ObjectDidLoad', updateViewMenu);\n//\n//         return elt('div', elemAttrs('view-menu'),\n//             changeViewButton,\n//             viewOptionsList\n//         );\n//     };\n//\n//     const createSlider = (name, options) => elt('input', options, {\n//         id: settings.ID + name,\n//         class: 'diva-' + name + ' diva-slider',\n//         type: 'range'\n//     });\n//\n//     const createLabel = (name, id, label, innerName, innerValue) => elt('div', {\n//             id: settings.ID + id,\n//             class: name + ' diva-label'\n//         },\n//         [\n//             label,\n//             elt('span', {\n//                 id: settings.ID + innerName\n//             }, innerValue)\n//         ]);\n//\n//     const createPageNavigationControls = () => {\n//         // Go to page form\n//         const gotoForm = settings.enableGotoPage ? createGotoPageForm() : null;\n//\n//         return elt('span', elemAttrs('page-nav'),\n//             createPageLabel(), // 'Page x of y' label\n//             gotoForm\n//         );\n//     };\n//\n//     const createGotoPageForm = () => {\n//         const gotoPageInput = elt('input', {\n//             id: settings.ID + 'goto-page-input',\n//             class: 'diva-input diva-goto-page-input',\n//             autocomplete: 'off',\n//             type: 'text'\n//         });\n//\n//         const gotoPageSubmit = elt('input', {\n//             id: settings.ID + 'goto-page-submit',\n//             class: 'diva-button diva-button-text',\n//             type: 'submit',\n//             value: 'Go'\n//         });\n//\n//         const inputSuggestions = elt('div', {\n//                 id: settings.ID + 'input-suggestions',\n//                 class: 'diva-input-suggestions'\n//             }\n//         );\n//\n//         const gotoForm = elt('form', {\n//                 id: settings.ID + 'goto-page',\n//                 class: 'diva-goto-form'\n//             },\n//             gotoPageInput,\n//             gotoPageSubmit,\n//             inputSuggestions\n//         );\n//\n//         $(gotoForm).on('submit', () => {\n//             const desiredPageLabel = gotoPageInput.value;\n//\n//             if (settings.onGotoSubmit && typeof settings.onGotoSubmit === \"function\")\n//             {\n//                 const pageIndex = settings.onGotoSubmit(desiredPageLabel);\n//                 if (!viewer.gotoPageByIndex(pageIndex))\n//                     alert(\"No page could be found with that label or page number\");\n//\n//             }\n//             else // Default if no function is specified in the settings\n//             {\n//                 if (!viewer.gotoPageByLabel(desiredPageLabel))\n//                     alert(\"No page could be found with that label or page number\");\n//             }\n//\n//             // Hide the suggestions\n//             inputSuggestions.style.display = 'none';\n//\n//             // Prevent the default action of reloading the page\n//             return false;\n//         });\n//\n//         $(gotoPageInput).on('input focus', () => {\n//             inputSuggestions.innerHTML = ''; // Remove all previous suggestions\n//\n//             const value = gotoPageInput.value;\n//             let numSuggestions = 0;\n//             if (settings.enableGotoSuggestions && value)\n//             {\n//                 const pages = settings.manifest.pages;\n//                 for (let i = 0, len = pages.length; i < len && numSuggestions < 10; i++)\n//                 {\n//                     if (pages[i].l.toLowerCase().indexOf(value.toLowerCase()) > -1)\n//                     {\n//                         const newInputSuggestion = elt('div', {\n//                                 class: 'diva-input-suggestion'\n//                             },\n//                             pages[i].l\n//                         );\n//\n//                         inputSuggestions.appendChild(newInputSuggestion);\n//\n//                         numSuggestions++;\n//                     }\n//                 }\n//\n//                 // Show label suggestions\n//                 if (numSuggestions > 0)\n//                     inputSuggestions.style.display = 'block';\n//             }\n//             else\n//                 inputSuggestions.style.display = 'none';\n//         });\n//\n//         $(gotoPageInput).on('keydown', e => {\n//             let el;\n//             if (e.keyCode === 13) // 'Enter' key\n//             {\n//                 const active = $('.active', inputSuggestions);\n//                 if (active.length)\n//                     gotoPageInput.value = active.text();\n//\n//             }\n//             if (e.keyCode === 38) // Up arrow key\n//             {\n//                 el = $('.active', inputSuggestions);\n//                 const prevEl = el.prev();\n//                 if (prevEl.length)\n//                 {\n//                     el.removeClass('active');\n//                     prevEl.addClass('active');\n//                 }\n//                 else\n//                 {\n//                     el.removeClass('active');\n//                     $('.diva-input-suggestion:last', inputSuggestions).addClass('active');\n//                 }\n//             }\n//             else if (e.keyCode === 40) // Down arrow key\n//             {\n//                 el = $('.active', inputSuggestions);\n//                 const nextEl = el.next();\n//                 if (nextEl.length)\n//                 {\n//                     el.removeClass('active');\n//                     nextEl.addClass('active');\n//                 }\n//                 else\n//                 {\n//                     el.removeClass('active');\n//                     $('.diva-input-suggestion:first', inputSuggestions).addClass('active');\n//                 }\n//             }\n//         });\n//\n//         $(inputSuggestions).on('mousedown', '.diva-input-suggestion', function()\n//         {\n//             gotoPageInput.value = this.textContent;\n//             inputSuggestions.style.display = 'none';\n//             $(gotoPageInput).trigger('submit');\n//         });\n//\n//         $(gotoPageInput).on('blur', () => {\n//             // Hide label suggestions\n//             inputSuggestions.style.display = 'none';\n//         });\n//\n//         return gotoForm;\n//     };\n//\n//     const createPageLabel = () => {\n//         // Current page\n//         const currentPage = elt('span', {\n//             id: settings.ID + 'current-page'\n//         });\n//\n//         const updateCurrentPage = () => {\n//             currentPage.textContent = viewer.getCurrentAliasedPageIndex();\n//         };\n//\n//         subscribe('VisiblePageDidChange', updateCurrentPage);\n//         subscribe('ViewerDidLoad', updateCurrentPage);\n//\n//         // Number of pages\n//         const numPages = elt('span', {\n//             id: settings.ID + 'num-pages'\n//         });\n//\n//         const updateNumPages = () => {\n//             numPages.textContent = settings.numPages;\n//         };\n//\n//         subscribe('NumberOfPagesDidChange', updateNumPages);\n//         subscribe('ObjectDidLoad', updateNumPages);\n//\n//         return elt('span', {\n//                 class: 'diva-page-label diva-label'\n//             },\n//             'Page ', currentPage, ' of ', numPages\n//         );\n//     };\n//\n//     const createToolbarButtonGroup = () => {\n//         const buttons = [createViewMenu()];\n//\n//         if (settings.enableLinkIcon)\n//             buttons.push(createLinkIcon());\n//\n//         if (settings.enableNonPagedVisibilityIcon)\n//             buttons.push(createToggleNonPagedButton());\n//\n//         if (settings.enableFullscreen)\n//             buttons.push(createFullscreenButton());\n//\n//         return elt('span', elemAttrs('toolbar-button-group'), buttons);\n//     };\n//\n//     const createLinkIcon = () => {\n//         const elem = createButtonElement('link-icon', 'Link to this page');\n//         const linkIcon = $(elem);\n//\n//         linkIcon.on('click', () => {\n//             $('body').prepend(\n//                 elt('div', {\n//                     id: settings.ID + 'link-popup',\n//                     class: 'diva-popup diva-link-popup'\n//                 }, [\n//                     elt('input', {\n//                         id: settings.ID + 'link-popup-input',\n//                         class: 'diva-input',\n//                         type: 'text',\n//                         value: viewer.getCurrentURL()\n//                     })\n//                 ])\n//             );\n//\n//             if (settings.inFullscreen)\n//             {\n//                 $(settings.selector + 'link-popup').addClass('in-fullscreen');\n//             }\n//             else\n//             {\n//                 // Calculate the left and top offsets\n//                 const leftOffset = linkIcon.offset().left - 222 + linkIcon.outerWidth();\n//                 const topOffset = linkIcon.offset().top + linkIcon.outerHeight() - 1;\n//\n//                 $(settings.selector + 'link-popup').css({\n//                     'top': topOffset + 'px',\n//                     'left': leftOffset + 'px'\n//                 });\n//             }\n//\n//             // Catch onmouseup events outside of this div\n//             $('body').mouseup(event => {\n//                 const targetID = event.target.id;\n//\n//                 if (targetID !== settings.ID + 'link-popup' && targetID !== settings.ID + 'link-popup-input')\n//                     $(settings.selector + 'link-popup').remove();\n//             });\n//\n//             // Also delete it upon scroll and page up/down key events\n//             // FIXME(wabain): This is aggressive\n//             settings.viewportObject.scroll(() => {\n//                 $(settings.selector + 'link-popup').remove();\n//             });\n//             $(settings.selector + 'link-popup input').click(function ()\n//             {\n//                 $(this).focus().select();\n//             });\n//\n//             return false;\n//         });\n//\n//         return elem;\n//     };\n//\n//     var createFullscreenButton = () => createButtonElement('fullscreen-icon', 'Toggle fullscreen mode', () => {\n//         viewer.toggleFullscreenMode();\n//     });\n//\n//     var createToggleNonPagedButton = () => {\n//         const getClassName = () => 'toggle-nonpaged-icon' + (viewer.getSettings().showNonPagedPages ? '-active' : '');\n//\n//         const toggleNonPagedButton = createButtonElement(getClassName(), 'Toggle visibility of non-paged pages', function()\n//         {\n//             viewer.toggleNonPagedPagesVisibility();\n//             const newClassName = 'diva-' + getClassName();\n//             this.className = this.className.replace(/diva-toggle-nonpaged-icon(-active)?/, newClassName);\n//         });\n//\n//         const updateNonPagedButtonVisibility = () => {\n//             const pages = settings.manifest.pages;\n//             for (let i = 0; i < pages.length; i++)\n//             {\n//                 if (settings.manifest.paged && !pages[i].paged)\n//                 {\n//                     // Show the button, there is at least one non-paged page\n//                     toggleNonPagedButton.style.display = 'inline-block';\n//                     return;\n//                 }\n//             }\n//\n//             // No non-paged pages were found, hide the button\n//             toggleNonPagedButton.style.display = 'none';\n//         };\n//         subscribe('ObjectDidLoad', updateNonPagedButtonVisibility);\n//\n//         return toggleNonPagedButton;\n//     };\n//\n//     // Handles all status updating etc (both fullscreen and not)\n//     const init = () => {\n//         const leftTools = [createZoomControls(), createGridControls()];\n//         const rightTools = [createPageNavigationControls(), createToolbarButtonGroup()];\n//\n//         const tools = elt('div', elemAttrs('tools'),\n//             elt('div', elemAttrs('tools-left'), leftTools),\n//             elt('div', elemAttrs('tools-right'), rightTools)\n//         );\n//\n//         settings.toolbarParentObject.prepend(tools);\n//\n//         // Handle entry to and exit from fullscreen mode\n//         const switchMode = () => {\n//             const toolsRightElement = document.getElementById(settings.ID + 'tools-right');\n//             const pageNavElement = document.getElementById(settings.ID + 'page-nav');\n//\n//             if (!settings.inFullscreen)\n//             {\n//                 // Leaving fullscreen\n//                 $(tools).removeClass('diva-fullscreen-tools');\n//\n//                 //move ID-page-nav to beginning of tools right\n//                 toolsRightElement.removeChild(pageNavElement);\n//                 toolsRightElement.insertBefore(pageNavElement, toolsRightElement.firstChild);\n//             }\n//             else\n//             {\n//                 // Entering fullscreen\n//                 $(tools).addClass('diva-fullscreen-tools');\n//\n//                 //move ID-page-nav to end of tools right\n//                 toolsRightElement.removeChild(pageNavElement);\n//                 toolsRightElement.appendChild(pageNavElement);\n//             }\n//         };\n//\n//         subscribe('ModeDidSwitch', switchMode);\n//         subscribe('ViewerDidLoad', switchMode);\n//\n//         const toolbar = {\n//             element: tools,\n//             closePopups: function ()\n//             {\n//                 $('.diva-popup').css('display', 'none');\n//             }\n//         };\n//\n//         return toolbar;\n//     };\n//\n//     return init();\n// }\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdG9vbGJhci5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9qcy90b29sYmFyLmpzPzIwYWYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGRpdmEgZnJvbSAnLi9kaXZhLWdsb2JhbCc7XG5pbXBvcnQgeyBlbHQgfSBmcm9tICcuL3V0aWxzL2VsdCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvb2xiYXJcbntcbiAgICBjb25zdHJ1Y3RvciAodmlld2VyKVxuICAgIHtcbiAgICAgICAgdGhpcy52aWV3ZXIgPSB2aWV3ZXI7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB2aWV3ZXIuc2V0dGluZ3M7XG4gICAgfVxuXG4gICAgX2VsZW1BdHRycyAoaWRlbnQsIGJhc2UpXG4gICAge1xuICAgICAgICBjb25zdCBhdHRycyA9IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLnNldHRpbmdzLklEICsgaWRlbnQsXG4gICAgICAgICAgICBjbGFzczogJ2RpdmEtJyArIGlkZW50XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGJhc2UpXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihhdHRycywgYmFzZSk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBhdHRycztcbiAgICB9XG5cblxuICAgIC8qKiBDb252ZW5pZW5jZSBmdW5jdGlvbiB0byBzdWJzY3JpYmUgdG8gYSBEaXZhIGV2ZW50ICovXG4gICAgX3N1YnNjcmliZSAoZXZlbnQsIGNhbGxiYWNrKVxuICAgIHtcbiAgICAgICAgZGl2YS5FdmVudHMuc3Vic2NyaWJlKGV2ZW50LCBjYWxsYmFjaywgdGhpcy5zZXR0aW5ncy5JRCk7XG4gICAgfVxuXG5cbiAgICBjcmVhdGVCdXR0b24gKG5hbWUsIGxhYmVsLCBjYWxsYmFjaywgaWNvbilcbiAgICB7XG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IGVsdCgnYnV0dG9uJywge1xuICAgICAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4gICAgICAgICAgICBpZDogdGhpcy5zZXR0aW5ncy5JRCArIG5hbWUsXG4gICAgICAgICAgICBjbGFzczogJ2RpdmEtJyArIG5hbWUgKyAnIGRpdmEtYnV0dG9uJyxcbiAgICAgICAgICAgIHRpdGxlOiBsYWJlbFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoaWNvbilcbiAgICAgICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChpY29uKTtcblxuICAgICAgICBpZiAoY2FsbGJhY2spXG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjYWxsYmFjayk7XG5cbiAgICAgICAgcmV0dXJuIGJ1dHRvbjtcbiAgICB9XG5cbiAgICBjcmVhdGVMYWJlbCAobmFtZSwgaWQsIGxhYmVsLCBpbm5lck5hbWUsIGlubmVyVmFsdWUpXG4gICAge1xuICAgICAgICByZXR1cm4gZWx0KCdkaXYnLCB7IGlkOiB0aGlzLnNldHRpbmdzLklEICsgaWQsIGNsYXNzOiBuYW1lICsgJyBkaXZhLWxhYmVsJ30sXG4gICAgICAgICAgICAgICAgICAgIFsgbGFiZWwsIGVsdCgnc3BhbicsIHsgaWQ6IHRoaXMuc2V0dGluZ3MuSUQgKyBpbm5lck5hbWUgfSwgaW5uZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgfVxuXG4gICAgY3JlYXRlWm9vbUJ1dHRvbnMgKClcbiAgICB7XG4gICAgICAgIGxldCB6b29tT3V0SWNvbiA9IHRoaXMuX2NyZWF0ZVpvb21PdXRJY29uKCk7XG4gICAgICAgIGxldCB6b29tSW5JY29uID0gdGhpcy5fY3JlYXRlWm9vbUluSWNvbigpO1xuXG4gICAgICAgIGxldCB6b29tQnV0dG9ucyA9IFtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQnV0dG9uKCd6b29tLW91dC1idXR0b24nLCAnWm9vbSBPdXQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3ZXIuc2V0Wm9vbUxldmVsKHRoaXMuc2V0dGluZ3Muem9vbUxldmVsIC0gMSk7XG4gICAgICAgICAgICB9LCB6b29tT3V0SWNvbiksXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUJ1dHRvbignem9vbS1pbi1idXR0b24nLCAnWm9vbSBJbicsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdlci5zZXRab29tTGV2ZWwodGhpcy5zZXR0aW5ncy56b29tTGV2ZWwgKyAxKTtcbiAgICAgICAgICAgIH0sIHpvb21Jbkljb24pLFxuICAgICAgICAgICAgdGhpcy5jcmVhdGVMYWJlbCgnZGl2YS16b29tLWxhYmVsJywgJ3pvb20tbGFiZWwnLCAnWm9vbSBsZXZlbDogJywgJ3pvb20tbGV2ZWwnLCB0aGlzLnNldHRpbmdzLnpvb21MZXZlbCArIDEpXG4gICAgICAgIF07XG5cbiAgICAgICAgbGV0IHpvb21IYW5kbGVyID0gZnVuY3Rpb24gKClcbiAgICAgICAge1xuICAgICAgICAgICAgbGV0IGxhYmVsRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnNldHRpbmdzLklEICsgJ3pvb20tbGV2ZWwnKTtcbiAgICAgICAgICAgIGxhYmVsRWwudGV4dENvbnRlbnQgPSB0aGlzLnNldHRpbmdzLnpvb21MZXZlbCArIDE7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlKCdab29tTGV2ZWxEaWRDaGFuZ2UnLCB6b29tSGFuZGxlcik7XG4gICAgICAgIHRoaXMuX3N1YnNjcmliZSgnVmlld2VyRGlkTG9hZCcsIHpvb21IYW5kbGVyKTtcblxuICAgICAgICByZXR1cm4gZWx0KCdkaXYnLCB7IGlkOiB0aGlzLnNldHRpbmdzLklEICsgXCJ6b29tLWNvbnRyb2xzXCIsIHN0eWxlOiBcImRpc3BsYXk6IG5vbmVcIn0sIHpvb21CdXR0b25zKTtcbiAgICB9XG5cbiAgICBjcmVhdGVHcmlkQ29udHJvbHMgKClcbiAgICB7XG4gICAgICAgIGxldCBncmlkTW9yZUljb24gPSB0aGlzLl9jcmVhdGVHcmlkTW9yZUljb24oKTtcbiAgICAgICAgbGV0IGdyaWRGZXdlckljb24gPSB0aGlzLl9jcmVhdGVHcmlkRmV3ZXJJY29uKCk7XG5cbiAgICAgICAgbGV0IGdyaWRCdXR0b25zID0gW1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVCdXR0b24oJ2dyaWQtb3V0LWJ1dHRvbicsICdGZXdlcicsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdlci5zZXRHcmlkUGFnZXNQZXJSb3codGhpcy5zZXR0aW5ncy5wYWdlc1BlclJvdyAtIDEpO1xuICAgICAgICAgICAgfSwgZ3JpZEZld2VySWNvbiksXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUJ1dHRvbignZ3JpZC1pbi1idXR0b24nLCAnTW9yZScsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdlci5zZXRHcmlkUGFnZXNQZXJSb3codGhpcy5zZXR0aW5ncy5wYWdlc1BlclJvdyArIDEpO1xuICAgICAgICAgICAgfSwgZ3JpZE1vcmVJY29uKSxcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTGFiZWwoJ2RpdmEtZ3JpZC1sYWJlbCcsICdncmlkLWxhYmVsJywgJ1BhZ2VzIHBlciByb3c6ICcsICdwYWdlcy1wZXItcm93JywgdGhpcy5zZXR0aW5ncy5wYWdlc1BlclJvdylcbiAgICAgICAgXTtcblxuICAgICAgICBsZXQgZ3JpZENoYW5nZUhhbmRsZXIgPSBmdW5jdGlvbiAoKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgbGFiZWxFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuc2V0dGluZ3MuSUQgKyAncGFnZXMtcGVyLXJvdycpO1xuICAgICAgICAgICAgbGFiZWxFbC50ZXh0Q29udGVudCA9IHRoaXMuc2V0dGluZ3MucGFnZXNQZXJSb3c7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlKCdHcmlkUm93TnVtYmVyRGlkQ2hhbmdlJywgZ3JpZENoYW5nZUhhbmRsZXIpO1xuXG4gICAgICAgIHJldHVybiBlbHQoJ2RpdicsIHtpZDogdGhpcy5zZXR0aW5ncy5JRCArIFwiZ3JpZC1jb250cm9sc1wiLCBzdHlsZTogXCJkaXNwbGF5Om5vbmVcIiB9LCBncmlkQnV0dG9ucyk7XG4gICAgfVxuXG4gICAgY3JlYXRlUGFnZUxhYmVsICgpXG4gICAge1xuICAgICAgICAvLyBDdXJyZW50IHBhZ2VcbiAgICAgICAgY29uc3QgY3VycmVudFBhZ2UgPSBlbHQoJ3NwYW4nLCB7XG4gICAgICAgICAgICBpZDogdGhpcy5zZXR0aW5ncy5JRCArICdjdXJyZW50LXBhZ2UnXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHVwZGF0ZUN1cnJlbnRQYWdlID0gKCkgPT4gXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGdldCBsYWJlbHMgZm9yIGluZGV4IHJhbmdlXG4gICAgICAgICAgICBsZXQgaW5kaWNlcyA9IHRoaXMudmlld2VyLmdldEN1cnJlbnRQYWdlSW5kaWNlcygpO1xuICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSBpbmRpY2VzWzBdO1xuICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gaW5kaWNlc1tpbmRpY2VzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgbGV0IHN0YXJ0TGFiZWwgPSB0aGlzLnNldHRpbmdzLm1hbmlmZXN0LnBhZ2VzW3N0YXJ0SW5kZXhdLmw7XG4gICAgICAgICAgICBsZXQgZW5kTGFiZWwgPSB0aGlzLnNldHRpbmdzLm1hbmlmZXN0LnBhZ2VzW2VuZEluZGV4XS5sO1xuXG4gICAgICAgICAgICBpZiAoc3RhcnRJbmRleCAhPT0gZW5kSW5kZXgpIFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgXHRpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVJbmRleEFzTGFiZWwpXG4gICAgICAgICAgICAgICAgXHRjdXJyZW50UGFnZS50ZXh0Q29udGVudCA9IHN0YXJ0SW5kZXggKyBcIiAtIFwiICsgZW5kSW5kZXg7XG4gICAgICAgICAgICBcdGVsc2VcbiAgICAgICAgICAgIFx0XHRjdXJyZW50UGFnZS50ZXh0Q29udGVudCA9IHN0YXJ0TGFiZWwgKyBcIiAtIFwiICsgZW5kTGFiZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgIFx0e1xuICAgICAgICAgICAgXHRpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVJbmRleEFzTGFiZWwpXG4gICAgICAgICAgICBcdFx0Y3VycmVudFBhZ2UudGV4dENvbnRlbnQgPSBzdGFydEluZGV4O1xuICAgICAgICAgICAgXHRlbHNlXG4gICAgICAgICAgICBcdFx0Y3VycmVudFBhZ2UudGV4dENvbnRlbnQgPSBzdGFydExhYmVsO1xuICAgICAgICBcdH1cbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLl9zdWJzY3JpYmUoJ1Zpc2libGVQYWdlRGlkQ2hhbmdlJywgdXBkYXRlQ3VycmVudFBhZ2UpO1xuICAgICAgICB0aGlzLl9zdWJzY3JpYmUoJ1ZpZXdlckRpZExvYWQnLCB1cGRhdGVDdXJyZW50UGFnZSk7XG4gICAgICAgIHRoaXMuX3N1YnNjcmliZSgnVmlld0RpZFN3aXRjaCcsIHVwZGF0ZUN1cnJlbnRQYWdlKTtcblxuICAgICAgICByZXR1cm4gZWx0KCdzcGFuJywge1xuICAgICAgICAgICAgICAgIGNsYXNzOiAnZGl2YS1wYWdlLWxhYmVsIGRpdmEtbGFiZWwnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3VycmVudFBhZ2VcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBjcmVhdGVHb3RvUGFnZUZvcm0gKCkgIFxuICAgIHtcbiAgICAgICAgY29uc3QgZ290b1BhZ2VJbnB1dCA9IGVsdCgnaW5wdXQnLCB7XG4gICAgICAgICAgICBpZDogdGhpcy5zZXR0aW5ncy5JRCArICdnb3RvLXBhZ2UtaW5wdXQnLFxuICAgICAgICAgICAgY2xhc3M6ICdkaXZhLWlucHV0IGRpdmEtZ290by1wYWdlLWlucHV0JyxcbiAgICAgICAgICAgIGF1dG9jb21wbGV0ZTogJ29mZicsXG4gICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgZ290b1BhZ2VTdWJtaXQgPSBlbHQoJ2lucHV0Jywge1xuICAgICAgICAgICAgaWQ6IHRoaXMuc2V0dGluZ3MuSUQgKyAnZ290by1wYWdlLXN1Ym1pdCcsXG4gICAgICAgICAgICBjbGFzczogJ2RpdmEtYnV0dG9uIGRpdmEtYnV0dG9uLXRleHQnLFxuICAgICAgICAgICAgdHlwZTogJ3N1Ym1pdCcsXG4gICAgICAgICAgICB2YWx1ZTogJ0dvJ1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBpbnB1dFN1Z2dlc3Rpb25zID0gZWx0KCdkaXYnLCB7XG4gICAgICAgICAgICAgICAgaWQ6IHRoaXMuc2V0dGluZ3MuSUQgKyAnaW5wdXQtc3VnZ2VzdGlvbnMnLFxuICAgICAgICAgICAgICAgIGNsYXNzOiAnZGl2YS1pbnB1dC1zdWdnZXN0aW9ucydcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBnb3RvRm9ybSA9IGVsdCgnZm9ybScsIHtcbiAgICAgICAgICAgICAgICBpZDogdGhpcy5zZXR0aW5ncy5JRCArICdnb3RvLXBhZ2UnLFxuICAgICAgICAgICAgICAgIGNsYXNzOiAnZGl2YS1nb3RvLWZvcm0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ290b1BhZ2VJbnB1dCxcbiAgICAgICAgICAgIGdvdG9QYWdlU3VibWl0LFxuICAgICAgICAgICAgaW5wdXRTdWdnZXN0aW9uc1xuICAgICAgICApO1xuXG4gICAgICAgIGdvdG9Gb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiBcbiAgICAgICAge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBjb25zdCBkZXNpcmVkUGFnZUxhYmVsID0gZ290b1BhZ2VJbnB1dC52YWx1ZTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3Mub25Hb3RvU3VibWl0ICYmIHR5cGVvZiB0aGlzLnNldHRpbmdzLm9uR290b1N1Ym1pdCA9PT0gXCJmdW5jdGlvblwiKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhZ2VJbmRleCA9IHRoaXMuc2V0dGluZ3Mub25Hb3RvU3VibWl0KGRlc2lyZWRQYWdlTGFiZWwpO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy52aWV3ZXIuZ290b1BhZ2VCeUluZGV4KHBhZ2VJbmRleCkpXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hbGVydChcIk5vIHBhZ2UgY291bGQgYmUgZm91bmQgd2l0aCB0aGF0IGxhYmVsIG9yIHBhZ2UgbnVtYmVyXCIpO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIC8vIERlZmF1bHQgaWYgbm8gZnVuY3Rpb24gaXMgc3BlY2lmaWVkIGluIHRoZSBzZXR0aW5nc1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy52aWV3ZXIuZ290b1BhZ2VCeUxhYmVsKGRlc2lyZWRQYWdlTGFiZWwpKVxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWxlcnQoXCJObyBwYWdlIGNvdWxkIGJlIGZvdW5kIHdpdGggdGhhdCBsYWJlbCBvciBwYWdlIG51bWJlclwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSGlkZSB0aGUgc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIGlucHV0U3VnZ2VzdGlvbnMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgICAgICAgICAgLy8gUHJldmVudCB0aGUgZGVmYXVsdCBhY3Rpb24gb2YgcmVsb2FkaW5nIHRoZSBwYWdlXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIFsnaW5wdXQnLCAnZm9jdXMnXS5mb3JFYWNoKGV2ZW50ID0+IFxuICAgICAgICB7XG4gICAgICAgICAgICBnb3RvUGFnZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsICgpID0+IHtcbiAgICAgICAgICAgICAgICBpbnB1dFN1Z2dlc3Rpb25zLmlubmVySFRNTCA9ICcnOyAvLyBSZW1vdmUgYWxsIHByZXZpb3VzIHN1Z2dlc3Rpb25zXG5cbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGdvdG9QYWdlSW5wdXQudmFsdWU7XG4gICAgICAgICAgICAgICAgbGV0IG51bVN1Z2dlc3Rpb25zID0gMDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVHb3RvU3VnZ2VzdGlvbnMgJiYgdmFsdWUpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYWdlcyA9IHRoaXMuc2V0dGluZ3MubWFuaWZlc3QucGFnZXM7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBwYWdlcy5sZW5ndGg7IGkgPCBsZW4gJiYgbnVtU3VnZ2VzdGlvbnMgPCAxMDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFnZXNbaV0ubC50b0xvd2VyQ2FzZSgpLmluZGV4T2YodmFsdWUudG9Mb3dlckNhc2UoKSkgPiAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdJbnB1dFN1Z2dlc3Rpb24gPSBlbHQoJ2RpdicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiAnZGl2YS1pbnB1dC1zdWdnZXN0aW9uJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlc1tpXS5sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0U3VnZ2VzdGlvbnMuYXBwZW5kQ2hpbGQobmV3SW5wdXRTdWdnZXN0aW9uKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bVN1Z2dlc3Rpb25zKys7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBTaG93IGxhYmVsIHN1Z2dlc3Rpb25zXG4gICAgICAgICAgICAgICAgICAgIGlmIChudW1TdWdnZXN0aW9ucyA+IDApXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFN1Z2dlc3Rpb25zLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGlucHV0U3VnZ2VzdGlvbnMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBnb3RvUGFnZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlID0+IHtcbiAgICAgICAgICAgIGxldCBlbDtcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDEzKSAvLyAnRW50ZXInIGtleVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2FjdGl2ZScpWzBdO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYWN0aXZlICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgICAgICAgICAgZ290b1BhZ2VJbnB1dC52YWx1ZSA9IGFjdGl2ZS5pbm5lclRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAzOCkgLy8gVXAgYXJyb3cga2V5XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdhY3RpdmUnKVswXTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2RWwgPSBlbCA/IGVsLnByZXZpb3VzU2libGluZyA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHByZXZFbCAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZFbCAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZFbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxhc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkaXZhLWlucHV0LXN1Z2dlc3Rpb24nKS5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkaXZhLWlucHV0LXN1Z2dlc3Rpb24nKVtsYXN0XS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChlLmtleUNvZGUgPT09IDQwKSAvLyBEb3duIGFycm93IGtleVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYWN0aXZlJylbMF07XG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dEVsID0gZWwgPyBlbC5uZXh0U2libGluZyA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG5leHRFbCAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRFbCAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRFbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZGl2YS1pbnB1dC1zdWdnZXN0aW9uJylbMF0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBvbkV2ZW50KGlucHV0U3VnZ2VzdGlvbnMsICdtb3VzZWRvd24nLCAnLmRpdmEtaW5wdXQtc3VnZ2VzdGlvbicsIGZ1bmN0aW9uICgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvdG9QYWdlSW5wdXQudmFsdWUgPSB0aGlzLnRleHRDb250ZW50O1xuICAgICAgICAgICAgaW5wdXRTdWdnZXN0aW9ucy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXG4gICAgICAgICAgICBsZXQgc3VibWl0RXZlbnQgPSBuZXcgRXZlbnQoJ3N1Ym1pdCcpO1xuICAgICAgICAgICAgZ290b0Zvcm0uZGlzcGF0Y2hFdmVudChzdWJtaXRFdmVudCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGphdmFzY3JpcHQgZXF1aXZhbGVudCB0byBqcXVlcnkgLm9uKGV2ZW50LCBzZWxlY3RvciwgZnVuY3Rpb24pXG4gICAgICAgIGZ1bmN0aW9uIG9uRXZlbnQgKGVsZW0sIGV2dCwgc2VsLCBoYW5kbGVyKSBcbiAgICAgICAge1xuICAgICAgICAgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKGV2dCwgZnVuY3Rpb24gKGV2ZW50KSBcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgdCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgICAgICAgICB3aGlsZSAodCAmJiB0ICE9PSB0aGlzKSBcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0Lm1hdGNoZXMoc2VsKSkgXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyLmNhbGwodCwgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICB0ID0gdC5wYXJlbnROb2RlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZ290b1BhZ2VJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgKCkgPT4ge1xuICAgICAgICAgICAgLy8gSGlkZSBsYWJlbCBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgaW5wdXRTdWdnZXN0aW9ucy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZ290b0Zvcm07XG4gICAgfVxuXG4gICAgY3JlYXRlVmlld01lbnUgKClcbiAgICB7XG4gICAgICAgIGNvbnN0IHZpZXdPcHRpb25zTGlzdCA9IGVsdCgnZGl2JywgdGhpcy5fZWxlbUF0dHJzKCd2aWV3LW9wdGlvbnMnKSk7XG4gICAgICAgIGNvbnN0IGdyaWRWaWV3SWNvbiA9IHRoaXMuX2NyZWF0ZUdyaWRWaWV3SWNvbigpO1xuICAgICAgICBjb25zdCBib29rVmlld0ljb24gPSB0aGlzLl9jcmVhdGVCb29rVmlld0ljb24oKTtcbiAgICAgICAgY29uc3QgcGFnZVZpZXdJY29uID0gdGhpcy5fY3JlYXRlUGFnZVZpZXdJY29uKCk7XG5cbiAgICAgICAgY29uc3Qgdmlld09wdGlvbnNUb2dnbGUgPSAoKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICB2aWV3T3B0aW9uc0xpc3Quc3R5bGUuZGlzcGxheSA9IHZpZXdPcHRpb25zTGlzdC5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIiA/IFwiYmxvY2tcIiA6IFwibm9uZVwiO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGNoYW5nZVZpZXdCdXR0b24gPSB0aGlzLmNyZWF0ZUJ1dHRvbigndmlldy1pY29uJywgJ0NoYW5nZSB2aWV3Jywgdmlld09wdGlvbnNUb2dnbGUpO1xuXG4gICAgICAgIGNvbnN0IHNlbGVjdFZpZXcgPSAodmlldykgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy52aWV3ZXIuY2hhbmdlVmlldyh2aWV3KTtcblxuICAgICAgICAgICAgLy9oaWRlIHZpZXcgbWVudVxuICAgICAgICAgICAgdmlld09wdGlvbnNMaXN0LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCB1cGRhdGVWaWV3TWVudSA9ICgpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHZpZXdJY29uQ2xhc3NlcyA9ICcgZGl2YS12aWV3LWljb24gZGl2YS1idXR0b24nO1xuXG5cbiAgICAgICAgICAgIC8vIGRpc3BsYXkgdGhlIGljb24gb2YgdGhlIG1vZGUgd2UncmUgY3VycmVudGx5IGluICg/KVxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaW5HcmlkKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNoYW5nZVZpZXdCdXR0b24uYXBwZW5kQ2hpbGQoZ3JpZFZpZXdJY29uKTtcbiAgICAgICAgICAgICAgICBjaGFuZ2VWaWV3QnV0dG9uLmNsYXNzTmFtZSA9ICdkaXZhLWdyaWQtaWNvbicgKyB2aWV3SWNvbkNsYXNzZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnNldHRpbmdzLmluQm9va0xheW91dClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VWaWV3QnV0dG9uLmFwcGVuZENoaWxkKGJvb2tWaWV3SWNvbik7XG4gICAgICAgICAgICAgICAgY2hhbmdlVmlld0J1dHRvbi5jbGFzc05hbWUgPSAnZGl2YS1ib29rLWljb24nICsgdmlld0ljb25DbGFzc2VzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNoYW5nZVZpZXdCdXR0b24uYXBwZW5kQ2hpbGQocGFnZVZpZXdJY29uKTtcbiAgICAgICAgICAgICAgICBjaGFuZ2VWaWV3QnV0dG9uLmNsYXNzTmFtZSA9ICdkaXZhLWRvY3VtZW50LWljb24nICsgdmlld0ljb25DbGFzc2VzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB2aWV3T3B0aW9ucyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblxuICAgICAgICAgICAgLy8gdGhlbiBkaXNwbGF5IGRvY3VtZW50LCBib29rLCBhbmQgZ3JpZCBidXR0b25zIGluIHRoYXQgb3JkZXIsIGV4Y2x1ZGluZyB0aGUgY3VycmVudCB2aWV3XG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5pbkdyaWQgfHwgdGhpcy5zZXR0aW5ncy5pbkJvb2tMYXlvdXQpXG4gICAgICAgICAgICAgICAgdmlld09wdGlvbnMuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVCdXR0b24oJ2RvY3VtZW50LWljb24nLCAnRG9jdW1lbnQgVmlldycsIHNlbGVjdFZpZXcuYmluZChudWxsLCAnZG9jdW1lbnQnKSwgcGFnZVZpZXdJY29uKSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmluR3JpZCB8fCAhdGhpcy5zZXR0aW5ncy5pbkJvb2tMYXlvdXQpXG4gICAgICAgICAgICAgICAgdmlld09wdGlvbnMuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVCdXR0b24oJ2Jvb2staWNvbicsICdCb29rIFZpZXcnLCBzZWxlY3RWaWV3LmJpbmQobnVsbCwgJ2Jvb2snKSwgYm9va1ZpZXdJY29uKSk7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5pbkdyaWQpXG4gICAgICAgICAgICAgICAgdmlld09wdGlvbnMuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVCdXR0b24oJ2dyaWQtaWNvbicsICdHcmlkIFZpZXcnLCBzZWxlY3RWaWV3LmJpbmQobnVsbCwgJ2dyaWQnKSwgZ3JpZFZpZXdJY29uKSk7XG5cbiAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgbWVudVxuICAgICAgICAgICAgd2hpbGUgKHZpZXdPcHRpb25zTGlzdC5maXJzdENoaWxkKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZpZXdPcHRpb25zTGlzdC5yZW1vdmVDaGlsZCh2aWV3T3B0aW9uc0xpc3QuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGluc2VydCBuZXcgbWVudVxuICAgICAgICAgICAgdmlld09wdGlvbnNMaXN0LmFwcGVuZENoaWxkKHZpZXdPcHRpb25zKTtcbiAgICAgICAgfTtcblxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZXZlbnQgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHZpZXdPcHRpb25zTGlzdCAhPT0gZXZlbnQudGFyZ2V0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZpZXdPcHRpb25zTGlzdC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9zdWJzY3JpYmUoJ1ZpZXdEaWRTd2l0Y2gnLCB1cGRhdGVWaWV3TWVudSk7XG4gICAgICAgIHRoaXMuX3N1YnNjcmliZSgnT2JqZWN0RGlkTG9hZCcsIHVwZGF0ZVZpZXdNZW51KTtcblxuICAgICAgICByZXR1cm4gZWx0KCdkaXYnLCB0aGlzLl9lbGVtQXR0cnMoJ3ZpZXctbWVudScpLFxuICAgICAgICAgICAgY2hhbmdlVmlld0J1dHRvbixcbiAgICAgICAgICAgIHZpZXdPcHRpb25zTGlzdFxuICAgICAgICApO1xuICAgIH1cblxuICAgIGNyZWF0ZUZ1bGxzY3JlZW5CdXR0b24gKClcbiAgICB7XG4gICAgICAgIGxldCBmdWxsc2NyZWVuSWNvbiA9IHRoaXMuX2NyZWF0ZUZ1bGxzY3JlZW5JY29uKCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQnV0dG9uKCdmdWxsc2NyZWVuLWljb24nLCAnVG9nZ2xlIGZ1bGxzY3JlZW4gbW9kZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudmlld2VyLnRvZ2dsZUZ1bGxzY3JlZW5Nb2RlKCk7XG4gICAgICAgIH0sIGZ1bGxzY3JlZW5JY29uKTtcbiAgICB9XG5cbiAgICB0b2dnbGVab29tR3JpZENvbnRyb2xzICgpXG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuaW5HcmlkKVxuICAgICAgICB7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnNldHRpbmdzLklEICsgXCJ6b29tLWNvbnRyb2xzXCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnNldHRpbmdzLklEICsgXCJncmlkLWNvbnRyb2xzXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuc2V0dGluZ3MuSUQgKyBcInpvb20tY29udHJvbHNcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5zZXR0aW5ncy5JRCArIFwiZ3JpZC1jb250cm9sc1wiKS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICByZW5kZXIgKClcbiAgICB7XG4gICAgICAgIHRoaXMuX3N1YnNjcmliZShcIlZpZXdEaWRTd2l0Y2hcIiwgdGhpcy50b2dnbGVab29tR3JpZENvbnRyb2xzKTtcbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlKFwiT2JqZWN0RGlkTG9hZFwiLCB0aGlzLnRvZ2dsZVpvb21HcmlkQ29udHJvbHMpO1xuXG4gICAgICAgIGxldCBsZWZ0VG9vbHMgPSBbXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVpvb21CdXR0b25zKCksXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUdyaWRDb250cm9scygpXG4gICAgICAgIF07XG4gICAgICAgIGxldCByaWdodFRvb2xzID0gW1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVQYWdlTGFiZWwoKSxcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVmlld01lbnUoKVxuICAgICAgICBdO1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVGdWxsc2NyZWVuKVxuICAgICAgICAgICAgcmlnaHRUb29scy5wdXNoKHRoaXMuY3JlYXRlRnVsbHNjcmVlbkJ1dHRvbigpKTtcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlR290b1BhZ2UpXG4gICAgICAgICAgICByaWdodFRvb2xzLnNwbGljZSgxLCAwLCB0aGlzLmNyZWF0ZUdvdG9QYWdlRm9ybSgpKTtcblxuICAgICAgICAvLyBhc3NpZ24gdG9vbGJhciBwbHVnaW5zIHRvIHByb3BlciBzaWRlXG4gICAgICAgIGxldCBwbHVnaW5zID0gdGhpcy52aWV3ZXIudmlld2VyU3RhdGUucGx1Z2luSW5zdGFuY2VzO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcGx1Z2lucy5sZW5ndGg7IGkgPCBsZW47IGkrKykgXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldCBwbHVnaW4gPSBwbHVnaW5zW2ldO1xuXG4gICAgICAgICAgICBpZiAoIXBsdWdpbi50b29sYmFyU2lkZSkgLy8gbm90IGEgdG9vbGJhciB0b29sXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIHBsdWdpbi50b29sYmFySWNvbiA9IHBsdWdpbi5jcmVhdGVJY29uKCk7IFxuICAgICAgICAgICAgaWYgKCFwbHVnaW4udG9vbGJhckljb24pIC8vIGljb24gY291bGRuJ3QgYmUgY3JlYXRlZFxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAvLyBhZGQgcGx1Z2luIHRvb2xzIGFmdGVyIHRoZSBnby10by1wYWdlIGFuZCBwYWdlLWxhYmVsIHRvb2xzXG4gICAgICAgICAgICBpZiAocGx1Z2luLnRvb2xiYXJTaWRlID09PSAncmlnaHQnKSBcbiAgICAgICAgICAgICAgICByaWdodFRvb2xzLnNwbGljZSgyLCAwLCBwbHVnaW4udG9vbGJhckljb24pO1xuICAgICAgICAgICAgZWxzZSBpZiAocGx1Z2luLnRvb2xiYXJTaWRlID09PSAnbGVmdCcpIFxuICAgICAgICAgICAgICAgIGxlZnRUb29scy5zcGxpY2UoMiwgMCwgcGx1Z2luLnRvb2xiYXJJY29uKTtcblxuICAgICAgICAgICAgcGx1Z2luLnRvb2xiYXJJY29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlUGx1Z2luQ2xpY2suYmluZCh0aGlzLCBwbHVnaW4pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZVBsdWdpbkNsaWNrIChwbHVnaW4pIFxuICAgICAgICB7XG4gICAgICAgICAgICBwbHVnaW4uaGFuZGxlQ2xpY2sodGhpcy52aWV3ZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdG9vbHMgPSBlbHQoJ2RpdicsIHRoaXMuX2VsZW1BdHRycygndG9vbHMnKSxcbiAgICAgICAgICAgICAgICAgICAgZWx0KCdkaXYnLCB0aGlzLl9lbGVtQXR0cnMoJ3Rvb2xzLWxlZnQnKSwgbGVmdFRvb2xzKSxcbiAgICAgICAgICAgICAgICAgICAgZWx0KCdkaXYnLCB0aGlzLl9lbGVtQXR0cnMoJ3Rvb2xzLXJpZ2h0JyksIHJpZ2h0VG9vbHMpXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICB0aGlzLnNldHRpbmdzLnRvb2xiYXJQYXJlbnRPYmplY3QuaW5zZXJ0QmVmb3JlKFxuICAgICAgICAgICAgdG9vbHMsXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnRvb2xiYXJQYXJlbnRPYmplY3QuZmlyc3RDaGlsZFxuICAgICAgICApO1xuICAgIH1cblxuICAgIF9jcmVhdGVUb29sYmFySWNvbiAocGF0aHMpXG4gICAge1xuICAgICAgICBsZXQgaWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIFwic3ZnXCIpO1xuICAgICAgICBpY29uLnNldEF0dHJpYnV0ZU5TKG51bGwsICd2aWV3Qm94JywgXCIwIDAgMjUgMjVcIik7XG4gICAgICAgIGljb24uc2V0QXR0cmlidXRlTlMobnVsbCwgJ3gnLCAnMHB4Jyk7XG4gICAgICAgIGljb24uc2V0QXR0cmlidXRlTlMobnVsbCwgJ3knLCAnMHB4Jyk7XG4gICAgICAgIGljb24uc2V0QXR0cmlidXRlTlMobnVsbCwgJ3N0eWxlJywgXCJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQ4IDQ4O1wiKTtcblxuICAgICAgICBsZXQgZ2x5cGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBcImdcIik7XG4gICAgICAgIGdseXBoLnNldEF0dHJpYnV0ZU5TKG51bGwsIFwidHJhbnNmb3JtXCIsIFwibWF0cml4KDEsIDAsIDAsIDEsIC0xMiwgLTEyKVwiKTtcblxuICAgICAgICBwYXRocy5mb3JFYWNoKCAocGF0aCkgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgbGV0IHBFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIFwicGF0aFwiKTtcbiAgICAgICAgICAgIHBFbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcImRcIiwgcGF0aCk7XG4gICAgICAgICAgICBnbHlwaC5hcHBlbmRDaGlsZChwRWwpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpY29uLmFwcGVuZENoaWxkKGdseXBoKTtcbiAgICAgICAgcmV0dXJuIGljb247XG4gICAgfVxuXG4gICAgX2NyZWF0ZVpvb21PdXRJY29uICgpXG4gICAge1xuICAgICAgICBsZXQgcGF0aHMgPSBbXG4gICAgICAgICAgICBcIk0xOS41LDIzYy0wLjI3NSwwLTAuNS0wLjIyNS0wLjUtMC41di0xYzAtMC4yNzUsMC4yMjUtMC41LDAuNS0wLjVoN2MwLjI3NSwwLDAuNSwwLjIyNSwwLjUsMC41djFjMCwwLjI3NS0wLjIyNSwwLjUtMC41LDAuNUgxOS41elwiLFxuICAgICAgICAgICAgXCJNMzcuMjE5LDM0LjI1N2wtMi4yMTMsMi4yMTJjLTAuMjAyLDAuMjAyLTAuNTM0LDAuMjAyLTAuNzM2LDBsLTYuMDk4LTYuMDk5Yy0xLjUzNywwLjk5My0zLjM2MiwxLjU3Ny01LjMyMywxLjU3N2MtNS40MzEsMC05Ljg0OS00LjQxOC05Ljg0OS05Ljg0OWMwLTUuNDMxLDQuNDE4LTkuODQ5LDkuODQ5LTkuODQ5YzUuNDMxLDAsOS44NDksNC40MTgsOS44NDksOS44NDljMCwxLjk2MS0wLjU4NCwzLjc4Ni0xLjU3Niw1LjMyM2w2LjA5OCw2LjA5OEMzNy40MjIsMzMuNzIyLDM3LjQyMiwzNC4wNTQsMzcuMjE5LDM0LjI1N3ogTTI5LjU2OCwyMi4wOTljMC0zLjcwNi0zLjAxNC02LjcyLTYuNzItNi43MmMtMy43MDYsMC02LjcyLDMuMDE0LTYuNzIsNi43MmMwLDMuNzA2LDMuMDE0LDYuNzIsNi43Miw2LjcyQzI2LjU1NSwyOC44MTgsMjkuNTY4LDI1LjgwNSwyOS41NjgsMjIuMDk5elwiXG4gICAgICAgIF07XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZVRvb2xiYXJJY29uKHBhdGhzKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlWm9vbUluSWNvbiAoKVxuICAgIHtcbiAgICAgICAgbGV0IHBhdGhzID0gW1xuICAgICAgICAgICAgXCJNMzcuNDY5LDM0LjI1N2wtMi4yMTMsMi4yMTJjLTAuMjAyLDAuMjAyLTAuNTM0LDAuMjAyLTAuNzM2LDBsLTYuMDk4LTYuMDk5Yy0xLjUzNywwLjk5My0zLjM2MiwxLjU3Ny01LjMyMywxLjU3N2MtNS40MzEsMC05Ljg0OS00LjQxOC05Ljg0OS05Ljg0OWMwLTUuNDMxLDQuNDE4LTkuODQ5LDkuODQ5LTkuODQ5YzUuNDMxLDAsOS44NDksNC40MTgsOS44NDksOS44NDljMCwxLjk2MS0wLjU4NCwzLjc4Ni0xLjU3Niw1LjMyM2w2LjA5OCw2LjA5OEMzNy42NzIsMzMuNzIyLDM3LjY3MiwzNC4wNTQsMzcuNDY5LDM0LjI1N3ogTTI5LjgxOCwyMi4wOTljMC0zLjcwNi0zLjAxNC02LjcyLTYuNzItNi43MmMtMy43MDYsMC02LjcyLDMuMDE0LTYuNzIsNi43MmMwLDMuNzA2LDMuMDE0LDYuNzIsNi43Miw2LjcyQzI2LjgwNSwyOC44MTgsMjkuODE4LDI1LjgwNSwyOS44MTgsMjIuMDk5eiBNMjYuNSwyMUgyNHYtMi41YzAtMC4yNzUtMC4yMjUtMC41LTAuNS0wLjVoLTFjLTAuMjc1LDAtMC41LDAuMjI1LTAuNSwwLjVWMjFoLTIuNWMtMC4yNzUsMC0wLjUsMC4yMjUtMC41LDAuNXYxYzAsMC4yNzUsMC4yMjUsMC41LDAuNSwwLjVIMjJ2Mi41YzAsMC4yNzUsMC4yMjUsMC41LDAuNSwwLjVoMWMwLjI3NSwwLDAuNS0wLjIyNSwwLjUtMC41VjIzaDIuNWMwLjI3NSwwLDAuNS0wLjIyNSwwLjUtMC41di0xQzI3LDIxLjIyNSwyNi43NzUsMjEsMjYuNSwyMXpcIlxuICAgICAgICBdO1xuICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlVG9vbGJhckljb24ocGF0aHMpO1xuICAgIH1cblxuICAgIF9jcmVhdGVHcmlkTW9yZUljb24gKClcbiAgICB7XG4gICAgICAgIGxldCBwYXRocyA9IFtcbiAgICAgICAgICAgIFwiTTI5LjUsMzVjLTAuMjc1LDAtMC41LTAuMjI1LTAuNS0wLjV2LTVjMC0wLjI3NSwwLjIyNS0wLjUsMC41LTAuNWg1YzAuMjc1LDAsMC41LDAuMjI1LDAuNSwwLjV2NWMwLDAuMjc1LTAuMjI1LDAuNS0wLjUsMC41SDI5LjV6IE0yMS41LDM1Yy0wLjI3NSwwLTAuNS0wLjIyNS0wLjUtMC41di01YzAtMC4yNzUsMC4yMjUtMC41LDAuNS0wLjVoNWMwLjI3NSwwLDAuNSwwLjIyNSwwLjUsMC41djVjMCwwLjI3NS0wLjIyNSwwLjUtMC41LDAuNUgyMS41eiBNMTMuNSwzNWMtMC4yNzUsMC0wLjUtMC4yMjUtMC41LTAuNXYtNWMwLTAuMjc1LDAuMjI1LTAuNSwwLjUtMC41aDVjMC4yNzUsMCwwLjUsMC4yMjUsMC41LDAuNXY1YzAsMC4yNzUtMC4yMjUsMC41LTAuNSwwLjVIMTMuNXogTTI5LjUsMjdjLTAuMjc1LDAtMC41LTAuMjI1LTAuNS0wLjV2LTVjMC0wLjI3NSwwLjIyNS0wLjUsMC41LTAuNWg1YzAuMjc1LDAsMC41LDAuMjI1LDAuNSwwLjV2NWMwLDAuMjc1LTAuMjI1LDAuNS0wLjUsMC41SDI5LjV6IE0yMS41LDI3Yy0wLjI3NSwwLTAuNS0wLjIyNS0wLjUtMC41di01YzAtMC4yNzUsMC4yMjUtMC41LDAuNS0wLjVoNWMwLjI3NSwwLDAuNSwwLjIyNSwwLjUsMC41djVjMCwwLjI3NS0wLjIyNSwwLjUtMC41LDAuNUgyMS41eiBNMTMuNSwyN2MtMC4yNzUsMC0wLjUtMC4yMjUtMC41LTAuNXYtNWMwLTAuMjc1LDAuMjI1LTAuNSwwLjUtMC41aDVjMC4yNzUsMCwwLjUsMC4yMjUsMC41LDAuNXY1YzAsMC4yNzUtMC4yMjUsMC41LTAuNSwwLjVIMTMuNXogTTI5LjUsMTljLTAuMjc1LDAtMC41LTAuMjI1LTAuNS0wLjV2LTVjMC0wLjI3NSwwLjIyNS0wLjUsMC41LTAuNWg1YzAuMjc1LDAsMC41LDAuMjI1LDAuNSwwLjV2NWMwLDAuMjc1LTAuMjI1LDAuNS0wLjUsMC41SDI5LjV6IE0yMS41LDE5Yy0wLjI3NSwwLTAuNS0wLjIyNS0wLjUtMC41di01YzAtMC4yNzUsMC4yMjUtMC41LDAuNS0wLjVoNWMwLjI3NSwwLDAuNSwwLjIyNSwwLjUsMC41djVjMCwwLjI3NS0wLjIyNSwwLjUtMC41LDAuNUgyMS41eiBNMTMuNSwxOWMtMC4yNzUsMC0wLjUtMC4yMjUtMC41LTAuNXYtNWMwLTAuMjc1LDAuMjI1LTAuNSwwLjUtMC41aDVjMC4yNzUsMCwwLjUsMC4yMjUsMC41LDAuNXY1YzAsMC4yNzUtMC4yMjUsMC41LTAuNSwwLjVIMTMuNXpcIlxuICAgICAgICBdO1xuICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlVG9vbGJhckljb24ocGF0aHMpO1xuICAgIH1cblxuICAgIF9jcmVhdGVHcmlkRmV3ZXJJY29uICgpXG4gICAge1xuICAgICAgICBsZXQgcGF0aHMgPSBbXG4gICAgICAgICAgICBcIk0yNS41LDM1Yy0wLjI3NSwwLTAuNS0wLjIyNS0wLjUtMC41di05YzAtMC4yNzUsMC4yMjUtMC41LDAuNS0wLjVoOWMwLjI3NSwwLDAuNSwwLjIyNSwwLjUsMC41djljMCwwLjI3NS0wLjIyNSwwLjUtMC41LDAuNUgyNS41eiBNMjIuNSwzNWMwLjI3NSwwLDAuNS0wLjIyNSwwLjUtMC41di05YzAtMC4yNzUtMC4yMjUtMC41LTAuNS0wLjVoLTljLTAuMjc1LDAtMC41LDAuMjI1LTAuNSwwLjV2OWMwLDAuMjc1LDAuMjI1LDAuNSwwLjUsMC41SDIyLjV6IE0zNC41LDIzYzAuMjc1LDAsMC41LTAuMjI1LDAuNS0wLjV2LTljMC0wLjI3NS0wLjIyNS0wLjUtMC41LTAuNWgtOWMtMC4yNzUsMC0wLjUsMC4yMjUtMC41LDAuNXY5YzAsMC4yNzUsMC4yMjUsMC41LDAuNSwwLjVIMzQuNXogTTIyLjUsMjNjMC4yNzUsMCwwLjUtMC4yMjUsMC41LTAuNXYtOWMwLTAuMjc1LTAuMjI1LTAuNS0wLjUtMC41aC05Yy0wLjI3NSwwLTAuNSwwLjIyNS0wLjUsMC41djljMCwwLjI3NSwwLjIyNSwwLjUsMC41LDAuNUgyMi41elwiXG4gICAgICAgIF07XG4gICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVUb29sYmFySWNvbihwYXRocyk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUdyaWRWaWV3SWNvbiAoKVxuICAgIHtcbiAgICAgICAgbGV0IHBhdGhzID0gW1xuICAgICAgICAgICAgXCJNMjkuNSwzNWMtMC4yNzUsMC0wLjUtMC4yMjUtMC41LTAuNXYtNWMwLTAuMjc1LDAuMjI1LTAuNSwwLjUtMC41aDVjMC4yNzUsMCwwLjUsMC4yMjUsMC41LDAuNXY1YzAsMC4yNzUtMC4yMjUsMC41LTAuNSwwLjVIMjkuNXogTTIxLjUsMzVjLTAuMjc1LDAtMC41LTAuMjI1LTAuNS0wLjV2LTVjMC0wLjI3NSwwLjIyNS0wLjUsMC41LTAuNWg1YzAuMjc1LDAsMC41LDAuMjI1LDAuNSwwLjV2NWMwLDAuMjc1LTAuMjI1LDAuNS0wLjUsMC41SDIxLjV6IE0xMy41LDM1Yy0wLjI3NSwwLTAuNS0wLjIyNS0wLjUtMC41di01YzAtMC4yNzUsMC4yMjUtMC41LDAuNS0wLjVoNWMwLjI3NSwwLDAuNSwwLjIyNSwwLjUsMC41djVjMCwwLjI3NS0wLjIyNSwwLjUtMC41LDAuNUgxMy41eiBNMjkuNSwyN2MtMC4yNzUsMC0wLjUtMC4yMjUtMC41LTAuNXYtNWMwLTAuMjc1LDAuMjI1LTAuNSwwLjUtMC41aDVjMC4yNzUsMCwwLjUsMC4yMjUsMC41LDAuNXY1YzAsMC4yNzUtMC4yMjUsMC41LTAuNSwwLjVIMjkuNXogTTIxLjUsMjdjLTAuMjc1LDAtMC41LTAuMjI1LTAuNS0wLjV2LTVjMC0wLjI3NSwwLjIyNS0wLjUsMC41LTAuNWg1YzAuMjc1LDAsMC41LDAuMjI1LDAuNSwwLjV2NWMwLDAuMjc1LTAuMjI1LDAuNS0wLjUsMC41SDIxLjV6IE0xMy41LDI3Yy0wLjI3NSwwLTAuNS0wLjIyNS0wLjUtMC41di01YzAtMC4yNzUsMC4yMjUtMC41LDAuNS0wLjVoNWMwLjI3NSwwLDAuNSwwLjIyNSwwLjUsMC41djVjMCwwLjI3NS0wLjIyNSwwLjUtMC41LDAuNUgxMy41eiBNMjkuNSwxOWMtMC4yNzUsMC0wLjUtMC4yMjUtMC41LTAuNXYtNWMwLTAuMjc1LDAuMjI1LTAuNSwwLjUtMC41aDVjMC4yNzUsMCwwLjUsMC4yMjUsMC41LDAuNXY1YzAsMC4yNzUtMC4yMjUsMC41LTAuNSwwLjVIMjkuNXogTTIxLjUsMTljLTAuMjc1LDAtMC41LTAuMjI1LTAuNS0wLjV2LTVjMC0wLjI3NSwwLjIyNS0wLjUsMC41LTAuNWg1YzAuMjc1LDAsMC41LDAuMjI1LDAuNSwwLjV2NWMwLDAuMjc1LTAuMjI1LDAuNS0wLjUsMC41SDIxLjV6IE0xMy41LDE5Yy0wLjI3NSwwLTAuNS0wLjIyNS0wLjUtMC41di01YzAtMC4yNzUsMC4yMjUtMC41LDAuNS0wLjVoNWMwLjI3NSwwLDAuNSwwLjIyNSwwLjUsMC41djVjMCwwLjI3NS0wLjIyNSwwLjUtMC41LDAuNUgxMy41elwiXG4gICAgICAgIF07XG4gICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVUb29sYmFySWNvbihwYXRocyk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUJvb2tWaWV3SWNvbiAoKVxuICAgIHtcbiAgICAgICAgbGV0IHBhdGhzID0gW1xuICAgICAgICAgICAgXCJNMzUsMTYuOHYtMS4zMjNjMCwwLTIuMjkyLTEuMzI4LTUuNzQtMS4zMjhjLTMuNDQ4LDAtNS4yNiwxLjI1LTUuMjYsMS4yNXMtMS44MTMtMS4yNS01LjI2LTEuMjVjLTMuNDQ4LDAtNS43NCwxLjMyOC01Ljc0LDEuMzI4VjE2LjhsLTEsMC41MzF2MC4wMjF2MTUuNjg3YzAsMCw0LjUzMS0xLjU3OCw2Ljk5OS0xLjU3OGMyLjQ2OCwwLDUuMDAxLDAuODg1LDUuMDAxLDAuODg1czIuNTMyLTAuODg1LDUtMC44ODVjMC4zMDYsMCwwLjY0MywwLjAyNCwxLDAuMDY2djQuMzI1bDEuNTMxLTIuMDE2TDMzLDM1Ljg1MnYtMy43MmMyLDAuNDMsMywwLjkwNiwzLDAuOTA2VjE3LjM1MnYtMC4wMjFMMzUsMTYuOHogTTIzLDI5LjAzYy0xLTAuMjkyLTIuNTg0LTAuNjc5LTMuOTgxLTAuNjc5Yy0yLjI0NiwwLTMuMDE5LDAuNDA0LTQuMDE5LDAuNjk5VjE2LjYzNGMwLDAsMS4xMjUtMC42OTksNC4wMTktMC42OTljMS42OTQsMCwyLjk4MSwwLjQxNywzLjk4MSwxLjEyNlYyOS4wM3ogTTMzLDI5LjA1MWMtMS0wLjI5NS0xLjc3My0wLjY5OS00LjAyLTAuNjk5Yy0xLjM5NiwwLTIuOTgxLDAuMzg3LTMuOTgsMC42NzlWMTcuMDZjMS0wLjcwOSwyLjI4Ni0xLjEyNiwzLjk4LTEuMTI2YzIuODk1LDAsNC4wMiwwLjY5OSw0LjAyLDAuNjk5VjI5LjA1MXpcIlxuICAgICAgICBdO1xuICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlVG9vbGJhckljb24ocGF0aHMpO1xuICAgIH1cblxuICAgIF9jcmVhdGVQYWdlVmlld0ljb24gKClcbiAgICB7XG4gICAgICAgIGxldCBwYXRocyA9IFtcbiAgICAgICAgICAgIFwiTTI5LjQyNSwyOWg0LjQ3TDI5LDMzLjkzNHYtNC40N0MyOSwyOS4xOSwyOS4xNTEsMjksMjkuNDI1LDI5eiBNMzQsMTQuNTYzVjI4aC01LjU2OUMyOC4xNTcsMjgsMjgsMjguMTk2LDI4LDI4LjQ3VjM0SDE0LjQ5N0MxNC4yMjMsMzQsMTQsMzMuNzEsMTQsMzMuNDM3VjE0LjU2M0MxNCwxNC4yOSwxNC4yMjMsMTQsMTQuNDk3LDE0aDE4LjlDMzMuNjcyLDE0LDM0LDE0LjI5LDM0LDE0LjU2M3ogTTI1LjQ5NywyNi40OTdDMjUuNDk3LDI2LjIyMywyNS4yNzUsMjYsMjUsMjZoLTdjLTAuMjc1LDAtMC40OTcsMC4yMjMtMC40OTcsMC40OTd2MS4wMDZDMTcuNTAzLDI3Ljc3NywxNy43MjUsMjgsMTgsMjhoN2MwLjI3NSwwLDAuNDk3LTAuMjIzLDAuNDk3LTAuNDk3VjI2LjQ5N3ogTTMwLjQ5NywyMi40OTdDMzAuNDk3LDIyLjIyMywzMC4yNzUsMjIsMzAsMjJIMThjLTAuMjc1LDAtMC40OTcsMC4yMjMtMC40OTcsMC40OTd2MS4wMDZDMTcuNTAzLDIzLjc3NywxNy43MjUsMjQsMTgsMjRoMTJjMC4yNzUsMCwwLjQ5Ny0wLjIyMywwLjQ5Ny0wLjQ5N1YyMi40OTd6IE0zMC40OTcsMTguNDk3QzMwLjQ5NywxOC4yMjMsMzAuMjc1LDE4LDMwLDE4SDE4Yy0wLjI3NSwwLTAuNDk3LDAuMjIzLTAuNDk3LDAuNDk3djEuMDA2QzE3LjUwMywxOS43NzcsMTcuNzI1LDIwLDE4LDIwaDEyYzAuMjc1LDAsMC40OTctMC4yMjMsMC40OTctMC40OTdWMTguNDk3elwiXG4gICAgICAgIF07XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZVRvb2xiYXJJY29uKHBhdGhzKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlRnVsbHNjcmVlbkljb24gKClcbiAgICB7XG4gICAgICAgIGxldCBwYXRocyA9IFtcbiAgICAgICAgICAgIFwiTTM1LDEySDEzYy0wLjU1LDAtMSwwLjQ1LTEsMXYyMmMwLDAuNTUsMC40NSwxLDEsMWgyMmMwLjU1LDAsMS0wLjQ1LDEtMVYxM0MzNiwxMi40NSwzNS41NSwxMiwzNSwxMnogTTM0LDM0SDE0VjE0aDIwVjM0elwiLFxuICAgICAgICAgICAgXCJNMTcsMjEuNzV2LTQuNWMwLTAuMTM4LDAuMTEyLTAuMjUsMC4yNS0wLjI1aDQuNWMwLjEzOCwwLDAuMTcsMC4wOCwwLjA3MywwLjE3N2wtMS42MTYsMS42MTZsMS44MjMsMS44MjNjMC4wOTcsMC4wOTcsMC4wOTcsMC4yNTYsMCwwLjM1NGwtMS4wNjEsMS4wNmMtMC4wOTcsMC4wOTctMC4yNTYsMC4wOTctMC4zNTQsMGwtMS44MjMtMS44MjNsLTEuNjE2LDEuNjE2QzE3LjA4LDIxLjkyLDE3LDIxLjg4OCwxNywyMS43NXogTTIwLjk3LDI1Ljk3Yy0wLjA5Ny0wLjA5Ny0wLjI1Ni0wLjA5Ny0wLjM1NCwwbC0xLjgyMywxLjgyM2wtMS42MTYtMS42MTZDMTcuMDgsMjYuMDgsMTcsMjYuMTEyLDE3LDI2LjI1djQuNWMwLDAuMTM4LDAuMTEyLDAuMjUsMC4yNSwwLjI1aDQuNWMwLjEzOCwwLDAuMTctMC4wOCwwLjA3My0wLjE3N2wtMS42MTYtMS42MTZsMS44MjMtMS44MjNjMC4wOTctMC4wOTcsMC4wOTctMC4yNTYsMC0wLjM1NEwyMC45NywyNS45N3ogTTMwLjc1LDE3aC00LjVjLTAuMTM4LDAtMC4xNywwLjA4LTAuMDczLDAuMTc3bDEuNjE2LDEuNjE2bC0xLjgyMywxLjgyM2MtMC4wOTcsMC4wOTctMC4wOTcsMC4yNTYsMCwwLjM1NGwxLjA2MSwxLjA2YzAuMDk3LDAuMDk3LDAuMjU2LDAuMDk3LDAuMzU0LDBsMS44MjMtMS44MjNsMS42MTYsMS42MTZDMzAuOTIsMjEuOTIsMzEsMjEuODg4LDMxLDIxLjc1di00LjVDMzEsMTcuMTEyLDMwLjg4OCwxNywzMC43NSwxN3ogTTMwLjgyMywyNi4xNzdsLTEuNjE2LDEuNjE2bC0xLjgyMy0xLjgyM2MtMC4wOTctMC4wOTctMC4yNTYtMC4wOTctMC4zNTQsMGwtMS4wNjEsMS4wNmMtMC4wOTcsMC4wOTctMC4wOTcsMC4yNTYsMCwwLjM1NGwxLjgyMywxLjgyM2wtMS42MTYsMS42MTZDMjYuMDgsMzAuOTIsMjYuMTEyLDMxLDI2LjI1LDMxaDQuNWMwLjEzOCwwLDAuMjUtMC4xMTIsMC4yNS0wLjI1di00LjVDMzEsMjYuMTEyLDMwLjkyLDI2LjA4LDMwLjgyMywyNi4xNzd6IE0yNiwyMi41YzAtMC4yNzUtMC4yMjUtMC41LTAuNS0wLjVoLTNjLTAuMjc1LDAtMC41LDAuMjI1LTAuNSwwLjV2M2MwLDAuMjc1LDAuMjI1LDAuNSwwLjUsMC41aDNjMC4yNzUsMCwwLjUtMC4yMjUsMC41LTAuNVYyMi41elwiXG4gICAgICAgIF07XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZVRvb2xiYXJJY29uKHBhdGhzKTtcbiAgICB9XG5cblxufVxuXG5cbi8vIGV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZVRvb2xiYXIgKHZpZXdlcilcbi8vIHtcbi8vICAgICBjb25zdCBzZXR0aW5ncyA9IHZpZXdlci5nZXRTZXR0aW5ncygpO1xuLy9cbi8vICAgICAvLyBGSVhNRSh3YWJhaW4pOiBUZW1wb3JhcmlseSBjb3BpZWQgZnJvbSB3aXRoaW4gRGl2YVxuLy8gICAgIGNvbnN0IGVsZW1BdHRycyA9IChpZGVudCwgYmFzZSkgPT4ge1xuLy8gICAgICAgICBjb25zdCBhdHRycyA9IHtcbi8vICAgICAgICAgICAgIGlkOiBzZXR0aW5ncy5JRCArIGlkZW50LFxuLy8gICAgICAgICAgICAgY2xhc3M6ICdkaXZhLScgKyBpZGVudFxuLy8gICAgICAgICB9O1xuLy9cbi8vICAgICAgICAgaWYgKGJhc2UpXG4vLyAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihhdHRycywgYmFzZSk7XG4vLyAgICAgICAgIGVsc2Vcbi8vICAgICAgICAgICAgIHJldHVybiBhdHRycztcbi8vICAgICB9O1xuLy9cbi8vICAgICAvKiogQ29udmVuaWVuY2UgZnVuY3Rpb24gdG8gc3Vic2NyaWJlIHRvIGEgRGl2YSBldmVudCAqL1xuLy8gICAgIGNvbnN0IHN1YnNjcmliZSA9IChldmVudCwgY2FsbGJhY2spID0+IHtcbi8vICAgICAgICAgZGl2YS5FdmVudHMuc3Vic2NyaWJlKGV2ZW50LCBjYWxsYmFjaywgc2V0dGluZ3MuSUQpO1xuLy8gICAgIH07XG4vL1xuLy8gICAgIC8vIENyZWF0ZXMgYSB0b29sYmFyIGJ1dHRvblxuLy8gICAgIGNvbnN0IGNyZWF0ZUJ1dHRvbkVsZW1lbnQgPSAobmFtZSwgbGFiZWwsIGNhbGxiYWNrKSA9PiB7XG4vLyAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGVsdCgnYnV0dG9uJywge1xuLy8gICAgICAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4vLyAgICAgICAgICAgICBpZDogc2V0dGluZ3MuSUQgKyBuYW1lLFxuLy8gICAgICAgICAgICAgY2xhc3M6ICdkaXZhLScgKyBuYW1lICsgJyBkaXZhLWJ1dHRvbicsXG4vLyAgICAgICAgICAgICB0aXRsZTogbGFiZWxcbi8vICAgICAgICAgfSk7XG4vL1xuLy8gICAgICAgICBpZiAoY2FsbGJhY2spXG4vLyAgICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjYWxsYmFjaywgZmFsc2UpO1xuLy9cbi8vICAgICAgICAgcmV0dXJuIGJ1dHRvbjtcbi8vICAgICB9O1xuLy9cbi8vICAgICAvLyBIaWdoZXItbGV2ZWwgZnVuY3Rpb24gZm9yIGNyZWF0b3JzIG9mIHpvb20gYW5kIGdyaWQgY29udHJvbHNcbi8vICAgICBjb25zdCBnZXRSZXNvbHV0aW9uQ29udHJvbENyZWF0b3IgPSBjb25maWcgPT4gKCkgPT4ge1xuLy8gICAgICAgICBsZXQgY29udHJvbHM7XG4vL1xuLy8gICAgICAgICBzd2l0Y2ggKHNldHRpbmdzW2NvbmZpZy5jb250cm9sbGVyU2V0dGluZ10pXG4vLyAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGNhc2UgJ3NsaWRlcic6XG4vLyAgICAgICAgICAgICAgICAgY29udHJvbHMgPSBjb25maWcuY3JlYXRlU2xpZGVyKCk7XG4vLyAgICAgICAgICAgICAgICAgYnJlYWs7XG4vL1xuLy8gICAgICAgICAgICAgY2FzZSAnYnV0dG9ucyc6XG4vLyAgICAgICAgICAgICAgICAgY29udHJvbHMgPSBjb25maWcuY3JlYXRlQnV0dG9ucygpO1xuLy8gICAgICAgICAgICAgICAgIGJyZWFrO1xuLy9cbi8vICAgICAgICAgICAgIGRlZmF1bHQ6XG4vLyAgICAgICAgICAgICAgICAgLy8gRG9uJ3QgZGlzcGxheSBhbnl0aGluZ1xuLy8gICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuLy8gICAgICAgICB9XG4vL1xuLy8gICAgICAgICBjb25zdCB3cmFwcGVyID0gZWx0KCdzcGFuJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xzLFxuLy8gICAgICAgICAgICAgY29uZmlnLmNyZWF0ZUxhYmVsKClcbi8vICAgICAgICAgKTtcbi8vXG4vLyAgICAgICAgIGNvbnN0IHVwZGF0ZVdyYXBwZXIgPSAoKSA9PiB7XG4vLyAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuaW5HcmlkID09PSBjb25maWcuc2hvd0luR3JpZClcbi8vICAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJztcbi8vICAgICAgICAgICAgIGVsc2Vcbi8vICAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4vLyAgICAgICAgIH07XG4vL1xuLy8gICAgICAgICBzdWJzY3JpYmUoJ1ZpZXdEaWRTd2l0Y2gnLCB1cGRhdGVXcmFwcGVyKTtcbi8vICAgICAgICAgc3Vic2NyaWJlKCdPYmplY3REaWRMb2FkJywgdXBkYXRlV3JhcHBlcik7XG4vL1xuLy8gICAgICAgICAvLyBTZXQgaW5pdGlhbCB2YWx1ZVxuLy8gICAgICAgICB1cGRhdGVXcmFwcGVyKCk7XG4vL1xuLy8gICAgICAgICByZXR1cm4gd3JhcHBlcjtcbi8vICAgICB9O1xuLy9cbi8vICAgICAvLyBab29tIGNvbnRyb2xzXG4vLyAgICAgY29uc3QgY3JlYXRlWm9vbUNvbnRyb2xzID0gZ2V0UmVzb2x1dGlvbkNvbnRyb2xDcmVhdG9yKHtcbi8vICAgICAgICAgY29udHJvbGxlclNldHRpbmc6ICdlbmFibGVab29tQ29udHJvbHMnLFxuLy8gICAgICAgICBzaG93SW5HcmlkOiBmYWxzZSxcbi8vXG4vLyAgICAgICAgIGNyZWF0ZVNsaWRlcjogZnVuY3Rpb24gKClcbi8vICAgICAgICAge1xuLy8gICAgICAgICAgICAgY29uc3QgZWxlbSA9IGNyZWF0ZVNsaWRlcignem9vbS1zbGlkZXInLCB7XG4vLyAgICAgICAgICAgICAgICAgc3RlcDogMC4xLFxuLy8gICAgICAgICAgICAgICAgIHZhbHVlOiBzZXR0aW5ncy56b29tTGV2ZWwsXG4vLyAgICAgICAgICAgICAgICAgbWluOiBzZXR0aW5ncy5taW5ab29tTGV2ZWwsXG4vLyAgICAgICAgICAgICAgICAgbWF4OiBzZXR0aW5ncy5tYXhab29tTGV2ZWxcbi8vICAgICAgICAgICAgIH0pO1xuLy9cbi8vICAgICAgICAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PlxuLy8gICAgICAgICAgICAge1xuLy8gICAgICAgICAgICAgICAgIGNvbnN0IGZsb2F0VmFsdWUgPSBwYXJzZUZsb2F0KHRoaXMudmFsdWUpO1xuLy8gICAgICAgICAgICAgICAgIHZpZXdlci5zZXRab29tTGV2ZWwoZmxvYXRWYWx1ZSk7XG4vLyAgICAgICAgICAgICB9KTtcbi8vXG4vLyAgICAgICAgICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+XG4vLyAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgICAgY29uc3QgZmxvYXRWYWx1ZSA9IHBhcnNlRmxvYXQodGhpcy52YWx1ZSk7XG4vLyAgICAgICAgICAgICAgICAgaWYgKGZsb2F0VmFsdWUgIT09IHNldHRpbmdzLnpvb21MZXZlbClcbi8vICAgICAgICAgICAgICAgICAgICAgdmlld2VyLnNldFpvb21MZXZlbChmbG9hdFZhbHVlKTtcbi8vICAgICAgICAgICAgIH0pO1xuLy9cbi8vICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZVNsaWRlciA9ICgpID0+IHtcbi8vICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3Muem9vbUxldmVsICE9PSAkZWxlbS52YWwoKSlcbi8vICAgICAgICAgICAgICAgICAgICAgJGVsZW0udmFsKHNldHRpbmdzLnpvb21MZXZlbCk7XG4vLyAgICAgICAgICAgICB9O1xuLy9cbi8vICAgICAgICAgICAgIHN1YnNjcmliZSgnWm9vbUxldmVsRGlkQ2hhbmdlJywgdXBkYXRlU2xpZGVyKTtcbi8vICAgICAgICAgICAgIHN1YnNjcmliZSgnVmlld2VyRGlkTG9hZCcsICgpID0+IHtcbi8vICAgICAgICAgICAgICAgICBlbHQuc2V0QXR0cmlidXRlcyhlbGVtLCB7XG4vLyAgICAgICAgICAgICAgICAgICAgIG1pbjogc2V0dGluZ3MubWluWm9vbUxldmVsLFxuLy8gICAgICAgICAgICAgICAgICAgICBtYXg6IHNldHRpbmdzLm1heFpvb21MZXZlbFxuLy8gICAgICAgICAgICAgICAgIH0pO1xuLy9cbi8vICAgICAgICAgICAgICAgICB1cGRhdGVTbGlkZXIoKTtcbi8vICAgICAgICAgICAgIH0pO1xuLy9cbi8vICAgICAgICAgICAgIHJldHVybiBlbGVtO1xuLy8gICAgICAgICB9LFxuLy9cbi8vICAgICAgICAgY3JlYXRlQnV0dG9uczogZnVuY3Rpb24gKClcbi8vICAgICAgICAge1xuLy8gICAgICAgICAgICAgcmV0dXJuIGVsdCgnc3BhbicsXG4vLyAgICAgICAgICAgICAgICAgY3JlYXRlQnV0dG9uRWxlbWVudCgnem9vbS1vdXQtYnV0dG9uJywgJ1pvb20gT3V0JywgKCkgPT4ge1xuLy8gICAgICAgICAgICAgICAgICAgICB2aWV3ZXIuc2V0Wm9vbUxldmVsKHNldHRpbmdzLnpvb21MZXZlbCAtIDEpO1xuLy8gICAgICAgICAgICAgICAgIH0pLFxuLy8gICAgICAgICAgICAgICAgIGNyZWF0ZUJ1dHRvbkVsZW1lbnQoJ3pvb20taW4tYnV0dG9uJywgJ1pvb20gSW4nLCAoKSA9PiB7XG4vLyAgICAgICAgICAgICAgICAgICAgIHZpZXdlci5zZXRab29tTGV2ZWwoc2V0dGluZ3Muem9vbUxldmVsICsgMSk7XG4vLyAgICAgICAgICAgICAgICAgfSlcbi8vICAgICAgICAgICAgICk7XG4vLyAgICAgICAgIH0sXG4vL1xuLy8gICAgICAgICBjcmVhdGVMYWJlbDogZnVuY3Rpb24gKClcbi8vICAgICAgICAge1xuLy8gICAgICAgICAgICAgY29uc3QgZWxlbSA9IGNyZWF0ZUxhYmVsKCdkaXZhLXpvb20tbGFiZWwnLCAnem9vbS1sYWJlbCcsICdab29tIGxldmVsOiAnLCAnem9vbS1sZXZlbCcsIHNldHRpbmdzLnpvb21MZXZlbCk7XG4vLyAgICAgICAgICAgICBjb25zdCB0ZXh0U3BhbiA9ICQoZWxlbSkuZmluZChzZXR0aW5ncy5zZWxlY3RvciArICd6b29tLWxldmVsJylbMF07XG4vL1xuLy8gICAgICAgICAgICAgY29uc3QgdXBkYXRlVGV4dCA9ICgpID0+IHtcbi8vICAgICAgICAgICAgICAgICB0ZXh0U3Bhbi50ZXh0Q29udGVudCA9IHNldHRpbmdzLnpvb21MZXZlbC50b0ZpeGVkKDIpO1xuLy8gICAgICAgICAgICAgfTtcbi8vXG4vLyAgICAgICAgICAgICBzdWJzY3JpYmUoJ1pvb21MZXZlbERpZENoYW5nZScsIHVwZGF0ZVRleHQpO1xuLy8gICAgICAgICAgICAgc3Vic2NyaWJlKCdWaWV3ZXJEaWRMb2FkJywgdXBkYXRlVGV4dCk7XG4vL1xuLy8gICAgICAgICAgICAgcmV0dXJuIGVsZW07XG4vLyAgICAgICAgIH1cbi8vICAgICB9KTtcbi8vXG4vLyAgICAgLy8gR3JpZCBjb250cm9sc1xuLy8gICAgIGNvbnN0IGNyZWF0ZUdyaWRDb250cm9scyA9IGdldFJlc29sdXRpb25Db250cm9sQ3JlYXRvcih7XG4vLyAgICAgICAgIGNvbnRyb2xsZXJTZXR0aW5nOiAnZW5hYmxlR3JpZENvbnRyb2xzJyxcbi8vICAgICAgICAgc2hvd0luR3JpZDogdHJ1ZSxcbi8vXG4vLyAgICAgICAgIGNyZWF0ZVNsaWRlcjogZnVuY3Rpb24gKClcbi8vICAgICAgICAge1xuLy8gICAgICAgICAgICAgY29uc3QgZWxlbSA9IGNyZWF0ZVNsaWRlcignZ3JpZC1zbGlkZXInLCB7XG4vLyAgICAgICAgICAgICAgICAgdmFsdWU6IHNldHRpbmdzLnBhZ2VzUGVyUm93LFxuLy8gICAgICAgICAgICAgICAgIG1pbjogc2V0dGluZ3MubWluUGFnZXNQZXJSb3csXG4vLyAgICAgICAgICAgICAgICAgbWF4OiBzZXR0aW5ncy5tYXhQYWdlc1BlclJvd1xuLy8gICAgICAgICAgICAgfSk7XG4vL1xuLy8gICAgICAgICAgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbi8vICAgICAgICAgICAgICAgICBjb25zdCBpbnRWYWx1ZSA9IHBhcnNlSW50KGVsZW0udmFsdWUsIDEwKTtcbi8vICAgICAgICAgICAgICAgICB2aWV3ZXIuc2V0R3JpZFBhZ2VzUGVyUm93KGludFZhbHVlKTtcbi8vICAgICAgICAgICAgIH0pO1xuLy9cbi8vICAgICAgICAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuLy8gICAgICAgICAgICAgICAgIGNvbnN0IGludFZhbHVlID0gcGFyc2VJbnQoZWxlbS52YWx1ZSwgMTApO1xuLy8gICAgICAgICAgICAgICAgIGlmIChpbnRWYWx1ZSAhPT0gc2V0dGluZ3MucGFnZXNQZXJSb3cpXG4vLyAgICAgICAgICAgICAgICAgICAgIHZpZXdlci5zZXRHcmlkUGFnZXNQZXJSb3coaW50VmFsdWUpO1xuLy8gICAgICAgICAgICAgfSk7XG4vL1xuLy8gICAgICAgICAgICAgc3Vic2NyaWJlKCdHcmlkUm93TnVtYmVyRGlkQ2hhbmdlJywgKCkgPT4ge1xuLy8gICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgcG9zaXRpb24gb2YgdGhlIGhhbmRsZSB3aXRoaW4gdGhlIHNsaWRlclxuLy8gICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5wYWdlc1BlclJvdyAhPT0gJGVsZW0udmFsKCkpXG4vLyAgICAgICAgICAgICAgICAgICAgICRlbGVtLnZhbChzZXR0aW5ncy5wYWdlc1BlclJvdyk7XG4vLyAgICAgICAgICAgICB9KTtcbi8vXG4vLyAgICAgICAgICAgICByZXR1cm4gZWxlbTtcbi8vICAgICAgICAgfSxcbi8vXG4vLyAgICAgICAgIGNyZWF0ZUJ1dHRvbnM6IGZ1bmN0aW9uICgpXG4vLyAgICAgICAgIHtcbi8vICAgICAgICAgICAgIHJldHVybiBlbHQoJ3NwYW4nLFxuLy8gICAgICAgICAgICAgICAgIGNyZWF0ZUJ1dHRvbkVsZW1lbnQoJ2dyaWQtb3V0LWJ1dHRvbicsICdab29tIE91dCcsICgpID0+IHtcbi8vICAgICAgICAgICAgICAgICAgICAgdmlld2VyLnNldEdyaWRQYWdlc1BlclJvdyhzZXR0aW5ncy5wYWdlc1BlclJvdyAtIDEpO1xuLy8gICAgICAgICAgICAgICAgIH0pLFxuLy8gICAgICAgICAgICAgICAgIGNyZWF0ZUJ1dHRvbkVsZW1lbnQoJ2dyaWQtaW4tYnV0dG9uJywgJ1pvb20gSW4nLCAoKSA9PiB7XG4vLyAgICAgICAgICAgICAgICAgICAgIHZpZXdlci5zZXRHcmlkUGFnZXNQZXJSb3coc2V0dGluZ3MucGFnZXNQZXJSb3cgKyAxKTtcbi8vICAgICAgICAgICAgICAgICB9KVxuLy8gICAgICAgICAgICAgKTtcbi8vICAgICAgICAgfSxcbi8vXG4vLyAgICAgICAgIGNyZWF0ZUxhYmVsOiBmdW5jdGlvbiAoKVxuLy8gICAgICAgICB7XG4vLyAgICAgICAgICAgICBjb25zdCBlbGVtID0gY3JlYXRlTGFiZWwoJ2RpdmEtZ3JpZC1sYWJlbCcsICdncmlkLWxhYmVsJywgJ1BhZ2VzIHBlciByb3c6ICcsICdwYWdlcy1wZXItcm93Jywgc2V0dGluZ3MucGFnZXNQZXJSb3cpO1xuLy8gICAgICAgICAgICAgY29uc3QgdGV4dFNwYW4gPSAkKGVsZW0pLmZpbmQoc2V0dGluZ3Muc2VsZWN0b3IgKyAncGFnZXMtcGVyLXJvdycpWzBdO1xuLy9cbi8vICAgICAgICAgICAgIHN1YnNjcmliZSgnR3JpZFJvd051bWJlckRpZENoYW5nZScsICgpID0+IHtcbi8vICAgICAgICAgICAgICAgICB0ZXh0U3Bhbi50ZXh0Q29udGVudCA9IHNldHRpbmdzLnBhZ2VzUGVyUm93O1xuLy8gICAgICAgICAgICAgfSk7XG4vL1xuLy8gICAgICAgICAgICAgcmV0dXJuIGVsZW07XG4vLyAgICAgICAgIH1cbi8vICAgICB9KTtcbi8vXG4vLyAgICAgY29uc3QgY3JlYXRlVmlld01lbnUgPSAoKSA9PiB7XG4vLyAgICAgICAgIGNvbnN0IHZpZXdPcHRpb25zTGlzdCA9IGVsdCgnZGl2JywgZWxlbUF0dHJzKCd2aWV3LW9wdGlvbnMnKSk7XG4vL1xuLy8gICAgICAgICBjb25zdCBjaGFuZ2VWaWV3QnV0dG9uID0gY3JlYXRlQnV0dG9uRWxlbWVudCgndmlldy1pY29uJywgJ0NoYW5nZSB2aWV3JywgKCkgPT4ge1xuLy8gICAgICAgICAgICAgJCh2aWV3T3B0aW9uc0xpc3QpLnRvZ2dsZSgpO1xuLy8gICAgICAgICB9KTtcbi8vXG4vLyAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBldmVudCA9PiB7XG4vLyAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSAkKHZpZXdPcHRpb25zTGlzdCk7XG4vL1xuLy8gICAgICAgICAgICAgaWYgKCFjb250YWluZXIuaXMoZXZlbnQudGFyZ2V0KSAmJiBjb250YWluZXIuaGFzKGV2ZW50LnRhcmdldCkubGVuZ3RoID09PSAwICYmIGV2ZW50LnRhcmdldC5pZCAhPT0gc2V0dGluZ3MuSUQgKyAndmlldy1pY29uJylcbi8vICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICBjb250YWluZXIuaGlkZSgpO1xuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICB9KTtcbi8vXG4vLyAgICAgICAgIGNvbnN0IHNlbGVjdFZpZXcgPSB2aWV3ID0+IHtcbi8vICAgICAgICAgICAgIHZpZXdlci5jaGFuZ2VWaWV3KHZpZXcpO1xuLy9cbi8vICAgICAgICAgICAgIC8vaGlkZSB2aWV3IG1lbnVcbi8vICAgICAgICAgICAgICQodmlld09wdGlvbnNMaXN0KS5oaWRlKCk7XG4vLyAgICAgICAgIH07XG4vL1xuLy8gICAgICAgICBjb25zdCB1cGRhdGVWaWV3TWVudSA9ICgpID0+IHtcbi8vICAgICAgICAgICAgIGNvbnN0IHZpZXdJY29uQ2xhc3NlcyA9ICcgZGl2YS12aWV3LWljb24gZGl2YS1idXR0b24nO1xuLy9cbi8vICAgICAgICAgICAgIC8vIGRpc3BsYXkgdGhlIGljb24gb2YgdGhlIG1vZGUgd2UncmUgY3VycmVudGx5IGluICg/KVxuLy8gICAgICAgICAgICAgaWYgKHNldHRpbmdzLmluR3JpZClcbi8vICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICBjaGFuZ2VWaWV3QnV0dG9uLmNsYXNzTmFtZSA9ICdkaXZhLWdyaWQtaWNvbicgKyB2aWV3SWNvbkNsYXNzZXM7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICBlbHNlIGlmIChzZXR0aW5ncy5pbkJvb2tMYXlvdXQpXG4vLyAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgICAgY2hhbmdlVmlld0J1dHRvbi5jbGFzc05hbWUgPSAnZGl2YS1ib29rLWljb24nICsgdmlld0ljb25DbGFzc2VzO1xuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgZWxzZVxuLy8gICAgICAgICAgICAge1xuLy8gICAgICAgICAgICAgICAgIGNoYW5nZVZpZXdCdXR0b24uY2xhc3NOYW1lID0gJ2RpdmEtZG9jdW1lbnQtaWNvbicgKyB2aWV3SWNvbkNsYXNzZXM7XG4vLyAgICAgICAgICAgICB9XG4vL1xuLy8gICAgICAgICAgICAgY29uc3Qgdmlld09wdGlvbnMgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4vL1xuLy8gICAgICAgICAgICAgLy8gdGhlbiBkaXNwbGF5IGRvY3VtZW50LCBib29rLCBhbmQgZ3JpZCBidXR0b25zIGluIHRoYXQgb3JkZXIsIGV4Y2x1ZGluZyB0aGUgY3VycmVudCB2aWV3XG4vLyAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuaW5HcmlkIHx8IHNldHRpbmdzLmluQm9va0xheW91dClcbi8vICAgICAgICAgICAgICAgICB2aWV3T3B0aW9ucy5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b25FbGVtZW50KCdkb2N1bWVudC1pY29uJywgJ0RvY3VtZW50IFZpZXcnLCBzZWxlY3RWaWV3LmJpbmQobnVsbCwgJ2RvY3VtZW50JykpKTtcbi8vXG4vLyAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuaW5HcmlkIHx8ICFzZXR0aW5ncy5pbkJvb2tMYXlvdXQpXG4vLyAgICAgICAgICAgICAgICAgdmlld09wdGlvbnMuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uRWxlbWVudCgnYm9vay1pY29uJywgJ0Jvb2sgVmlldycsIHNlbGVjdFZpZXcuYmluZChudWxsLCAnYm9vaycpKSk7XG4vL1xuLy8gICAgICAgICAgICAgaWYgKCFzZXR0aW5ncy5pbkdyaWQpXG4vLyAgICAgICAgICAgICAgICAgdmlld09wdGlvbnMuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uRWxlbWVudCgnZ3JpZC1pY29uJywgJ0dyaWQgVmlldycsIHNlbGVjdFZpZXcuYmluZChudWxsLCAnZ3JpZCcpKSk7XG4vL1xuLy8gICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBtZW51XG4vLyAgICAgICAgICAgICB3aGlsZSAodmlld09wdGlvbnNMaXN0LmZpcnN0Q2hpbGQpXG4vLyAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgICAgdmlld09wdGlvbnNMaXN0LnJlbW92ZUNoaWxkKHZpZXdPcHRpb25zTGlzdC5maXJzdENoaWxkKTtcbi8vICAgICAgICAgICAgIH1cbi8vXG4vLyAgICAgICAgICAgICAvLyBpbnNlcnQgbmV3IG1lbnVcbi8vICAgICAgICAgICAgIHZpZXdPcHRpb25zTGlzdC5hcHBlbmRDaGlsZCh2aWV3T3B0aW9ucyk7XG4vLyAgICAgICAgIH07XG4vL1xuLy8gICAgICAgICBzdWJzY3JpYmUoJ1ZpZXdEaWRTd2l0Y2gnLCB1cGRhdGVWaWV3TWVudSk7XG4vLyAgICAgICAgIHN1YnNjcmliZSgnT2JqZWN0RGlkTG9hZCcsIHVwZGF0ZVZpZXdNZW51KTtcbi8vXG4vLyAgICAgICAgIHJldHVybiBlbHQoJ2RpdicsIGVsZW1BdHRycygndmlldy1tZW51JyksXG4vLyAgICAgICAgICAgICBjaGFuZ2VWaWV3QnV0dG9uLFxuLy8gICAgICAgICAgICAgdmlld09wdGlvbnNMaXN0XG4vLyAgICAgICAgICk7XG4vLyAgICAgfTtcbi8vXG4vLyAgICAgY29uc3QgY3JlYXRlU2xpZGVyID0gKG5hbWUsIG9wdGlvbnMpID0+IGVsdCgnaW5wdXQnLCBvcHRpb25zLCB7XG4vLyAgICAgICAgIGlkOiBzZXR0aW5ncy5JRCArIG5hbWUsXG4vLyAgICAgICAgIGNsYXNzOiAnZGl2YS0nICsgbmFtZSArICcgZGl2YS1zbGlkZXInLFxuLy8gICAgICAgICB0eXBlOiAncmFuZ2UnXG4vLyAgICAgfSk7XG4vL1xuLy8gICAgIGNvbnN0IGNyZWF0ZUxhYmVsID0gKG5hbWUsIGlkLCBsYWJlbCwgaW5uZXJOYW1lLCBpbm5lclZhbHVlKSA9PiBlbHQoJ2RpdicsIHtcbi8vICAgICAgICAgICAgIGlkOiBzZXR0aW5ncy5JRCArIGlkLFxuLy8gICAgICAgICAgICAgY2xhc3M6IG5hbWUgKyAnIGRpdmEtbGFiZWwnXG4vLyAgICAgICAgIH0sXG4vLyAgICAgICAgIFtcbi8vICAgICAgICAgICAgIGxhYmVsLFxuLy8gICAgICAgICAgICAgZWx0KCdzcGFuJywge1xuLy8gICAgICAgICAgICAgICAgIGlkOiBzZXR0aW5ncy5JRCArIGlubmVyTmFtZVxuLy8gICAgICAgICAgICAgfSwgaW5uZXJWYWx1ZSlcbi8vICAgICAgICAgXSk7XG4vL1xuLy8gICAgIGNvbnN0IGNyZWF0ZVBhZ2VOYXZpZ2F0aW9uQ29udHJvbHMgPSAoKSA9PiB7XG4vLyAgICAgICAgIC8vIEdvIHRvIHBhZ2UgZm9ybVxuLy8gICAgICAgICBjb25zdCBnb3RvRm9ybSA9IHNldHRpbmdzLmVuYWJsZUdvdG9QYWdlID8gY3JlYXRlR290b1BhZ2VGb3JtKCkgOiBudWxsO1xuLy9cbi8vICAgICAgICAgcmV0dXJuIGVsdCgnc3BhbicsIGVsZW1BdHRycygncGFnZS1uYXYnKSxcbi8vICAgICAgICAgICAgIGNyZWF0ZVBhZ2VMYWJlbCgpLCAvLyAnUGFnZSB4IG9mIHknIGxhYmVsXG4vLyAgICAgICAgICAgICBnb3RvRm9ybVxuLy8gICAgICAgICApO1xuLy8gICAgIH07XG4vL1xuLy8gICAgIGNvbnN0IGNyZWF0ZUdvdG9QYWdlRm9ybSA9ICgpID0+IHtcbi8vICAgICAgICAgY29uc3QgZ290b1BhZ2VJbnB1dCA9IGVsdCgnaW5wdXQnLCB7XG4vLyAgICAgICAgICAgICBpZDogc2V0dGluZ3MuSUQgKyAnZ290by1wYWdlLWlucHV0Jyxcbi8vICAgICAgICAgICAgIGNsYXNzOiAnZGl2YS1pbnB1dCBkaXZhLWdvdG8tcGFnZS1pbnB1dCcsXG4vLyAgICAgICAgICAgICBhdXRvY29tcGxldGU6ICdvZmYnLFxuLy8gICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4vLyAgICAgICAgIH0pO1xuLy9cbi8vICAgICAgICAgY29uc3QgZ290b1BhZ2VTdWJtaXQgPSBlbHQoJ2lucHV0Jywge1xuLy8gICAgICAgICAgICAgaWQ6IHNldHRpbmdzLklEICsgJ2dvdG8tcGFnZS1zdWJtaXQnLFxuLy8gICAgICAgICAgICAgY2xhc3M6ICdkaXZhLWJ1dHRvbiBkaXZhLWJ1dHRvbi10ZXh0Jyxcbi8vICAgICAgICAgICAgIHR5cGU6ICdzdWJtaXQnLFxuLy8gICAgICAgICAgICAgdmFsdWU6ICdHbydcbi8vICAgICAgICAgfSk7XG4vL1xuLy8gICAgICAgICBjb25zdCBpbnB1dFN1Z2dlc3Rpb25zID0gZWx0KCdkaXYnLCB7XG4vLyAgICAgICAgICAgICAgICAgaWQ6IHNldHRpbmdzLklEICsgJ2lucHV0LXN1Z2dlc3Rpb25zJyxcbi8vICAgICAgICAgICAgICAgICBjbGFzczogJ2RpdmEtaW5wdXQtc3VnZ2VzdGlvbnMnXG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgICk7XG4vL1xuLy8gICAgICAgICBjb25zdCBnb3RvRm9ybSA9IGVsdCgnZm9ybScsIHtcbi8vICAgICAgICAgICAgICAgICBpZDogc2V0dGluZ3MuSUQgKyAnZ290by1wYWdlJyxcbi8vICAgICAgICAgICAgICAgICBjbGFzczogJ2RpdmEtZ290by1mb3JtJ1xuLy8gICAgICAgICAgICAgfSxcbi8vICAgICAgICAgICAgIGdvdG9QYWdlSW5wdXQsXG4vLyAgICAgICAgICAgICBnb3RvUGFnZVN1Ym1pdCxcbi8vICAgICAgICAgICAgIGlucHV0U3VnZ2VzdGlvbnNcbi8vICAgICAgICAgKTtcbi8vXG4vLyAgICAgICAgICQoZ290b0Zvcm0pLm9uKCdzdWJtaXQnLCAoKSA9PiB7XG4vLyAgICAgICAgICAgICBjb25zdCBkZXNpcmVkUGFnZUxhYmVsID0gZ290b1BhZ2VJbnB1dC52YWx1ZTtcbi8vXG4vLyAgICAgICAgICAgICBpZiAoc2V0dGluZ3Mub25Hb3RvU3VibWl0ICYmIHR5cGVvZiBzZXR0aW5ncy5vbkdvdG9TdWJtaXQgPT09IFwiZnVuY3Rpb25cIilcbi8vICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICBjb25zdCBwYWdlSW5kZXggPSBzZXR0aW5ncy5vbkdvdG9TdWJtaXQoZGVzaXJlZFBhZ2VMYWJlbCk7XG4vLyAgICAgICAgICAgICAgICAgaWYgKCF2aWV3ZXIuZ290b1BhZ2VCeUluZGV4KHBhZ2VJbmRleCkpXG4vLyAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiTm8gcGFnZSBjb3VsZCBiZSBmb3VuZCB3aXRoIHRoYXQgbGFiZWwgb3IgcGFnZSBudW1iZXJcIik7XG4vL1xuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgZWxzZSAvLyBEZWZhdWx0IGlmIG5vIGZ1bmN0aW9uIGlzIHNwZWNpZmllZCBpbiB0aGUgc2V0dGluZ3Ncbi8vICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICBpZiAoIXZpZXdlci5nb3RvUGFnZUJ5TGFiZWwoZGVzaXJlZFBhZ2VMYWJlbCkpXG4vLyAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiTm8gcGFnZSBjb3VsZCBiZSBmb3VuZCB3aXRoIHRoYXQgbGFiZWwgb3IgcGFnZSBudW1iZXJcIik7XG4vLyAgICAgICAgICAgICB9XG4vL1xuLy8gICAgICAgICAgICAgLy8gSGlkZSB0aGUgc3VnZ2VzdGlvbnNcbi8vICAgICAgICAgICAgIGlucHV0U3VnZ2VzdGlvbnMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbi8vXG4vLyAgICAgICAgICAgICAvLyBQcmV2ZW50IHRoZSBkZWZhdWx0IGFjdGlvbiBvZiByZWxvYWRpbmcgdGhlIHBhZ2Vcbi8vICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbi8vICAgICAgICAgfSk7XG4vL1xuLy8gICAgICAgICAkKGdvdG9QYWdlSW5wdXQpLm9uKCdpbnB1dCBmb2N1cycsICgpID0+IHtcbi8vICAgICAgICAgICAgIGlucHV0U3VnZ2VzdGlvbnMuaW5uZXJIVE1MID0gJyc7IC8vIFJlbW92ZSBhbGwgcHJldmlvdXMgc3VnZ2VzdGlvbnNcbi8vXG4vLyAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGdvdG9QYWdlSW5wdXQudmFsdWU7XG4vLyAgICAgICAgICAgICBsZXQgbnVtU3VnZ2VzdGlvbnMgPSAwO1xuLy8gICAgICAgICAgICAgaWYgKHNldHRpbmdzLmVuYWJsZUdvdG9TdWdnZXN0aW9ucyAmJiB2YWx1ZSlcbi8vICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICBjb25zdCBwYWdlcyA9IHNldHRpbmdzLm1hbmlmZXN0LnBhZ2VzO1xuLy8gICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBwYWdlcy5sZW5ndGg7IGkgPCBsZW4gJiYgbnVtU3VnZ2VzdGlvbnMgPCAxMDsgaSsrKVxuLy8gICAgICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICAgICAgaWYgKHBhZ2VzW2ldLmwudG9Mb3dlckNhc2UoKS5pbmRleE9mKHZhbHVlLnRvTG93ZXJDYXNlKCkpID4gLTEpXG4vLyAgICAgICAgICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0lucHV0U3VnZ2VzdGlvbiA9IGVsdCgnZGl2Jywge1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogJ2RpdmEtaW5wdXQtc3VnZ2VzdGlvbidcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VzW2ldLmxcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4vL1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRTdWdnZXN0aW9ucy5hcHBlbmRDaGlsZChuZXdJbnB1dFN1Z2dlc3Rpb24pO1xuLy9cbi8vICAgICAgICAgICAgICAgICAgICAgICAgIG51bVN1Z2dlc3Rpb25zKys7XG4vLyAgICAgICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgICAgICB9XG4vL1xuLy8gICAgICAgICAgICAgICAgIC8vIFNob3cgbGFiZWwgc3VnZ2VzdGlvbnNcbi8vICAgICAgICAgICAgICAgICBpZiAobnVtU3VnZ2VzdGlvbnMgPiAwKVxuLy8gICAgICAgICAgICAgICAgICAgICBpbnB1dFN1Z2dlc3Rpb25zLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgZWxzZVxuLy8gICAgICAgICAgICAgICAgIGlucHV0U3VnZ2VzdGlvbnMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbi8vICAgICAgICAgfSk7XG4vL1xuLy8gICAgICAgICAkKGdvdG9QYWdlSW5wdXQpLm9uKCdrZXlkb3duJywgZSA9PiB7XG4vLyAgICAgICAgICAgICBsZXQgZWw7XG4vLyAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAxMykgLy8gJ0VudGVyJyBrZXlcbi8vICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICBjb25zdCBhY3RpdmUgPSAkKCcuYWN0aXZlJywgaW5wdXRTdWdnZXN0aW9ucyk7XG4vLyAgICAgICAgICAgICAgICAgaWYgKGFjdGl2ZS5sZW5ndGgpXG4vLyAgICAgICAgICAgICAgICAgICAgIGdvdG9QYWdlSW5wdXQudmFsdWUgPSBhY3RpdmUudGV4dCgpO1xuLy9cbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDM4KSAvLyBVcCBhcnJvdyBrZXlcbi8vICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICBlbCA9ICQoJy5hY3RpdmUnLCBpbnB1dFN1Z2dlc3Rpb25zKTtcbi8vICAgICAgICAgICAgICAgICBjb25zdCBwcmV2RWwgPSBlbC5wcmV2KCk7XG4vLyAgICAgICAgICAgICAgICAgaWYgKHByZXZFbC5sZW5ndGgpXG4vLyAgICAgICAgICAgICAgICAge1xuLy8gICAgICAgICAgICAgICAgICAgICBlbC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4vLyAgICAgICAgICAgICAgICAgICAgIHByZXZFbC5hZGRDbGFzcygnYWN0aXZlJyk7XG4vLyAgICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgICAgIGVsc2Vcbi8vICAgICAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgICAgICAgIGVsLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbi8vICAgICAgICAgICAgICAgICAgICAgJCgnLmRpdmEtaW5wdXQtc3VnZ2VzdGlvbjpsYXN0JywgaW5wdXRTdWdnZXN0aW9ucykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgIGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gNDApIC8vIERvd24gYXJyb3cga2V5XG4vLyAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgICAgZWwgPSAkKCcuYWN0aXZlJywgaW5wdXRTdWdnZXN0aW9ucyk7XG4vLyAgICAgICAgICAgICAgICAgY29uc3QgbmV4dEVsID0gZWwubmV4dCgpO1xuLy8gICAgICAgICAgICAgICAgIGlmIChuZXh0RWwubGVuZ3RoKVxuLy8gICAgICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICAgICAgZWwucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICAgICAgICAgICAgICBuZXh0RWwuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuLy8gICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgICAgICBlbHNlXG4vLyAgICAgICAgICAgICAgICAge1xuLy8gICAgICAgICAgICAgICAgICAgICBlbC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4vLyAgICAgICAgICAgICAgICAgICAgICQoJy5kaXZhLWlucHV0LXN1Z2dlc3Rpb246Zmlyc3QnLCBpbnB1dFN1Z2dlc3Rpb25zKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4vLyAgICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICB9KTtcbi8vXG4vLyAgICAgICAgICQoaW5wdXRTdWdnZXN0aW9ucykub24oJ21vdXNlZG93bicsICcuZGl2YS1pbnB1dC1zdWdnZXN0aW9uJywgZnVuY3Rpb24oKVxuLy8gICAgICAgICB7XG4vLyAgICAgICAgICAgICBnb3RvUGFnZUlucHV0LnZhbHVlID0gdGhpcy50ZXh0Q29udGVudDtcbi8vICAgICAgICAgICAgIGlucHV0U3VnZ2VzdGlvbnMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbi8vICAgICAgICAgICAgICQoZ290b1BhZ2VJbnB1dCkudHJpZ2dlcignc3VibWl0Jyk7XG4vLyAgICAgICAgIH0pO1xuLy9cbi8vICAgICAgICAgJChnb3RvUGFnZUlucHV0KS5vbignYmx1cicsICgpID0+IHtcbi8vICAgICAgICAgICAgIC8vIEhpZGUgbGFiZWwgc3VnZ2VzdGlvbnNcbi8vICAgICAgICAgICAgIGlucHV0U3VnZ2VzdGlvbnMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbi8vICAgICAgICAgfSk7XG4vL1xuLy8gICAgICAgICByZXR1cm4gZ290b0Zvcm07XG4vLyAgICAgfTtcbi8vXG4vLyAgICAgY29uc3QgY3JlYXRlUGFnZUxhYmVsID0gKCkgPT4ge1xuLy8gICAgICAgICAvLyBDdXJyZW50IHBhZ2Vcbi8vICAgICAgICAgY29uc3QgY3VycmVudFBhZ2UgPSBlbHQoJ3NwYW4nLCB7XG4vLyAgICAgICAgICAgICBpZDogc2V0dGluZ3MuSUQgKyAnY3VycmVudC1wYWdlJ1xuLy8gICAgICAgICB9KTtcbi8vXG4vLyAgICAgICAgIGNvbnN0IHVwZGF0ZUN1cnJlbnRQYWdlID0gKCkgPT4ge1xuLy8gICAgICAgICAgICAgY3VycmVudFBhZ2UudGV4dENvbnRlbnQgPSB2aWV3ZXIuZ2V0Q3VycmVudEFsaWFzZWRQYWdlSW5kZXgoKTtcbi8vICAgICAgICAgfTtcbi8vXG4vLyAgICAgICAgIHN1YnNjcmliZSgnVmlzaWJsZVBhZ2VEaWRDaGFuZ2UnLCB1cGRhdGVDdXJyZW50UGFnZSk7XG4vLyAgICAgICAgIHN1YnNjcmliZSgnVmlld2VyRGlkTG9hZCcsIHVwZGF0ZUN1cnJlbnRQYWdlKTtcbi8vXG4vLyAgICAgICAgIC8vIE51bWJlciBvZiBwYWdlc1xuLy8gICAgICAgICBjb25zdCBudW1QYWdlcyA9IGVsdCgnc3BhbicsIHtcbi8vICAgICAgICAgICAgIGlkOiBzZXR0aW5ncy5JRCArICdudW0tcGFnZXMnXG4vLyAgICAgICAgIH0pO1xuLy9cbi8vICAgICAgICAgY29uc3QgdXBkYXRlTnVtUGFnZXMgPSAoKSA9PiB7XG4vLyAgICAgICAgICAgICBudW1QYWdlcy50ZXh0Q29udGVudCA9IHNldHRpbmdzLm51bVBhZ2VzO1xuLy8gICAgICAgICB9O1xuLy9cbi8vICAgICAgICAgc3Vic2NyaWJlKCdOdW1iZXJPZlBhZ2VzRGlkQ2hhbmdlJywgdXBkYXRlTnVtUGFnZXMpO1xuLy8gICAgICAgICBzdWJzY3JpYmUoJ09iamVjdERpZExvYWQnLCB1cGRhdGVOdW1QYWdlcyk7XG4vL1xuLy8gICAgICAgICByZXR1cm4gZWx0KCdzcGFuJywge1xuLy8gICAgICAgICAgICAgICAgIGNsYXNzOiAnZGl2YS1wYWdlLWxhYmVsIGRpdmEtbGFiZWwnXG4vLyAgICAgICAgICAgICB9LFxuLy8gICAgICAgICAgICAgJ1BhZ2UgJywgY3VycmVudFBhZ2UsICcgb2YgJywgbnVtUGFnZXNcbi8vICAgICAgICAgKTtcbi8vICAgICB9O1xuLy9cbi8vICAgICBjb25zdCBjcmVhdGVUb29sYmFyQnV0dG9uR3JvdXAgPSAoKSA9PiB7XG4vLyAgICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBbY3JlYXRlVmlld01lbnUoKV07XG4vL1xuLy8gICAgICAgICBpZiAoc2V0dGluZ3MuZW5hYmxlTGlua0ljb24pXG4vLyAgICAgICAgICAgICBidXR0b25zLnB1c2goY3JlYXRlTGlua0ljb24oKSk7XG4vL1xuLy8gICAgICAgICBpZiAoc2V0dGluZ3MuZW5hYmxlTm9uUGFnZWRWaXNpYmlsaXR5SWNvbilcbi8vICAgICAgICAgICAgIGJ1dHRvbnMucHVzaChjcmVhdGVUb2dnbGVOb25QYWdlZEJ1dHRvbigpKTtcbi8vXG4vLyAgICAgICAgIGlmIChzZXR0aW5ncy5lbmFibGVGdWxsc2NyZWVuKVxuLy8gICAgICAgICAgICAgYnV0dG9ucy5wdXNoKGNyZWF0ZUZ1bGxzY3JlZW5CdXR0b24oKSk7XG4vL1xuLy8gICAgICAgICByZXR1cm4gZWx0KCdzcGFuJywgZWxlbUF0dHJzKCd0b29sYmFyLWJ1dHRvbi1ncm91cCcpLCBidXR0b25zKTtcbi8vICAgICB9O1xuLy9cbi8vICAgICBjb25zdCBjcmVhdGVMaW5rSWNvbiA9ICgpID0+IHtcbi8vICAgICAgICAgY29uc3QgZWxlbSA9IGNyZWF0ZUJ1dHRvbkVsZW1lbnQoJ2xpbmstaWNvbicsICdMaW5rIHRvIHRoaXMgcGFnZScpO1xuLy8gICAgICAgICBjb25zdCBsaW5rSWNvbiA9ICQoZWxlbSk7XG4vL1xuLy8gICAgICAgICBsaW5rSWNvbi5vbignY2xpY2snLCAoKSA9PiB7XG4vLyAgICAgICAgICAgICAkKCdib2R5JykucHJlcGVuZChcbi8vICAgICAgICAgICAgICAgICBlbHQoJ2RpdicsIHtcbi8vICAgICAgICAgICAgICAgICAgICAgaWQ6IHNldHRpbmdzLklEICsgJ2xpbmstcG9wdXAnLFxuLy8gICAgICAgICAgICAgICAgICAgICBjbGFzczogJ2RpdmEtcG9wdXAgZGl2YS1saW5rLXBvcHVwJ1xuLy8gICAgICAgICAgICAgICAgIH0sIFtcbi8vICAgICAgICAgICAgICAgICAgICAgZWx0KCdpbnB1dCcsIHtcbi8vICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzZXR0aW5ncy5JRCArICdsaW5rLXBvcHVwLWlucHV0Jyxcbi8vICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiAnZGl2YS1pbnB1dCcsXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdmlld2VyLmdldEN1cnJlbnRVUkwoKVxuLy8gICAgICAgICAgICAgICAgICAgICB9KVxuLy8gICAgICAgICAgICAgICAgIF0pXG4vLyAgICAgICAgICAgICApO1xuLy9cbi8vICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5pbkZ1bGxzY3JlZW4pXG4vLyAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgICAgJChzZXR0aW5ncy5zZWxlY3RvciArICdsaW5rLXBvcHVwJykuYWRkQ2xhc3MoJ2luLWZ1bGxzY3JlZW4nKTtcbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgIGVsc2Vcbi8vICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIGxlZnQgYW5kIHRvcCBvZmZzZXRzXG4vLyAgICAgICAgICAgICAgICAgY29uc3QgbGVmdE9mZnNldCA9IGxpbmtJY29uLm9mZnNldCgpLmxlZnQgLSAyMjIgKyBsaW5rSWNvbi5vdXRlcldpZHRoKCk7XG4vLyAgICAgICAgICAgICAgICAgY29uc3QgdG9wT2Zmc2V0ID0gbGlua0ljb24ub2Zmc2V0KCkudG9wICsgbGlua0ljb24ub3V0ZXJIZWlnaHQoKSAtIDE7XG4vL1xuLy8gICAgICAgICAgICAgICAgICQoc2V0dGluZ3Muc2VsZWN0b3IgKyAnbGluay1wb3B1cCcpLmNzcyh7XG4vLyAgICAgICAgICAgICAgICAgICAgICd0b3AnOiB0b3BPZmZzZXQgKyAncHgnLFxuLy8gICAgICAgICAgICAgICAgICAgICAnbGVmdCc6IGxlZnRPZmZzZXQgKyAncHgnXG4vLyAgICAgICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgICAgICB9XG4vL1xuLy8gICAgICAgICAgICAgLy8gQ2F0Y2ggb25tb3VzZXVwIGV2ZW50cyBvdXRzaWRlIG9mIHRoaXMgZGl2XG4vLyAgICAgICAgICAgICAkKCdib2R5JykubW91c2V1cChldmVudCA9PiB7XG4vLyAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0SUQgPSBldmVudC50YXJnZXQuaWQ7XG4vL1xuLy8gICAgICAgICAgICAgICAgIGlmICh0YXJnZXRJRCAhPT0gc2V0dGluZ3MuSUQgKyAnbGluay1wb3B1cCcgJiYgdGFyZ2V0SUQgIT09IHNldHRpbmdzLklEICsgJ2xpbmstcG9wdXAtaW5wdXQnKVxuLy8gICAgICAgICAgICAgICAgICAgICAkKHNldHRpbmdzLnNlbGVjdG9yICsgJ2xpbmstcG9wdXAnKS5yZW1vdmUoKTtcbi8vICAgICAgICAgICAgIH0pO1xuLy9cbi8vICAgICAgICAgICAgIC8vIEFsc28gZGVsZXRlIGl0IHVwb24gc2Nyb2xsIGFuZCBwYWdlIHVwL2Rvd24ga2V5IGV2ZW50c1xuLy8gICAgICAgICAgICAgLy8gRklYTUUod2FiYWluKTogVGhpcyBpcyBhZ2dyZXNzaXZlXG4vLyAgICAgICAgICAgICBzZXR0aW5ncy52aWV3cG9ydE9iamVjdC5zY3JvbGwoKCkgPT4ge1xuLy8gICAgICAgICAgICAgICAgICQoc2V0dGluZ3Muc2VsZWN0b3IgKyAnbGluay1wb3B1cCcpLnJlbW92ZSgpO1xuLy8gICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgICAgICAkKHNldHRpbmdzLnNlbGVjdG9yICsgJ2xpbmstcG9wdXAgaW5wdXQnKS5jbGljayhmdW5jdGlvbiAoKVxuLy8gICAgICAgICAgICAge1xuLy8gICAgICAgICAgICAgICAgICQodGhpcykuZm9jdXMoKS5zZWxlY3QoKTtcbi8vICAgICAgICAgICAgIH0pO1xuLy9cbi8vICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbi8vICAgICAgICAgfSk7XG4vL1xuLy8gICAgICAgICByZXR1cm4gZWxlbTtcbi8vICAgICB9O1xuLy9cbi8vICAgICB2YXIgY3JlYXRlRnVsbHNjcmVlbkJ1dHRvbiA9ICgpID0+IGNyZWF0ZUJ1dHRvbkVsZW1lbnQoJ2Z1bGxzY3JlZW4taWNvbicsICdUb2dnbGUgZnVsbHNjcmVlbiBtb2RlJywgKCkgPT4ge1xuLy8gICAgICAgICB2aWV3ZXIudG9nZ2xlRnVsbHNjcmVlbk1vZGUoKTtcbi8vICAgICB9KTtcbi8vXG4vLyAgICAgdmFyIGNyZWF0ZVRvZ2dsZU5vblBhZ2VkQnV0dG9uID0gKCkgPT4ge1xuLy8gICAgICAgICBjb25zdCBnZXRDbGFzc05hbWUgPSAoKSA9PiAndG9nZ2xlLW5vbnBhZ2VkLWljb24nICsgKHZpZXdlci5nZXRTZXR0aW5ncygpLnNob3dOb25QYWdlZFBhZ2VzID8gJy1hY3RpdmUnIDogJycpO1xuLy9cbi8vICAgICAgICAgY29uc3QgdG9nZ2xlTm9uUGFnZWRCdXR0b24gPSBjcmVhdGVCdXR0b25FbGVtZW50KGdldENsYXNzTmFtZSgpLCAnVG9nZ2xlIHZpc2liaWxpdHkgb2Ygbm9uLXBhZ2VkIHBhZ2VzJywgZnVuY3Rpb24oKVxuLy8gICAgICAgICB7XG4vLyAgICAgICAgICAgICB2aWV3ZXIudG9nZ2xlTm9uUGFnZWRQYWdlc1Zpc2liaWxpdHkoKTtcbi8vICAgICAgICAgICAgIGNvbnN0IG5ld0NsYXNzTmFtZSA9ICdkaXZhLScgKyBnZXRDbGFzc05hbWUoKTtcbi8vICAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gdGhpcy5jbGFzc05hbWUucmVwbGFjZSgvZGl2YS10b2dnbGUtbm9ucGFnZWQtaWNvbigtYWN0aXZlKT8vLCBuZXdDbGFzc05hbWUpO1xuLy8gICAgICAgICB9KTtcbi8vXG4vLyAgICAgICAgIGNvbnN0IHVwZGF0ZU5vblBhZ2VkQnV0dG9uVmlzaWJpbGl0eSA9ICgpID0+IHtcbi8vICAgICAgICAgICAgIGNvbnN0IHBhZ2VzID0gc2V0dGluZ3MubWFuaWZlc3QucGFnZXM7XG4vLyAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZ2VzLmxlbmd0aDsgaSsrKVxuLy8gICAgICAgICAgICAge1xuLy8gICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5tYW5pZmVzdC5wYWdlZCAmJiAhcGFnZXNbaV0ucGFnZWQpXG4vLyAgICAgICAgICAgICAgICAge1xuLy8gICAgICAgICAgICAgICAgICAgICAvLyBTaG93IHRoZSBidXR0b24sIHRoZXJlIGlzIGF0IGxlYXN0IG9uZSBub24tcGFnZWQgcGFnZVxuLy8gICAgICAgICAgICAgICAgICAgICB0b2dnbGVOb25QYWdlZEJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7XG4vLyAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbi8vICAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICB9XG4vL1xuLy8gICAgICAgICAgICAgLy8gTm8gbm9uLXBhZ2VkIHBhZ2VzIHdlcmUgZm91bmQsIGhpZGUgdGhlIGJ1dHRvblxuLy8gICAgICAgICAgICAgdG9nZ2xlTm9uUGFnZWRCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbi8vICAgICAgICAgfTtcbi8vICAgICAgICAgc3Vic2NyaWJlKCdPYmplY3REaWRMb2FkJywgdXBkYXRlTm9uUGFnZWRCdXR0b25WaXNpYmlsaXR5KTtcbi8vXG4vLyAgICAgICAgIHJldHVybiB0b2dnbGVOb25QYWdlZEJ1dHRvbjtcbi8vICAgICB9O1xuLy9cbi8vICAgICAvLyBIYW5kbGVzIGFsbCBzdGF0dXMgdXBkYXRpbmcgZXRjIChib3RoIGZ1bGxzY3JlZW4gYW5kIG5vdClcbi8vICAgICBjb25zdCBpbml0ID0gKCkgPT4ge1xuLy8gICAgICAgICBjb25zdCBsZWZ0VG9vbHMgPSBbY3JlYXRlWm9vbUNvbnRyb2xzKCksIGNyZWF0ZUdyaWRDb250cm9scygpXTtcbi8vICAgICAgICAgY29uc3QgcmlnaHRUb29scyA9IFtjcmVhdGVQYWdlTmF2aWdhdGlvbkNvbnRyb2xzKCksIGNyZWF0ZVRvb2xiYXJCdXR0b25Hcm91cCgpXTtcbi8vXG4vLyAgICAgICAgIGNvbnN0IHRvb2xzID0gZWx0KCdkaXYnLCBlbGVtQXR0cnMoJ3Rvb2xzJyksXG4vLyAgICAgICAgICAgICBlbHQoJ2RpdicsIGVsZW1BdHRycygndG9vbHMtbGVmdCcpLCBsZWZ0VG9vbHMpLFxuLy8gICAgICAgICAgICAgZWx0KCdkaXYnLCBlbGVtQXR0cnMoJ3Rvb2xzLXJpZ2h0JyksIHJpZ2h0VG9vbHMpXG4vLyAgICAgICAgICk7XG4vL1xuLy8gICAgICAgICBzZXR0aW5ncy50b29sYmFyUGFyZW50T2JqZWN0LnByZXBlbmQodG9vbHMpO1xuLy9cbi8vICAgICAgICAgLy8gSGFuZGxlIGVudHJ5IHRvIGFuZCBleGl0IGZyb20gZnVsbHNjcmVlbiBtb2RlXG4vLyAgICAgICAgIGNvbnN0IHN3aXRjaE1vZGUgPSAoKSA9PiB7XG4vLyAgICAgICAgICAgICBjb25zdCB0b29sc1JpZ2h0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNldHRpbmdzLklEICsgJ3Rvb2xzLXJpZ2h0Jyk7XG4vLyAgICAgICAgICAgICBjb25zdCBwYWdlTmF2RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNldHRpbmdzLklEICsgJ3BhZ2UtbmF2Jyk7XG4vL1xuLy8gICAgICAgICAgICAgaWYgKCFzZXR0aW5ncy5pbkZ1bGxzY3JlZW4pXG4vLyAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgICAgLy8gTGVhdmluZyBmdWxsc2NyZWVuXG4vLyAgICAgICAgICAgICAgICAgJCh0b29scykucmVtb3ZlQ2xhc3MoJ2RpdmEtZnVsbHNjcmVlbi10b29scycpO1xuLy9cbi8vICAgICAgICAgICAgICAgICAvL21vdmUgSUQtcGFnZS1uYXYgdG8gYmVnaW5uaW5nIG9mIHRvb2xzIHJpZ2h0XG4vLyAgICAgICAgICAgICAgICAgdG9vbHNSaWdodEVsZW1lbnQucmVtb3ZlQ2hpbGQocGFnZU5hdkVsZW1lbnQpO1xuLy8gICAgICAgICAgICAgICAgIHRvb2xzUmlnaHRFbGVtZW50Lmluc2VydEJlZm9yZShwYWdlTmF2RWxlbWVudCwgdG9vbHNSaWdodEVsZW1lbnQuZmlyc3RDaGlsZCk7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICBlbHNlXG4vLyAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgICAgLy8gRW50ZXJpbmcgZnVsbHNjcmVlblxuLy8gICAgICAgICAgICAgICAgICQodG9vbHMpLmFkZENsYXNzKCdkaXZhLWZ1bGxzY3JlZW4tdG9vbHMnKTtcbi8vXG4vLyAgICAgICAgICAgICAgICAgLy9tb3ZlIElELXBhZ2UtbmF2IHRvIGVuZCBvZiB0b29scyByaWdodFxuLy8gICAgICAgICAgICAgICAgIHRvb2xzUmlnaHRFbGVtZW50LnJlbW92ZUNoaWxkKHBhZ2VOYXZFbGVtZW50KTtcbi8vICAgICAgICAgICAgICAgICB0b29sc1JpZ2h0RWxlbWVudC5hcHBlbmRDaGlsZChwYWdlTmF2RWxlbWVudCk7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH07XG4vL1xuLy8gICAgICAgICBzdWJzY3JpYmUoJ01vZGVEaWRTd2l0Y2gnLCBzd2l0Y2hNb2RlKTtcbi8vICAgICAgICAgc3Vic2NyaWJlKCdWaWV3ZXJEaWRMb2FkJywgc3dpdGNoTW9kZSk7XG4vL1xuLy8gICAgICAgICBjb25zdCB0b29sYmFyID0ge1xuLy8gICAgICAgICAgICAgZWxlbWVudDogdG9vbHMsXG4vLyAgICAgICAgICAgICBjbG9zZVBvcHVwczogZnVuY3Rpb24gKClcbi8vICAgICAgICAgICAgIHtcbi8vICAgICAgICAgICAgICAgICAkKCcuZGl2YS1wb3B1cCcpLmNzcygnZGlzcGxheScsICdub25lJyk7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH07XG4vL1xuLy8gICAgICAgICByZXR1cm4gdG9vbGJhcjtcbi8vICAgICB9O1xuLy9cbi8vICAgICByZXR1cm4gaW5pdCgpO1xuLy8gfVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/toolbar.js\n");

/***/ }),

/***/ "./source/js/utils/dragscroll.js":
/*!***************************************!*\
  !*** ./source/js/utils/dragscroll.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**\n * @fileoverview dragscroll - scroll area by dragging\n * @version 0.0.8\n *\n * @license MIT, see http://github.com/asvd/dragscroll\n * @copyright 2015 asvd <heliosframework@gmail.com>\n */\n(function (root, factory)\n{\n    if (true)\n    {\n        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n    }\n    else {}\n}(this, function (exports)\n{\n    var _window = window;\n    var _document = document;\n    var mousemove = 'mousemove';\n    var mouseup = 'mouseup';\n    var mousedown = 'mousedown';\n    var EventListener = 'EventListener';\n    var addEventListener = 'add' + EventListener;\n    var removeEventListener = 'remove' + EventListener;\n    var newScrollX, newScrollY; // jshint ignore:line\n\n    var dragged = [];\n\n    var reset = function (i, el)\n    {\n        for (i = 0; i < dragged.length;)\n        {\n            el = dragged[i++];\n            el = el.container || el;\n            el[removeEventListener](mousedown, el.md, 0);\n            _window[removeEventListener](mouseup, el.mu, 0);\n            _window[removeEventListener](mousemove, el.mm, 0);\n        }\n\n        // suppress warning about functions in loops.\n        /* jshint ignore:start */\n        // cloning into array since HTMLCollection is updated dynamically\n        dragged = [].slice.call(_document.getElementsByClassName('dragscroll'));\n        for (i = 0; i < dragged.length;)\n        {\n            (function (el, lastClientX, lastClientY, pushed, scroller, cont)\n            {\n                (cont = el.container || el)[addEventListener](\n                    mousedown,\n                    cont.md = function (e)\n                    {\n                        if (!el.hasAttribute('nochilddrag') || _document.elementFromPoint(e.pageX, e.pageY) === cont)\n                        {\n                            pushed = 1;\n                            lastClientX = e.clientX;\n                            lastClientY = e.clientY;\n\n                            e.preventDefault();\n                        }\n                    }, 0\n                );\n\n                _window[addEventListener](mouseup, cont.mu = function ()\n                    {\n                        pushed = 0;\n                    }, 0);\n\n                _window[addEventListener](mousemove, cont.mm = function (e)\n                    {\n                        if (pushed)\n                        {\n                            (scroller = el.scroller || el).scrollLeft -=\n                                newScrollX = (-lastClientX + (lastClientX = e.clientX));\n                            scroller.scrollTop -=\n                                newScrollY = (-lastClientY + (lastClientY = e.clientY));\n                            if (el === _document.body)\n                            {\n                                (scroller = _document.documentElement).scrollLeft -= newScrollX;\n                                scroller.scrollTop -= newScrollY;\n                            }\n                        }\n                    }, 0);\n            })(dragged[i++]);\n        }\n        /* jshint ignore:end */\n    };\n\n    if (_document.readyState === 'complete')\n    {\n        reset();\n    }\n    else\n    {\n        _window[addEventListener]('load', reset, 0);\n    }\n\n    exports.reset = reset;\n    window.resetDragscroll = reset;\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdXRpbHMvZHJhZ3Njcm9sbC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9qcy91dGlscy9kcmFnc2Nyb2xsLmpzPzliMGEiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IGRyYWdzY3JvbGwgLSBzY3JvbGwgYXJlYSBieSBkcmFnZ2luZ1xuICogQHZlcnNpb24gMC4wLjhcbiAqXG4gKiBAbGljZW5zZSBNSVQsIHNlZSBodHRwOi8vZ2l0aHViLmNvbS9hc3ZkL2RyYWdzY3JvbGxcbiAqIEBjb3B5cmlnaHQgMjAxNSBhc3ZkIDxoZWxpb3NmcmFtZXdvcmtAZ21haWwuY29tPlxuICovXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpXG57XG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcbiAgICB7XG4gICAgICAgIGRlZmluZShbJ2V4cG9ydHMnXSwgZmFjdG9yeSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJylcbiAgICB7XG4gICAgICAgIGZhY3RvcnkoZXhwb3J0cyk7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgIGZhY3RvcnkoKHJvb3QuZHJhZ3Njcm9sbCA9IHt9KSk7XG4gICAgfVxufSh0aGlzLCBmdW5jdGlvbiAoZXhwb3J0cylcbntcbiAgICB2YXIgX3dpbmRvdyA9IHdpbmRvdztcbiAgICB2YXIgX2RvY3VtZW50ID0gZG9jdW1lbnQ7XG4gICAgdmFyIG1vdXNlbW92ZSA9ICdtb3VzZW1vdmUnO1xuICAgIHZhciBtb3VzZXVwID0gJ21vdXNldXAnO1xuICAgIHZhciBtb3VzZWRvd24gPSAnbW91c2Vkb3duJztcbiAgICB2YXIgRXZlbnRMaXN0ZW5lciA9ICdFdmVudExpc3RlbmVyJztcbiAgICB2YXIgYWRkRXZlbnRMaXN0ZW5lciA9ICdhZGQnICsgRXZlbnRMaXN0ZW5lcjtcbiAgICB2YXIgcmVtb3ZlRXZlbnRMaXN0ZW5lciA9ICdyZW1vdmUnICsgRXZlbnRMaXN0ZW5lcjtcbiAgICB2YXIgbmV3U2Nyb2xsWCwgbmV3U2Nyb2xsWTsgLy8ganNoaW50IGlnbm9yZTpsaW5lXG5cbiAgICB2YXIgZHJhZ2dlZCA9IFtdO1xuXG4gICAgdmFyIHJlc2V0ID0gZnVuY3Rpb24gKGksIGVsKVxuICAgIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGRyYWdnZWQubGVuZ3RoOylcbiAgICAgICAge1xuICAgICAgICAgICAgZWwgPSBkcmFnZ2VkW2krK107XG4gICAgICAgICAgICBlbCA9IGVsLmNvbnRhaW5lciB8fCBlbDtcbiAgICAgICAgICAgIGVsW3JlbW92ZUV2ZW50TGlzdGVuZXJdKG1vdXNlZG93biwgZWwubWQsIDApO1xuICAgICAgICAgICAgX3dpbmRvd1tyZW1vdmVFdmVudExpc3RlbmVyXShtb3VzZXVwLCBlbC5tdSwgMCk7XG4gICAgICAgICAgICBfd2luZG93W3JlbW92ZUV2ZW50TGlzdGVuZXJdKG1vdXNlbW92ZSwgZWwubW0sIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc3VwcHJlc3Mgd2FybmluZyBhYm91dCBmdW5jdGlvbnMgaW4gbG9vcHMuXG4gICAgICAgIC8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbiAgICAgICAgLy8gY2xvbmluZyBpbnRvIGFycmF5IHNpbmNlIEhUTUxDb2xsZWN0aW9uIGlzIHVwZGF0ZWQgZHluYW1pY2FsbHlcbiAgICAgICAgZHJhZ2dlZCA9IFtdLnNsaWNlLmNhbGwoX2RvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2RyYWdzY3JvbGwnKSk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBkcmFnZ2VkLmxlbmd0aDspXG4gICAgICAgIHtcbiAgICAgICAgICAgIChmdW5jdGlvbiAoZWwsIGxhc3RDbGllbnRYLCBsYXN0Q2xpZW50WSwgcHVzaGVkLCBzY3JvbGxlciwgY29udClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAoY29udCA9IGVsLmNvbnRhaW5lciB8fCBlbClbYWRkRXZlbnRMaXN0ZW5lcl0oXG4gICAgICAgICAgICAgICAgICAgIG1vdXNlZG93bixcbiAgICAgICAgICAgICAgICAgICAgY29udC5tZCA9IGZ1bmN0aW9uIChlKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVsLmhhc0F0dHJpYnV0ZSgnbm9jaGlsZGRyYWcnKSB8fCBfZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChlLnBhZ2VYLCBlLnBhZ2VZKSA9PT0gY29udClcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXNoZWQgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RDbGllbnRYID0gZS5jbGllbnRYO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RDbGllbnRZID0gZS5jbGllbnRZO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCAwXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIF93aW5kb3dbYWRkRXZlbnRMaXN0ZW5lcl0obW91c2V1cCwgY29udC5tdSA9IGZ1bmN0aW9uICgpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHB1c2hlZCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH0sIDApO1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvd1thZGRFdmVudExpc3RlbmVyXShtb3VzZW1vdmUsIGNvbnQubW0gPSBmdW5jdGlvbiAoZSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHB1c2hlZClcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc2Nyb2xsZXIgPSBlbC5zY3JvbGxlciB8fCBlbCkuc2Nyb2xsTGVmdCAtPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdTY3JvbGxYID0gKC1sYXN0Q2xpZW50WCArIChsYXN0Q2xpZW50WCA9IGUuY2xpZW50WCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbGVyLnNjcm9sbFRvcCAtPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdTY3JvbGxZID0gKC1sYXN0Q2xpZW50WSArIChsYXN0Q2xpZW50WSA9IGUuY2xpZW50WSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbCA9PT0gX2RvY3VtZW50LmJvZHkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc2Nyb2xsZXIgPSBfZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5zY3JvbGxMZWZ0IC09IG5ld1Njcm9sbFg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbGVyLnNjcm9sbFRvcCAtPSBuZXdTY3JvbGxZO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9KShkcmFnZ2VkW2krK10pO1xuICAgICAgICB9XG4gICAgICAgIC8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4gICAgfTtcblxuICAgIGlmIChfZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJylcbiAgICB7XG4gICAgICAgIHJlc2V0KCk7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgIF93aW5kb3dbYWRkRXZlbnRMaXN0ZW5lcl0oJ2xvYWQnLCByZXNldCwgMCk7XG4gICAgfVxuXG4gICAgZXhwb3J0cy5yZXNldCA9IHJlc2V0O1xuICAgIHdpbmRvdy5yZXNldERyYWdzY3JvbGwgPSByZXNldDtcbn0pKTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQSxXQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./source/js/utils/dragscroll.js\n");

/***/ }),

/***/ "./source/js/utils/elt.js":
/*!********************************!*\
  !*** ./source/js/utils/elt.js ***!
  \********************************/
/*! exports provided: setAttributes, elt */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setAttributes\", function() { return setDOMAttributes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"elt\", function() { return elt; });\n\n\n/**\n * Convenience function to create a DOM element, set attributes on it, and\n * append children. All arguments which are not of primitive type, are not\n * arrays, and are not DOM nodes are treated as attribute hashes and are\n * handled as described for setDOMAttributes. Children can either be a DOM\n * node or a primitive value, which is converted to a text node. Arrays are\n * handled recursively. Null and undefined values are ignored.\n *\n * Inspired by the ProseMirror helper of the same name.\n */\nfunction elt (tag)\n{\n    const el = document.createElement(tag);\n    const args = Array.prototype.slice.call(arguments, 1);\n\n    while (args.length)\n    {\n        const arg = args.shift();\n        handleEltConstructorArg(el, arg);\n    }\n\n    return el;\n}\n\nfunction handleEltConstructorArg (el, arg)\n{\n    if (arg == null)  // NB: == is correct;\n        return;\n\n    if (typeof arg !== 'object' && typeof arg !== 'function')\n    {\n        // Coerce to string\n        el.appendChild(document.createTextNode(arg));\n    }\n    else if (arg instanceof window.Node)\n    {\n        el.appendChild(arg);\n    }\n    else if (arg instanceof Array)\n    {\n        const childCount = arg.length;\n        for (let i = 0; i < childCount; i++)\n            handleEltConstructorArg(el, arg[i]);\n    }\n    else\n    {\n        setDOMAttributes(el, arg);\n    }\n}\n\n/**\n * Set attributes of a DOM element. The `style` property is special-cased to\n * accept either a string or an object whose own attributes are assigned to\n * el.style.\n */\nfunction setDOMAttributes (el, attributes)\n{\n    for (const prop in attributes)\n    {\n        if (!attributes.hasOwnProperty(prop))\n            continue;\n\n        if (prop === 'style')\n        {\n            setStyle(el, attributes.style);\n        }\n        else\n        {\n            el.setAttribute(prop, attributes[prop]);\n        }\n    }\n}\n\nfunction setStyle (el, style)\n{\n    if (!style)\n        return;\n\n    if (typeof style !== 'object')\n    {\n        el.style.cssText = style;\n        return;\n    }\n\n    for (const cssProp in style)\n    {\n        if (!style.hasOwnProperty(cssProp))\n            continue;\n\n        el.style[cssProp] = style[cssProp];\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdXRpbHMvZWx0LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL3V0aWxzL2VsdC5qcz9lZWFkIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB7IHNldERPTUF0dHJpYnV0ZXMgYXMgc2V0QXR0cmlidXRlcyB9O1xuXG4vKipcbiAqIENvbnZlbmllbmNlIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIERPTSBlbGVtZW50LCBzZXQgYXR0cmlidXRlcyBvbiBpdCwgYW5kXG4gKiBhcHBlbmQgY2hpbGRyZW4uIEFsbCBhcmd1bWVudHMgd2hpY2ggYXJlIG5vdCBvZiBwcmltaXRpdmUgdHlwZSwgYXJlIG5vdFxuICogYXJyYXlzLCBhbmQgYXJlIG5vdCBET00gbm9kZXMgYXJlIHRyZWF0ZWQgYXMgYXR0cmlidXRlIGhhc2hlcyBhbmQgYXJlXG4gKiBoYW5kbGVkIGFzIGRlc2NyaWJlZCBmb3Igc2V0RE9NQXR0cmlidXRlcy4gQ2hpbGRyZW4gY2FuIGVpdGhlciBiZSBhIERPTVxuICogbm9kZSBvciBhIHByaW1pdGl2ZSB2YWx1ZSwgd2hpY2ggaXMgY29udmVydGVkIHRvIGEgdGV4dCBub2RlLiBBcnJheXMgYXJlXG4gKiBoYW5kbGVkIHJlY3Vyc2l2ZWx5LiBOdWxsIGFuZCB1bmRlZmluZWQgdmFsdWVzIGFyZSBpZ25vcmVkLlxuICpcbiAqIEluc3BpcmVkIGJ5IHRoZSBQcm9zZU1pcnJvciBoZWxwZXIgb2YgdGhlIHNhbWUgbmFtZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVsdCAodGFnKVxue1xuICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xuICAgIGNvbnN0IGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuXG4gICAgd2hpbGUgKGFyZ3MubGVuZ3RoKVxuICAgIHtcbiAgICAgICAgY29uc3QgYXJnID0gYXJncy5zaGlmdCgpO1xuICAgICAgICBoYW5kbGVFbHRDb25zdHJ1Y3RvckFyZyhlbCwgYXJnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZWw7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVsdENvbnN0cnVjdG9yQXJnIChlbCwgYXJnKVxue1xuICAgIGlmIChhcmcgPT0gbnVsbCkgIC8vIE5COiA9PSBpcyBjb3JyZWN0O1xuICAgICAgICByZXR1cm47XG5cbiAgICBpZiAodHlwZW9mIGFyZyAhPT0gJ29iamVjdCcgJiYgdHlwZW9mIGFyZyAhPT0gJ2Z1bmN0aW9uJylcbiAgICB7XG4gICAgICAgIC8vIENvZXJjZSB0byBzdHJpbmdcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoYXJnKSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyZyBpbnN0YW5jZW9mIHdpbmRvdy5Ob2RlKVxuICAgIHtcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoYXJnKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYXJnIGluc3RhbmNlb2YgQXJyYXkpXG4gICAge1xuICAgICAgICBjb25zdCBjaGlsZENvdW50ID0gYXJnLmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZENvdW50OyBpKyspXG4gICAgICAgICAgICBoYW5kbGVFbHRDb25zdHJ1Y3RvckFyZyhlbCwgYXJnW2ldKTtcbiAgICB9XG4gICAgZWxzZVxuICAgIHtcbiAgICAgICAgc2V0RE9NQXR0cmlidXRlcyhlbCwgYXJnKTtcbiAgICB9XG59XG5cbi8qKlxuICogU2V0IGF0dHJpYnV0ZXMgb2YgYSBET00gZWxlbWVudC4gVGhlIGBzdHlsZWAgcHJvcGVydHkgaXMgc3BlY2lhbC1jYXNlZCB0b1xuICogYWNjZXB0IGVpdGhlciBhIHN0cmluZyBvciBhbiBvYmplY3Qgd2hvc2Ugb3duIGF0dHJpYnV0ZXMgYXJlIGFzc2lnbmVkIHRvXG4gKiBlbC5zdHlsZS5cbiAqL1xuZnVuY3Rpb24gc2V0RE9NQXR0cmlidXRlcyAoZWwsIGF0dHJpYnV0ZXMpXG57XG4gICAgZm9yIChjb25zdCBwcm9wIGluIGF0dHJpYnV0ZXMpXG4gICAge1xuICAgICAgICBpZiAoIWF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkocHJvcCkpXG4gICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICBpZiAocHJvcCA9PT0gJ3N0eWxlJylcbiAgICAgICAge1xuICAgICAgICAgICAgc2V0U3R5bGUoZWwsIGF0dHJpYnV0ZXMuc3R5bGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKHByb3AsIGF0dHJpYnV0ZXNbcHJvcF0pO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzZXRTdHlsZSAoZWwsIHN0eWxlKVxue1xuICAgIGlmICghc3R5bGUpXG4gICAgICAgIHJldHVybjtcblxuICAgIGlmICh0eXBlb2Ygc3R5bGUgIT09ICdvYmplY3QnKVxuICAgIHtcbiAgICAgICAgZWwuc3R5bGUuY3NzVGV4dCA9IHN0eWxlO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBjc3NQcm9wIGluIHN0eWxlKVxuICAgIHtcbiAgICAgICAgaWYgKCFzdHlsZS5oYXNPd25Qcm9wZXJ0eShjc3NQcm9wKSlcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgIGVsLnN0eWxlW2Nzc1Byb3BdID0gc3R5bGVbY3NzUHJvcF07XG4gICAgfVxufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/utils/elt.js\n");

/***/ }),

/***/ "./source/js/utils/events.js":
/*!***********************************!*\
  !*** ./source/js/utils/events.js ***!
  \***********************************/
/*! exports provided: Events */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Events\", function() { return Events; });\n/**\n * Events. Pub/Sub system for Loosely Coupled logic.\n * Based on Peter Higgins' port from Dojo to jQuery\n * https://github.com/phiggins42/bloody-jquery-plugins/blob/master/pubsub.js\n *\n * Re-adapted to vanilla Javascript\n *\n * @class Events\n */\n\nclass DivaEvents\n{\n    constructor()\n    {\n        this._cache = {};\n    }\n\n    /**\n     * diva.Events.publish\n     * e.g.: diva.Events.publish(\"PageDidLoad\", [pageIndex, filename, pageSelector], this);\n     *\n     * @class Events\n     * @method publish\n     * @param topic {String}\n     * @param args  {Array}\n     * @param scope {Object=} Optional - Subscribed functions will be executed with the supplied object as `this`.\n     *     It is necessary to supply this argument with the self variable when within a Diva instance.\n     *     The scope argument is matched with the instance ID of subscribers to determine whether they\n     *         should be executed. (See instanceID argument of subscribe.)\n     */\n    publish(topic, args, scope)\n    {\n        if (this._cache[topic])\n        {\n            const thisTopic = this._cache[topic];\n\n            if (typeof thisTopic.global !== 'undefined')\n            {\n                const thisTopicGlobal = thisTopic.global;\n                const globalCount = thisTopicGlobal.length;\n\n                for (let i=0; i < globalCount; i++)\n                {\n                    thisTopicGlobal[i].apply(scope || null, args || []);\n                }\n            }\n\n            if (scope && typeof scope.getInstanceId !== 'undefined')\n            {\n                // get publisher instance ID from scope arg, compare, and execute if match\n                const instanceID = scope.getInstanceId();\n\n                if (this._cache[topic][instanceID])\n                {\n                    const thisTopicInstance = this._cache[topic][instanceID];\n                    const scopedCount = thisTopicInstance.length;\n\n                    for (let j=0; j < scopedCount; j++)\n                    {\n                        thisTopicInstance[j].apply(scope, args || []);\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * diva.Events.subscribe\n     * e.g.: diva.Events.subscribe(\"PageDidLoad\", highlight, settings.ID)\n     *\n     * @class Events\n     * @method subscribe\n     * @param {string} topic\n     * @param {function} callback\n     * @param {string=} instanceID  Optional - String representing the ID of a Diva instance; if provided,\n     *                                       callback only fires for events published from that instance.\n     * @return Event handler {Array}\n     */\n    subscribe(topic, callback, instanceID)\n    {\n        if (!this._cache[topic])\n        {\n            this._cache[topic] = {};\n        }\n\n        if (typeof instanceID === 'string')\n        {\n            if (!this._cache[topic][instanceID])\n            {\n                this._cache[topic][instanceID] = [];\n            }\n\n            this._cache[topic][instanceID].push(callback);\n        }\n        else\n        {\n            if (!this._cache[topic].global)\n            {\n                this._cache[topic].global = [];\n            }\n\n            this._cache[topic].global.push(callback);\n        }\n\n        return instanceID ? [topic, callback, instanceID] : [topic, callback];\n    }\n\n    /**\n     * diva.Events.unsubscribe\n     * e.g.: var handle = Events.subscribe(\"PageDidLoad\", highlight);\n     *         Events.unsubscribe(handle);\n     *\n     * @class Events\n     * @method unsubscribe\n     * @param {array} handle\n     * @param {boolean=} completely - Unsubscribe all events for a given topic.\n     * @return {boolean} success\n     */\n    unsubscribe(handle, completely)\n    {\n        const t = handle[0];\n\n        if (this._cache[t])\n        {\n            let topicArray;\n            const instanceID = handle.length === 3 ? handle[2] : 'global';\n\n            topicArray = this._cache[t][instanceID];\n\n            if (!topicArray)\n            {\n                return false;\n            }\n\n            if (completely)\n            {\n                delete this._cache[t][instanceID];\n                return topicArray.length > 0;\n            }\n\n            let i = topicArray.length;\n\n            while (i--)\n            {\n                if (topicArray[i] === handle[1])\n                {\n                    this._cache[t][instanceID].splice(i, 1);\n                    return true;\n                }\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * diva.Events.unsubscribeAll\n     * e.g.: diva.Events.unsubscribeAll('global');\n     *\n     * @class Events\n     * @param {string=} instanceID Optional - instance ID to remove subscribers from or 'global' (if omitted,\n     *                              subscribers in all scopes removed)\n     * @method unsubscribeAll\n     */\n    unsubscribeAll(instanceID)\n    {\n        if (instanceID)\n        {\n            const topics = Object.keys(this._cache);\n            let i = topics.length;\n            let topic;\n\n            while (i--)\n            {\n                topic = topics[i];\n\n                if (typeof this._cache[topic][instanceID] !== 'undefined')\n                {\n                    delete this._cache[topic][instanceID];\n                }\n            }\n        }\n        else\n        {\n            this._cache = {};\n        }\n    }\n}\n\nlet Events = new DivaEvents();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdXRpbHMvZXZlbnRzLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL3V0aWxzL2V2ZW50cy5qcz83OWFlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRXZlbnRzLiBQdWIvU3ViIHN5c3RlbSBmb3IgTG9vc2VseSBDb3VwbGVkIGxvZ2ljLlxuICogQmFzZWQgb24gUGV0ZXIgSGlnZ2lucycgcG9ydCBmcm9tIERvam8gdG8galF1ZXJ5XG4gKiBodHRwczovL2dpdGh1Yi5jb20vcGhpZ2dpbnM0Mi9ibG9vZHktanF1ZXJ5LXBsdWdpbnMvYmxvYi9tYXN0ZXIvcHVic3ViLmpzXG4gKlxuICogUmUtYWRhcHRlZCB0byB2YW5pbGxhIEphdmFzY3JpcHRcbiAqXG4gKiBAY2xhc3MgRXZlbnRzXG4gKi9cblxuY2xhc3MgRGl2YUV2ZW50c1xue1xuICAgIGNvbnN0cnVjdG9yKClcbiAgICB7XG4gICAgICAgIHRoaXMuX2NhY2hlID0ge307XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZGl2YS5FdmVudHMucHVibGlzaFxuICAgICAqIGUuZy46IGRpdmEuRXZlbnRzLnB1Ymxpc2goXCJQYWdlRGlkTG9hZFwiLCBbcGFnZUluZGV4LCBmaWxlbmFtZSwgcGFnZVNlbGVjdG9yXSwgdGhpcyk7XG4gICAgICpcbiAgICAgKiBAY2xhc3MgRXZlbnRzXG4gICAgICogQG1ldGhvZCBwdWJsaXNoXG4gICAgICogQHBhcmFtIHRvcGljIHtTdHJpbmd9XG4gICAgICogQHBhcmFtIGFyZ3MgIHtBcnJheX1cbiAgICAgKiBAcGFyYW0gc2NvcGUge09iamVjdD19IE9wdGlvbmFsIC0gU3Vic2NyaWJlZCBmdW5jdGlvbnMgd2lsbCBiZSBleGVjdXRlZCB3aXRoIHRoZSBzdXBwbGllZCBvYmplY3QgYXMgYHRoaXNgLlxuICAgICAqICAgICBJdCBpcyBuZWNlc3NhcnkgdG8gc3VwcGx5IHRoaXMgYXJndW1lbnQgd2l0aCB0aGUgc2VsZiB2YXJpYWJsZSB3aGVuIHdpdGhpbiBhIERpdmEgaW5zdGFuY2UuXG4gICAgICogICAgIFRoZSBzY29wZSBhcmd1bWVudCBpcyBtYXRjaGVkIHdpdGggdGhlIGluc3RhbmNlIElEIG9mIHN1YnNjcmliZXJzIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZXlcbiAgICAgKiAgICAgICAgIHNob3VsZCBiZSBleGVjdXRlZC4gKFNlZSBpbnN0YW5jZUlEIGFyZ3VtZW50IG9mIHN1YnNjcmliZS4pXG4gICAgICovXG4gICAgcHVibGlzaCh0b3BpYywgYXJncywgc2NvcGUpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fY2FjaGVbdG9waWNdKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB0aGlzVG9waWMgPSB0aGlzLl9jYWNoZVt0b3BpY107XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpc1RvcGljLmdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGhpc1RvcGljR2xvYmFsID0gdGhpc1RvcGljLmdsb2JhbDtcbiAgICAgICAgICAgICAgICBjb25zdCBnbG9iYWxDb3VudCA9IHRoaXNUb3BpY0dsb2JhbC5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpPTA7IGkgPCBnbG9iYWxDb3VudDsgaSsrKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1RvcGljR2xvYmFsW2ldLmFwcGx5KHNjb3BlIHx8IG51bGwsIGFyZ3MgfHwgW10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHNjb3BlICYmIHR5cGVvZiBzY29wZS5nZXRJbnN0YW5jZUlkICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBnZXQgcHVibGlzaGVyIGluc3RhbmNlIElEIGZyb20gc2NvcGUgYXJnLCBjb21wYXJlLCBhbmQgZXhlY3V0ZSBpZiBtYXRjaFxuICAgICAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlSUQgPSBzY29wZS5nZXRJbnN0YW5jZUlkKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fY2FjaGVbdG9waWNdW2luc3RhbmNlSURdKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGhpc1RvcGljSW5zdGFuY2UgPSB0aGlzLl9jYWNoZVt0b3BpY11baW5zdGFuY2VJRF07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjb3BlZENvdW50ID0gdGhpc1RvcGljSW5zdGFuY2UubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGo9MDsgaiA8IHNjb3BlZENvdW50OyBqKyspXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNUb3BpY0luc3RhbmNlW2pdLmFwcGx5KHNjb3BlLCBhcmdzIHx8IFtdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGRpdmEuRXZlbnRzLnN1YnNjcmliZVxuICAgICAqIGUuZy46IGRpdmEuRXZlbnRzLnN1YnNjcmliZShcIlBhZ2VEaWRMb2FkXCIsIGhpZ2hsaWdodCwgc2V0dGluZ3MuSUQpXG4gICAgICpcbiAgICAgKiBAY2xhc3MgRXZlbnRzXG4gICAgICogQG1ldGhvZCBzdWJzY3JpYmVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdG9waWNcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFja1xuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gaW5zdGFuY2VJRCAgT3B0aW9uYWwgLSBTdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBJRCBvZiBhIERpdmEgaW5zdGFuY2U7IGlmIHByb3ZpZGVkLFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sgb25seSBmaXJlcyBmb3IgZXZlbnRzIHB1Ymxpc2hlZCBmcm9tIHRoYXQgaW5zdGFuY2UuXG4gICAgICogQHJldHVybiBFdmVudCBoYW5kbGVyIHtBcnJheX1cbiAgICAgKi9cbiAgICBzdWJzY3JpYmUodG9waWMsIGNhbGxiYWNrLCBpbnN0YW5jZUlEKVxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jYWNoZVt0b3BpY10pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlW3RvcGljXSA9IHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGVvZiBpbnN0YW5jZUlEID09PSAnc3RyaW5nJylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9jYWNoZVt0b3BpY11baW5zdGFuY2VJRF0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2FjaGVbdG9waWNdW2luc3RhbmNlSURdID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2NhY2hlW3RvcGljXVtpbnN0YW5jZUlEXS5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fY2FjaGVbdG9waWNdLmdsb2JhbClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZVt0b3BpY10uZ2xvYmFsID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2NhY2hlW3RvcGljXS5nbG9iYWwucHVzaChjYWxsYmFjayk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaW5zdGFuY2VJRCA/IFt0b3BpYywgY2FsbGJhY2ssIGluc3RhbmNlSURdIDogW3RvcGljLCBjYWxsYmFja107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZGl2YS5FdmVudHMudW5zdWJzY3JpYmVcbiAgICAgKiBlLmcuOiB2YXIgaGFuZGxlID0gRXZlbnRzLnN1YnNjcmliZShcIlBhZ2VEaWRMb2FkXCIsIGhpZ2hsaWdodCk7XG4gICAgICogICAgICAgICBFdmVudHMudW5zdWJzY3JpYmUoaGFuZGxlKTtcbiAgICAgKlxuICAgICAqIEBjbGFzcyBFdmVudHNcbiAgICAgKiBAbWV0aG9kIHVuc3Vic2NyaWJlXG4gICAgICogQHBhcmFtIHthcnJheX0gaGFuZGxlXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gY29tcGxldGVseSAtIFVuc3Vic2NyaWJlIGFsbCBldmVudHMgZm9yIGEgZ2l2ZW4gdG9waWMuXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gc3VjY2Vzc1xuICAgICAqL1xuICAgIHVuc3Vic2NyaWJlKGhhbmRsZSwgY29tcGxldGVseSlcbiAgICB7XG4gICAgICAgIGNvbnN0IHQgPSBoYW5kbGVbMF07XG5cbiAgICAgICAgaWYgKHRoaXMuX2NhY2hlW3RdKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgdG9waWNBcnJheTtcbiAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlSUQgPSBoYW5kbGUubGVuZ3RoID09PSAzID8gaGFuZGxlWzJdIDogJ2dsb2JhbCc7XG5cbiAgICAgICAgICAgIHRvcGljQXJyYXkgPSB0aGlzLl9jYWNoZVt0XVtpbnN0YW5jZUlEXTtcblxuICAgICAgICAgICAgaWYgKCF0b3BpY0FycmF5KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNvbXBsZXRlbHkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2NhY2hlW3RdW2luc3RhbmNlSURdO1xuICAgICAgICAgICAgICAgIHJldHVybiB0b3BpY0FycmF5Lmxlbmd0aCA+IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBpID0gdG9waWNBcnJheS5sZW5ndGg7XG5cbiAgICAgICAgICAgIHdoaWxlIChpLS0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKHRvcGljQXJyYXlbaV0gPT09IGhhbmRsZVsxXSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlW3RdW2luc3RhbmNlSURdLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGRpdmEuRXZlbnRzLnVuc3Vic2NyaWJlQWxsXG4gICAgICogZS5nLjogZGl2YS5FdmVudHMudW5zdWJzY3JpYmVBbGwoJ2dsb2JhbCcpO1xuICAgICAqXG4gICAgICogQGNsYXNzIEV2ZW50c1xuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gaW5zdGFuY2VJRCBPcHRpb25hbCAtIGluc3RhbmNlIElEIHRvIHJlbW92ZSBzdWJzY3JpYmVycyBmcm9tIG9yICdnbG9iYWwnIChpZiBvbWl0dGVkLFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlcnMgaW4gYWxsIHNjb3BlcyByZW1vdmVkKVxuICAgICAqIEBtZXRob2QgdW5zdWJzY3JpYmVBbGxcbiAgICAgKi9cbiAgICB1bnN1YnNjcmliZUFsbChpbnN0YW5jZUlEKVxuICAgIHtcbiAgICAgICAgaWYgKGluc3RhbmNlSUQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHRvcGljcyA9IE9iamVjdC5rZXlzKHRoaXMuX2NhY2hlKTtcbiAgICAgICAgICAgIGxldCBpID0gdG9waWNzLmxlbmd0aDtcbiAgICAgICAgICAgIGxldCB0b3BpYztcblxuICAgICAgICAgICAgd2hpbGUgKGktLSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0b3BpYyA9IHRvcGljc1tpXTtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5fY2FjaGVbdG9waWNdW2luc3RhbmNlSURdICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9jYWNoZVt0b3BpY11baW5zdGFuY2VJRF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fY2FjaGUgPSB7fTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGxldCBFdmVudHMgPSBuZXcgRGl2YUV2ZW50cygpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./source/js/utils/events.js\n");

/***/ }),

/***/ "./source/js/utils/get-scrollbar-width.js":
/*!************************************************!*\
  !*** ./source/js/utils/get-scrollbar-width.js ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return getScrollbarWidth; });\n// From http://www.alexandre-gomes.com/?p=115, modified slightly\nfunction getScrollbarWidth()\n{\n    let inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '200px';\n\n    let outer = document.createElement('div');\n    outer.style.position = 'absolute';\n    outer.style.top = '0px';\n    outer.style.left = '0px';\n    outer.style.visibility = 'hidden';\n    outer.style.width = '200px';\n    outer.style.height = '150px';\n    outer.style.overflow = 'hidden';\n    outer.appendChild(inner);\n\n    document.body.appendChild(outer);\n\n    let w1 = inner.offsetWidth;\n    outer.style.overflow = 'scroll';\n    let w2 = inner.offsetWidth;\n    if (w1 === w2) {\n        w2 = outer.clientWidth; // for IE i think\n    }\n\n    document.body.removeChild(outer);\n    return w1 - w2;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdXRpbHMvZ2V0LXNjcm9sbGJhci13aWR0aC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NvdXJjZS9qcy91dGlscy9nZXQtc2Nyb2xsYmFyLXdpZHRoLmpzPzA5ODUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gRnJvbSBodHRwOi8vd3d3LmFsZXhhbmRyZS1nb21lcy5jb20vP3A9MTE1LCBtb2RpZmllZCBzbGlnaHRseVxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0U2Nyb2xsYmFyV2lkdGgoKVxue1xuICAgIGxldCBpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBpbm5lci5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICBpbm5lci5zdHlsZS5oZWlnaHQgPSAnMjAwcHgnO1xuXG4gICAgbGV0IG91dGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgb3V0ZXIuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgIG91dGVyLnN0eWxlLnRvcCA9ICcwcHgnO1xuICAgIG91dGVyLnN0eWxlLmxlZnQgPSAnMHB4JztcbiAgICBvdXRlci5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgb3V0ZXIuc3R5bGUud2lkdGggPSAnMjAwcHgnO1xuICAgIG91dGVyLnN0eWxlLmhlaWdodCA9ICcxNTBweCc7XG4gICAgb3V0ZXIuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgICBvdXRlci5hcHBlbmRDaGlsZChpbm5lcik7XG5cbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG91dGVyKTtcblxuICAgIGxldCB3MSA9IGlubmVyLm9mZnNldFdpZHRoO1xuICAgIG91dGVyLnN0eWxlLm92ZXJmbG93ID0gJ3Njcm9sbCc7XG4gICAgbGV0IHcyID0gaW5uZXIub2Zmc2V0V2lkdGg7XG4gICAgaWYgKHcxID09PSB3Mikge1xuICAgICAgICB3MiA9IG91dGVyLmNsaWVudFdpZHRoOyAvLyBmb3IgSUUgaSB0aGlua1xuICAgIH1cblxuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3V0ZXIpO1xuICAgIHJldHVybiB3MSAtIHcyO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/utils/get-scrollbar-width.js\n");

/***/ }),

/***/ "./source/js/utils/hash-params.js":
/*!****************************************!*\
  !*** ./source/js/utils/hash-params.js ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nlet HashParams = {\n    get: getHashParam,\n    update: updateHashParam\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (HashParams);\n\n\n// For getting the #key values from the URL. For specifying a page and zoom level\n// Look into caching, because we only need to get this during the initial load\n// Although for the tests I guess we would need to override caching somehow\nfunction getHashParam (key)\n{\n    const hash = window.location.hash;\n\n    if (hash !== '')\n    {\n        // Check if there is something that looks like either &key= or #key=\n        let startIndex = (hash.indexOf('&' + key + '=') > 0) ? hash.indexOf('&' + key + '=') : hash.indexOf('#' + key + '=');\n\n        // If startIndex is still -1, it means it can't find either\n        if (startIndex >= 0)\n        {\n            // Add the length of the key plus the & and =\n            startIndex += key.length + 2;\n\n            // Either to the next ampersand or to the end of the string\n            const endIndex = hash.indexOf('&', startIndex);\n            if (endIndex > startIndex)\n            {\n                return decodeURIComponent(hash.substring(startIndex, endIndex));\n            }\n            else if (endIndex < 0)\n            {\n                // This means this hash param is the last one\n                return decodeURIComponent(hash.substring(startIndex));\n            }\n            // If the key doesn't have a value I think\n            return '';\n        }\n        else\n        {\n            // If it can't find the key\n            return false;\n        }\n    }\n    else\n    {\n        // If there are no hash params just return false\n        return false;\n    }\n}\n\nfunction updateHashParam (key, value)\n{\n    // First make sure that we have to do any work at all\n    const originalValue = getHashParam(key);\n    const hash = window.location.hash;\n\n    if (originalValue !== value)\n    {\n        // Is the key already in the URL?\n        if (typeof originalValue === 'string')\n        {\n            // Already in the URL. Just get rid of the original value\n            const startIndex = (hash.indexOf('&' + key + '=') > 0) ? hash.indexOf('&' + key + '=') : hash.indexOf('#' + key + '=');\n            const endIndex = startIndex + key.length + 2 + originalValue.length;\n            // # if it's the first, & otherwise\n            const startThing = (startIndex === 0) ? '#' : '&';\n            window.location.replace(hash.substring(0, startIndex) + startThing + key + '=' + value + hash.substring(endIndex));\n        }\n        else\n        {\n            // It's not present - add it\n            if (hash.length === 0)\n            {\n                window.location.replace('#' + key + '=' + value);\n            }\n            else\n            {\n                // Append it\n                window.location.replace(hash + '&' + key + '=' + value);\n            }\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdXRpbHMvaGFzaC1wYXJhbXMuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvdXRpbHMvaGFzaC1wYXJhbXMuanM/NTEwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgSGFzaFBhcmFtcyA9IHtcbiAgICBnZXQ6IGdldEhhc2hQYXJhbSxcbiAgICB1cGRhdGU6IHVwZGF0ZUhhc2hQYXJhbVxufTtcblxuZXhwb3J0IGRlZmF1bHQgSGFzaFBhcmFtcztcblxuXG4vLyBGb3IgZ2V0dGluZyB0aGUgI2tleSB2YWx1ZXMgZnJvbSB0aGUgVVJMLiBGb3Igc3BlY2lmeWluZyBhIHBhZ2UgYW5kIHpvb20gbGV2ZWxcbi8vIExvb2sgaW50byBjYWNoaW5nLCBiZWNhdXNlIHdlIG9ubHkgbmVlZCB0byBnZXQgdGhpcyBkdXJpbmcgdGhlIGluaXRpYWwgbG9hZFxuLy8gQWx0aG91Z2ggZm9yIHRoZSB0ZXN0cyBJIGd1ZXNzIHdlIHdvdWxkIG5lZWQgdG8gb3ZlcnJpZGUgY2FjaGluZyBzb21laG93XG5mdW5jdGlvbiBnZXRIYXNoUGFyYW0gKGtleSlcbntcbiAgICBjb25zdCBoYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2g7XG5cbiAgICBpZiAoaGFzaCAhPT0gJycpXG4gICAge1xuICAgICAgICAvLyBDaGVjayBpZiB0aGVyZSBpcyBzb21ldGhpbmcgdGhhdCBsb29rcyBsaWtlIGVpdGhlciAma2V5PSBvciAja2V5PVxuICAgICAgICBsZXQgc3RhcnRJbmRleCA9IChoYXNoLmluZGV4T2YoJyYnICsga2V5ICsgJz0nKSA+IDApID8gaGFzaC5pbmRleE9mKCcmJyArIGtleSArICc9JykgOiBoYXNoLmluZGV4T2YoJyMnICsga2V5ICsgJz0nKTtcblxuICAgICAgICAvLyBJZiBzdGFydEluZGV4IGlzIHN0aWxsIC0xLCBpdCBtZWFucyBpdCBjYW4ndCBmaW5kIGVpdGhlclxuICAgICAgICBpZiAoc3RhcnRJbmRleCA+PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBBZGQgdGhlIGxlbmd0aCBvZiB0aGUga2V5IHBsdXMgdGhlICYgYW5kID1cbiAgICAgICAgICAgIHN0YXJ0SW5kZXggKz0ga2V5Lmxlbmd0aCArIDI7XG5cbiAgICAgICAgICAgIC8vIEVpdGhlciB0byB0aGUgbmV4dCBhbXBlcnNhbmQgb3IgdG8gdGhlIGVuZCBvZiB0aGUgc3RyaW5nXG4gICAgICAgICAgICBjb25zdCBlbmRJbmRleCA9IGhhc2guaW5kZXhPZignJicsIHN0YXJ0SW5kZXgpO1xuICAgICAgICAgICAgaWYgKGVuZEluZGV4ID4gc3RhcnRJbmRleClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGhhc2guc3Vic3RyaW5nKHN0YXJ0SW5kZXgsIGVuZEluZGV4KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChlbmRJbmRleCA8IDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBtZWFucyB0aGlzIGhhc2ggcGFyYW0gaXMgdGhlIGxhc3Qgb25lXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChoYXNoLnN1YnN0cmluZyhzdGFydEluZGV4KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZiB0aGUga2V5IGRvZXNuJ3QgaGF2ZSBhIHZhbHVlIEkgdGhpbmtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIElmIGl0IGNhbid0IGZpbmQgdGhlIGtleVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgIC8vIElmIHRoZXJlIGFyZSBubyBoYXNoIHBhcmFtcyBqdXN0IHJldHVybiBmYWxzZVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVIYXNoUGFyYW0gKGtleSwgdmFsdWUpXG57XG4gICAgLy8gRmlyc3QgbWFrZSBzdXJlIHRoYXQgd2UgaGF2ZSB0byBkbyBhbnkgd29yayBhdCBhbGxcbiAgICBjb25zdCBvcmlnaW5hbFZhbHVlID0gZ2V0SGFzaFBhcmFtKGtleSk7XG4gICAgY29uc3QgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoO1xuXG4gICAgaWYgKG9yaWdpbmFsVmFsdWUgIT09IHZhbHVlKVxuICAgIHtcbiAgICAgICAgLy8gSXMgdGhlIGtleSBhbHJlYWR5IGluIHRoZSBVUkw/XG4gICAgICAgIGlmICh0eXBlb2Ygb3JpZ2luYWxWYWx1ZSA9PT0gJ3N0cmluZycpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIEFscmVhZHkgaW4gdGhlIFVSTC4gSnVzdCBnZXQgcmlkIG9mIHRoZSBvcmlnaW5hbCB2YWx1ZVxuICAgICAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IChoYXNoLmluZGV4T2YoJyYnICsga2V5ICsgJz0nKSA+IDApID8gaGFzaC5pbmRleE9mKCcmJyArIGtleSArICc9JykgOiBoYXNoLmluZGV4T2YoJyMnICsga2V5ICsgJz0nKTtcbiAgICAgICAgICAgIGNvbnN0IGVuZEluZGV4ID0gc3RhcnRJbmRleCArIGtleS5sZW5ndGggKyAyICsgb3JpZ2luYWxWYWx1ZS5sZW5ndGg7XG4gICAgICAgICAgICAvLyAjIGlmIGl0J3MgdGhlIGZpcnN0LCAmIG90aGVyd2lzZVxuICAgICAgICAgICAgY29uc3Qgc3RhcnRUaGluZyA9IChzdGFydEluZGV4ID09PSAwKSA/ICcjJyA6ICcmJztcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKGhhc2guc3Vic3RyaW5nKDAsIHN0YXJ0SW5kZXgpICsgc3RhcnRUaGluZyArIGtleSArICc9JyArIHZhbHVlICsgaGFzaC5zdWJzdHJpbmcoZW5kSW5kZXgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIEl0J3Mgbm90IHByZXNlbnQgLSBhZGQgaXRcbiAgICAgICAgICAgIGlmIChoYXNoLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZSgnIycgKyBrZXkgKyAnPScgKyB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gQXBwZW5kIGl0XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UoaGFzaCArICcmJyArIGtleSArICc9JyArIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/utils/hash-params.js\n");

/***/ }),

/***/ "./source/js/utils/parse-label-value.js":
/*!**********************************************!*\
  !*** ./source/js/utils/parse-label-value.js ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return parseLabelValue; });\n/**\n * Parses a v3 manifest's label/value pair from an object & array to a string\n *\n * @public\n * @params {string} key - The key from which a label/value pair should be extracted.\n * @returns {object} - The label/value pair as strings.\n * */\n\nfunction parseLabelValue (key)\n{\n    let l = key.label; \n    let label = (typeof l === 'object') ? l[Object.keys(l)[0]][0] : l;\n\n    let v = key.value;\n    let value;\n    if (Array.isArray(v))\n    { // is array of objects\n        value = v.map(e => e[Object.keys(e)[0]]);\n    }\n    else\n    { // is object where value is possibly an array\n        value = (typeof v === 'object') ? v[Object.keys(v)[0]] : v;\n    }\n\n    if (Array.isArray(value))\n    {\n        value = value.join(', ');\n    }\n\n    return {\n        label: label,\n        value: value\n    };\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdXRpbHMvcGFyc2UtbGFiZWwtdmFsdWUuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvdXRpbHMvcGFyc2UtbGFiZWwtdmFsdWUuanM/OGY1YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFBhcnNlcyBhIHYzIG1hbmlmZXN0J3MgbGFiZWwvdmFsdWUgcGFpciBmcm9tIGFuIG9iamVjdCAmIGFycmF5IHRvIGEgc3RyaW5nXG4gKlxuICogQHB1YmxpY1xuICogQHBhcmFtcyB7c3RyaW5nfSBrZXkgLSBUaGUga2V5IGZyb20gd2hpY2ggYSBsYWJlbC92YWx1ZSBwYWlyIHNob3VsZCBiZSBleHRyYWN0ZWQuXG4gKiBAcmV0dXJucyB7b2JqZWN0fSAtIFRoZSBsYWJlbC92YWx1ZSBwYWlyIGFzIHN0cmluZ3MuXG4gKiAqL1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBwYXJzZUxhYmVsVmFsdWUgKGtleSlcbntcbiAgICBsZXQgbCA9IGtleS5sYWJlbDsgXG4gICAgbGV0IGxhYmVsID0gKHR5cGVvZiBsID09PSAnb2JqZWN0JykgPyBsW09iamVjdC5rZXlzKGwpWzBdXVswXSA6IGw7XG5cbiAgICBsZXQgdiA9IGtleS52YWx1ZTtcbiAgICBsZXQgdmFsdWU7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodikpXG4gICAgeyAvLyBpcyBhcnJheSBvZiBvYmplY3RzXG4gICAgICAgIHZhbHVlID0gdi5tYXAoZSA9PiBlW09iamVjdC5rZXlzKGUpWzBdXSk7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7IC8vIGlzIG9iamVjdCB3aGVyZSB2YWx1ZSBpcyBwb3NzaWJseSBhbiBhcnJheVxuICAgICAgICB2YWx1ZSA9ICh0eXBlb2YgdiA9PT0gJ29iamVjdCcpID8gdltPYmplY3Qua2V5cyh2KVswXV0gOiB2O1xuICAgIH1cblxuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSlcbiAgICB7XG4gICAgICAgIHZhbHVlID0gdmFsdWUuam9pbignLCAnKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgIH07XG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/utils/parse-label-value.js\n");

/***/ }),

/***/ "./source/js/utils/vanilla.kinetic.js":
/*!********************************************!*\
  !*** ./source/js/utils/vanilla.kinetic.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("/*\n The MIT License (MIT)\n Copyright (c) <2011> <Dave Taylor http://the-taylors.org>\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is furnished\n to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in all\n copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\n FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\n COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\n IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n Port to vanilla Javascript by Jacek Nowacki http://jacek-nowacki.net/\n**/\n\n(function() {\n    var _raf = window.requestAnimationFrame;\n\n    var _isTouch = 'ontouchend' in document;\n\n    // this is simple, no \"deep\" support\n    var _extend = function() {\n        for (var i=1; i<arguments.length; i++) {\n            for (var key in arguments[i]) {\n                if (arguments[i].hasOwnProperty(key)) {\n                    arguments[0][key] = arguments[i][key];\n                }\n            }\n        }\n        return arguments[0];\n    };\n\n    var VanillaKinetic = function(element, settings) {\n        this.settings = _extend({}, VanillaKinetic.DEFAULTS, settings);\n        this.el       = element;\n        this.ACTIVE_CLASS = \"kinetic-active\";\n\n        this._initElements();\n\n        this.el._VanillaKinetic = this;\n        return this;\n    };\n\n    VanillaKinetic.DEFAULTS = {\n        cursor: 'move',\n        decelerate: true,\n        triggerHardware: false,\n        threshold: 0,\n        y: true,\n        x: true,\n        slowdown: 0.9,\n        maxvelocity: 40,\n        throttleFPS: 60,\n        invert: false,\n        movingClass: {\n            up: 'kinetic-moving-up',\n            down: 'kinetic-moving-down',\n            left: 'kinetic-moving-left',\n            right: 'kinetic-moving-right'\n        },\n        deceleratingClass: {\n            up: 'kinetic-decelerating-up',\n            down: 'kinetic-decelerating-down',\n            left: 'kinetic-decelerating-left',\n            right: 'kinetic-decelerating-right'\n        }\n    };\n\n    // Public functions\n    VanillaKinetic.prototype.start = function(options) {\n        this.settings = _extend(this.settings, options);\n        this.velocity = options.velocity || this.velocity;\n        this.velocityY = options.velocityY || this.velocityY;\n        this.settings.decelerate = false;\n        this._move();\n    };\n\n    VanillaKinetic.prototype.end = function() {\n        this.settings.decelerate = true;\n    };\n\n    VanillaKinetic.prototype.stop = function() {\n        this.velocity = 0;\n        this.velocityY = 0;\n        this.settings.decelerate = true;\n        if (typeof this.settings.stopped === 'function') {\n            this.settings.stopped.call(this);\n        }\n    };\n\n    VanillaKinetic.prototype.detach = function() {\n        this._detachListeners();\n        this.el.classList.remove(this.ACTIVE_CLASS);\n        this.el.style.cursor = '';\n    };\n\n    VanillaKinetic.prototype.attach = function() {\n        if (this.el.classList.contains(this.ACTIVE_CLASS)) {\n            return;\n        }\n        this._attachListeners();\n        this.el.classList.add(this.ACTIVE_CLASS);\n        this.el.style.cursor = this.settings.cursor;\n    };\n\n    // Internal functions\n\n    VanillaKinetic.prototype._initElements = function() {\n        this.el.classList.add(this.ACTIVE_CLASS);\n\n        _extend(this, {\n            xpos: null,\n            prevXPos: false,\n            ypos: null,\n            prevYPos: false,\n            mouseDown: false,\n            throttleTimeout: 1000 / this.settings.throttleFPS,\n            lastMove: null,\n            elementFocused: null\n        });\n\n        this.velocity = 0;\n        this.velocityY = 0;\n\n        var that = this;\n        this.documentResetHandler = function() {\n            that._resetMouse.apply(that);\n        };\n\n        // FIXME make sure to remove this\n        var html = document.documentElement;\n        html.addEventListener(\"mouseup\", this.documentResetHandler, false);\n        html.addEventListener(\"click\", this.documentResetHandler, false);\n\n        this._initEvents();\n\n        this.el.style.cursor = this.settings.cursor;\n\n        if (this.settings.triggerHardware) {\n            var prefixes = ['', '-ms-', '-webkit-', '-moz-'];\n            var styles = {\n                'transform': 'translate3d(0,0,0)',\n                'perspective': '1000', // TODO is this even valid? is this even needed?\n                'backface-visibility': 'hidden'\n            };\n            for (var i=0; i<prefixes.length; i++) {\n                var prefix = prefixes[i];\n                for (var key in styles) {\n                    if (styles.hasOwnProperty(key)){\n                        this.el.style[prefix+key] = styles[key];\n                    }\n                }\n            }\n        }\n    };\n\n    VanillaKinetic.prototype._initEvents = function() {\n        var self = this;\n        this.settings.events = {\n            touchStart: function(e) {\n                var touch;\n                if (self._useTarget(e.target, e)) {\n                    touch = e.originalEvent.touches[0];\n                    self.threshold = self._threshold(e.target, e);\n                    self._start(touch.clientX, touch.clientY);\n                    e.stopPropagation();\n                }\n            },\n            touchMove: function(e) {\n                var touch;\n                if (self.mouseDown) {\n                    touch = e.originalEvent.touches[0];\n                    self._inputmove(touch.clientX, touch.clientY);\n                    if (e.preventDefault) {\n                        e.preventDefault();\n                    }\n                }\n            },\n            inputDown: function(e) {\n                if (self._useTarget(e.target, e)) {\n                    self.threshold = self._threshold(e.target, e);\n                    self._start(e.clientX, e.clientY);\n                    self.elementFocused = e.target;\n                    if (e.target.nodeName === \"IMG\") {\n                        e.preventDefault();\n                    }\n                    e.stopPropagation();\n                }\n            },\n            inputEnd: function(e) {\n                if (self._useTarget(e.target, e)) {\n                    self._end();\n                    self.elementFocused = null;\n                    if (e.preventDefault) {\n                        e.preventDefault();\n                    }\n                }\n            },\n            inputMove: function(e) {\n                if (self.mouseDown) {\n                    self._inputmove(e.clientX, e.clientY);\n                    if (e.preventDefault) {\n                        e.preventDefault();\n                    }\n                }\n            },\n            scroll: function(e) {\n                if (typeof self.settings.moved === 'function') {\n                    self.settings.moved.call(self, self.settings);\n                }\n                if (e.preventDefault) {\n                    e.preventDefault();\n                }\n            },\n            inputClick: function(e) {\n                if (Math.abs(self.velocity) > 0 || Math.abs(self.velocityY) > 0) {\n                    e.preventDefault();\n                    if (e.stopPropagation) {\n                        e.stopPropagation();\n                    }\n                    return false;\n                }\n            },\n            dragStart: function(e) {\n                if (self._useTarget(e.target, e) && self.elementFocused) {\n                    if (e.preventDefault) {\n                        e.preventDefault();\n                    }\n                    if (e.stopPropagation) {\n                        e.stopPropagation();\n                    }\n                    return false;\n                }\n            },\n            selectStart: function(e) {\n                if (typeof self.settings.selectStart === 'function') {\n                    return self.settings.selectStart.apply(self, arguments);\n                }\n                else if (self._useTarget(e.target, e)) {\n                    if (e.preventDefault) {\n                        e.preventDefault();\n                    }\n                    if (e.stopPropagation) {\n                        e.stopPropagation();\n                    }\n                    return false;\n                }\n            }\n        };\n\n        this._attachListeners();\n    };\n\n    VanillaKinetic.prototype._inputmove = function(clientX, clientY) {\n        if (!this.lastMove || new Date() > new Date(this.lastMove.getTime() + this.throttleTimeout)) {\n            this.lastMove = new Date();\n\n            if (this.mouseDown && (this.xpos || this.ypos)) {\n                var movedX = (clientX - this.xpos);\n                var movedY = (clientY - this.ypos);\n                if (this.settings.invert) {\n                    movedX *= -1;\n                    movedY *= -1;\n                }\n                if (this.threshold>0) {\n                    var moved = Math.sqrt(movedX*movedX + movedY*movedY);\n                    if (this.threshold>moved) {\n                        return;\n                    }\n                    else {\n                        this.threshold = 0;\n                    }\n                }\n                if (this.elementFocused) {\n                    this.elementFocused.blur();\n                    this.elementFocused = null;\n                    this.el.focus();\n                }\n\n                this.settings.decelerate = false;\n                this.velocity = this.velocityY = 0;\n\n                var scrollLeft = this.scrollLeft();\n                var scrollTop = this.scrollTop();\n\n                this.scrollLeft(this.settings.x ? scrollLeft - movedX : scrollLeft);\n                this.scrollTop(this.settings.y ? scrollTop - movedY : scrollTop);\n\n                this.prevXPos = this.xpos;\n                this.prevYPos = this.ypos;\n                this.xpos = clientX;\n                this.ypos = clientY;\n\n                this._calculateVelocities();\n                this._setMoveClasses(this.settings.movingClass);\n\n                if (typeof this.settings.moved === 'function') {\n                    this.settings.moved.call(this, this.settings);\n                }\n            }\n        }\n    };\n\n    VanillaKinetic.prototype._calculateVelocities = function() {\n        this.velocity = this._capVelocity(this.prevXPos - this.xpos, this.settings.maxvelocity);\n        this.velocityY = this._capVelocity(this.prevYPos - this.ypos, this.settings.maxvelocity);\n        if (this.settings.invert) {\n            this.velocity *= -1;\n            this.velocityY *= -1;\n        }\n    };\n\n    VanillaKinetic.prototype._end = function() {\n        if (this.xpos && this.prevXPos && this.settings.decelerate === false) {\n            this.settings.decelerate = true;\n            this._calculateVelocities();\n            this.xpos = this.prevXPos = this.mouseDown = false;\n            this._move();\n        }\n    };\n\n    VanillaKinetic.prototype._useTarget = function(target, event) {\n        if (typeof this.settings.filterTarget === 'function') {\n            return this.settings.filterTarget.call(this, target, event) !== false;\n        }\n        return true;\n\n    };\n\n    VanillaKinetic.prototype._threshold = function(target, event) {\n        if (typeof this.settings.threshold === 'function') {\n            return this.settings.threshold.call(this, target, event);\n        }\n        return this.settings.threshold;\n    };\n\n    VanillaKinetic.prototype._start = function(clientX, clientY) {\n        this.mouseDown = true;\n        this.velocity = this.prevXPos = 0;\n        this.velocityY = this.prevYPos = 0;\n        this.xpos = clientX;\n        this.ypos = clientY;\n    };\n\n    VanillaKinetic.prototype._resetMouse = function() {\n        this.xpos = false;\n        this.ypos = false;\n        this.mouseDown = false;\n    };\n\n    VanillaKinetic.prototype._decelerateVelocity = function(velocity, slowdown) {\n        return Math.floor(Math.abs(velocity)) === 0 ? 0 // is velocity less than 1?\n            : velocity * slowdown; // reduce slowdown\n    };\n\n    VanillaKinetic.prototype._capVelocity = function(velocity, max) {\n        var newVelocity = velocity;\n        if (velocity > 0){\n            if (velocity > max){\n                newVelocity = max;\n            }\n        } else {\n            if (velocity < (0 - max)){\n                newVelocity = (0 - max);\n            }\n        }\n        return newVelocity;\n    };\n\n    VanillaKinetic.prototype._setMoveClasses = function(classes) {\n        // The fix-me comment below is from original jQuery.kinetic project\n        // FIXME: consider if we want to apply PL #44, this should not remove\n        // classes we have not defined on the element!\n        var settings = this.settings;\n        var el = this.el;\n\n        el.classList.remove(settings.movingClass.up);\n        el.classList.remove(settings.movingClass.down);\n        el.classList.remove(settings.movingClass.left);\n        el.classList.remove(settings.movingClass.right);\n        el.classList.remove(settings.deceleratingClass.up);\n        el.classList.remove(settings.deceleratingClass.down);\n        el.classList.remove(settings.deceleratingClass.left);\n        el.classList.remove(settings.deceleratingClass.right);\n\n        if (this.velocity > 0){\n            el.classList.add(classes.right);\n        }\n        if (this.velocity < 0){\n            el.classList.add(classes.left);\n        }\n        if (this.velocityY > 0){\n            el.classList.add(classes.down);\n        }\n        if (this.velocityY < 0){\n            el.classList.add(classes.up);\n        }\n    };\n\n    VanillaKinetic.prototype._move = function() {\n        var scroller = this._getScroller();\n        var self = this;\n        var settings = this.settings;\n\n        if (settings.x && scroller.scrollWidth > 0) {\n            this.scrollLeft(this.scrollLeft() + this.velocity);\n            if (Math.abs(this.velocity) > 0) {\n                this.velocity = settings.decelerate ?\n                    self._decelerateVelocity(this.velocity, settings.slowdown) : this.velocity;\n            }\n        }\n        else {\n            this.velocity = 0;\n        }\n\n        if (settings.y && scroller.scrollHeight > 0){\n            this.scrollTop(this.scrollTop() + this.velocityY);\n            if (Math.abs(this.velocityY) > 0){\n                this.velocityY = settings.decelerate ?\n                    self._decelerateVelocity(this.velocityY, settings.slowdown) : this.velocityY;\n            }\n        }\n        else {\n            this.velocityY = 0;\n        }\n\n        self._setMoveClasses(settings.deceleratingClass);\n\n        if (typeof settings.moved === 'function'){\n            settings.moved.call(this, settings);\n        }\n\n        if (Math.abs(this.velocity) > 0 || Math.abs(this.velocityY) > 0){\n            if (!this.moving) {\n                this.moving = true;\n                // tick for next movement\n                _raf(function() {\n                    self.moving = false;\n                    self._move();\n                });\n            }\n        }\n        else {\n            self.stop();\n        }\n    };\n\n    VanillaKinetic.prototype._getScroller = function() {\n        // FIXME we may want to normalize behaviour across browsers as in original jQuery.kinetic\n        // currently this won't work correctly on all brwosers when attached to html or body element\n        return this.el;\n    };\n\n    VanillaKinetic.prototype.scrollLeft = function(left) {\n        var scroller = this._getScroller();\n        if (typeof left === 'number') {\n            scroller.scrollLeft = left;\n            this.settings.scrollLeft = left;\n        }\n        else {\n            return scroller.scrollLeft;\n        }\n    };\n\n    VanillaKinetic.prototype.scrollTop = function(top) {\n        var scroller = this._getScroller();\n        if (typeof top === 'number') {\n            scroller.scrollTop = top;\n            this.settings.scrollTop = top;\n        }\n        else {\n            return scroller.scrollTop;\n        }\n    };\n\n    VanillaKinetic.prototype._attachListeners = function() {\n        var el = this.el;\n        var settings = this.settings;\n\n        if (_isTouch) {\n            el.addEventListener('touchstart', settings.events.touchStart, false);\n            el.addEventListener('touchend', settings.events.inputEnd, false);\n            el.addEventListener('touchmove', settings.events.touchMove, false);\n        }\n\n        el.addEventListener('mousedown', settings.events.inputDown, false);\n        el.addEventListener('mouseup', settings.events.inputEnd, false);\n        el.addEventListener('mousemove', settings.events.inputMove, false);\n\n        el.addEventListener('click', settings.events.inputClick, false);\n        el.addEventListener('scroll', settings.events.scroll, false);\n        el.addEventListener('selectstart', settings.events.selectStart, false);\n        el.addEventListener('dragstart', settings.events.dragStart, false);\n    };\n\n    VanillaKinetic.prototype._detachListeners = function() {\n        var el = this.el;\n        var settings = this.settings;\n\n        if (_isTouch) {\n            el.removeEventListener('touchstart', settings.events.touchStart, false);\n            el.removeEventListener('touchend', settings.events.inputEnd, false);\n            el.removeEventListener('touchmove', settings.events.touchMove, false);\n        }\n\n        el.removeEventListener('mousedown', settings.events.inputDown, false);\n        el.removeEventListener('mouseup', settings.events.inputEnd, false);\n        el.removeEventListener('mousemove', settings.events.inputMove, false);\n\n        el.removeEventListener('click', settings.events.inputClick, false);\n        el.removeEventListener('scroll', settings.events.scroll, false);\n        el.removeEventListener('selectstart', settings.events.selectStart, false);\n        el.removeEventListener('dragstart', settings.events.dragStart, false);\n    };\n\n\n    window.VanillaKinetic = VanillaKinetic;\n})();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdXRpbHMvdmFuaWxsYS5raW5ldGljLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL3V0aWxzL3ZhbmlsbGEua2luZXRpYy5qcz9iNTM4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gVGhlIE1JVCBMaWNlbnNlIChNSVQpXG4gQ29weXJpZ2h0IChjKSA8MjAxMT4gPERhdmUgVGF5bG9yIGh0dHA6Ly90aGUtdGF5bG9ycy5vcmc+XG5cbiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZFxuIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxuIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG5cbiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1NcbiBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1JcbiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVJcbiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTlxuIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbiBQb3J0IHRvIHZhbmlsbGEgSmF2YXNjcmlwdCBieSBKYWNlayBOb3dhY2tpIGh0dHA6Ly9qYWNlay1ub3dhY2tpLm5ldC9cbioqL1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgdmFyIF9yYWYgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xuXG4gICAgdmFyIF9pc1RvdWNoID0gJ29udG91Y2hlbmQnIGluIGRvY3VtZW50O1xuXG4gICAgLy8gdGhpcyBpcyBzaW1wbGUsIG5vIFwiZGVlcFwiIHN1cHBvcnRcbiAgICB2YXIgX2V4dGVuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBmb3IgKHZhciBpPTE7IGk8YXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gYXJndW1lbnRzW2ldKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFyZ3VtZW50c1tpXS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3VtZW50c1swXVtrZXldID0gYXJndW1lbnRzW2ldW2tleV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcmd1bWVudHNbMF07XG4gICAgfTtcblxuICAgIHZhciBWYW5pbGxhS2luZXRpYyA9IGZ1bmN0aW9uKGVsZW1lbnQsIHNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBfZXh0ZW5kKHt9LCBWYW5pbGxhS2luZXRpYy5ERUZBVUxUUywgc2V0dGluZ3MpO1xuICAgICAgICB0aGlzLmVsICAgICAgID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5BQ1RJVkVfQ0xBU1MgPSBcImtpbmV0aWMtYWN0aXZlXCI7XG5cbiAgICAgICAgdGhpcy5faW5pdEVsZW1lbnRzKCk7XG5cbiAgICAgICAgdGhpcy5lbC5fVmFuaWxsYUtpbmV0aWMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgVmFuaWxsYUtpbmV0aWMuREVGQVVMVFMgPSB7XG4gICAgICAgIGN1cnNvcjogJ21vdmUnLFxuICAgICAgICBkZWNlbGVyYXRlOiB0cnVlLFxuICAgICAgICB0cmlnZ2VySGFyZHdhcmU6IGZhbHNlLFxuICAgICAgICB0aHJlc2hvbGQ6IDAsXG4gICAgICAgIHk6IHRydWUsXG4gICAgICAgIHg6IHRydWUsXG4gICAgICAgIHNsb3dkb3duOiAwLjksXG4gICAgICAgIG1heHZlbG9jaXR5OiA0MCxcbiAgICAgICAgdGhyb3R0bGVGUFM6IDYwLFxuICAgICAgICBpbnZlcnQ6IGZhbHNlLFxuICAgICAgICBtb3ZpbmdDbGFzczoge1xuICAgICAgICAgICAgdXA6ICdraW5ldGljLW1vdmluZy11cCcsXG4gICAgICAgICAgICBkb3duOiAna2luZXRpYy1tb3ZpbmctZG93bicsXG4gICAgICAgICAgICBsZWZ0OiAna2luZXRpYy1tb3ZpbmctbGVmdCcsXG4gICAgICAgICAgICByaWdodDogJ2tpbmV0aWMtbW92aW5nLXJpZ2h0J1xuICAgICAgICB9LFxuICAgICAgICBkZWNlbGVyYXRpbmdDbGFzczoge1xuICAgICAgICAgICAgdXA6ICdraW5ldGljLWRlY2VsZXJhdGluZy11cCcsXG4gICAgICAgICAgICBkb3duOiAna2luZXRpYy1kZWNlbGVyYXRpbmctZG93bicsXG4gICAgICAgICAgICBsZWZ0OiAna2luZXRpYy1kZWNlbGVyYXRpbmctbGVmdCcsXG4gICAgICAgICAgICByaWdodDogJ2tpbmV0aWMtZGVjZWxlcmF0aW5nLXJpZ2h0J1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIFB1YmxpYyBmdW5jdGlvbnNcbiAgICBWYW5pbGxhS2luZXRpYy5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBfZXh0ZW5kKHRoaXMuc2V0dGluZ3MsIG9wdGlvbnMpO1xuICAgICAgICB0aGlzLnZlbG9jaXR5ID0gb3B0aW9ucy52ZWxvY2l0eSB8fCB0aGlzLnZlbG9jaXR5O1xuICAgICAgICB0aGlzLnZlbG9jaXR5WSA9IG9wdGlvbnMudmVsb2NpdHlZIHx8IHRoaXMudmVsb2NpdHlZO1xuICAgICAgICB0aGlzLnNldHRpbmdzLmRlY2VsZXJhdGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fbW92ZSgpO1xuICAgIH07XG5cbiAgICBWYW5pbGxhS2luZXRpYy5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MuZGVjZWxlcmF0ZSA9IHRydWU7XG4gICAgfTtcblxuICAgIFZhbmlsbGFLaW5ldGljLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMudmVsb2NpdHkgPSAwO1xuICAgICAgICB0aGlzLnZlbG9jaXR5WSA9IDA7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MuZGVjZWxlcmF0ZSA9IHRydWU7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5zZXR0aW5ncy5zdG9wcGVkID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnN0b3BwZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBWYW5pbGxhS2luZXRpYy5wcm90b3R5cGUuZGV0YWNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX2RldGFjaExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5BQ1RJVkVfQ0xBU1MpO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmN1cnNvciA9ICcnO1xuICAgIH07XG5cbiAgICBWYW5pbGxhS2luZXRpYy5wcm90b3R5cGUuYXR0YWNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLmVsLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLkFDVElWRV9DTEFTUykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9hdHRhY2hMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKHRoaXMuQUNUSVZFX0NMQVNTKTtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5jdXJzb3IgPSB0aGlzLnNldHRpbmdzLmN1cnNvcjtcbiAgICB9O1xuXG4gICAgLy8gSW50ZXJuYWwgZnVuY3Rpb25zXG5cbiAgICBWYW5pbGxhS2luZXRpYy5wcm90b3R5cGUuX2luaXRFbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQodGhpcy5BQ1RJVkVfQ0xBU1MpO1xuXG4gICAgICAgIF9leHRlbmQodGhpcywge1xuICAgICAgICAgICAgeHBvczogbnVsbCxcbiAgICAgICAgICAgIHByZXZYUG9zOiBmYWxzZSxcbiAgICAgICAgICAgIHlwb3M6IG51bGwsXG4gICAgICAgICAgICBwcmV2WVBvczogZmFsc2UsXG4gICAgICAgICAgICBtb3VzZURvd246IGZhbHNlLFxuICAgICAgICAgICAgdGhyb3R0bGVUaW1lb3V0OiAxMDAwIC8gdGhpcy5zZXR0aW5ncy50aHJvdHRsZUZQUyxcbiAgICAgICAgICAgIGxhc3RNb3ZlOiBudWxsLFxuICAgICAgICAgICAgZWxlbWVudEZvY3VzZWQ6IG51bGxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy52ZWxvY2l0eSA9IDA7XG4gICAgICAgIHRoaXMudmVsb2NpdHlZID0gMDtcblxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHRoaXMuZG9jdW1lbnRSZXNldEhhbmRsZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoYXQuX3Jlc2V0TW91c2UuYXBwbHkodGhhdCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gRklYTUUgbWFrZSBzdXJlIHRvIHJlbW92ZSB0aGlzXG4gICAgICAgIHZhciBodG1sID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICAgICAgICBodG1sLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMuZG9jdW1lbnRSZXNldEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgaHRtbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5kb2N1bWVudFJlc2V0SGFuZGxlciwgZmFsc2UpO1xuXG4gICAgICAgIHRoaXMuX2luaXRFdmVudHMoKTtcblxuICAgICAgICB0aGlzLmVsLnN0eWxlLmN1cnNvciA9IHRoaXMuc2V0dGluZ3MuY3Vyc29yO1xuXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnRyaWdnZXJIYXJkd2FyZSkge1xuICAgICAgICAgICAgdmFyIHByZWZpeGVzID0gWycnLCAnLW1zLScsICctd2Via2l0LScsICctbW96LSddO1xuICAgICAgICAgICAgdmFyIHN0eWxlcyA9IHtcbiAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogJ3RyYW5zbGF0ZTNkKDAsMCwwKScsXG4gICAgICAgICAgICAgICAgJ3BlcnNwZWN0aXZlJzogJzEwMDAnLCAvLyBUT0RPIGlzIHRoaXMgZXZlbiB2YWxpZD8gaXMgdGhpcyBldmVuIG5lZWRlZD9cbiAgICAgICAgICAgICAgICAnYmFja2ZhY2UtdmlzaWJpbGl0eSc6ICdoaWRkZW4nXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPHByZWZpeGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByZWZpeCA9IHByZWZpeGVzW2ldO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzdHlsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0eWxlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWwuc3R5bGVbcHJlZml4K2tleV0gPSBzdHlsZXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBWYW5pbGxhS2luZXRpYy5wcm90b3R5cGUuX2luaXRFdmVudHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLnNldHRpbmdzLmV2ZW50cyA9IHtcbiAgICAgICAgICAgIHRvdWNoU3RhcnQ6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG91Y2g7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuX3VzZVRhcmdldChlLnRhcmdldCwgZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdG91Y2ggPSBlLm9yaWdpbmFsRXZlbnQudG91Y2hlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi50aHJlc2hvbGQgPSBzZWxmLl90aHJlc2hvbGQoZS50YXJnZXQsIGUpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9zdGFydCh0b3VjaC5jbGllbnRYLCB0b3VjaC5jbGllbnRZKTtcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdG91Y2hNb3ZlOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvdWNoO1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLm1vdXNlRG93bikge1xuICAgICAgICAgICAgICAgICAgICB0b3VjaCA9IGUub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9pbnB1dG1vdmUodG91Y2guY2xpZW50WCwgdG91Y2guY2xpZW50WSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5wdXREb3duOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuX3VzZVRhcmdldChlLnRhcmdldCwgZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi50aHJlc2hvbGQgPSBzZWxmLl90aHJlc2hvbGQoZS50YXJnZXQsIGUpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9zdGFydChlLmNsaWVudFgsIGUuY2xpZW50WSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZWxlbWVudEZvY3VzZWQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0Lm5vZGVOYW1lID09PSBcIklNR1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5wdXRFbmQ6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5fdXNlVGFyZ2V0KGUudGFyZ2V0LCBlKSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9lbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5lbGVtZW50Rm9jdXNlZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5wdXRNb3ZlOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYubW91c2VEb3duKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2lucHV0bW92ZShlLmNsaWVudFgsIGUuY2xpZW50WSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2Nyb2xsOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLnNldHRpbmdzLm1vdmVkID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0dGluZ3MubW92ZWQuY2FsbChzZWxmLCBzZWxmLnNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGUucHJldmVudERlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbnB1dENsaWNrOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHNlbGYudmVsb2NpdHkpID4gMCB8fCBNYXRoLmFicyhzZWxmLnZlbG9jaXR5WSkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuc3RvcFByb3BhZ2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZHJhZ1N0YXJ0OiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuX3VzZVRhcmdldChlLnRhcmdldCwgZSkgJiYgc2VsZi5lbGVtZW50Rm9jdXNlZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnN0b3BQcm9wYWdhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlbGVjdFN0YXJ0OiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLnNldHRpbmdzLnNlbGVjdFN0YXJ0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnNldHRpbmdzLnNlbGVjdFN0YXJ0LmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNlbGYuX3VzZVRhcmdldChlLnRhcmdldCwgZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUucHJldmVudERlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5zdG9wUHJvcGFnYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLl9hdHRhY2hMaXN0ZW5lcnMoKTtcbiAgICB9O1xuXG4gICAgVmFuaWxsYUtpbmV0aWMucHJvdG90eXBlLl9pbnB1dG1vdmUgPSBmdW5jdGlvbihjbGllbnRYLCBjbGllbnRZKSB7XG4gICAgICAgIGlmICghdGhpcy5sYXN0TW92ZSB8fCBuZXcgRGF0ZSgpID4gbmV3IERhdGUodGhpcy5sYXN0TW92ZS5nZXRUaW1lKCkgKyB0aGlzLnRocm90dGxlVGltZW91dCkpIHtcbiAgICAgICAgICAgIHRoaXMubGFzdE1vdmUgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5tb3VzZURvd24gJiYgKHRoaXMueHBvcyB8fCB0aGlzLnlwb3MpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1vdmVkWCA9IChjbGllbnRYIC0gdGhpcy54cG9zKTtcbiAgICAgICAgICAgICAgICB2YXIgbW92ZWRZID0gKGNsaWVudFkgLSB0aGlzLnlwb3MpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmludmVydCkge1xuICAgICAgICAgICAgICAgICAgICBtb3ZlZFggKj0gLTE7XG4gICAgICAgICAgICAgICAgICAgIG1vdmVkWSAqPSAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGhyZXNob2xkPjApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vdmVkID0gTWF0aC5zcXJ0KG1vdmVkWCptb3ZlZFggKyBtb3ZlZFkqbW92ZWRZKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudGhyZXNob2xkPm1vdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRocmVzaG9sZCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudEZvY3VzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50Rm9jdXNlZC5ibHVyKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudEZvY3VzZWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5kZWNlbGVyYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eSA9IHRoaXMudmVsb2NpdHlZID0gMDtcblxuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0KCk7XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbFRvcCA9IHRoaXMuc2Nyb2xsVG9wKCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQodGhpcy5zZXR0aW5ncy54ID8gc2Nyb2xsTGVmdCAtIG1vdmVkWCA6IHNjcm9sbExlZnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9wKHRoaXMuc2V0dGluZ3MueSA/IHNjcm9sbFRvcCAtIG1vdmVkWSA6IHNjcm9sbFRvcCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnByZXZYUG9zID0gdGhpcy54cG9zO1xuICAgICAgICAgICAgICAgIHRoaXMucHJldllQb3MgPSB0aGlzLnlwb3M7XG4gICAgICAgICAgICAgICAgdGhpcy54cG9zID0gY2xpZW50WDtcbiAgICAgICAgICAgICAgICB0aGlzLnlwb3MgPSBjbGllbnRZO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsY3VsYXRlVmVsb2NpdGllcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3NldE1vdmVDbGFzc2VzKHRoaXMuc2V0dGluZ3MubW92aW5nQ2xhc3MpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnNldHRpbmdzLm1vdmVkID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubW92ZWQuY2FsbCh0aGlzLCB0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgVmFuaWxsYUtpbmV0aWMucHJvdG90eXBlLl9jYWxjdWxhdGVWZWxvY2l0aWVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMudmVsb2NpdHkgPSB0aGlzLl9jYXBWZWxvY2l0eSh0aGlzLnByZXZYUG9zIC0gdGhpcy54cG9zLCB0aGlzLnNldHRpbmdzLm1heHZlbG9jaXR5KTtcbiAgICAgICAgdGhpcy52ZWxvY2l0eVkgPSB0aGlzLl9jYXBWZWxvY2l0eSh0aGlzLnByZXZZUG9zIC0gdGhpcy55cG9zLCB0aGlzLnNldHRpbmdzLm1heHZlbG9jaXR5KTtcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaW52ZXJ0KSB7XG4gICAgICAgICAgICB0aGlzLnZlbG9jaXR5ICo9IC0xO1xuICAgICAgICAgICAgdGhpcy52ZWxvY2l0eVkgKj0gLTE7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgVmFuaWxsYUtpbmV0aWMucHJvdG90eXBlLl9lbmQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMueHBvcyAmJiB0aGlzLnByZXZYUG9zICYmIHRoaXMuc2V0dGluZ3MuZGVjZWxlcmF0ZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuZGVjZWxlcmF0ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9jYWxjdWxhdGVWZWxvY2l0aWVzKCk7XG4gICAgICAgICAgICB0aGlzLnhwb3MgPSB0aGlzLnByZXZYUG9zID0gdGhpcy5tb3VzZURvd24gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX21vdmUoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBWYW5pbGxhS2luZXRpYy5wcm90b3R5cGUuX3VzZVRhcmdldCA9IGZ1bmN0aW9uKHRhcmdldCwgZXZlbnQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnNldHRpbmdzLmZpbHRlclRhcmdldCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MuZmlsdGVyVGFyZ2V0LmNhbGwodGhpcywgdGFyZ2V0LCBldmVudCkgIT09IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgfTtcblxuICAgIFZhbmlsbGFLaW5ldGljLnByb3RvdHlwZS5fdGhyZXNob2xkID0gZnVuY3Rpb24odGFyZ2V0LCBldmVudCkge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuc2V0dGluZ3MudGhyZXNob2xkID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy50aHJlc2hvbGQuY2FsbCh0aGlzLCB0YXJnZXQsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy50aHJlc2hvbGQ7XG4gICAgfTtcblxuICAgIFZhbmlsbGFLaW5ldGljLnByb3RvdHlwZS5fc3RhcnQgPSBmdW5jdGlvbihjbGllbnRYLCBjbGllbnRZKSB7XG4gICAgICAgIHRoaXMubW91c2VEb3duID0gdHJ1ZTtcbiAgICAgICAgdGhpcy52ZWxvY2l0eSA9IHRoaXMucHJldlhQb3MgPSAwO1xuICAgICAgICB0aGlzLnZlbG9jaXR5WSA9IHRoaXMucHJldllQb3MgPSAwO1xuICAgICAgICB0aGlzLnhwb3MgPSBjbGllbnRYO1xuICAgICAgICB0aGlzLnlwb3MgPSBjbGllbnRZO1xuICAgIH07XG5cbiAgICBWYW5pbGxhS2luZXRpYy5wcm90b3R5cGUuX3Jlc2V0TW91c2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy54cG9zID0gZmFsc2U7XG4gICAgICAgIHRoaXMueXBvcyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1vdXNlRG93biA9IGZhbHNlO1xuICAgIH07XG5cbiAgICBWYW5pbGxhS2luZXRpYy5wcm90b3R5cGUuX2RlY2VsZXJhdGVWZWxvY2l0eSA9IGZ1bmN0aW9uKHZlbG9jaXR5LCBzbG93ZG93bikge1xuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLmFicyh2ZWxvY2l0eSkpID09PSAwID8gMCAvLyBpcyB2ZWxvY2l0eSBsZXNzIHRoYW4gMT9cbiAgICAgICAgICAgIDogdmVsb2NpdHkgKiBzbG93ZG93bjsgLy8gcmVkdWNlIHNsb3dkb3duXG4gICAgfTtcblxuICAgIFZhbmlsbGFLaW5ldGljLnByb3RvdHlwZS5fY2FwVmVsb2NpdHkgPSBmdW5jdGlvbih2ZWxvY2l0eSwgbWF4KSB7XG4gICAgICAgIHZhciBuZXdWZWxvY2l0eSA9IHZlbG9jaXR5O1xuICAgICAgICBpZiAodmVsb2NpdHkgPiAwKXtcbiAgICAgICAgICAgIGlmICh2ZWxvY2l0eSA+IG1heCl7XG4gICAgICAgICAgICAgICAgbmV3VmVsb2NpdHkgPSBtYXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodmVsb2NpdHkgPCAoMCAtIG1heCkpe1xuICAgICAgICAgICAgICAgIG5ld1ZlbG9jaXR5ID0gKDAgLSBtYXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdWZWxvY2l0eTtcbiAgICB9O1xuXG4gICAgVmFuaWxsYUtpbmV0aWMucHJvdG90eXBlLl9zZXRNb3ZlQ2xhc3NlcyA9IGZ1bmN0aW9uKGNsYXNzZXMpIHtcbiAgICAgICAgLy8gVGhlIGZpeC1tZSBjb21tZW50IGJlbG93IGlzIGZyb20gb3JpZ2luYWwgalF1ZXJ5LmtpbmV0aWMgcHJvamVjdFxuICAgICAgICAvLyBGSVhNRTogY29uc2lkZXIgaWYgd2Ugd2FudCB0byBhcHBseSBQTCAjNDQsIHRoaXMgc2hvdWxkIG5vdCByZW1vdmVcbiAgICAgICAgLy8gY2xhc3NlcyB3ZSBoYXZlIG5vdCBkZWZpbmVkIG9uIHRoZSBlbGVtZW50IVxuICAgICAgICB2YXIgc2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzO1xuICAgICAgICB2YXIgZWwgPSB0aGlzLmVsO1xuXG4gICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MubW92aW5nQ2xhc3MudXApO1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKHNldHRpbmdzLm1vdmluZ0NsYXNzLmRvd24pO1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKHNldHRpbmdzLm1vdmluZ0NsYXNzLmxlZnQpO1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKHNldHRpbmdzLm1vdmluZ0NsYXNzLnJpZ2h0KTtcbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5kZWNlbGVyYXRpbmdDbGFzcy51cCk7XG4gICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MuZGVjZWxlcmF0aW5nQ2xhc3MuZG93bik7XG4gICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MuZGVjZWxlcmF0aW5nQ2xhc3MubGVmdCk7XG4gICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MuZGVjZWxlcmF0aW5nQ2xhc3MucmlnaHQpO1xuXG4gICAgICAgIGlmICh0aGlzLnZlbG9jaXR5ID4gMCl7XG4gICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzZXMucmlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZlbG9jaXR5IDwgMCl7XG4gICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzZXMubGVmdCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmVsb2NpdHlZID4gMCl7XG4gICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzZXMuZG93bik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmVsb2NpdHlZIDwgMCl7XG4gICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzZXMudXApO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIFZhbmlsbGFLaW5ldGljLnByb3RvdHlwZS5fbW92ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2Nyb2xsZXIgPSB0aGlzLl9nZXRTY3JvbGxlcigpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBzZXR0aW5ncyA9IHRoaXMuc2V0dGluZ3M7XG5cbiAgICAgICAgaWYgKHNldHRpbmdzLnggJiYgc2Nyb2xsZXIuc2Nyb2xsV2lkdGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQodGhpcy5zY3JvbGxMZWZ0KCkgKyB0aGlzLnZlbG9jaXR5KTtcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnZlbG9jaXR5KSA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZlbG9jaXR5ID0gc2V0dGluZ3MuZGVjZWxlcmF0ZSA/XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2RlY2VsZXJhdGVWZWxvY2l0eSh0aGlzLnZlbG9jaXR5LCBzZXR0aW5ncy5zbG93ZG93bikgOiB0aGlzLnZlbG9jaXR5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52ZWxvY2l0eSA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2V0dGluZ3MueSAmJiBzY3JvbGxlci5zY3JvbGxIZWlnaHQgPiAwKXtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9wKHRoaXMuc2Nyb2xsVG9wKCkgKyB0aGlzLnZlbG9jaXR5WSk7XG4gICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy52ZWxvY2l0eVkpID4gMCl7XG4gICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eVkgPSBzZXR0aW5ncy5kZWNlbGVyYXRlID9cbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGVjZWxlcmF0ZVZlbG9jaXR5KHRoaXMudmVsb2NpdHlZLCBzZXR0aW5ncy5zbG93ZG93bikgOiB0aGlzLnZlbG9jaXR5WTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudmVsb2NpdHlZID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHNlbGYuX3NldE1vdmVDbGFzc2VzKHNldHRpbmdzLmRlY2VsZXJhdGluZ0NsYXNzKTtcblxuICAgICAgICBpZiAodHlwZW9mIHNldHRpbmdzLm1vdmVkID09PSAnZnVuY3Rpb24nKXtcbiAgICAgICAgICAgIHNldHRpbmdzLm1vdmVkLmNhbGwodGhpcywgc2V0dGluZ3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKE1hdGguYWJzKHRoaXMudmVsb2NpdHkpID4gMCB8fCBNYXRoLmFicyh0aGlzLnZlbG9jaXR5WSkgPiAwKXtcbiAgICAgICAgICAgIGlmICghdGhpcy5tb3ZpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgLy8gdGljayBmb3IgbmV4dCBtb3ZlbWVudFxuICAgICAgICAgICAgICAgIF9yYWYoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubW92aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX21vdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuc3RvcCgpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIFZhbmlsbGFLaW5ldGljLnByb3RvdHlwZS5fZ2V0U2Nyb2xsZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gRklYTUUgd2UgbWF5IHdhbnQgdG8gbm9ybWFsaXplIGJlaGF2aW91ciBhY3Jvc3MgYnJvd3NlcnMgYXMgaW4gb3JpZ2luYWwgalF1ZXJ5LmtpbmV0aWNcbiAgICAgICAgLy8gY3VycmVudGx5IHRoaXMgd29uJ3Qgd29yayBjb3JyZWN0bHkgb24gYWxsIGJyd29zZXJzIHdoZW4gYXR0YWNoZWQgdG8gaHRtbCBvciBib2R5IGVsZW1lbnRcbiAgICAgICAgcmV0dXJuIHRoaXMuZWw7XG4gICAgfTtcblxuICAgIFZhbmlsbGFLaW5ldGljLnByb3RvdHlwZS5zY3JvbGxMZWZ0ID0gZnVuY3Rpb24obGVmdCkge1xuICAgICAgICB2YXIgc2Nyb2xsZXIgPSB0aGlzLl9nZXRTY3JvbGxlcigpO1xuICAgICAgICBpZiAodHlwZW9mIGxlZnQgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBzY3JvbGxlci5zY3JvbGxMZWZ0ID0gbGVmdDtcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc2Nyb2xsTGVmdCA9IGxlZnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc2Nyb2xsZXIuc2Nyb2xsTGVmdDtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBWYW5pbGxhS2luZXRpYy5wcm90b3R5cGUuc2Nyb2xsVG9wID0gZnVuY3Rpb24odG9wKSB7XG4gICAgICAgIHZhciBzY3JvbGxlciA9IHRoaXMuX2dldFNjcm9sbGVyKCk7XG4gICAgICAgIGlmICh0eXBlb2YgdG9wID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgc2Nyb2xsZXIuc2Nyb2xsVG9wID0gdG9wO1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zY3JvbGxUb3AgPSB0b3A7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc2Nyb2xsZXIuc2Nyb2xsVG9wO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIFZhbmlsbGFLaW5ldGljLnByb3RvdHlwZS5fYXR0YWNoTGlzdGVuZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgICAgIHZhciBzZXR0aW5ncyA9IHRoaXMuc2V0dGluZ3M7XG5cbiAgICAgICAgaWYgKF9pc1RvdWNoKSB7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgc2V0dGluZ3MuZXZlbnRzLnRvdWNoU3RhcnQsIGZhbHNlKTtcbiAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgc2V0dGluZ3MuZXZlbnRzLmlucHV0RW5kLCBmYWxzZSk7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBzZXR0aW5ncy5ldmVudHMudG91Y2hNb3ZlLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBzZXR0aW5ncy5ldmVudHMuaW5wdXREb3duLCBmYWxzZSk7XG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBzZXR0aW5ncy5ldmVudHMuaW5wdXRFbmQsIGZhbHNlKTtcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgc2V0dGluZ3MuZXZlbnRzLmlucHV0TW92ZSwgZmFsc2UpO1xuXG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2V0dGluZ3MuZXZlbnRzLmlucHV0Q2xpY2ssIGZhbHNlKTtcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgc2V0dGluZ3MuZXZlbnRzLnNjcm9sbCwgZmFsc2UpO1xuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdzZWxlY3RzdGFydCcsIHNldHRpbmdzLmV2ZW50cy5zZWxlY3RTdGFydCwgZmFsc2UpO1xuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCBzZXR0aW5ncy5ldmVudHMuZHJhZ1N0YXJ0LCBmYWxzZSk7XG4gICAgfTtcblxuICAgIFZhbmlsbGFLaW5ldGljLnByb3RvdHlwZS5fZGV0YWNoTGlzdGVuZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgICAgIHZhciBzZXR0aW5ncyA9IHRoaXMuc2V0dGluZ3M7XG5cbiAgICAgICAgaWYgKF9pc1RvdWNoKSB7XG4gICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgc2V0dGluZ3MuZXZlbnRzLnRvdWNoU3RhcnQsIGZhbHNlKTtcbiAgICAgICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgc2V0dGluZ3MuZXZlbnRzLmlucHV0RW5kLCBmYWxzZSk7XG4gICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBzZXR0aW5ncy5ldmVudHMudG91Y2hNb3ZlLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBzZXR0aW5ncy5ldmVudHMuaW5wdXREb3duLCBmYWxzZSk7XG4gICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBzZXR0aW5ncy5ldmVudHMuaW5wdXRFbmQsIGZhbHNlKTtcbiAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgc2V0dGluZ3MuZXZlbnRzLmlucHV0TW92ZSwgZmFsc2UpO1xuXG4gICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2V0dGluZ3MuZXZlbnRzLmlucHV0Q2xpY2ssIGZhbHNlKTtcbiAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgc2V0dGluZ3MuZXZlbnRzLnNjcm9sbCwgZmFsc2UpO1xuICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdzZWxlY3RzdGFydCcsIHNldHRpbmdzLmV2ZW50cy5zZWxlY3RTdGFydCwgZmFsc2UpO1xuICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCBzZXR0aW5ncy5ldmVudHMuZHJhZ1N0YXJ0LCBmYWxzZSk7XG4gICAgfTtcblxuXG4gICAgd2luZG93LlZhbmlsbGFLaW5ldGljID0gVmFuaWxsYUtpbmV0aWM7XG59KSgpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./source/js/utils/vanilla.kinetic.js\n");

/***/ }),

/***/ "./source/js/validation-runner.js":
/*!****************************************!*\
  !*** ./source/js/validation-runner.js ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ValidationRunner; });\nclass ValidationRunner\n{\n    constructor (options)\n    {\n        this.whitelistedKeys = options.whitelistedKeys || [];\n        this.additionalProperties = options.additionalProperties || [];\n        this.validations = options.validations;\n    }\n\n    isValid (key, value, settings)\n    {\n        // Get the validation index\n        let validationIndex = null;\n\n        this.validations.some((validation, index) =>\n        {\n            if (validation.key !== key)\n            {\n                return false;\n            }\n\n            validationIndex = index;\n            return true;\n        });\n\n        if (validationIndex === null)\n        {\n            return true;\n        }\n\n        // Run the validation\n        const dummyChanges = {};\n        dummyChanges[key] = value;\n        const proxier = createSettingsProxier(settings, dummyChanges, this);\n\n        return !this._runValidation(validationIndex, value, proxier);\n    }\n\n    validate (settings)\n    {\n        this._validateOptions({}, settings);\n    }\n\n    getValidatedOptions (settings, options)\n    {\n        const cloned = Object.assign({}, options);\n        this._validateOptions(settings, cloned);\n        return cloned;\n    }\n\n    _validateOptions (settings, options)\n    {\n        const settingsProxier = createSettingsProxier(settings, options, this);\n        this._applyValidations(options, settingsProxier);\n    }\n\n    _applyValidations (options, proxier)\n    {\n        this.validations.forEach((validation, index) =>\n        {\n            if (!options.hasOwnProperty(validation.key))\n            {\n                return;\n            }\n\n            const input = options[validation.key];\n            const corrected = this._runValidation(index, input, proxier);\n\n            if (corrected)\n            {\n                if (!corrected.warningSuppressed)\n                {\n                    emitWarning(validation.key, input, corrected.value);\n                }\n\n                options[validation.key] = corrected.value;\n            }\n        }, this);\n    }\n\n    _runValidation (index, input, proxier)\n    {\n        const validation = this.validations[index];\n\n        proxier.index = index;\n\n        let warningSuppressed = false;\n        const config = {\n            suppressWarning: () =>\n            {\n                warningSuppressed = true;\n            }\n        };\n\n        const outputValue = validation.validate(input, proxier.proxy, config);\n\n        if (outputValue === undefined || outputValue === input)\n        {\n            return null;\n        }\n\n        return {\n            value: outputValue,\n            warningSuppressed: warningSuppressed\n        };\n    }\n}\n\n/**\n * The settings proxy wraps the settings object and ensures that\n * only values which have previously been validated are accessed,\n * throwing a TypeError otherwise.\n *\n * FIXME(wabain): Is it worth keeping this? When I wrote it I had\n * multiple validation stages and it was a lot harder to keep track\n * of everything, so this was more valuable.\n */\nfunction createSettingsProxier (settings, options, runner)\n{\n    const proxier = {\n        proxy: {},\n        index: null\n    };\n\n    const lookup = lookupValue.bind(null, settings, options);\n\n    const properties = {};\n\n    runner.whitelistedKeys.forEach((whitelisted) =>\n    {\n        properties[whitelisted] = {\n            get: lookup.bind(null, whitelisted)\n        };\n    });\n\n    runner.additionalProperties.forEach((additional) =>\n    {\n        properties[additional.key] = {\n            get: additional.get\n        };\n    });\n\n    runner.validations.forEach( (validation, validationIndex) =>\n    {\n        properties[validation.key] = {\n            get: () =>\n            {\n                if (validationIndex < proxier.index)\n                {\n                    return lookup(validation.key);\n                }\n\n                const currentKey = runner.validations[proxier.index].key;\n                throw new TypeError('Cannot access setting ' + validation.key + ' while validating ' + currentKey);\n            }\n        };\n    });\n\n    Object.defineProperties(proxier.proxy, properties);\n\n    return proxier;\n}\n\nfunction emitWarning (key, original, corrected)\n{\n    console.warn('Invalid value for ' + key + ': ' + original + '. Using ' + corrected + ' instead.');\n}\n\nfunction lookupValue (base, extension, key)\n{\n    if (key in extension)\n    {\n        return extension[key];\n    }\n\n    return base[key];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdmFsaWRhdGlvbi1ydW5uZXIuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvdmFsaWRhdGlvbi1ydW5uZXIuanM/ZGI1ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBWYWxpZGF0aW9uUnVubmVyXG57XG4gICAgY29uc3RydWN0b3IgKG9wdGlvbnMpXG4gICAge1xuICAgICAgICB0aGlzLndoaXRlbGlzdGVkS2V5cyA9IG9wdGlvbnMud2hpdGVsaXN0ZWRLZXlzIHx8IFtdO1xuICAgICAgICB0aGlzLmFkZGl0aW9uYWxQcm9wZXJ0aWVzID0gb3B0aW9ucy5hZGRpdGlvbmFsUHJvcGVydGllcyB8fCBbXTtcbiAgICAgICAgdGhpcy52YWxpZGF0aW9ucyA9IG9wdGlvbnMudmFsaWRhdGlvbnM7XG4gICAgfVxuXG4gICAgaXNWYWxpZCAoa2V5LCB2YWx1ZSwgc2V0dGluZ3MpXG4gICAge1xuICAgICAgICAvLyBHZXQgdGhlIHZhbGlkYXRpb24gaW5kZXhcbiAgICAgICAgbGV0IHZhbGlkYXRpb25JbmRleCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy52YWxpZGF0aW9ucy5zb21lKCh2YWxpZGF0aW9uLCBpbmRleCkgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHZhbGlkYXRpb24ua2V5ICE9PSBrZXkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YWxpZGF0aW9uSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAodmFsaWRhdGlvbkluZGV4ID09PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJ1biB0aGUgdmFsaWRhdGlvblxuICAgICAgICBjb25zdCBkdW1teUNoYW5nZXMgPSB7fTtcbiAgICAgICAgZHVtbXlDaGFuZ2VzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgY29uc3QgcHJveGllciA9IGNyZWF0ZVNldHRpbmdzUHJveGllcihzZXR0aW5ncywgZHVtbXlDaGFuZ2VzLCB0aGlzKTtcblxuICAgICAgICByZXR1cm4gIXRoaXMuX3J1blZhbGlkYXRpb24odmFsaWRhdGlvbkluZGV4LCB2YWx1ZSwgcHJveGllcik7XG4gICAgfVxuXG4gICAgdmFsaWRhdGUgKHNldHRpbmdzKVxuICAgIHtcbiAgICAgICAgdGhpcy5fdmFsaWRhdGVPcHRpb25zKHt9LCBzZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgZ2V0VmFsaWRhdGVkT3B0aW9ucyAoc2V0dGluZ3MsIG9wdGlvbnMpXG4gICAge1xuICAgICAgICBjb25zdCBjbG9uZWQgPSBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zKTtcbiAgICAgICAgdGhpcy5fdmFsaWRhdGVPcHRpb25zKHNldHRpbmdzLCBjbG9uZWQpO1xuICAgICAgICByZXR1cm4gY2xvbmVkO1xuICAgIH1cblxuICAgIF92YWxpZGF0ZU9wdGlvbnMgKHNldHRpbmdzLCBvcHRpb25zKVxuICAgIHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3NQcm94aWVyID0gY3JlYXRlU2V0dGluZ3NQcm94aWVyKHNldHRpbmdzLCBvcHRpb25zLCB0aGlzKTtcbiAgICAgICAgdGhpcy5fYXBwbHlWYWxpZGF0aW9ucyhvcHRpb25zLCBzZXR0aW5nc1Byb3hpZXIpO1xuICAgIH1cblxuICAgIF9hcHBseVZhbGlkYXRpb25zIChvcHRpb25zLCBwcm94aWVyKVxuICAgIHtcbiAgICAgICAgdGhpcy52YWxpZGF0aW9ucy5mb3JFYWNoKCh2YWxpZGF0aW9uLCBpbmRleCkgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFvcHRpb25zLmhhc093blByb3BlcnR5KHZhbGlkYXRpb24ua2V5KSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gb3B0aW9uc1t2YWxpZGF0aW9uLmtleV07XG4gICAgICAgICAgICBjb25zdCBjb3JyZWN0ZWQgPSB0aGlzLl9ydW5WYWxpZGF0aW9uKGluZGV4LCBpbnB1dCwgcHJveGllcik7XG5cbiAgICAgICAgICAgIGlmIChjb3JyZWN0ZWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKCFjb3JyZWN0ZWQud2FybmluZ1N1cHByZXNzZWQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBlbWl0V2FybmluZyh2YWxpZGF0aW9uLmtleSwgaW5wdXQsIGNvcnJlY3RlZC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgb3B0aW9uc1t2YWxpZGF0aW9uLmtleV0gPSBjb3JyZWN0ZWQudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH1cblxuICAgIF9ydW5WYWxpZGF0aW9uIChpbmRleCwgaW5wdXQsIHByb3hpZXIpXG4gICAge1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0aW9uc1tpbmRleF07XG5cbiAgICAgICAgcHJveGllci5pbmRleCA9IGluZGV4O1xuXG4gICAgICAgIGxldCB3YXJuaW5nU3VwcHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgICAgICBzdXBwcmVzc1dhcm5pbmc6ICgpID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgd2FybmluZ1N1cHByZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IG91dHB1dFZhbHVlID0gdmFsaWRhdGlvbi52YWxpZGF0ZShpbnB1dCwgcHJveGllci5wcm94eSwgY29uZmlnKTtcblxuICAgICAgICBpZiAob3V0cHV0VmFsdWUgPT09IHVuZGVmaW5lZCB8fCBvdXRwdXRWYWx1ZSA9PT0gaW5wdXQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRWYWx1ZSxcbiAgICAgICAgICAgIHdhcm5pbmdTdXBwcmVzc2VkOiB3YXJuaW5nU3VwcHJlc3NlZFxuICAgICAgICB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBUaGUgc2V0dGluZ3MgcHJveHkgd3JhcHMgdGhlIHNldHRpbmdzIG9iamVjdCBhbmQgZW5zdXJlcyB0aGF0XG4gKiBvbmx5IHZhbHVlcyB3aGljaCBoYXZlIHByZXZpb3VzbHkgYmVlbiB2YWxpZGF0ZWQgYXJlIGFjY2Vzc2VkLFxuICogdGhyb3dpbmcgYSBUeXBlRXJyb3Igb3RoZXJ3aXNlLlxuICpcbiAqIEZJWE1FKHdhYmFpbik6IElzIGl0IHdvcnRoIGtlZXBpbmcgdGhpcz8gV2hlbiBJIHdyb3RlIGl0IEkgaGFkXG4gKiBtdWx0aXBsZSB2YWxpZGF0aW9uIHN0YWdlcyBhbmQgaXQgd2FzIGEgbG90IGhhcmRlciB0byBrZWVwIHRyYWNrXG4gKiBvZiBldmVyeXRoaW5nLCBzbyB0aGlzIHdhcyBtb3JlIHZhbHVhYmxlLlxuICovXG5mdW5jdGlvbiBjcmVhdGVTZXR0aW5nc1Byb3hpZXIgKHNldHRpbmdzLCBvcHRpb25zLCBydW5uZXIpXG57XG4gICAgY29uc3QgcHJveGllciA9IHtcbiAgICAgICAgcHJveHk6IHt9LFxuICAgICAgICBpbmRleDogbnVsbFxuICAgIH07XG5cbiAgICBjb25zdCBsb29rdXAgPSBsb29rdXBWYWx1ZS5iaW5kKG51bGwsIHNldHRpbmdzLCBvcHRpb25zKTtcblxuICAgIGNvbnN0IHByb3BlcnRpZXMgPSB7fTtcblxuICAgIHJ1bm5lci53aGl0ZWxpc3RlZEtleXMuZm9yRWFjaCgod2hpdGVsaXN0ZWQpID0+XG4gICAge1xuICAgICAgICBwcm9wZXJ0aWVzW3doaXRlbGlzdGVkXSA9IHtcbiAgICAgICAgICAgIGdldDogbG9va3VwLmJpbmQobnVsbCwgd2hpdGVsaXN0ZWQpXG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICBydW5uZXIuYWRkaXRpb25hbFByb3BlcnRpZXMuZm9yRWFjaCgoYWRkaXRpb25hbCkgPT5cbiAgICB7XG4gICAgICAgIHByb3BlcnRpZXNbYWRkaXRpb25hbC5rZXldID0ge1xuICAgICAgICAgICAgZ2V0OiBhZGRpdGlvbmFsLmdldFxuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgcnVubmVyLnZhbGlkYXRpb25zLmZvckVhY2goICh2YWxpZGF0aW9uLCB2YWxpZGF0aW9uSW5kZXgpID0+XG4gICAge1xuICAgICAgICBwcm9wZXJ0aWVzW3ZhbGlkYXRpb24ua2V5XSA9IHtcbiAgICAgICAgICAgIGdldDogKCkgPT5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsaWRhdGlvbkluZGV4IDwgcHJveGllci5pbmRleClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsb29rdXAodmFsaWRhdGlvbi5rZXkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRLZXkgPSBydW5uZXIudmFsaWRhdGlvbnNbcHJveGllci5pbmRleF0ua2V5O1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBhY2Nlc3Mgc2V0dGluZyAnICsgdmFsaWRhdGlvbi5rZXkgKyAnIHdoaWxlIHZhbGlkYXRpbmcgJyArIGN1cnJlbnRLZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMocHJveGllci5wcm94eSwgcHJvcGVydGllcyk7XG5cbiAgICByZXR1cm4gcHJveGllcjtcbn1cblxuZnVuY3Rpb24gZW1pdFdhcm5pbmcgKGtleSwgb3JpZ2luYWwsIGNvcnJlY3RlZClcbntcbiAgICBjb25zb2xlLndhcm4oJ0ludmFsaWQgdmFsdWUgZm9yICcgKyBrZXkgKyAnOiAnICsgb3JpZ2luYWwgKyAnLiBVc2luZyAnICsgY29ycmVjdGVkICsgJyBpbnN0ZWFkLicpO1xufVxuXG5mdW5jdGlvbiBsb29rdXBWYWx1ZSAoYmFzZSwgZXh0ZW5zaW9uLCBrZXkpXG57XG4gICAgaWYgKGtleSBpbiBleHRlbnNpb24pXG4gICAge1xuICAgICAgICByZXR1cm4gZXh0ZW5zaW9uW2tleV07XG4gICAgfVxuXG4gICAgcmV0dXJuIGJhc2Vba2V5XTtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/validation-runner.js\n");

/***/ }),

/***/ "./source/js/viewer-core.js":
/*!**********************************!*\
  !*** ./source/js/viewer-core.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ViewerCore; });\n/* harmony import */ var _utils_elt__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/elt */ \"./source/js/utils/elt.js\");\n/* harmony import */ var _utils_get_scrollbar_width__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/get-scrollbar-width */ \"./source/js/utils/get-scrollbar-width.js\");\n/* harmony import */ var _gesture_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./gesture-events */ \"./source/js/gesture-events.js\");\n/* harmony import */ var _diva_global__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./diva-global */ \"./source/js/diva-global.js\");\n/* harmony import */ var _document_handler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./document-handler */ \"./source/js/document-handler.js\");\n/* harmony import */ var _grid_handler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./grid-handler */ \"./source/js/grid-handler.js\");\n/* harmony import */ var _page_overlay_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./page-overlay-manager */ \"./source/js/page-overlay-manager.js\");\n/* harmony import */ var _renderer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./renderer */ \"./source/js/renderer.js\");\n/* harmony import */ var _page_layouts__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./page-layouts */ \"./source/js/page-layouts/index.js\");\n/* harmony import */ var _settings_view__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./settings-view */ \"./source/js/settings-view.js\");\n/* harmony import */ var _validation_runner__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./validation-runner */ \"./source/js/validation-runner.js\");\n/* harmony import */ var _viewport__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./viewport */ \"./source/js/viewport.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst debug = __webpack_require__(/*! debug */ \"./node_modules/debug/src/browser.js\")('diva:ViewerCore');\n\nfunction generateId() {\n    return generateId.counter++;\n}\ngenerateId.counter = 1;\n\n\n// Define validations\nconst optionsValidations = [\n    {\n        key: 'goDirectlyTo',\n        validate: (value, settings) =>\n        {\n            if (value < 0 || value >= settings.manifest.pages.length)\n                return 0;\n        }\n    },\n    {\n        key: 'minPagesPerRow',\n        validate: (value) =>\n        {\n            return Math.max(2, value);\n        }\n    },\n    {\n        key: 'maxPagesPerRow',\n        validate: (value, settings) =>\n        {\n            return Math.max(value, settings.minPagesPerRow);\n        }\n    },\n    {\n        key: 'pagesPerRow',\n        validate: (value, settings) =>\n        {\n            // Default to the maximum\n            if (value < settings.minPagesPerRow || value > settings.maxPagesPerRow)\n                return settings.maxPagesPerRow;\n        }\n    },\n    {\n        key: 'maxZoomLevel',\n        validate: (value, settings, config) =>\n        {\n            // Changing this value isn't really an error, it just depends on the\n            // source manifest\n            config.suppressWarning();\n\n            if (value < 0 || value > settings.manifest.maxZoom)\n                return settings.manifest.maxZoom;\n        }\n    },\n    {\n        key: 'minZoomLevel',\n        validate: (value, settings, config) =>\n        {\n            // Changes based on the manifest value shouldn't trigger a\n            // warning\n            if (value > settings.manifest.maxZoom)\n            {\n                config.suppressWarning();\n                return 0;\n            }\n\n            if (value < 0 || value > settings.maxZoomLevel)\n                return 0;\n        }\n    },\n    {\n        key: 'zoomLevel',\n        validate: (value, settings, config) =>\n        {\n            if (value > settings.manifest.maxZoom)\n            {\n                config.suppressWarning();\n                return 0;\n            }\n\n            if (value < settings.minZoomLevel || value > settings.maxZoomLevel)\n                return settings.minZoomLevel;\n        }\n    }\n];\n\nclass ViewerCore\n{\n    constructor (element, options, publicInstance)\n    {\n        this.parentObject = element;\n        this.publicInstance = publicInstance;\n\n        // Things that cannot be changed because of the way they are used by the script\n        // Many of these are declared with arbitrary values that are changed later on\n        this.viewerState = {\n            currentPageIndices: [0],    // The visible pages in the viewport\n            activePageIndex: 0,         // The current 'active' page in the viewport\n            horizontalOffset: 0,        // Distance from the center of the diva element to the top of the current page\n            horizontalPadding: 0,       // Either the fixed padding or adaptive padding\n            ID: null,                   // The prefix of the IDs of the elements (usually 1-diva-)\n            initialKeyScroll: false,    // Holds the initial state of enableKeyScroll\n            initialSpaceScroll: false,  // Holds the initial state of enableSpaceScroll\n            innerElement: null,         // The native .diva-outer DOM object\n            innerObject: {},            // document.getElementById(settings.ID + 'inner'), for selecting the .diva-inner element\n            isActiveDiva: true,         // In the case that multiple diva panes exist on the same page, this should have events funneled to it.\n            isScrollable: true,         // Used in enable/disableScrollable public methods\n            isZooming: false,           // Flag to keep track of whether zooming is still in progress, for handleZoom\n            loaded: false,              // A flag for when everything is loaded and ready to go.\n            manifest: null,\n            mobileWebkit: false,        // Checks if the user is on a touch device (iPad/iPod/iPhone/Android)\n            numPages: 0,                // Number of pages in the array\n            oldZoomLevel: -1,           // Holds the previous zoom level after zooming in or out\n            options: options,\n            outerElement: null,         // The native .diva-outer DOM object\n            outerObject: {},            // document.getElementById(settings.ID + 'outer'), for selecting the .diva-outer element\n            pageOverlays: new _page_overlay_manager__WEBPACK_IMPORTED_MODULE_6__[\"default\"](),\n            pageTools: [],              // The plugins which are enabled as page tools\n            parentObject: this.parentObject, // JQuery object referencing the parent element\n            pendingManifestRequest: null, // Reference to the xhr request retrieving the manifest. Used to cancel the request on destroy()\n            pluginInstances: [],                // Filled with the enabled plugins from the registry\n            renderer: null,\n            resizeTimer: -1,            // Holds the ID of the timeout used when resizing the window (for clearing)\n            scrollbarWidth: 0,          // Set to the actual scrollbar width in init()\n            selector: '',               // Uses the generated ID prefix to easily select elements\n            throbberTimeoutID: -1,      // Holds the ID of the throbber loading timeout\n            toolbar: null,              // Holds an object with some toolbar-related functions\n            verticalOffset: 0,          // Distance from the center of the diva element to the left side of the current page\n            verticalPadding: 0,         // Either the fixed padding or adaptive padding\n            viewHandler: null,\n            viewport: null,             // Object caching the viewport dimensions\n            viewportElement: null,\n            viewportObject: null,\n            zoomDuration: 400\n        };\n\n        this.settings = Object(_settings_view__WEBPACK_IMPORTED_MODULE_9__[\"default\"])([options, this.viewerState]);\n\n        // Generate an ID that can be used as a prefix for all the other IDs\n        const idNumber = generateId();\n        this.viewerState.ID = 'diva-' + idNumber + '-';\n        this.viewerState.selector = this.settings.ID;\n\n        // Aliases for compatibility\n        Object.defineProperties(this.settings, {\n            // Height of the document viewer pane\n            panelHeight: {\n                get: () =>\n                {\n                    return this.viewerState.viewport.height;\n                }\n            },\n            // Width of the document viewer pane\n            panelWidth: {\n                get: () =>\n                {\n                    return this.viewerState.viewport.width;\n                }\n            }\n        });\n\n        this.optionsValidator = new _validation_runner__WEBPACK_IMPORTED_MODULE_10__[\"default\"]({\n            additionalProperties: [\n                {\n                    key: 'manifest',\n                    get: () =>\n                    {\n                        return this.viewerState.manifest;\n                    }\n                }\n            ],\n\n            validations: optionsValidations\n        });\n\n        this.viewerState.scrollbarWidth = Object(_utils_get_scrollbar_width__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();\n\n        // If window.orientation is defined, then it's probably mobileWebkit\n        this.viewerState.mobileWebkit = window.orientation !== undefined;\n\n        if (options.hashParamSuffix === null)\n        {\n            // Omit the suffix from the first instance\n            if (idNumber === 1)\n                options.hashParamSuffix = '';\n            else\n                options.hashParamSuffix = idNumber + '';\n        }\n\n        // Create the inner and outer panels\n        const innerElem = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', this.elemAttrs('inner', { class: 'diva-inner' }));\n        const viewportElem = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', this.elemAttrs('viewport'), innerElem);\n        const outerElem = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', this.elemAttrs('outer'),\n            viewportElem,\n            Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', this.elemAttrs('throbber'),\n                [\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'cube cube1' }),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'cube cube2' }),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'cube cube3' }),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'cube cube4' }),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'cube cube5' }),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'cube cube6' }),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'cube cube7' }),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'cube cube8' }),\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', { class: 'cube cube9' }),\n                ]\n            ));\n\n        this.viewerState.innerElement = innerElem;\n        this.viewerState.viewportElement = viewportElem;\n        this.viewerState.outerElement = outerElem;\n\n        this.viewerState.innerObject = innerElem;\n        this.viewerState.viewportObject = viewportElem;\n        this.viewerState.outerObject = outerElem;\n\n        this.settings.parentObject.append(outerElem);\n\n        this.viewerState.viewport = new _viewport__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.viewerState.viewportElement, {\n            intersectionTolerance: this.settings.viewportMargin\n        });\n\n        this.boundScrollFunction = this.scrollFunction.bind(this);\n        this.boundEscapeListener = this.escapeListener.bind(this);\n\n        // Do all the plugin initialisation\n        this.initPlugins();\n        this.handleEvents();\n\n        // Show the throbber while waiting for the manifest to load\n        this.showThrobber();\n    }\n\n    isValidOption (key, value)\n    {\n        return this.optionsValidator.isValid(key, value, this.viewerState.options);\n    }\n\n    elemAttrs (ident, base)\n    {\n        const attrs = {\n            id: this.settings.ID + ident,\n            class: 'diva-' + ident\n        };\n\n        if (base)\n            return Object.assign(attrs, base);\n        else\n            return attrs;\n    }\n\n    getPageData (pageIndex, attribute)\n    {\n        return this.settings.manifest.pages[pageIndex].d[this.settings.zoomLevel][attribute];\n    }\n\n    // Reset some settings and empty the viewport\n    clearViewer ()\n    {\n        this.viewerState.viewport.top = 0;\n\n        // Clear all the timeouts to prevent undesired pages from loading\n        clearTimeout(this.viewerState.resizeTimer);\n    }\n\n    hasChangedOption (options, key)\n    {\n        return key in options && options[key] !== this.settings[key];\n    }\n\n    //Shortcut for closing fullscreen with the escape key\n    escapeListener (e)\n    {\n        if (e.keyCode === 27)\n        {\n            this.publicInstance.leaveFullscreenMode();\n        }\n    }\n\n    /**\n     * Update settings to match the specified options. Load the viewer,\n     * fire appropriate events for changed options.\n     */\n    reloadViewer (newOptions)\n    {\n        const queuedEvents = [];\n\n        newOptions = this.optionsValidator.getValidatedOptions(this.settings, newOptions);\n\n        // Set the zoom level if valid and fire a ZoomLevelDidChange event\n        if (this.hasChangedOption(newOptions, 'zoomLevel'))\n        {\n            this.viewerState.oldZoomLevel = this.settings.zoomLevel;\n            this.viewerState.options.zoomLevel = newOptions.zoomLevel;\n            queuedEvents.push([\"ZoomLevelDidChange\", newOptions.zoomLevel]);\n        }\n\n        // Set the pages per row if valid and fire an event\n        if (this.hasChangedOption(newOptions, 'pagesPerRow'))\n        {\n            this.viewerState.options.pagesPerRow = newOptions.pagesPerRow;\n            queuedEvents.push([\"GridRowNumberDidChange\", newOptions.pagesPerRow]);\n        }\n\n        // Update verticallyOriented (no event fired)\n        if (this.hasChangedOption(newOptions, 'verticallyOriented'))\n            this.viewerState.options.verticallyOriented = newOptions.verticallyOriented;\n\n        // Show/Hide non-paged pages\n        if (this.hasChangedOption(newOptions, 'showNonPagedPages'))\n        {\n            this.viewerState.options.showNonPagedPages = newOptions.showNonPagedPages;\n        }\n\n        // Update page position (no event fired here)\n        if ('goDirectlyTo' in newOptions)\n        {\n            this.viewerState.options.goDirectlyTo = newOptions.goDirectlyTo;\n\n            if ('verticalOffset' in newOptions)\n                this.viewerState.verticalOffset = newOptions.verticalOffset;\n\n            if ('horizontalOffset' in newOptions)\n                this.viewerState.horizontalOffset = newOptions.horizontalOffset;\n        }\n        else\n        {\n            // Otherwise the default is to remain on the current page\n            this.viewerState.options.goDirectlyTo = this.settings.activePageIndex;\n        }\n\n        if (this.hasChangedOption(newOptions, 'inGrid') || this.hasChangedOption(newOptions, 'inBookLayout'))\n        {\n            if ('inGrid' in newOptions)\n                this.viewerState.options.inGrid = newOptions.inGrid;\n\n            if ('inBookLayout' in newOptions)\n                this.viewerState.options.inBookLayout = newOptions.inBookLayout;\n\n            queuedEvents.push([\"ViewDidSwitch\", this.settings.inGrid]);\n        }\n\n        // Note: prepareModeChange() depends on inGrid and the vertical/horizontalOffset (for now)\n        if (this.hasChangedOption(newOptions, 'inFullscreen'))\n        {\n            this.viewerState.options.inFullscreen = newOptions.inFullscreen;\n            this.prepareModeChange(newOptions);\n            queuedEvents.push([\"ModeDidSwitch\", this.settings.inFullscreen]);\n        }\n\n        this.clearViewer();\n        this.updateViewHandlerAndRendering();\n\n        if (this.viewerState.renderer)\n        {\n            // TODO: The usage of padding variables is still really\n            // messy and inconsistent\n            const rendererConfig = {\n                pageLayouts: Object(_page_layouts__WEBPACK_IMPORTED_MODULE_8__[\"default\"])(this.settings),\n                padding: this.getPadding(),\n                maxZoomLevel: this.settings.inGrid ? null : this.viewerState.manifest.maxZoom,\n                verticallyOriented: this.settings.verticallyOriented || this.settings.inGrid,\n            };\n\n            const viewportPosition = {\n                zoomLevel: this.settings.inGrid ? null : this.settings.zoomLevel,\n                anchorPage: this.settings.goDirectlyTo,\n                verticalOffset: this.viewerState.verticalOffset,\n                horizontalOffset: this.viewerState.horizontalOffset\n            };\n\n            const sourceProvider = this.getCurrentSourceProvider();\n\n            if (debug.enabled)\n            {\n                const serialized = Object.keys(rendererConfig)\n                    .filter(function (key)\n                    {\n                        // Too long\n                        return key !== 'pageLayouts' && key !== 'padding';\n                    })\n                    .map(function (key)\n                    {\n                        const value = rendererConfig[key];\n                        return key + ': ' + JSON.stringify(value);\n                    })\n                    .join(', ');\n\n                debug('reload with %s', serialized);\n            }\n\n            this.viewerState.renderer.load(rendererConfig, viewportPosition, sourceProvider);\n        }\n\n        queuedEvents.forEach( (params) =>\n        {\n            this.publish.apply(this, params);\n        });\n\n        return true;\n    }\n\n    // Handles switching in and out of fullscreen mode\n    prepareModeChange (options)\n    {\n        // Toggle the classes\n        const changeClass = options.inFullscreen ? 'add' : 'remove';\n        this.viewerState.outerObject.classList[changeClass]('diva-fullscreen');\n        document.body.classList[changeClass]('diva-hide-scrollbar');\n        this.settings.parentObject.classList[changeClass]('diva-full-width');\n\n        // Adjust Diva's internal panel size, keeping the old values\n        const storedHeight = this.settings.panelHeight;\n        const storedWidth = this.settings.panelWidth;\n        this.viewerState.viewport.invalidate();\n\n        // If this isn't the original load, the offsets matter, and the position isn't being changed...\n        if (!this.viewerState.loaded && !this.settings.inGrid && !('verticalOffset' in options))\n        {\n            //get the updated panel size\n            const newHeight = this.settings.panelHeight;\n            const newWidth = this.settings.panelWidth;\n\n            //and re-center the new panel on the same point\n            this.viewerState.verticalOffset += ((storedHeight - newHeight) / 2);\n            this.viewerState.horizontalOffset += ((storedWidth - newWidth) / 2);\n        }\n\n        //turn on/off escape key listener\n        if (options.inFullscreen)\n            document.addEventListener('keyup', this.boundEscapeListener);\n        else\n            document.removeEventListener('keyup', this.boundEscapeListener);\n    }\n\n    // Update the view handler and the view rendering for the current view\n    updateViewHandlerAndRendering ()\n    {\n        const Handler = this.settings.inGrid ? _grid_handler__WEBPACK_IMPORTED_MODULE_5__[\"default\"] : _document_handler__WEBPACK_IMPORTED_MODULE_4__[\"default\"];\n\n        if (this.viewerState.viewHandler && !(this.viewerState.viewHandler instanceof Handler))\n        {\n            this.viewerState.viewHandler.destroy();\n            this.viewerState.viewHandler = null;\n        }\n\n        if (!this.viewerState.viewHandler)\n            this.viewerState.viewHandler = new Handler(this);\n\n        if (!this.viewerState.renderer)\n            this.initializeRenderer();\n    }\n\n    // TODO: This could probably be done upon ViewerCore initialization\n    initializeRenderer ()\n    {\n        const compatErrors = _renderer__WEBPACK_IMPORTED_MODULE_7__[\"default\"].getCompatibilityErrors();\n\n        if (compatErrors)\n        {\n            this.showError(compatErrors);\n        }\n        else\n        {\n            const options = {\n                viewport: this.viewerState.viewport,\n                outerElement: this.viewerState.outerElement,\n                innerElement: this.viewerState.innerElement\n            };\n\n            const hooks = {\n                onViewWillLoad: () =>\n                {\n                    this.viewerState.viewHandler.onViewWillLoad();\n                },\n                onViewDidLoad: () =>\n                {\n                    this.updatePageOverlays();\n                    this.viewerState.viewHandler.onViewDidLoad();\n                },\n                onViewDidUpdate: (pages, targetPage) =>\n                {\n                    this.updatePageOverlays();\n                    this.viewerState.viewHandler.onViewDidUpdate(pages, targetPage);\n                },\n                onViewDidTransition: () =>\n                {\n                    this.updatePageOverlays();\n                },\n                onPageWillLoad: (pageIndex) =>\n                {\n                    this.publish('PageWillLoad', pageIndex);\n                },\n                onZoomLevelWillChange: (zoomLevel) =>\n                {\n                    this.publish('ZoomLevelWillChange', zoomLevel);\n                }\n            };\n\n            this.viewerState.renderer = new _renderer__WEBPACK_IMPORTED_MODULE_7__[\"default\"](options, hooks);\n        }\n    }\n\n    getCurrentSourceProvider ()\n    {\n        if (this.settings.inGrid)\n        {\n            const gridSourceProvider = {\n                getAllZoomLevelsForPage: (page) =>\n                {\n                    return [gridSourceProvider.getBestZoomLevelForPage(page)];\n                },\n                getBestZoomLevelForPage: (page) =>\n                {\n                    const url = this.settings.manifest.getPageImageURL(page.index, {\n                        width: page.dimensions.width\n                    });\n\n                    return {\n                        zoomLevel: 1, // FIXME\n                        rows: 1,\n                        cols: 1,\n                        tiles: [{\n                            url: url,\n                            zoomLevel: 1, // FIXME\n                            row: 0,\n                            col: 0,\n                            dimensions: page.dimensions,\n                            offset: {\n                                top: 0,\n                                left: 0\n                            }\n                        }]\n                    };\n                }\n            };\n\n            return gridSourceProvider;\n        }\n\n        const tileDimensions = {\n            width: this.settings.tileWidth,\n            height: this.settings.tileHeight\n        };\n\n        return {\n            getBestZoomLevelForPage: (page) =>\n            {\n                return this.settings.manifest.getPageImageTiles(page.index, Math.ceil(this.settings.zoomLevel), tileDimensions);\n            },\n            getAllZoomLevelsForPage: (page) =>\n            {\n                const levels = [];\n                const levelCount = this.viewerState.manifest.maxZoom;\n\n                for (let level=0; level <= levelCount; level++)\n                {\n                    levels.push(this.settings.manifest.getPageImageTiles(page.index, level, tileDimensions));\n                }\n\n                levels.reverse();\n\n                return levels;\n            }\n        };\n    }\n\n    getPadding ()\n    {\n        let topPadding, leftPadding;\n        let docVPadding, docHPadding;\n\n        if (this.settings.inGrid)\n        {\n            docVPadding = this.settings.fixedPadding;\n            topPadding = leftPadding = docHPadding = 0;\n        }\n        else\n        {\n            topPadding = this.settings.verticallyOriented ? this.viewerState.verticalPadding : 0;\n            leftPadding = this.settings.verticallyOriented ? 0 : this.viewerState.horizontalPadding;\n\n            docVPadding = this.settings.verticallyOriented ? 0 : this.viewerState.verticalPadding;\n            docHPadding = this.settings.verticallyOriented ? this.viewerState.horizontalPadding : 0;\n        }\n\n        return {\n            document: {\n                top: docVPadding,\n                bottom: docVPadding,\n                left: docHPadding,\n                right: docHPadding\n            },\n            page: {\n                top: topPadding,\n                bottom: 0,\n                left: leftPadding,\n                right: 0\n            }\n        };\n    }\n\n    updatePageOverlays ()\n    {\n        this.viewerState.pageOverlays.updateOverlays(\n            this.viewerState.renderer.getRenderedPages()\n        );\n    }\n\n    // Called to handle any zoom level\n    handleZoom (newZoomLevel, focalPoint)\n    {\n        // If the zoom level provided is invalid, return false\n        if (!this.isValidOption('zoomLevel', newZoomLevel))\n            return false;\n\n        // While zooming, don't update scroll offsets based on the scaled version of diva-inner\n        this.viewerState.viewportObject.removeEventListener('scroll', this.boundScrollFunction);\n\n        // If no focal point was given, zoom on the center of the viewport\n        if (!focalPoint)\n        {\n            const viewport = this.viewerState.viewport;\n            const currentRegion = this.viewerState.renderer.layout.getPageRegion(this.settings.activePageIndex);\n\n            focalPoint = {\n                anchorPage: this.settings.activePageIndex,\n                offset: {\n                    left: (viewport.width / 2) - (currentRegion.left - viewport.left),\n                    top: (viewport.height / 2) - (currentRegion.top - viewport.top)\n                }\n            };\n        }\n\n        const pageRegion = this.viewerState.renderer.layout.getPageRegion(focalPoint.anchorPage);\n\n        // calculate distance from cursor coordinates to center of viewport\n        const focalXToCenter = (pageRegion.left + focalPoint.offset.left) -\n            (this.settings.viewport.left + (this.settings.viewport.width / 2));\n        const focalYToCenter = (pageRegion.top + focalPoint.offset.top) -\n            (this.settings.viewport.top + (this.settings.viewport.height / 2));\n\n        const getPositionForZoomLevel = function (zoomLevel, initZoom)\n        {\n            const zoomRatio = Math.pow(2, zoomLevel - initZoom);\n\n            //TODO(jeromepl): Calculate position from page top left to viewport top left\n            // calculate horizontal/verticalOffset: distance from viewport center to page upper left corner\n            const horizontalOffset = (focalPoint.offset.left * zoomRatio) - focalXToCenter;\n            const verticalOffset = (focalPoint.offset.top * zoomRatio) - focalYToCenter;\n\n            return {\n                zoomLevel: zoomLevel,\n                anchorPage: focalPoint.anchorPage,\n                verticalOffset: verticalOffset,\n                horizontalOffset: horizontalOffset\n            };\n        };\n\n        this.viewerState.options.zoomLevel = newZoomLevel;\n        let initialZoomLevel = this.viewerState.oldZoomLevel;\n        this.viewerState.oldZoomLevel = this.settings.zoomLevel;\n        const endPosition = getPositionForZoomLevel(newZoomLevel, initialZoomLevel);\n        this.viewerState.options.goDirectlyTo = endPosition.anchorPage;\n        this.viewerState.verticalOffset = endPosition.verticalOffset;\n        this.viewerState.horizontalOffset = endPosition.horizontalOffset;\n\n        this.viewerState.renderer.transitionViewportPosition({\n            duration: this.settings.zoomDuration,\n            parameters: {\n                zoomLevel: {\n                    from: initialZoomLevel,\n                    to: newZoomLevel\n                }\n            },\n            getPosition: (parameters) =>\n            {\n                return getPositionForZoomLevel(parameters.zoomLevel, initialZoomLevel);\n            },\n            onEnd: (info) =>\n            {\n                this.viewerState.viewportObject.addEventListener('scroll', this.boundScrollFunction);\n\n                if (info.interrupted)\n                    this.viewerState.oldZoomLevel = newZoomLevel;\n            }\n        });\n\n        // Deactivate zoom buttons while zooming\n        let zoomInButton = document.getElementById(this.settings.selector + 'zoom-in-button');\n        let zoomOutButton = document.getElementById(this.settings.selector + 'zoom-out-button');\n        zoomInButton.disabled = true;\n        zoomOutButton.disabled = true;\n        setTimeout(() =>\n        {\n            zoomInButton.disabled = false;\n            zoomOutButton.disabled = false;\n        }, this.settings.zoomDuration);\n\n        // Send off the zoom level did change event.\n        this.publish(\"ZoomLevelDidChange\", newZoomLevel);\n\n        return true;\n    }\n\n    /*\n     Gets the Y-offset for a specific point on a specific page\n     Acceptable values for \"anchor\":\n     \"top\" (default) - will anchor top of the page to the top of the diva-outer element\n     \"bottom\" - top, s/top/bottom\n     \"center\" - will center the page on the diva element\n     Returned value will be the distance from the center of the diva-outer element to the top of the current page for the specified anchor\n     */\n    getYOffset (pageIndex, anchor)\n    {\n        let pidx = (typeof(pageIndex) === \"undefined\" ? this.settings.activePageIndex : pageIndex);\n\n        if (anchor === \"center\" || anchor === \"centre\") //how you can tell an American coded this\n        {\n            return parseInt(this.getPageData(pidx, \"h\") / 2, 10);\n        }\n        else if (anchor === \"bottom\")\n        {\n            return parseInt(this.getPageData(pidx, \"h\") - this.settings.panelHeight / 2, 10);\n        }\n        else\n        {\n            return parseInt(this.settings.panelHeight / 2, 10);\n        }\n    }\n\n    //Same as getYOffset with \"left\" and \"right\" as acceptable values instead of \"top\" and \"bottom\"\n    getXOffset (pageIndex, anchor)\n    {\n        let pidx = (typeof(pageIndex) === \"undefined\" ? this.settings.activePageIndex : pageIndex);\n\n        if (anchor === \"left\")\n        {\n            return parseInt(this.settings.panelWidth / 2, 10);\n        }\n        else if (anchor === \"right\")\n        {\n            return parseInt(this.getPageData(pidx, \"w\") - this.settings.panelWidth / 2, 10);\n        }\n        else\n        {\n            return parseInt(this.getPageData(pidx, \"w\") / 2, 10);\n        }\n    }\n\n    // updates panelHeight/panelWidth on resize\n    updatePanelSize ()\n    {\n        this.viewerState.viewport.invalidate();\n\n        // FIXME(wabain): This should really only be called after initial load\n        if (this.viewerState.renderer)\n        {\n            this.updateOffsets();\n            this.viewerState.renderer.goto(this.settings.activePageIndex, this.viewerState.verticalOffset, this.viewerState.horizontalOffset);\n        }\n\n        return true;\n    }\n\n    updateOffsets ()\n    {\n        const pageOffset = this.viewerState.renderer.layout.getPageToViewportCenterOffset(this.settings.activePageIndex, this.viewerState.viewport);\n\n        if (pageOffset)\n        {\n            this.viewerState.horizontalOffset = pageOffset.x;\n            this.viewerState.verticalOffset = pageOffset.y;\n        }\n    }\n\n    // Bind mouse events (drag to scroll, double-click)\n    bindMouseEvents ()\n    {\n        // Set drag scroll on the viewport object\n        this.viewerState.viewportObject.classList.add('dragscroll');\n\n        _gesture_events__WEBPACK_IMPORTED_MODULE_2__[\"default\"].onDoubleClick(this.viewerState.viewportObject, (event, coords) =>\n        {\n            debug('Double click at %s, %s', coords.left, coords.top);\n            this.viewerState.viewHandler.onDoubleClick(event, coords);\n        });\n    }\n\n    onResize ()\n    {\n        this.updatePanelSize();\n        // Cancel any previously-set resize timeouts\n        clearTimeout(this.viewerState.resizeTimer);\n\n        this.viewerState.resizeTimer = setTimeout( () =>\n        {\n            const pageOffset = this.viewerState.renderer.layout.getPageToViewportCenterOffset(this.settings.activePageIndex, this.viewerState.viewport);\n\n            if (pageOffset)\n            {\n                this.reloadViewer({\n                    goDirectlyTo: this.settings.activePageIndex,\n                    verticalOffset: pageOffset.y,\n                    horizontalOffset: pageOffset.x\n                });\n            }\n            else\n            {\n                this.reloadViewer({\n                    goDirectlyTo: this.settings.activePageIndex\n                });\n            }\n        }, 200);\n    }\n\n    // Bind touch and orientation change events\n    bindTouchEvents ()\n    {\n        // Block the user from moving the window only if it's not integrated\n        if (this.settings.blockMobileMove)\n        {\n            document.body.addEventListener('touchmove', (event) =>\n            {\n                const e = event.originalEvent;\n                e.preventDefault();\n\n                return false;\n            });\n        }\n\n        // Touch events for swiping in the viewport to scroll pages\n        // this.viewerState.viewportObject.addEventListener('scroll', this.scrollFunction.bind(this));\n\n        _gesture_events__WEBPACK_IMPORTED_MODULE_2__[\"default\"].onPinch(this.viewerState.viewportObject, function (event, coords, start, end)\n        {\n            debug('Pinch %s at %s, %s', end - start, coords.left, coords.top);\n            this.viewerState.viewHandler.onPinch(event, coords, start, end);\n        });\n\n        _gesture_events__WEBPACK_IMPORTED_MODULE_2__[\"default\"].onDoubleTap(this.viewerState.viewportObject, function (event, coords)\n        {\n            debug('Double tap at %s, %s', coords.left, coords.top);\n            this.viewerState.viewHandler.onDoubleClick(event, coords);\n        });\n    }\n\n    // Handle the scroll\n    scrollFunction ()\n    {\n        const previousTopScroll = this.viewerState.viewport.top;\n        const previousLeftScroll = this.viewerState.viewport.left;\n\n        let direction;\n\n        this.viewerState.viewport.invalidate();\n\n        const newScrollTop = this.viewerState.viewport.top;\n        const newScrollLeft = this.viewerState.viewport.left;\n\n        if (this.settings.verticallyOriented || this.settings.inGrid)\n            direction = newScrollTop - previousTopScroll;\n        else\n            direction = newScrollLeft - previousLeftScroll;\n\n        this.viewerState.renderer.adjust();\n\n        const primaryScroll = (this.settings.verticallyOriented || this.settings.inGrid) ? newScrollTop : newScrollLeft;\n\n        this.publish(\"ViewerDidScroll\", primaryScroll);\n\n        if (direction > 0)\n        {\n            this.publish(\"ViewerDidScrollDown\", primaryScroll);\n        }\n        else if (direction < 0)\n        {\n            this.publish(\"ViewerDidScrollUp\", primaryScroll);\n        }\n\n        this.updateOffsets();\n    }\n\n    // Binds most of the event handlers (some more in createToolbar)\n    handleEvents ()\n    {\n        // Change the cursor for dragging\n        this.viewerState.innerObject.addEventListener('mousedown', () =>\n        {\n            this.viewerState.innerObject.classList.add('diva-grabbing');\n        });\n\n        this.viewerState.innerObject.addEventListener('mouseup', () =>\n        {\n            this.viewerState.innerObject.classList.remove('diva-grabbing');\n        });\n\n        this.bindMouseEvents();\n        this.viewerState.viewportObject.addEventListener('scroll', this.boundScrollFunction);\n\n        const upArrowKey = 38, downArrowKey = 40, leftArrowKey = 37, rightArrowKey = 39, spaceKey = 32, pageUpKey = 33, pageDownKey = 34, homeKey = 36, endKey = 35;\n\n        // Catch the key presses in document\n        document.addEventListener('keydown.diva', (event) =>\n        {\n            if (!this.viewerState.isActiveDiva)\n                return true;\n\n            // Space or page down - go to the next page\n            if ((this.settings.enableSpaceScroll && !event.shiftKey && event.keyCode === spaceKey) || (this.settings.enableKeyScroll && event.keyCode === pageDownKey))\n            {\n                this.viewerState.viewport.top += this.settings.panelHeight;\n                return false;\n            }\n            else if (!this.settings.enableSpaceScroll && event.keyCode === spaceKey)\n            {\n                event.preventDefault();\n            }\n\n            if (this.settings.enableKeyScroll)\n            {\n                // Don't steal keyboard shortcuts (metaKey = command [OS X], super [Win/Linux])\n                if (event.shiftKey || event.ctrlKey || event.metaKey)\n                    return true;\n\n                switch (event.keyCode)\n                {\n                    case pageUpKey:\n                        // Page up - go to the previous page\n                        this.viewerState.viewport.top -= this.settings.panelHeight;\n                        return false;\n\n                    case upArrowKey:\n                        // Up arrow - scroll up\n                        this.viewerState.viewport.top -= this.settings.arrowScrollAmount;\n                        return false;\n\n                    case downArrowKey:\n                        // Down arrow - scroll down\n                        this.viewerState.viewport.top += this.settings.arrowScrollAmount;\n                        return false;\n\n                    case leftArrowKey:\n                        // Left arrow - scroll left\n                        this.viewerState.viewport.left -= this.settings.arrowScrollAmount;\n                        return false;\n\n                    case rightArrowKey:\n                        // Right arrow - scroll right\n                        this.viewerState.viewport.left += this.settings.arrowScrollAmount;\n                        return false;\n\n                    case homeKey:\n                        // Home key - go to the beginning of the document\n                        this.viewerState.viewport.top = 0;\n                        return false;\n\n                    case endKey:\n                        // End key - go to the end of the document\n                        // Count on the viewport coordinate value being normalized\n                        if (this.settings.verticallyOriented)\n                            this.viewerState.viewport.top = Infinity;\n                        else\n                            this.viewerState.viewport.left = Infinity;\n\n                        return false;\n\n                    default:\n                        return true;\n                }\n            }\n            return true;\n        });\n\n        _diva_global__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.subscribe('ViewerDidTerminate', function()\n        {\n            document.removeEventListener('keydown.diva');\n        }, this.settings.ID);\n\n        // this.bindTouchEvents();\n\n        // Handle window resizing events\n        window.addEventListener('resize', this.onResize.bind(this), false);\n\n        _diva_global__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.subscribe('ViewerDidTerminate', function()\n        {\n            window.removeEventListener('resize', this.onResize, false);\n        }, this.settings.ID);\n\n        // Handle orientation change separately\n        if ('onorientationchange' in window)\n        {\n            window.addEventListener('orientationchange', this.onResize, false);\n\n            _diva_global__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.subscribe('ViewerDidTerminate', function()\n            {\n                window.removeEventListener('orientationchange', this.onResize, false);\n            }, this.settings.ID);\n        }\n\n        _diva_global__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.subscribe('PanelSizeDidChange', this.updatePanelSize, this.settings.ID);\n\n        // Clear page and resize timeouts when the viewer is destroyed\n        _diva_global__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.subscribe('ViewerDidTerminate', () =>\n        {\n            if (this.viewerState.renderer)\n                this.viewerState.renderer.destroy();\n\n            clearTimeout(this.viewerState.resizeTimer);\n        }, this.settings.ID);\n    }\n\n    initPlugins ()\n    {\n        if (!this.settings.hasOwnProperty('plugins'))\n            return null;\n\n        this.viewerState.pluginInstances = this.settings.plugins.map( (plugin) =>\n        {\n            const p = new plugin(this);\n\n            if (p.isPageTool)\n                this.viewerState.pageTools.push(p);\n\n            return p;\n        });\n    }\n\n    showThrobber ()\n    {\n        this.hideThrobber();\n\n        this.viewerState.throbberTimeoutID = setTimeout( () =>\n        {\n            let thb = document.getElementById(this.settings.selector + 'throbber');\n            if (thb) thb.style.display = 'block';\n        }, this.settings.throbberTimeout);\n    }\n\n    hideThrobber ()\n    {\n        // Clear the timeout, if it hasn't executed yet\n        clearTimeout(this.viewerState.throbberTimeoutID);\n\n        let thb = document.getElementById(this.settings.selector + 'throbber');\n        // Hide the throbber if it has already executed\n        if (thb) thb.style.display = 'none';\n    }\n\n    showError (message)\n    {\n        const errorElement = Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', this.elemAttrs('error'), [\n            Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('button', this.elemAttrs('error-close', {'aria-label': 'Close dialog'})),\n            Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('p',\n                Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('strong', 'Error')\n            ),\n            Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', message)\n        ]);\n\n        this.viewerState.outerObject.appendChild(errorElement);\n\n        //bind dialog close button\n        document.querySelector(this.settings.selector + 'error-close').addEventListener('click', () =>\n        {\n            errorElement.parentNode.removeChild(errorElement);\n        });\n    }\n\n    setManifest (manifest, loadOptions)\n    {\n        this.viewerState.manifest = manifest;\n\n        this.hideThrobber();\n\n        // Convenience value\n        this.viewerState.numPages = this.settings.manifest.pages.length;\n\n        this.optionsValidator.validate(this.viewerState.options);\n\n        this.publish('NumberOfPagesDidChange', this.settings.numPages);\n\n        if (this.settings.enableAutoTitle)\n        {\n            let title = document.getElementById(this.settings.selector + 'title');\n\n            if (title)\n            {\n                title.innerHTML = this.settings.manifest.itemTitle;\n            }\n            else\n            {\n                this.settings.parentObject.insertBefore(\n                    Object(_utils_elt__WEBPACK_IMPORTED_MODULE_0__[\"elt\"])('div', this.elemAttrs('title'), [this.settings.manifest.itemTitle]),\n                    this.settings.parentObject.firstChild\n                );\n            }\n        }\n\n        // Calculate the horizontal and vertical inter-page padding based on the dimensions of the average zoom level\n        if (this.settings.adaptivePadding > 0)\n        {\n            const z = Math.floor((this.settings.minZoomLevel + this.settings.maxZoomLevel) / 2);\n            this.viewerState.horizontalPadding = parseInt(this.settings.manifest.getAverageWidth(z) * this.settings.adaptivePadding, 10);\n            this.viewerState.verticalPadding = parseInt(this.settings.manifest.getAverageHeight(z) * this.settings.adaptivePadding, 10);\n        }\n        else\n        {\n            // It's less than or equal to 0; use fixedPadding instead\n            this.viewerState.horizontalPadding = this.settings.fixedPadding;\n            this.viewerState.verticalPadding = this.settings.fixedPadding;\n        }\n\n        // Make sure the vertical padding is at least 40, if plugin icons are enabled\n        if (this.viewerState.pageTools.length)\n        {\n            this.viewerState.verticalPadding = Math.max(40, this.viewerState.verticalPadding);\n        }\n\n        // If we detect a viewingHint of 'paged' in the manifest or sequence, enable book view by default\n        if (this.settings.manifest.paged)\n        {\n            this.viewerState.options.inBookLayout = true;\n        }\n\n        // Plugin setup hooks should be bound to the ObjectDidLoad event\n        this.publish('ObjectDidLoad', this.settings);\n\n        // Adjust the document panel dimensions\n        this.updatePanelSize();\n\n        let needsXCoord, needsYCoord;\n\n        let anchoredVertically = false;\n        let anchoredHorizontally = false;\n\n        // NB: `==` here will check both null and undefined\n        if (loadOptions.goDirectlyTo == null)\n        {\n            loadOptions.goDirectlyTo = this.settings.goDirectlyTo;\n            needsXCoord = needsYCoord = true;\n        }\n        else\n        {\n            needsXCoord = loadOptions.horizontalOffset == null || isNaN(loadOptions.horizontalOffset);\n            needsYCoord = loadOptions.verticalOffset == null || isNaN(loadOptions.verticalOffset);\n        }\n\n        // Set default values for the horizontal and vertical offsets\n        if (needsXCoord)\n        {\n            // FIXME: What if inBookLayout/verticallyOriented is changed by loadOptions?\n            if (loadOptions.goDirectlyTo === 0 && this.settings.inBookLayout && this.settings.verticallyOriented)\n            {\n                // if in book layout, center the first opening by default\n                loadOptions.horizontalOffset = this.viewerState.horizontalPadding;\n            }\n            else\n            {\n                anchoredHorizontally = true;\n                loadOptions.horizontalOffset = this.getXOffset(loadOptions.goDirectlyTo, \"center\");\n            }\n        }\n\n        if (needsYCoord)\n        {\n            anchoredVertically = true;\n            loadOptions.verticalOffset = this.getYOffset(loadOptions.goDirectlyTo, \"top\");\n        }\n\n        this.reloadViewer(loadOptions);\n\n        //prep dimensions one last time now that pages have loaded\n        this.updatePanelSize();\n\n        // FIXME: This is a hack to ensure that the outerElement scrollbars are taken into account\n        if (this.settings.verticallyOriented)\n            this.viewerState.innerElement.style.minWidth = this.settings.panelWidth + 'px';\n        else\n            this.viewerState.innerElement.style.minHeight = this.settings.panelHeight + 'px';\n\n        // FIXME: If the page was supposed to be positioned relative to the viewport we need to\n        // recalculate it to take into account the scrollbars\n        if (anchoredVertically || anchoredHorizontally)\n        {\n            if (anchoredVertically)\n                this.viewerState.verticalOffset = this.getYOffset(this.settings.activePageIndex, \"top\");\n\n            if (anchoredHorizontally)\n                this.viewerState.horizontalOffset = this.getXOffset(this.settings.activePageIndex, \"center\");\n\n            this.viewerState.renderer.goto(this.settings.activePageIndex, this.viewerState.verticalOffset, this.viewerState.horizontalOffset);\n        }\n\n        // signal that everything should be set up and ready to go.\n        this.viewerState.loaded = true;\n\n        this.publish(\"ViewerDidLoad\", this.settings);\n    }\n\n    publish (event)\n    {\n        const args = Array.prototype.slice.call(arguments, 1);\n        _diva_global__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.publish(event, args, this.publicInstance);\n    }\n\n    getSettings ()\n    {\n        return this.settings;\n    }\n\n    // Temporary accessor for the state of the viewer core\n    // TODO: Replace this with a more restricted view of whatever needs\n    // be exposed through settings for backwards compat\n    getInternalState ()\n    {\n        return this.viewerState;\n    }\n\n    getPublicInstance ()\n    {\n        return this.publicInstance;\n    }\n\n    getPageTools ()\n    {\n        return this.viewerState.pageTools;\n    }\n\n    getCurrentLayout ()\n    {\n        return this.viewerState.renderer ? this.viewerState.renderer.layout : null;\n    }\n\n    /** Get a copy of the current viewport dimensions */\n    getViewport ()\n    {\n        const viewport = this.viewerState.viewport;\n\n        return {\n            top: viewport.top,\n            left: viewport.left,\n            bottom: viewport.bottom,\n            right: viewport.right,\n\n            width: viewport.width,\n            height: viewport.height\n        };\n    }\n\n    addPageOverlay (overlay)\n    {\n        this.viewerState.pageOverlays.addOverlay(overlay);\n    }\n\n    removePageOverlay (overlay)\n    {\n        this.viewerState.pageOverlays.removeOverlay(overlay);\n    }\n\n    getPageRegion (pageIndex, options)\n    {\n        const layout = this.viewerState.renderer.layout;\n        const region = layout.getPageRegion(pageIndex, options);\n\n        if (options && options.incorporateViewport)\n        {\n            const secondaryDim = this.settings.verticallyOriented ? 'width' : 'height';\n\n            if (this.viewerState.viewport[secondaryDim] > layout.dimensions[secondaryDim])\n            {\n                const docOffset = (this.viewerState.viewport[secondaryDim] - layout.dimensions[secondaryDim]) / 2;\n\n                if (this.settings.verticallyOriented)\n                {\n                    return {\n                        top: region.top,\n                        bottom: region.bottom,\n\n                        left: region.left + docOffset,\n                        right: region.right + docOffset\n                    };\n                }\n                else\n                {\n                    return {\n                        top: region.top + docOffset,\n                        bottom: region.bottom + docOffset,\n\n                        left: region.left,\n                        right: region.right\n                    };\n                }\n            }\n        }\n\n        return region;\n    }\n\n    getPagePositionAtViewportOffset (coords)\n    {\n        const docCoords = {\n            left: coords.left + this.viewerState.viewport.left,\n            top: coords.top + this.viewerState.viewport.top\n        };\n\n        const renderedPages = this.viewerState.renderer.getRenderedPages();\n        const pageCount = renderedPages.length;\n\n        // Find the page on which the coords occur\n        for (let i=0; i < pageCount; i++)\n        {\n            const pageIndex = renderedPages[i];\n            const region = this.viewerState.renderer.layout.getPageRegion(pageIndex);\n\n            if (region.left <= docCoords.left && region.right >= docCoords.left &&\n                region.top <= docCoords.top && region.bottom >= docCoords.top)\n            {\n                return {\n                    anchorPage: pageIndex,\n                    offset: {\n                        left: docCoords.left - region.left,\n                        top: docCoords.top - region.top\n                    }\n                };\n            }\n        }\n\n        // Fall back to current page\n        // FIXME: Would be better to use the closest page or something\n        const currentRegion = this.viewerState.renderer.layout.getPageRegion(this.settings.activePageIndex);\n\n        return {\n            anchorPage: this.settings.activePageIndex,\n            offset: {\n                left: docCoords.left - currentRegion.left,\n                top: docCoords.top - currentRegion.top\n            }\n        };\n    }\n\n    // setManifest (manifest, loadOptions)\n    // {\n    //     setManifest(manifest, loadOptions || {});\n    // }\n\n    /**\n     * Set the current page to the given index, firing VisiblePageDidChange\n     *\n     * @param pageIndex\n     */\n    setCurrentPages (activePage, visiblePages)\n    {\n        if (!arraysEqual(this.viewerState.currentPageIndices, visiblePages))\n        {\n            this.viewerState.currentPageIndices = visiblePages;\n            this.viewerState.activePageIndex = activePage;\n            this.publish(\"VisiblePageDidChange\", visiblePages);\n\n            // Publish an event if the page we're switching to has other images.\n            if (this.viewerState.manifest.pages[activePage].otherImages.length > 0)\n                this.publish('VisiblePageHasAlternateViews', activePage);\n        }\n\n        function arraysEqual (a, b)\n        {\n            if (a.length !== b.length)\n                return false;\n            \n            for (let i = 0, len = a.length; i < len; i++)\n            {\n                if (a[i] !== b[i])\n                    return false;\n            }\n            return true;\n        }\n    }\n\n    getPageName (pageIndex)\n    {\n        return this.viewerState.manifest.pages[pageIndex].f;\n    }\n\n    reload (newOptions)\n    {\n        this.reloadViewer(newOptions);\n    }\n\n    zoom (zoomLevel, focalPoint)\n    {\n        return this.handleZoom(zoomLevel, focalPoint);\n    }\n\n    enableScrollable ()\n    {\n        if (!this.viewerState.isScrollable)\n        {\n            this.bindMouseEvents();\n            this.enableDragScrollable();\n            this.viewerState.options.enableKeyScroll = this.viewerState.initialKeyScroll;\n            this.viewerState.options.enableSpaceScroll = this.viewerState.initialSpaceScroll;\n            this.viewerState.viewportElement.style.overflow = 'auto';\n            this.viewerState.isScrollable = true;\n        }\n    }\n\n    enableDragScrollable ()\n    {\n        if (this.viewerState.viewportObject.hasAttribute('nochilddrag'))\n            this.viewerState.viewportObject.removeAttribute('nochilddrag');\n    }\n\n    disableScrollable ()\n    {\n        if (this.viewerState.isScrollable)\n        {\n            // block dragging\n            this.disableDragScrollable();\n\n            // block double-click zooming\n            this.viewerState.outerObject.dblclick = null;\n            this.viewerState.outerObject.contextmenu = null;\n\n            // disable all other scrolling actions\n            this.viewerState.viewportElement.style.overflow = 'hidden';\n\n            // block scrolling keys behavior, respecting initial scroll settings\n            this.viewerState.initialKeyScroll = this.settings.enableKeyScroll;\n            this.viewerState.initialSpaceScroll = this.settings.enableSpaceScroll;\n            this.viewerState.options.enableKeyScroll = false;\n            this.viewerState.options.enableSpaceScroll = false;\n\n            this.viewerState.isScrollable = false;\n        }\n    }\n\n    disableDragScrollable ()\n    {\n        if (!this.viewerState.viewportObject.hasAttribute('nochilddrag'))\n            this.viewerState.viewportObject.setAttribute('nochilddrag', \"\");\n    }\n\n    // isValidOption (key, value)\n    // {\n    //     return isValidOption(key, value);\n    // }\n\n    // getXOffset (pageIndex, xAnchor)\n    // {\n    //     return getXOffset(pageIndex, xAnchor);\n    // }\n\n    // getYOffset (pageIndex, yAnchor)\n    // {\n    //     return getYOffset(pageIndex, yAnchor);\n    // }\n\n    // this.publish = publish;\n\n    clear ()\n    {\n        this.clearViewer();\n    }\n\n    setPendingManifestRequest (pendingManifestRequest)\n    {\n        this.viewerState.pendingManifestRequest = pendingManifestRequest;\n    }\n\n    destroy ()\n    {\n        // Useful event to access elements in diva before they get destroyed. Used by the highlight plugin.\n        this.publish('ViewerWillTerminate', this.settings);\n\n        // Cancel any pending request retrieving a manifest\n        if (this.settings.pendingManifestRequest)\n            this.settings.pendingManifestRequest.abort();\n\n        // Removes the hide-scrollbar class from the body\n        document.body.removeClass('diva-hide-scrollbar');\n\n        // Empty the parent container and remove any diva-related data\n        this.settings.parentObject.parent().empty().removeData('diva');\n\n        // Remove any additional styling on the parent element\n        this.settings.parentObject.parent().removeAttr('style').removeAttr('class');\n\n        this.publish('ViewerDidTerminate', this.settings);\n\n        // Clear the Events cache\n        _diva_global__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.unsubscribeAll(this.settings.ID);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdmlld2VyLWNvcmUuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvdmlld2VyLWNvcmUuanM/NjYzZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBlbHQgfSBmcm9tICcuL3V0aWxzL2VsdCc7XG5pbXBvcnQgZ2V0U2Nyb2xsYmFyV2lkdGggZnJvbSAnLi91dGlscy9nZXQtc2Nyb2xsYmFyLXdpZHRoJztcbmltcG9ydCBnZXN0dXJlRXZlbnRzIGZyb20gJy4vZ2VzdHVyZS1ldmVudHMnO1xuaW1wb3J0IGRpdmEgZnJvbSAnLi9kaXZhLWdsb2JhbCc7XG5pbXBvcnQgRG9jdW1lbnRIYW5kbGVyIGZyb20gJy4vZG9jdW1lbnQtaGFuZGxlcic7XG5pbXBvcnQgR3JpZEhhbmRsZXIgZnJvbSAnLi9ncmlkLWhhbmRsZXInO1xuaW1wb3J0IFBhZ2VPdmVybGF5TWFuYWdlciBmcm9tICcuL3BhZ2Utb3ZlcmxheS1tYW5hZ2VyJztcbmltcG9ydCBSZW5kZXJlciBmcm9tICcuL3JlbmRlcmVyJztcbmltcG9ydCBnZXRQYWdlTGF5b3V0cyBmcm9tICcuL3BhZ2UtbGF5b3V0cyc7XG5pbXBvcnQgY3JlYXRlU2V0dGluZ3NWaWV3IGZyb20gJy4vc2V0dGluZ3Mtdmlldyc7XG5pbXBvcnQgVmFsaWRhdGlvblJ1bm5lciBmcm9tICcuL3ZhbGlkYXRpb24tcnVubmVyJztcbmltcG9ydCBWaWV3cG9ydCBmcm9tICcuL3ZpZXdwb3J0JztcblxuY29uc3QgZGVidWcgPSByZXF1aXJlKCdkZWJ1ZycpKCdkaXZhOlZpZXdlckNvcmUnKTtcblxuZnVuY3Rpb24gZ2VuZXJhdGVJZCgpIHtcbiAgICByZXR1cm4gZ2VuZXJhdGVJZC5jb3VudGVyKys7XG59XG5nZW5lcmF0ZUlkLmNvdW50ZXIgPSAxO1xuXG5cbi8vIERlZmluZSB2YWxpZGF0aW9uc1xuY29uc3Qgb3B0aW9uc1ZhbGlkYXRpb25zID0gW1xuICAgIHtcbiAgICAgICAga2V5OiAnZ29EaXJlY3RseVRvJyxcbiAgICAgICAgdmFsaWRhdGU6ICh2YWx1ZSwgc2V0dGluZ3MpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IDAgfHwgdmFsdWUgPj0gc2V0dGluZ3MubWFuaWZlc3QucGFnZXMubGVuZ3RoKVxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIGtleTogJ21pblBhZ2VzUGVyUm93JyxcbiAgICAgICAgdmFsaWRhdGU6ICh2YWx1ZSkgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KDIsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgICBrZXk6ICdtYXhQYWdlc1BlclJvdycsXG4gICAgICAgIHZhbGlkYXRlOiAodmFsdWUsIHNldHRpbmdzKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgodmFsdWUsIHNldHRpbmdzLm1pblBhZ2VzUGVyUm93KTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgICBrZXk6ICdwYWdlc1BlclJvdycsXG4gICAgICAgIHZhbGlkYXRlOiAodmFsdWUsIHNldHRpbmdzKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBEZWZhdWx0IHRvIHRoZSBtYXhpbXVtXG4gICAgICAgICAgICBpZiAodmFsdWUgPCBzZXR0aW5ncy5taW5QYWdlc1BlclJvdyB8fCB2YWx1ZSA+IHNldHRpbmdzLm1heFBhZ2VzUGVyUm93KVxuICAgICAgICAgICAgICAgIHJldHVybiBzZXR0aW5ncy5tYXhQYWdlc1BlclJvdztcbiAgICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgICBrZXk6ICdtYXhab29tTGV2ZWwnLFxuICAgICAgICB2YWxpZGF0ZTogKHZhbHVlLCBzZXR0aW5ncywgY29uZmlnKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBDaGFuZ2luZyB0aGlzIHZhbHVlIGlzbid0IHJlYWxseSBhbiBlcnJvciwgaXQganVzdCBkZXBlbmRzIG9uIHRoZVxuICAgICAgICAgICAgLy8gc291cmNlIG1hbmlmZXN0XG4gICAgICAgICAgICBjb25maWcuc3VwcHJlc3NXYXJuaW5nKCk7XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IDAgfHwgdmFsdWUgPiBzZXR0aW5ncy5tYW5pZmVzdC5tYXhab29tKVxuICAgICAgICAgICAgICAgIHJldHVybiBzZXR0aW5ncy5tYW5pZmVzdC5tYXhab29tO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIGtleTogJ21pblpvb21MZXZlbCcsXG4gICAgICAgIHZhbGlkYXRlOiAodmFsdWUsIHNldHRpbmdzLCBjb25maWcpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIENoYW5nZXMgYmFzZWQgb24gdGhlIG1hbmlmZXN0IHZhbHVlIHNob3VsZG4ndCB0cmlnZ2VyIGFcbiAgICAgICAgICAgIC8vIHdhcm5pbmdcbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IHNldHRpbmdzLm1hbmlmZXN0Lm1heFpvb20pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uZmlnLnN1cHByZXNzV2FybmluZygpO1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID4gc2V0dGluZ3MubWF4Wm9vbUxldmVsKVxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIGtleTogJ3pvb21MZXZlbCcsXG4gICAgICAgIHZhbGlkYXRlOiAodmFsdWUsIHNldHRpbmdzLCBjb25maWcpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IHNldHRpbmdzLm1hbmlmZXN0Lm1heFpvb20pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uZmlnLnN1cHByZXNzV2FybmluZygpO1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodmFsdWUgPCBzZXR0aW5ncy5taW5ab29tTGV2ZWwgfHwgdmFsdWUgPiBzZXR0aW5ncy5tYXhab29tTGV2ZWwpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNldHRpbmdzLm1pblpvb21MZXZlbDtcbiAgICAgICAgfVxuICAgIH1cbl07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZpZXdlckNvcmVcbntcbiAgICBjb25zdHJ1Y3RvciAoZWxlbWVudCwgb3B0aW9ucywgcHVibGljSW5zdGFuY2UpXG4gICAge1xuICAgICAgICB0aGlzLnBhcmVudE9iamVjdCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMucHVibGljSW5zdGFuY2UgPSBwdWJsaWNJbnN0YW5jZTtcblxuICAgICAgICAvLyBUaGluZ3MgdGhhdCBjYW5ub3QgYmUgY2hhbmdlZCBiZWNhdXNlIG9mIHRoZSB3YXkgdGhleSBhcmUgdXNlZCBieSB0aGUgc2NyaXB0XG4gICAgICAgIC8vIE1hbnkgb2YgdGhlc2UgYXJlIGRlY2xhcmVkIHdpdGggYXJiaXRyYXJ5IHZhbHVlcyB0aGF0IGFyZSBjaGFuZ2VkIGxhdGVyIG9uXG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUgPSB7XG4gICAgICAgICAgICBjdXJyZW50UGFnZUluZGljZXM6IFswXSwgICAgLy8gVGhlIHZpc2libGUgcGFnZXMgaW4gdGhlIHZpZXdwb3J0XG4gICAgICAgICAgICBhY3RpdmVQYWdlSW5kZXg6IDAsICAgICAgICAgLy8gVGhlIGN1cnJlbnQgJ2FjdGl2ZScgcGFnZSBpbiB0aGUgdmlld3BvcnRcbiAgICAgICAgICAgIGhvcml6b250YWxPZmZzZXQ6IDAsICAgICAgICAvLyBEaXN0YW5jZSBmcm9tIHRoZSBjZW50ZXIgb2YgdGhlIGRpdmEgZWxlbWVudCB0byB0aGUgdG9wIG9mIHRoZSBjdXJyZW50IHBhZ2VcbiAgICAgICAgICAgIGhvcml6b250YWxQYWRkaW5nOiAwLCAgICAgICAvLyBFaXRoZXIgdGhlIGZpeGVkIHBhZGRpbmcgb3IgYWRhcHRpdmUgcGFkZGluZ1xuICAgICAgICAgICAgSUQ6IG51bGwsICAgICAgICAgICAgICAgICAgIC8vIFRoZSBwcmVmaXggb2YgdGhlIElEcyBvZiB0aGUgZWxlbWVudHMgKHVzdWFsbHkgMS1kaXZhLSlcbiAgICAgICAgICAgIGluaXRpYWxLZXlTY3JvbGw6IGZhbHNlLCAgICAvLyBIb2xkcyB0aGUgaW5pdGlhbCBzdGF0ZSBvZiBlbmFibGVLZXlTY3JvbGxcbiAgICAgICAgICAgIGluaXRpYWxTcGFjZVNjcm9sbDogZmFsc2UsICAvLyBIb2xkcyB0aGUgaW5pdGlhbCBzdGF0ZSBvZiBlbmFibGVTcGFjZVNjcm9sbFxuICAgICAgICAgICAgaW5uZXJFbGVtZW50OiBudWxsLCAgICAgICAgIC8vIFRoZSBuYXRpdmUgLmRpdmEtb3V0ZXIgRE9NIG9iamVjdFxuICAgICAgICAgICAgaW5uZXJPYmplY3Q6IHt9LCAgICAgICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNldHRpbmdzLklEICsgJ2lubmVyJyksIGZvciBzZWxlY3RpbmcgdGhlIC5kaXZhLWlubmVyIGVsZW1lbnRcbiAgICAgICAgICAgIGlzQWN0aXZlRGl2YTogdHJ1ZSwgICAgICAgICAvLyBJbiB0aGUgY2FzZSB0aGF0IG11bHRpcGxlIGRpdmEgcGFuZXMgZXhpc3Qgb24gdGhlIHNhbWUgcGFnZSwgdGhpcyBzaG91bGQgaGF2ZSBldmVudHMgZnVubmVsZWQgdG8gaXQuXG4gICAgICAgICAgICBpc1Njcm9sbGFibGU6IHRydWUsICAgICAgICAgLy8gVXNlZCBpbiBlbmFibGUvZGlzYWJsZVNjcm9sbGFibGUgcHVibGljIG1ldGhvZHNcbiAgICAgICAgICAgIGlzWm9vbWluZzogZmFsc2UsICAgICAgICAgICAvLyBGbGFnIHRvIGtlZXAgdHJhY2sgb2Ygd2hldGhlciB6b29taW5nIGlzIHN0aWxsIGluIHByb2dyZXNzLCBmb3IgaGFuZGxlWm9vbVxuICAgICAgICAgICAgbG9hZGVkOiBmYWxzZSwgICAgICAgICAgICAgIC8vIEEgZmxhZyBmb3Igd2hlbiBldmVyeXRoaW5nIGlzIGxvYWRlZCBhbmQgcmVhZHkgdG8gZ28uXG4gICAgICAgICAgICBtYW5pZmVzdDogbnVsbCxcbiAgICAgICAgICAgIG1vYmlsZVdlYmtpdDogZmFsc2UsICAgICAgICAvLyBDaGVja3MgaWYgdGhlIHVzZXIgaXMgb24gYSB0b3VjaCBkZXZpY2UgKGlQYWQvaVBvZC9pUGhvbmUvQW5kcm9pZClcbiAgICAgICAgICAgIG51bVBhZ2VzOiAwLCAgICAgICAgICAgICAgICAvLyBOdW1iZXIgb2YgcGFnZXMgaW4gdGhlIGFycmF5XG4gICAgICAgICAgICBvbGRab29tTGV2ZWw6IC0xLCAgICAgICAgICAgLy8gSG9sZHMgdGhlIHByZXZpb3VzIHpvb20gbGV2ZWwgYWZ0ZXIgem9vbWluZyBpbiBvciBvdXRcbiAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnMsXG4gICAgICAgICAgICBvdXRlckVsZW1lbnQ6IG51bGwsICAgICAgICAgLy8gVGhlIG5hdGl2ZSAuZGl2YS1vdXRlciBET00gb2JqZWN0XG4gICAgICAgICAgICBvdXRlck9iamVjdDoge30sICAgICAgICAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2V0dGluZ3MuSUQgKyAnb3V0ZXInKSwgZm9yIHNlbGVjdGluZyB0aGUgLmRpdmEtb3V0ZXIgZWxlbWVudFxuICAgICAgICAgICAgcGFnZU92ZXJsYXlzOiBuZXcgUGFnZU92ZXJsYXlNYW5hZ2VyKCksXG4gICAgICAgICAgICBwYWdlVG9vbHM6IFtdLCAgICAgICAgICAgICAgLy8gVGhlIHBsdWdpbnMgd2hpY2ggYXJlIGVuYWJsZWQgYXMgcGFnZSB0b29sc1xuICAgICAgICAgICAgcGFyZW50T2JqZWN0OiB0aGlzLnBhcmVudE9iamVjdCwgLy8gSlF1ZXJ5IG9iamVjdCByZWZlcmVuY2luZyB0aGUgcGFyZW50IGVsZW1lbnRcbiAgICAgICAgICAgIHBlbmRpbmdNYW5pZmVzdFJlcXVlc3Q6IG51bGwsIC8vIFJlZmVyZW5jZSB0byB0aGUgeGhyIHJlcXVlc3QgcmV0cmlldmluZyB0aGUgbWFuaWZlc3QuIFVzZWQgdG8gY2FuY2VsIHRoZSByZXF1ZXN0IG9uIGRlc3Ryb3koKVxuICAgICAgICAgICAgcGx1Z2luSW5zdGFuY2VzOiBbXSwgICAgICAgICAgICAgICAgLy8gRmlsbGVkIHdpdGggdGhlIGVuYWJsZWQgcGx1Z2lucyBmcm9tIHRoZSByZWdpc3RyeVxuICAgICAgICAgICAgcmVuZGVyZXI6IG51bGwsXG4gICAgICAgICAgICByZXNpemVUaW1lcjogLTEsICAgICAgICAgICAgLy8gSG9sZHMgdGhlIElEIG9mIHRoZSB0aW1lb3V0IHVzZWQgd2hlbiByZXNpemluZyB0aGUgd2luZG93IChmb3IgY2xlYXJpbmcpXG4gICAgICAgICAgICBzY3JvbGxiYXJXaWR0aDogMCwgICAgICAgICAgLy8gU2V0IHRvIHRoZSBhY3R1YWwgc2Nyb2xsYmFyIHdpZHRoIGluIGluaXQoKVxuICAgICAgICAgICAgc2VsZWN0b3I6ICcnLCAgICAgICAgICAgICAgIC8vIFVzZXMgdGhlIGdlbmVyYXRlZCBJRCBwcmVmaXggdG8gZWFzaWx5IHNlbGVjdCBlbGVtZW50c1xuICAgICAgICAgICAgdGhyb2JiZXJUaW1lb3V0SUQ6IC0xLCAgICAgIC8vIEhvbGRzIHRoZSBJRCBvZiB0aGUgdGhyb2JiZXIgbG9hZGluZyB0aW1lb3V0XG4gICAgICAgICAgICB0b29sYmFyOiBudWxsLCAgICAgICAgICAgICAgLy8gSG9sZHMgYW4gb2JqZWN0IHdpdGggc29tZSB0b29sYmFyLXJlbGF0ZWQgZnVuY3Rpb25zXG4gICAgICAgICAgICB2ZXJ0aWNhbE9mZnNldDogMCwgICAgICAgICAgLy8gRGlzdGFuY2UgZnJvbSB0aGUgY2VudGVyIG9mIHRoZSBkaXZhIGVsZW1lbnQgdG8gdGhlIGxlZnQgc2lkZSBvZiB0aGUgY3VycmVudCBwYWdlXG4gICAgICAgICAgICB2ZXJ0aWNhbFBhZGRpbmc6IDAsICAgICAgICAgLy8gRWl0aGVyIHRoZSBmaXhlZCBwYWRkaW5nIG9yIGFkYXB0aXZlIHBhZGRpbmdcbiAgICAgICAgICAgIHZpZXdIYW5kbGVyOiBudWxsLFxuICAgICAgICAgICAgdmlld3BvcnQ6IG51bGwsICAgICAgICAgICAgIC8vIE9iamVjdCBjYWNoaW5nIHRoZSB2aWV3cG9ydCBkaW1lbnNpb25zXG4gICAgICAgICAgICB2aWV3cG9ydEVsZW1lbnQ6IG51bGwsXG4gICAgICAgICAgICB2aWV3cG9ydE9iamVjdDogbnVsbCxcbiAgICAgICAgICAgIHpvb21EdXJhdGlvbjogNDAwXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IGNyZWF0ZVNldHRpbmdzVmlldyhbb3B0aW9ucywgdGhpcy52aWV3ZXJTdGF0ZV0pO1xuXG4gICAgICAgIC8vIEdlbmVyYXRlIGFuIElEIHRoYXQgY2FuIGJlIHVzZWQgYXMgYSBwcmVmaXggZm9yIGFsbCB0aGUgb3RoZXIgSURzXG4gICAgICAgIGNvbnN0IGlkTnVtYmVyID0gZ2VuZXJhdGVJZCgpO1xuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLklEID0gJ2RpdmEtJyArIGlkTnVtYmVyICsgJy0nO1xuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnNlbGVjdG9yID0gdGhpcy5zZXR0aW5ncy5JRDtcblxuICAgICAgICAvLyBBbGlhc2VzIGZvciBjb21wYXRpYmlsaXR5XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMuc2V0dGluZ3MsIHtcbiAgICAgICAgICAgIC8vIEhlaWdodCBvZiB0aGUgZG9jdW1lbnQgdmlld2VyIHBhbmVcbiAgICAgICAgICAgIHBhbmVsSGVpZ2h0OiB7XG4gICAgICAgICAgICAgICAgZ2V0OiAoKSA9PlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBXaWR0aCBvZiB0aGUgZG9jdW1lbnQgdmlld2VyIHBhbmVcbiAgICAgICAgICAgIHBhbmVsV2lkdGg6IHtcbiAgICAgICAgICAgICAgICBnZXQ6ICgpID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydC53aWR0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMub3B0aW9uc1ZhbGlkYXRvciA9IG5ldyBWYWxpZGF0aW9uUnVubmVyKHtcbiAgICAgICAgICAgIGFkZGl0aW9uYWxQcm9wZXJ0aWVzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdtYW5pZmVzdCcsXG4gICAgICAgICAgICAgICAgICAgIGdldDogKCkgPT5cbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlld2VyU3RhdGUubWFuaWZlc3Q7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdLFxuXG4gICAgICAgICAgICB2YWxpZGF0aW9uczogb3B0aW9uc1ZhbGlkYXRpb25zXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUuc2Nyb2xsYmFyV2lkdGggPSBnZXRTY3JvbGxiYXJXaWR0aCgpO1xuXG4gICAgICAgIC8vIElmIHdpbmRvdy5vcmllbnRhdGlvbiBpcyBkZWZpbmVkLCB0aGVuIGl0J3MgcHJvYmFibHkgbW9iaWxlV2Via2l0XG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUubW9iaWxlV2Via2l0ID0gd2luZG93Lm9yaWVudGF0aW9uICE9PSB1bmRlZmluZWQ7XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuaGFzaFBhcmFtU3VmZml4ID09PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBPbWl0IHRoZSBzdWZmaXggZnJvbSB0aGUgZmlyc3QgaW5zdGFuY2VcbiAgICAgICAgICAgIGlmIChpZE51bWJlciA9PT0gMSlcbiAgICAgICAgICAgICAgICBvcHRpb25zLmhhc2hQYXJhbVN1ZmZpeCA9ICcnO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIG9wdGlvbnMuaGFzaFBhcmFtU3VmZml4ID0gaWROdW1iZXIgKyAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgaW5uZXIgYW5kIG91dGVyIHBhbmVsc1xuICAgICAgICBjb25zdCBpbm5lckVsZW0gPSBlbHQoJ2RpdicsIHRoaXMuZWxlbUF0dHJzKCdpbm5lcicsIHsgY2xhc3M6ICdkaXZhLWlubmVyJyB9KSk7XG4gICAgICAgIGNvbnN0IHZpZXdwb3J0RWxlbSA9IGVsdCgnZGl2JywgdGhpcy5lbGVtQXR0cnMoJ3ZpZXdwb3J0JyksIGlubmVyRWxlbSk7XG4gICAgICAgIGNvbnN0IG91dGVyRWxlbSA9IGVsdCgnZGl2JywgdGhpcy5lbGVtQXR0cnMoJ291dGVyJyksXG4gICAgICAgICAgICB2aWV3cG9ydEVsZW0sXG4gICAgICAgICAgICBlbHQoJ2RpdicsIHRoaXMuZWxlbUF0dHJzKCd0aHJvYmJlcicpLFxuICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgZWx0KCdkaXYnLCB7IGNsYXNzOiAnY3ViZSBjdWJlMScgfSksXG4gICAgICAgICAgICAgICAgICAgIGVsdCgnZGl2JywgeyBjbGFzczogJ2N1YmUgY3ViZTInIH0pLFxuICAgICAgICAgICAgICAgICAgICBlbHQoJ2RpdicsIHsgY2xhc3M6ICdjdWJlIGN1YmUzJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgZWx0KCdkaXYnLCB7IGNsYXNzOiAnY3ViZSBjdWJlNCcgfSksXG4gICAgICAgICAgICAgICAgICAgIGVsdCgnZGl2JywgeyBjbGFzczogJ2N1YmUgY3ViZTUnIH0pLFxuICAgICAgICAgICAgICAgICAgICBlbHQoJ2RpdicsIHsgY2xhc3M6ICdjdWJlIGN1YmU2JyB9KSxcbiAgICAgICAgICAgICAgICAgICAgZWx0KCdkaXYnLCB7IGNsYXNzOiAnY3ViZSBjdWJlNycgfSksXG4gICAgICAgICAgICAgICAgICAgIGVsdCgnZGl2JywgeyBjbGFzczogJ2N1YmUgY3ViZTgnIH0pLFxuICAgICAgICAgICAgICAgICAgICBlbHQoJ2RpdicsIHsgY2xhc3M6ICdjdWJlIGN1YmU5JyB9KSxcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICApKTtcblxuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmlubmVyRWxlbWVudCA9IGlubmVyRWxlbTtcbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydEVsZW1lbnQgPSB2aWV3cG9ydEVsZW07XG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUub3V0ZXJFbGVtZW50ID0gb3V0ZXJFbGVtO1xuXG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUuaW5uZXJPYmplY3QgPSBpbm5lckVsZW07XG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnRPYmplY3QgPSB2aWV3cG9ydEVsZW07XG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUub3V0ZXJPYmplY3QgPSBvdXRlckVsZW07XG5cbiAgICAgICAgdGhpcy5zZXR0aW5ncy5wYXJlbnRPYmplY3QuYXBwZW5kKG91dGVyRWxlbSk7XG5cbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydCA9IG5ldyBWaWV3cG9ydCh0aGlzLnZpZXdlclN0YXRlLnZpZXdwb3J0RWxlbWVudCwge1xuICAgICAgICAgICAgaW50ZXJzZWN0aW9uVG9sZXJhbmNlOiB0aGlzLnNldHRpbmdzLnZpZXdwb3J0TWFyZ2luXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYm91bmRTY3JvbGxGdW5jdGlvbiA9IHRoaXMuc2Nyb2xsRnVuY3Rpb24uYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5ib3VuZEVzY2FwZUxpc3RlbmVyID0gdGhpcy5lc2NhcGVMaXN0ZW5lci5iaW5kKHRoaXMpO1xuXG4gICAgICAgIC8vIERvIGFsbCB0aGUgcGx1Z2luIGluaXRpYWxpc2F0aW9uXG4gICAgICAgIHRoaXMuaW5pdFBsdWdpbnMoKTtcbiAgICAgICAgdGhpcy5oYW5kbGVFdmVudHMoKTtcblxuICAgICAgICAvLyBTaG93IHRoZSB0aHJvYmJlciB3aGlsZSB3YWl0aW5nIGZvciB0aGUgbWFuaWZlc3QgdG8gbG9hZFxuICAgICAgICB0aGlzLnNob3dUaHJvYmJlcigpO1xuICAgIH1cblxuICAgIGlzVmFsaWRPcHRpb24gKGtleSwgdmFsdWUpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zVmFsaWRhdG9yLmlzVmFsaWQoa2V5LCB2YWx1ZSwgdGhpcy52aWV3ZXJTdGF0ZS5vcHRpb25zKTtcbiAgICB9XG5cbiAgICBlbGVtQXR0cnMgKGlkZW50LCBiYXNlKVxuICAgIHtcbiAgICAgICAgY29uc3QgYXR0cnMgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5zZXR0aW5ncy5JRCArIGlkZW50LFxuICAgICAgICAgICAgY2xhc3M6ICdkaXZhLScgKyBpZGVudFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChiYXNlKVxuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oYXR0cnMsIGJhc2UpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gYXR0cnM7XG4gICAgfVxuXG4gICAgZ2V0UGFnZURhdGEgKHBhZ2VJbmRleCwgYXR0cmlidXRlKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MubWFuaWZlc3QucGFnZXNbcGFnZUluZGV4XS5kW3RoaXMuc2V0dGluZ3Muem9vbUxldmVsXVthdHRyaWJ1dGVdO1xuICAgIH1cblxuICAgIC8vIFJlc2V0IHNvbWUgc2V0dGluZ3MgYW5kIGVtcHR5IHRoZSB2aWV3cG9ydFxuICAgIGNsZWFyVmlld2VyICgpXG4gICAge1xuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZpZXdwb3J0LnRvcCA9IDA7XG5cbiAgICAgICAgLy8gQ2xlYXIgYWxsIHRoZSB0aW1lb3V0cyB0byBwcmV2ZW50IHVuZGVzaXJlZCBwYWdlcyBmcm9tIGxvYWRpbmdcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudmlld2VyU3RhdGUucmVzaXplVGltZXIpO1xuICAgIH1cblxuICAgIGhhc0NoYW5nZWRPcHRpb24gKG9wdGlvbnMsIGtleSlcbiAgICB7XG4gICAgICAgIHJldHVybiBrZXkgaW4gb3B0aW9ucyAmJiBvcHRpb25zW2tleV0gIT09IHRoaXMuc2V0dGluZ3Nba2V5XTtcbiAgICB9XG5cbiAgICAvL1Nob3J0Y3V0IGZvciBjbG9zaW5nIGZ1bGxzY3JlZW4gd2l0aCB0aGUgZXNjYXBlIGtleVxuICAgIGVzY2FwZUxpc3RlbmVyIChlKVxuICAgIHtcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMjcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucHVibGljSW5zdGFuY2UubGVhdmVGdWxsc2NyZWVuTW9kZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHNldHRpbmdzIHRvIG1hdGNoIHRoZSBzcGVjaWZpZWQgb3B0aW9ucy4gTG9hZCB0aGUgdmlld2VyLFxuICAgICAqIGZpcmUgYXBwcm9wcmlhdGUgZXZlbnRzIGZvciBjaGFuZ2VkIG9wdGlvbnMuXG4gICAgICovXG4gICAgcmVsb2FkVmlld2VyIChuZXdPcHRpb25zKVxuICAgIHtcbiAgICAgICAgY29uc3QgcXVldWVkRXZlbnRzID0gW107XG5cbiAgICAgICAgbmV3T3B0aW9ucyA9IHRoaXMub3B0aW9uc1ZhbGlkYXRvci5nZXRWYWxpZGF0ZWRPcHRpb25zKHRoaXMuc2V0dGluZ3MsIG5ld09wdGlvbnMpO1xuXG4gICAgICAgIC8vIFNldCB0aGUgem9vbSBsZXZlbCBpZiB2YWxpZCBhbmQgZmlyZSBhIFpvb21MZXZlbERpZENoYW5nZSBldmVudFxuICAgICAgICBpZiAodGhpcy5oYXNDaGFuZ2VkT3B0aW9uKG5ld09wdGlvbnMsICd6b29tTGV2ZWwnKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5vbGRab29tTGV2ZWwgPSB0aGlzLnNldHRpbmdzLnpvb21MZXZlbDtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUub3B0aW9ucy56b29tTGV2ZWwgPSBuZXdPcHRpb25zLnpvb21MZXZlbDtcbiAgICAgICAgICAgIHF1ZXVlZEV2ZW50cy5wdXNoKFtcIlpvb21MZXZlbERpZENoYW5nZVwiLCBuZXdPcHRpb25zLnpvb21MZXZlbF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0IHRoZSBwYWdlcyBwZXIgcm93IGlmIHZhbGlkIGFuZCBmaXJlIGFuIGV2ZW50XG4gICAgICAgIGlmICh0aGlzLmhhc0NoYW5nZWRPcHRpb24obmV3T3B0aW9ucywgJ3BhZ2VzUGVyUm93JykpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUub3B0aW9ucy5wYWdlc1BlclJvdyA9IG5ld09wdGlvbnMucGFnZXNQZXJSb3c7XG4gICAgICAgICAgICBxdWV1ZWRFdmVudHMucHVzaChbXCJHcmlkUm93TnVtYmVyRGlkQ2hhbmdlXCIsIG5ld09wdGlvbnMucGFnZXNQZXJSb3ddKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVwZGF0ZSB2ZXJ0aWNhbGx5T3JpZW50ZWQgKG5vIGV2ZW50IGZpcmVkKVxuICAgICAgICBpZiAodGhpcy5oYXNDaGFuZ2VkT3B0aW9uKG5ld09wdGlvbnMsICd2ZXJ0aWNhbGx5T3JpZW50ZWQnKSlcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUub3B0aW9ucy52ZXJ0aWNhbGx5T3JpZW50ZWQgPSBuZXdPcHRpb25zLnZlcnRpY2FsbHlPcmllbnRlZDtcblxuICAgICAgICAvLyBTaG93L0hpZGUgbm9uLXBhZ2VkIHBhZ2VzXG4gICAgICAgIGlmICh0aGlzLmhhc0NoYW5nZWRPcHRpb24obmV3T3B0aW9ucywgJ3Nob3dOb25QYWdlZFBhZ2VzJykpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUub3B0aW9ucy5zaG93Tm9uUGFnZWRQYWdlcyA9IG5ld09wdGlvbnMuc2hvd05vblBhZ2VkUGFnZXM7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBVcGRhdGUgcGFnZSBwb3NpdGlvbiAobm8gZXZlbnQgZmlyZWQgaGVyZSlcbiAgICAgICAgaWYgKCdnb0RpcmVjdGx5VG8nIGluIG5ld09wdGlvbnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUub3B0aW9ucy5nb0RpcmVjdGx5VG8gPSBuZXdPcHRpb25zLmdvRGlyZWN0bHlUbztcblxuICAgICAgICAgICAgaWYgKCd2ZXJ0aWNhbE9mZnNldCcgaW4gbmV3T3B0aW9ucylcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZlcnRpY2FsT2Zmc2V0ID0gbmV3T3B0aW9ucy52ZXJ0aWNhbE9mZnNldDtcblxuICAgICAgICAgICAgaWYgKCdob3Jpem9udGFsT2Zmc2V0JyBpbiBuZXdPcHRpb25zKVxuICAgICAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUuaG9yaXpvbnRhbE9mZnNldCA9IG5ld09wdGlvbnMuaG9yaXpvbnRhbE9mZnNldDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIE90aGVyd2lzZSB0aGUgZGVmYXVsdCBpcyB0byByZW1haW4gb24gdGhlIGN1cnJlbnQgcGFnZVxuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5vcHRpb25zLmdvRGlyZWN0bHlUbyA9IHRoaXMuc2V0dGluZ3MuYWN0aXZlUGFnZUluZGV4O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuaGFzQ2hhbmdlZE9wdGlvbihuZXdPcHRpb25zLCAnaW5HcmlkJykgfHwgdGhpcy5oYXNDaGFuZ2VkT3B0aW9uKG5ld09wdGlvbnMsICdpbkJvb2tMYXlvdXQnKSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCdpbkdyaWQnIGluIG5ld09wdGlvbnMpXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5vcHRpb25zLmluR3JpZCA9IG5ld09wdGlvbnMuaW5HcmlkO1xuXG4gICAgICAgICAgICBpZiAoJ2luQm9va0xheW91dCcgaW4gbmV3T3B0aW9ucylcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLm9wdGlvbnMuaW5Cb29rTGF5b3V0ID0gbmV3T3B0aW9ucy5pbkJvb2tMYXlvdXQ7XG5cbiAgICAgICAgICAgIHF1ZXVlZEV2ZW50cy5wdXNoKFtcIlZpZXdEaWRTd2l0Y2hcIiwgdGhpcy5zZXR0aW5ncy5pbkdyaWRdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE5vdGU6IHByZXBhcmVNb2RlQ2hhbmdlKCkgZGVwZW5kcyBvbiBpbkdyaWQgYW5kIHRoZSB2ZXJ0aWNhbC9ob3Jpem9udGFsT2Zmc2V0IChmb3Igbm93KVxuICAgICAgICBpZiAodGhpcy5oYXNDaGFuZ2VkT3B0aW9uKG5ld09wdGlvbnMsICdpbkZ1bGxzY3JlZW4nKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5vcHRpb25zLmluRnVsbHNjcmVlbiA9IG5ld09wdGlvbnMuaW5GdWxsc2NyZWVuO1xuICAgICAgICAgICAgdGhpcy5wcmVwYXJlTW9kZUNoYW5nZShuZXdPcHRpb25zKTtcbiAgICAgICAgICAgIHF1ZXVlZEV2ZW50cy5wdXNoKFtcIk1vZGVEaWRTd2l0Y2hcIiwgdGhpcy5zZXR0aW5ncy5pbkZ1bGxzY3JlZW5dKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2xlYXJWaWV3ZXIoKTtcbiAgICAgICAgdGhpcy51cGRhdGVWaWV3SGFuZGxlckFuZFJlbmRlcmluZygpO1xuXG4gICAgICAgIGlmICh0aGlzLnZpZXdlclN0YXRlLnJlbmRlcmVyKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBUT0RPOiBUaGUgdXNhZ2Ugb2YgcGFkZGluZyB2YXJpYWJsZXMgaXMgc3RpbGwgcmVhbGx5XG4gICAgICAgICAgICAvLyBtZXNzeSBhbmQgaW5jb25zaXN0ZW50XG4gICAgICAgICAgICBjb25zdCByZW5kZXJlckNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICBwYWdlTGF5b3V0czogZ2V0UGFnZUxheW91dHModGhpcy5zZXR0aW5ncyksXG4gICAgICAgICAgICAgICAgcGFkZGluZzogdGhpcy5nZXRQYWRkaW5nKCksXG4gICAgICAgICAgICAgICAgbWF4Wm9vbUxldmVsOiB0aGlzLnNldHRpbmdzLmluR3JpZCA/IG51bGwgOiB0aGlzLnZpZXdlclN0YXRlLm1hbmlmZXN0Lm1heFpvb20sXG4gICAgICAgICAgICAgICAgdmVydGljYWxseU9yaWVudGVkOiB0aGlzLnNldHRpbmdzLnZlcnRpY2FsbHlPcmllbnRlZCB8fCB0aGlzLnNldHRpbmdzLmluR3JpZCxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IHZpZXdwb3J0UG9zaXRpb24gPSB7XG4gICAgICAgICAgICAgICAgem9vbUxldmVsOiB0aGlzLnNldHRpbmdzLmluR3JpZCA/IG51bGwgOiB0aGlzLnNldHRpbmdzLnpvb21MZXZlbCxcbiAgICAgICAgICAgICAgICBhbmNob3JQYWdlOiB0aGlzLnNldHRpbmdzLmdvRGlyZWN0bHlUbyxcbiAgICAgICAgICAgICAgICB2ZXJ0aWNhbE9mZnNldDogdGhpcy52aWV3ZXJTdGF0ZS52ZXJ0aWNhbE9mZnNldCxcbiAgICAgICAgICAgICAgICBob3Jpem9udGFsT2Zmc2V0OiB0aGlzLnZpZXdlclN0YXRlLmhvcml6b250YWxPZmZzZXRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZVByb3ZpZGVyID0gdGhpcy5nZXRDdXJyZW50U291cmNlUHJvdmlkZXIoKTtcblxuICAgICAgICAgICAgaWYgKGRlYnVnLmVuYWJsZWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VyaWFsaXplZCA9IE9iamVjdC5rZXlzKHJlbmRlcmVyQ29uZmlnKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChrZXkpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRvbyBsb25nXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2V5ICE9PSAncGFnZUxheW91dHMnICYmIGtleSAhPT0gJ3BhZGRpbmcnO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChrZXkpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gcmVuZGVyZXJDb25maWdba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXkgKyAnOiAnICsgSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuam9pbignLCAnKTtcblxuICAgICAgICAgICAgICAgIGRlYnVnKCdyZWxvYWQgd2l0aCAlcycsIHNlcmlhbGl6ZWQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnJlbmRlcmVyLmxvYWQocmVuZGVyZXJDb25maWcsIHZpZXdwb3J0UG9zaXRpb24sIHNvdXJjZVByb3ZpZGVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHF1ZXVlZEV2ZW50cy5mb3JFYWNoKCAocGFyYW1zKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnB1Ymxpc2guYXBwbHkodGhpcywgcGFyYW1zKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlcyBzd2l0Y2hpbmcgaW4gYW5kIG91dCBvZiBmdWxsc2NyZWVuIG1vZGVcbiAgICBwcmVwYXJlTW9kZUNoYW5nZSAob3B0aW9ucylcbiAgICB7XG4gICAgICAgIC8vIFRvZ2dsZSB0aGUgY2xhc3Nlc1xuICAgICAgICBjb25zdCBjaGFuZ2VDbGFzcyA9IG9wdGlvbnMuaW5GdWxsc2NyZWVuID8gJ2FkZCcgOiAncmVtb3ZlJztcbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5vdXRlck9iamVjdC5jbGFzc0xpc3RbY2hhbmdlQ2xhc3NdKCdkaXZhLWZ1bGxzY3JlZW4nKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3RbY2hhbmdlQ2xhc3NdKCdkaXZhLWhpZGUtc2Nyb2xsYmFyJyk7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MucGFyZW50T2JqZWN0LmNsYXNzTGlzdFtjaGFuZ2VDbGFzc10oJ2RpdmEtZnVsbC13aWR0aCcpO1xuXG4gICAgICAgIC8vIEFkanVzdCBEaXZhJ3MgaW50ZXJuYWwgcGFuZWwgc2l6ZSwga2VlcGluZyB0aGUgb2xkIHZhbHVlc1xuICAgICAgICBjb25zdCBzdG9yZWRIZWlnaHQgPSB0aGlzLnNldHRpbmdzLnBhbmVsSGVpZ2h0O1xuICAgICAgICBjb25zdCBzdG9yZWRXaWR0aCA9IHRoaXMuc2V0dGluZ3MucGFuZWxXaWR0aDtcbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydC5pbnZhbGlkYXRlKCk7XG5cbiAgICAgICAgLy8gSWYgdGhpcyBpc24ndCB0aGUgb3JpZ2luYWwgbG9hZCwgdGhlIG9mZnNldHMgbWF0dGVyLCBhbmQgdGhlIHBvc2l0aW9uIGlzbid0IGJlaW5nIGNoYW5nZWQuLi5cbiAgICAgICAgaWYgKCF0aGlzLnZpZXdlclN0YXRlLmxvYWRlZCAmJiAhdGhpcy5zZXR0aW5ncy5pbkdyaWQgJiYgISgndmVydGljYWxPZmZzZXQnIGluIG9wdGlvbnMpKVxuICAgICAgICB7XG4gICAgICAgICAgICAvL2dldCB0aGUgdXBkYXRlZCBwYW5lbCBzaXplXG4gICAgICAgICAgICBjb25zdCBuZXdIZWlnaHQgPSB0aGlzLnNldHRpbmdzLnBhbmVsSGVpZ2h0O1xuICAgICAgICAgICAgY29uc3QgbmV3V2lkdGggPSB0aGlzLnNldHRpbmdzLnBhbmVsV2lkdGg7XG5cbiAgICAgICAgICAgIC8vYW5kIHJlLWNlbnRlciB0aGUgbmV3IHBhbmVsIG9uIHRoZSBzYW1lIHBvaW50XG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZlcnRpY2FsT2Zmc2V0ICs9ICgoc3RvcmVkSGVpZ2h0IC0gbmV3SGVpZ2h0KSAvIDIpO1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5ob3Jpem9udGFsT2Zmc2V0ICs9ICgoc3RvcmVkV2lkdGggLSBuZXdXaWR0aCkgLyAyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vdHVybiBvbi9vZmYgZXNjYXBlIGtleSBsaXN0ZW5lclxuICAgICAgICBpZiAob3B0aW9ucy5pbkZ1bGxzY3JlZW4pXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuYm91bmRFc2NhcGVMaXN0ZW5lcik7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5ib3VuZEVzY2FwZUxpc3RlbmVyKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgdGhlIHZpZXcgaGFuZGxlciBhbmQgdGhlIHZpZXcgcmVuZGVyaW5nIGZvciB0aGUgY3VycmVudCB2aWV3XG4gICAgdXBkYXRlVmlld0hhbmRsZXJBbmRSZW5kZXJpbmcgKClcbiAgICB7XG4gICAgICAgIGNvbnN0IEhhbmRsZXIgPSB0aGlzLnNldHRpbmdzLmluR3JpZCA/IEdyaWRIYW5kbGVyIDogRG9jdW1lbnRIYW5kbGVyO1xuXG4gICAgICAgIGlmICh0aGlzLnZpZXdlclN0YXRlLnZpZXdIYW5kbGVyICYmICEodGhpcy52aWV3ZXJTdGF0ZS52aWV3SGFuZGxlciBpbnN0YW5jZW9mIEhhbmRsZXIpKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZpZXdIYW5kbGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld0hhbmRsZXIgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLnZpZXdlclN0YXRlLnZpZXdIYW5kbGVyKVxuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52aWV3SGFuZGxlciA9IG5ldyBIYW5kbGVyKHRoaXMpO1xuXG4gICAgICAgIGlmICghdGhpcy52aWV3ZXJTdGF0ZS5yZW5kZXJlcilcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZVJlbmRlcmVyKCk7XG4gICAgfVxuXG4gICAgLy8gVE9ETzogVGhpcyBjb3VsZCBwcm9iYWJseSBiZSBkb25lIHVwb24gVmlld2VyQ29yZSBpbml0aWFsaXphdGlvblxuICAgIGluaXRpYWxpemVSZW5kZXJlciAoKVxuICAgIHtcbiAgICAgICAgY29uc3QgY29tcGF0RXJyb3JzID0gUmVuZGVyZXIuZ2V0Q29tcGF0aWJpbGl0eUVycm9ycygpO1xuXG4gICAgICAgIGlmIChjb21wYXRFcnJvcnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yKGNvbXBhdEVycm9ycyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHZpZXdwb3J0OiB0aGlzLnZpZXdlclN0YXRlLnZpZXdwb3J0LFxuICAgICAgICAgICAgICAgIG91dGVyRWxlbWVudDogdGhpcy52aWV3ZXJTdGF0ZS5vdXRlckVsZW1lbnQsXG4gICAgICAgICAgICAgICAgaW5uZXJFbGVtZW50OiB0aGlzLnZpZXdlclN0YXRlLmlubmVyRWxlbWVudFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgaG9va3MgPSB7XG4gICAgICAgICAgICAgICAgb25WaWV3V2lsbExvYWQ6ICgpID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZpZXdIYW5kbGVyLm9uVmlld1dpbGxMb2FkKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvblZpZXdEaWRMb2FkOiAoKSA9PlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVQYWdlT3ZlcmxheXMoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52aWV3SGFuZGxlci5vblZpZXdEaWRMb2FkKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvblZpZXdEaWRVcGRhdGU6IChwYWdlcywgdGFyZ2V0UGFnZSkgPT5cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUGFnZU92ZXJsYXlzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld0hhbmRsZXIub25WaWV3RGlkVXBkYXRlKHBhZ2VzLCB0YXJnZXRQYWdlKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uVmlld0RpZFRyYW5zaXRpb246ICgpID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVBhZ2VPdmVybGF5cygpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25QYWdlV2lsbExvYWQ6IChwYWdlSW5kZXgpID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnB1Ymxpc2goJ1BhZ2VXaWxsTG9hZCcsIHBhZ2VJbmRleCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvblpvb21MZXZlbFdpbGxDaGFuZ2U6ICh6b29tTGV2ZWwpID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnB1Ymxpc2goJ1pvb21MZXZlbFdpbGxDaGFuZ2UnLCB6b29tTGV2ZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUucmVuZGVyZXIgPSBuZXcgUmVuZGVyZXIob3B0aW9ucywgaG9va3MpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0Q3VycmVudFNvdXJjZVByb3ZpZGVyICgpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5pbkdyaWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGdyaWRTb3VyY2VQcm92aWRlciA9IHtcbiAgICAgICAgICAgICAgICBnZXRBbGxab29tTGV2ZWxzRm9yUGFnZTogKHBhZ2UpID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2dyaWRTb3VyY2VQcm92aWRlci5nZXRCZXN0Wm9vbUxldmVsRm9yUGFnZShwYWdlKV07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBnZXRCZXN0Wm9vbUxldmVsRm9yUGFnZTogKHBhZ2UpID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSB0aGlzLnNldHRpbmdzLm1hbmlmZXN0LmdldFBhZ2VJbWFnZVVSTChwYWdlLmluZGV4LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogcGFnZS5kaW1lbnNpb25zLndpZHRoXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tTGV2ZWw6IDEsIC8vIEZJWE1FXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dzOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sczogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbGVzOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvb21MZXZlbDogMSwgLy8gRklYTUVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3c6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpbWVuc2lvbnM6IHBhZ2UuZGltZW5zaW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gZ3JpZFNvdXJjZVByb3ZpZGVyO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdGlsZURpbWVuc2lvbnMgPSB7XG4gICAgICAgICAgICB3aWR0aDogdGhpcy5zZXR0aW5ncy50aWxlV2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IHRoaXMuc2V0dGluZ3MudGlsZUhlaWdodFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRCZXN0Wm9vbUxldmVsRm9yUGFnZTogKHBhZ2UpID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MubWFuaWZlc3QuZ2V0UGFnZUltYWdlVGlsZXMocGFnZS5pbmRleCwgTWF0aC5jZWlsKHRoaXMuc2V0dGluZ3Muem9vbUxldmVsKSwgdGlsZURpbWVuc2lvbnMpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldEFsbFpvb21MZXZlbHNGb3JQYWdlOiAocGFnZSkgPT5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZXZlbHMgPSBbXTtcbiAgICAgICAgICAgICAgICBjb25zdCBsZXZlbENvdW50ID0gdGhpcy52aWV3ZXJTdGF0ZS5tYW5pZmVzdC5tYXhab29tO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgbGV2ZWw9MDsgbGV2ZWwgPD0gbGV2ZWxDb3VudDsgbGV2ZWwrKylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGxldmVscy5wdXNoKHRoaXMuc2V0dGluZ3MubWFuaWZlc3QuZ2V0UGFnZUltYWdlVGlsZXMocGFnZS5pbmRleCwgbGV2ZWwsIHRpbGVEaW1lbnNpb25zKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbGV2ZWxzLnJldmVyc2UoKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBsZXZlbHM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZ2V0UGFkZGluZyAoKVxuICAgIHtcbiAgICAgICAgbGV0IHRvcFBhZGRpbmcsIGxlZnRQYWRkaW5nO1xuICAgICAgICBsZXQgZG9jVlBhZGRpbmcsIGRvY0hQYWRkaW5nO1xuXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmluR3JpZClcbiAgICAgICAge1xuICAgICAgICAgICAgZG9jVlBhZGRpbmcgPSB0aGlzLnNldHRpbmdzLmZpeGVkUGFkZGluZztcbiAgICAgICAgICAgIHRvcFBhZGRpbmcgPSBsZWZ0UGFkZGluZyA9IGRvY0hQYWRkaW5nID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRvcFBhZGRpbmcgPSB0aGlzLnNldHRpbmdzLnZlcnRpY2FsbHlPcmllbnRlZCA/IHRoaXMudmlld2VyU3RhdGUudmVydGljYWxQYWRkaW5nIDogMDtcbiAgICAgICAgICAgIGxlZnRQYWRkaW5nID0gdGhpcy5zZXR0aW5ncy52ZXJ0aWNhbGx5T3JpZW50ZWQgPyAwIDogdGhpcy52aWV3ZXJTdGF0ZS5ob3Jpem9udGFsUGFkZGluZztcblxuICAgICAgICAgICAgZG9jVlBhZGRpbmcgPSB0aGlzLnNldHRpbmdzLnZlcnRpY2FsbHlPcmllbnRlZCA/IDAgOiB0aGlzLnZpZXdlclN0YXRlLnZlcnRpY2FsUGFkZGluZztcbiAgICAgICAgICAgIGRvY0hQYWRkaW5nID0gdGhpcy5zZXR0aW5ncy52ZXJ0aWNhbGx5T3JpZW50ZWQgPyB0aGlzLnZpZXdlclN0YXRlLmhvcml6b250YWxQYWRkaW5nIDogMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkb2N1bWVudDoge1xuICAgICAgICAgICAgICAgIHRvcDogZG9jVlBhZGRpbmcsXG4gICAgICAgICAgICAgICAgYm90dG9tOiBkb2NWUGFkZGluZyxcbiAgICAgICAgICAgICAgICBsZWZ0OiBkb2NIUGFkZGluZyxcbiAgICAgICAgICAgICAgICByaWdodDogZG9jSFBhZGRpbmdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwYWdlOiB7XG4gICAgICAgICAgICAgICAgdG9wOiB0b3BQYWRkaW5nLFxuICAgICAgICAgICAgICAgIGJvdHRvbTogMCxcbiAgICAgICAgICAgICAgICBsZWZ0OiBsZWZ0UGFkZGluZyxcbiAgICAgICAgICAgICAgICByaWdodDogMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHVwZGF0ZVBhZ2VPdmVybGF5cyAoKVxuICAgIHtcbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5wYWdlT3ZlcmxheXMudXBkYXRlT3ZlcmxheXMoXG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnJlbmRlcmVyLmdldFJlbmRlcmVkUGFnZXMoKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8vIENhbGxlZCB0byBoYW5kbGUgYW55IHpvb20gbGV2ZWxcbiAgICBoYW5kbGVab29tIChuZXdab29tTGV2ZWwsIGZvY2FsUG9pbnQpXG4gICAge1xuICAgICAgICAvLyBJZiB0aGUgem9vbSBsZXZlbCBwcm92aWRlZCBpcyBpbnZhbGlkLCByZXR1cm4gZmFsc2VcbiAgICAgICAgaWYgKCF0aGlzLmlzVmFsaWRPcHRpb24oJ3pvb21MZXZlbCcsIG5ld1pvb21MZXZlbCkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgLy8gV2hpbGUgem9vbWluZywgZG9uJ3QgdXBkYXRlIHNjcm9sbCBvZmZzZXRzIGJhc2VkIG9uIHRoZSBzY2FsZWQgdmVyc2lvbiBvZiBkaXZhLWlubmVyXG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnRPYmplY3QucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5ib3VuZFNjcm9sbEZ1bmN0aW9uKTtcblxuICAgICAgICAvLyBJZiBubyBmb2NhbCBwb2ludCB3YXMgZ2l2ZW4sIHpvb20gb24gdGhlIGNlbnRlciBvZiB0aGUgdmlld3BvcnRcbiAgICAgICAgaWYgKCFmb2NhbFBvaW50KVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB2aWV3cG9ydCA9IHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQ7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50UmVnaW9uID0gdGhpcy52aWV3ZXJTdGF0ZS5yZW5kZXJlci5sYXlvdXQuZ2V0UGFnZVJlZ2lvbih0aGlzLnNldHRpbmdzLmFjdGl2ZVBhZ2VJbmRleCk7XG5cbiAgICAgICAgICAgIGZvY2FsUG9pbnQgPSB7XG4gICAgICAgICAgICAgICAgYW5jaG9yUGFnZTogdGhpcy5zZXR0aW5ncy5hY3RpdmVQYWdlSW5kZXgsXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiB7XG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6ICh2aWV3cG9ydC53aWR0aCAvIDIpIC0gKGN1cnJlbnRSZWdpb24ubGVmdCAtIHZpZXdwb3J0LmxlZnQpLFxuICAgICAgICAgICAgICAgICAgICB0b3A6ICh2aWV3cG9ydC5oZWlnaHQgLyAyKSAtIChjdXJyZW50UmVnaW9uLnRvcCAtIHZpZXdwb3J0LnRvcClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGFnZVJlZ2lvbiA9IHRoaXMudmlld2VyU3RhdGUucmVuZGVyZXIubGF5b3V0LmdldFBhZ2VSZWdpb24oZm9jYWxQb2ludC5hbmNob3JQYWdlKTtcblxuICAgICAgICAvLyBjYWxjdWxhdGUgZGlzdGFuY2UgZnJvbSBjdXJzb3IgY29vcmRpbmF0ZXMgdG8gY2VudGVyIG9mIHZpZXdwb3J0XG4gICAgICAgIGNvbnN0IGZvY2FsWFRvQ2VudGVyID0gKHBhZ2VSZWdpb24ubGVmdCArIGZvY2FsUG9pbnQub2Zmc2V0LmxlZnQpIC1cbiAgICAgICAgICAgICh0aGlzLnNldHRpbmdzLnZpZXdwb3J0LmxlZnQgKyAodGhpcy5zZXR0aW5ncy52aWV3cG9ydC53aWR0aCAvIDIpKTtcbiAgICAgICAgY29uc3QgZm9jYWxZVG9DZW50ZXIgPSAocGFnZVJlZ2lvbi50b3AgKyBmb2NhbFBvaW50Lm9mZnNldC50b3ApIC1cbiAgICAgICAgICAgICh0aGlzLnNldHRpbmdzLnZpZXdwb3J0LnRvcCArICh0aGlzLnNldHRpbmdzLnZpZXdwb3J0LmhlaWdodCAvIDIpKTtcblxuICAgICAgICBjb25zdCBnZXRQb3NpdGlvbkZvclpvb21MZXZlbCA9IGZ1bmN0aW9uICh6b29tTGV2ZWwsIGluaXRab29tKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB6b29tUmF0aW8gPSBNYXRoLnBvdygyLCB6b29tTGV2ZWwgLSBpbml0Wm9vbSk7XG5cbiAgICAgICAgICAgIC8vVE9ETyhqZXJvbWVwbCk6IENhbGN1bGF0ZSBwb3NpdGlvbiBmcm9tIHBhZ2UgdG9wIGxlZnQgdG8gdmlld3BvcnQgdG9wIGxlZnRcbiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBob3Jpem9udGFsL3ZlcnRpY2FsT2Zmc2V0OiBkaXN0YW5jZSBmcm9tIHZpZXdwb3J0IGNlbnRlciB0byBwYWdlIHVwcGVyIGxlZnQgY29ybmVyXG4gICAgICAgICAgICBjb25zdCBob3Jpem9udGFsT2Zmc2V0ID0gKGZvY2FsUG9pbnQub2Zmc2V0LmxlZnQgKiB6b29tUmF0aW8pIC0gZm9jYWxYVG9DZW50ZXI7XG4gICAgICAgICAgICBjb25zdCB2ZXJ0aWNhbE9mZnNldCA9IChmb2NhbFBvaW50Lm9mZnNldC50b3AgKiB6b29tUmF0aW8pIC0gZm9jYWxZVG9DZW50ZXI7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgem9vbUxldmVsOiB6b29tTGV2ZWwsXG4gICAgICAgICAgICAgICAgYW5jaG9yUGFnZTogZm9jYWxQb2ludC5hbmNob3JQYWdlLFxuICAgICAgICAgICAgICAgIHZlcnRpY2FsT2Zmc2V0OiB2ZXJ0aWNhbE9mZnNldCxcbiAgICAgICAgICAgICAgICBob3Jpem9udGFsT2Zmc2V0OiBob3Jpem9udGFsT2Zmc2V0XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUub3B0aW9ucy56b29tTGV2ZWwgPSBuZXdab29tTGV2ZWw7XG4gICAgICAgIGxldCBpbml0aWFsWm9vbUxldmVsID0gdGhpcy52aWV3ZXJTdGF0ZS5vbGRab29tTGV2ZWw7XG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUub2xkWm9vbUxldmVsID0gdGhpcy5zZXR0aW5ncy56b29tTGV2ZWw7XG4gICAgICAgIGNvbnN0IGVuZFBvc2l0aW9uID0gZ2V0UG9zaXRpb25Gb3Jab29tTGV2ZWwobmV3Wm9vbUxldmVsLCBpbml0aWFsWm9vbUxldmVsKTtcbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5vcHRpb25zLmdvRGlyZWN0bHlUbyA9IGVuZFBvc2l0aW9uLmFuY2hvclBhZ2U7XG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUudmVydGljYWxPZmZzZXQgPSBlbmRQb3NpdGlvbi52ZXJ0aWNhbE9mZnNldDtcbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5ob3Jpem9udGFsT2Zmc2V0ID0gZW5kUG9zaXRpb24uaG9yaXpvbnRhbE9mZnNldDtcblxuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnJlbmRlcmVyLnRyYW5zaXRpb25WaWV3cG9ydFBvc2l0aW9uKHtcbiAgICAgICAgICAgIGR1cmF0aW9uOiB0aGlzLnNldHRpbmdzLnpvb21EdXJhdGlvbixcbiAgICAgICAgICAgIHBhcmFtZXRlcnM6IHtcbiAgICAgICAgICAgICAgICB6b29tTGV2ZWw6IHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbTogaW5pdGlhbFpvb21MZXZlbCxcbiAgICAgICAgICAgICAgICAgICAgdG86IG5ld1pvb21MZXZlbFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRQb3NpdGlvbjogKHBhcmFtZXRlcnMpID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFBvc2l0aW9uRm9yWm9vbUxldmVsKHBhcmFtZXRlcnMuem9vbUxldmVsLCBpbml0aWFsWm9vbUxldmVsKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkVuZDogKGluZm8pID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydE9iamVjdC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLmJvdW5kU2Nyb2xsRnVuY3Rpb24pO1xuXG4gICAgICAgICAgICAgICAgaWYgKGluZm8uaW50ZXJydXB0ZWQpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUub2xkWm9vbUxldmVsID0gbmV3Wm9vbUxldmVsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBEZWFjdGl2YXRlIHpvb20gYnV0dG9ucyB3aGlsZSB6b29taW5nXG4gICAgICAgIGxldCB6b29tSW5CdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnNldHRpbmdzLnNlbGVjdG9yICsgJ3pvb20taW4tYnV0dG9uJyk7XG4gICAgICAgIGxldCB6b29tT3V0QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5zZXR0aW5ncy5zZWxlY3RvciArICd6b29tLW91dC1idXR0b24nKTtcbiAgICAgICAgem9vbUluQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgem9vbU91dEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgem9vbUluQnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB6b29tT3V0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIH0sIHRoaXMuc2V0dGluZ3Muem9vbUR1cmF0aW9uKTtcblxuICAgICAgICAvLyBTZW5kIG9mZiB0aGUgem9vbSBsZXZlbCBkaWQgY2hhbmdlIGV2ZW50LlxuICAgICAgICB0aGlzLnB1Ymxpc2goXCJab29tTGV2ZWxEaWRDaGFuZ2VcIiwgbmV3Wm9vbUxldmVsKTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICBHZXRzIHRoZSBZLW9mZnNldCBmb3IgYSBzcGVjaWZpYyBwb2ludCBvbiBhIHNwZWNpZmljIHBhZ2VcbiAgICAgQWNjZXB0YWJsZSB2YWx1ZXMgZm9yIFwiYW5jaG9yXCI6XG4gICAgIFwidG9wXCIgKGRlZmF1bHQpIC0gd2lsbCBhbmNob3IgdG9wIG9mIHRoZSBwYWdlIHRvIHRoZSB0b3Agb2YgdGhlIGRpdmEtb3V0ZXIgZWxlbWVudFxuICAgICBcImJvdHRvbVwiIC0gdG9wLCBzL3RvcC9ib3R0b21cbiAgICAgXCJjZW50ZXJcIiAtIHdpbGwgY2VudGVyIHRoZSBwYWdlIG9uIHRoZSBkaXZhIGVsZW1lbnRcbiAgICAgUmV0dXJuZWQgdmFsdWUgd2lsbCBiZSB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgY2VudGVyIG9mIHRoZSBkaXZhLW91dGVyIGVsZW1lbnQgdG8gdGhlIHRvcCBvZiB0aGUgY3VycmVudCBwYWdlIGZvciB0aGUgc3BlY2lmaWVkIGFuY2hvclxuICAgICAqL1xuICAgIGdldFlPZmZzZXQgKHBhZ2VJbmRleCwgYW5jaG9yKVxuICAgIHtcbiAgICAgICAgbGV0IHBpZHggPSAodHlwZW9mKHBhZ2VJbmRleCkgPT09IFwidW5kZWZpbmVkXCIgPyB0aGlzLnNldHRpbmdzLmFjdGl2ZVBhZ2VJbmRleCA6IHBhZ2VJbmRleCk7XG5cbiAgICAgICAgaWYgKGFuY2hvciA9PT0gXCJjZW50ZXJcIiB8fCBhbmNob3IgPT09IFwiY2VudHJlXCIpIC8vaG93IHlvdSBjYW4gdGVsbCBhbiBBbWVyaWNhbiBjb2RlZCB0aGlzXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh0aGlzLmdldFBhZ2VEYXRhKHBpZHgsIFwiaFwiKSAvIDIsIDEwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhbmNob3IgPT09IFwiYm90dG9tXCIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh0aGlzLmdldFBhZ2VEYXRhKHBpZHgsIFwiaFwiKSAtIHRoaXMuc2V0dGluZ3MucGFuZWxIZWlnaHQgLyAyLCAxMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQodGhpcy5zZXR0aW5ncy5wYW5lbEhlaWdodCAvIDIsIDEwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vU2FtZSBhcyBnZXRZT2Zmc2V0IHdpdGggXCJsZWZ0XCIgYW5kIFwicmlnaHRcIiBhcyBhY2NlcHRhYmxlIHZhbHVlcyBpbnN0ZWFkIG9mIFwidG9wXCIgYW5kIFwiYm90dG9tXCJcbiAgICBnZXRYT2Zmc2V0IChwYWdlSW5kZXgsIGFuY2hvcilcbiAgICB7XG4gICAgICAgIGxldCBwaWR4ID0gKHR5cGVvZihwYWdlSW5kZXgpID09PSBcInVuZGVmaW5lZFwiID8gdGhpcy5zZXR0aW5ncy5hY3RpdmVQYWdlSW5kZXggOiBwYWdlSW5kZXgpO1xuXG4gICAgICAgIGlmIChhbmNob3IgPT09IFwibGVmdFwiKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQodGhpcy5zZXR0aW5ncy5wYW5lbFdpZHRoIC8gMiwgMTApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFuY2hvciA9PT0gXCJyaWdodFwiKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQodGhpcy5nZXRQYWdlRGF0YShwaWR4LCBcIndcIikgLSB0aGlzLnNldHRpbmdzLnBhbmVsV2lkdGggLyAyLCAxMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQodGhpcy5nZXRQYWdlRGF0YShwaWR4LCBcIndcIikgLyAyLCAxMCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyB1cGRhdGVzIHBhbmVsSGVpZ2h0L3BhbmVsV2lkdGggb24gcmVzaXplXG4gICAgdXBkYXRlUGFuZWxTaXplICgpXG4gICAge1xuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZpZXdwb3J0LmludmFsaWRhdGUoKTtcblxuICAgICAgICAvLyBGSVhNRSh3YWJhaW4pOiBUaGlzIHNob3VsZCByZWFsbHkgb25seSBiZSBjYWxsZWQgYWZ0ZXIgaW5pdGlhbCBsb2FkXG4gICAgICAgIGlmICh0aGlzLnZpZXdlclN0YXRlLnJlbmRlcmVyKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU9mZnNldHMoKTtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUucmVuZGVyZXIuZ290byh0aGlzLnNldHRpbmdzLmFjdGl2ZVBhZ2VJbmRleCwgdGhpcy52aWV3ZXJTdGF0ZS52ZXJ0aWNhbE9mZnNldCwgdGhpcy52aWV3ZXJTdGF0ZS5ob3Jpem9udGFsT2Zmc2V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHVwZGF0ZU9mZnNldHMgKClcbiAgICB7XG4gICAgICAgIGNvbnN0IHBhZ2VPZmZzZXQgPSB0aGlzLnZpZXdlclN0YXRlLnJlbmRlcmVyLmxheW91dC5nZXRQYWdlVG9WaWV3cG9ydENlbnRlck9mZnNldCh0aGlzLnNldHRpbmdzLmFjdGl2ZVBhZ2VJbmRleCwgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydCk7XG5cbiAgICAgICAgaWYgKHBhZ2VPZmZzZXQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUuaG9yaXpvbnRhbE9mZnNldCA9IHBhZ2VPZmZzZXQueDtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmVydGljYWxPZmZzZXQgPSBwYWdlT2Zmc2V0Lnk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBCaW5kIG1vdXNlIGV2ZW50cyAoZHJhZyB0byBzY3JvbGwsIGRvdWJsZS1jbGljaylcbiAgICBiaW5kTW91c2VFdmVudHMgKClcbiAgICB7XG4gICAgICAgIC8vIFNldCBkcmFnIHNjcm9sbCBvbiB0aGUgdmlld3BvcnQgb2JqZWN0XG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnRPYmplY3QuY2xhc3NMaXN0LmFkZCgnZHJhZ3Njcm9sbCcpO1xuXG4gICAgICAgIGdlc3R1cmVFdmVudHMub25Eb3VibGVDbGljayh0aGlzLnZpZXdlclN0YXRlLnZpZXdwb3J0T2JqZWN0LCAoZXZlbnQsIGNvb3JkcykgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgZGVidWcoJ0RvdWJsZSBjbGljayBhdCAlcywgJXMnLCBjb29yZHMubGVmdCwgY29vcmRzLnRvcCk7XG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZpZXdIYW5kbGVyLm9uRG91YmxlQ2xpY2soZXZlbnQsIGNvb3Jkcyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uUmVzaXplICgpXG4gICAge1xuICAgICAgICB0aGlzLnVwZGF0ZVBhbmVsU2l6ZSgpO1xuICAgICAgICAvLyBDYW5jZWwgYW55IHByZXZpb3VzbHktc2V0IHJlc2l6ZSB0aW1lb3V0c1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy52aWV3ZXJTdGF0ZS5yZXNpemVUaW1lcik7XG5cbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5yZXNpemVUaW1lciA9IHNldFRpbWVvdXQoICgpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHBhZ2VPZmZzZXQgPSB0aGlzLnZpZXdlclN0YXRlLnJlbmRlcmVyLmxheW91dC5nZXRQYWdlVG9WaWV3cG9ydENlbnRlck9mZnNldCh0aGlzLnNldHRpbmdzLmFjdGl2ZVBhZ2VJbmRleCwgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydCk7XG5cbiAgICAgICAgICAgIGlmIChwYWdlT2Zmc2V0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMucmVsb2FkVmlld2VyKHtcbiAgICAgICAgICAgICAgICAgICAgZ29EaXJlY3RseVRvOiB0aGlzLnNldHRpbmdzLmFjdGl2ZVBhZ2VJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgdmVydGljYWxPZmZzZXQ6IHBhZ2VPZmZzZXQueSxcbiAgICAgICAgICAgICAgICAgICAgaG9yaXpvbnRhbE9mZnNldDogcGFnZU9mZnNldC54XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWxvYWRWaWV3ZXIoe1xuICAgICAgICAgICAgICAgICAgICBnb0RpcmVjdGx5VG86IHRoaXMuc2V0dGluZ3MuYWN0aXZlUGFnZUluZGV4XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDIwMCk7XG4gICAgfVxuXG4gICAgLy8gQmluZCB0b3VjaCBhbmQgb3JpZW50YXRpb24gY2hhbmdlIGV2ZW50c1xuICAgIGJpbmRUb3VjaEV2ZW50cyAoKVxuICAgIHtcbiAgICAgICAgLy8gQmxvY2sgdGhlIHVzZXIgZnJvbSBtb3ZpbmcgdGhlIHdpbmRvdyBvbmx5IGlmIGl0J3Mgbm90IGludGVncmF0ZWRcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuYmxvY2tNb2JpbGVNb3ZlKVxuICAgICAgICB7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIChldmVudCkgPT5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gZXZlbnQub3JpZ2luYWxFdmVudDtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRvdWNoIGV2ZW50cyBmb3Igc3dpcGluZyBpbiB0aGUgdmlld3BvcnQgdG8gc2Nyb2xsIHBhZ2VzXG4gICAgICAgIC8vIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnRPYmplY3QuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5zY3JvbGxGdW5jdGlvbi5iaW5kKHRoaXMpKTtcblxuICAgICAgICBnZXN0dXJlRXZlbnRzLm9uUGluY2godGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydE9iamVjdCwgZnVuY3Rpb24gKGV2ZW50LCBjb29yZHMsIHN0YXJ0LCBlbmQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlYnVnKCdQaW5jaCAlcyBhdCAlcywgJXMnLCBlbmQgLSBzdGFydCwgY29vcmRzLmxlZnQsIGNvb3Jkcy50b3ApO1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52aWV3SGFuZGxlci5vblBpbmNoKGV2ZW50LCBjb29yZHMsIHN0YXJ0LCBlbmQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBnZXN0dXJlRXZlbnRzLm9uRG91YmxlVGFwKHRoaXMudmlld2VyU3RhdGUudmlld3BvcnRPYmplY3QsIGZ1bmN0aW9uIChldmVudCwgY29vcmRzKVxuICAgICAgICB7XG4gICAgICAgICAgICBkZWJ1ZygnRG91YmxlIHRhcCBhdCAlcywgJXMnLCBjb29yZHMubGVmdCwgY29vcmRzLnRvcCk7XG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZpZXdIYW5kbGVyLm9uRG91YmxlQ2xpY2soZXZlbnQsIGNvb3Jkcyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEhhbmRsZSB0aGUgc2Nyb2xsXG4gICAgc2Nyb2xsRnVuY3Rpb24gKClcbiAgICB7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzVG9wU2Nyb2xsID0gdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydC50b3A7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzTGVmdFNjcm9sbCA9IHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQubGVmdDtcblxuICAgICAgICBsZXQgZGlyZWN0aW9uO1xuXG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQuaW52YWxpZGF0ZSgpO1xuXG4gICAgICAgIGNvbnN0IG5ld1Njcm9sbFRvcCA9IHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQudG9wO1xuICAgICAgICBjb25zdCBuZXdTY3JvbGxMZWZ0ID0gdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydC5sZWZ0O1xuXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnZlcnRpY2FsbHlPcmllbnRlZCB8fCB0aGlzLnNldHRpbmdzLmluR3JpZClcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9IG5ld1Njcm9sbFRvcCAtIHByZXZpb3VzVG9wU2Nyb2xsO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBkaXJlY3Rpb24gPSBuZXdTY3JvbGxMZWZ0IC0gcHJldmlvdXNMZWZ0U2Nyb2xsO1xuXG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUucmVuZGVyZXIuYWRqdXN0KCk7XG5cbiAgICAgICAgY29uc3QgcHJpbWFyeVNjcm9sbCA9ICh0aGlzLnNldHRpbmdzLnZlcnRpY2FsbHlPcmllbnRlZCB8fCB0aGlzLnNldHRpbmdzLmluR3JpZCkgPyBuZXdTY3JvbGxUb3AgOiBuZXdTY3JvbGxMZWZ0O1xuXG4gICAgICAgIHRoaXMucHVibGlzaChcIlZpZXdlckRpZFNjcm9sbFwiLCBwcmltYXJ5U2Nyb2xsKTtcblxuICAgICAgICBpZiAoZGlyZWN0aW9uID4gMClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5wdWJsaXNoKFwiVmlld2VyRGlkU2Nyb2xsRG93blwiLCBwcmltYXJ5U2Nyb2xsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkaXJlY3Rpb24gPCAwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnB1Ymxpc2goXCJWaWV3ZXJEaWRTY3JvbGxVcFwiLCBwcmltYXJ5U2Nyb2xsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudXBkYXRlT2Zmc2V0cygpO1xuICAgIH1cblxuICAgIC8vIEJpbmRzIG1vc3Qgb2YgdGhlIGV2ZW50IGhhbmRsZXJzIChzb21lIG1vcmUgaW4gY3JlYXRlVG9vbGJhcilcbiAgICBoYW5kbGVFdmVudHMgKClcbiAgICB7XG4gICAgICAgIC8vIENoYW5nZSB0aGUgY3Vyc29yIGZvciBkcmFnZ2luZ1xuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmlubmVyT2JqZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsICgpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUuaW5uZXJPYmplY3QuY2xhc3NMaXN0LmFkZCgnZGl2YS1ncmFiYmluZycpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmlubmVyT2JqZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmlubmVyT2JqZWN0LmNsYXNzTGlzdC5yZW1vdmUoJ2RpdmEtZ3JhYmJpbmcnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5iaW5kTW91c2VFdmVudHMoKTtcbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydE9iamVjdC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLmJvdW5kU2Nyb2xsRnVuY3Rpb24pO1xuXG4gICAgICAgIGNvbnN0IHVwQXJyb3dLZXkgPSAzOCwgZG93bkFycm93S2V5ID0gNDAsIGxlZnRBcnJvd0tleSA9IDM3LCByaWdodEFycm93S2V5ID0gMzksIHNwYWNlS2V5ID0gMzIsIHBhZ2VVcEtleSA9IDMzLCBwYWdlRG93bktleSA9IDM0LCBob21lS2V5ID0gMzYsIGVuZEtleSA9IDM1O1xuXG4gICAgICAgIC8vIENhdGNoIHRoZSBrZXkgcHJlc3NlcyBpbiBkb2N1bWVudFxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duLmRpdmEnLCAoZXZlbnQpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghdGhpcy52aWV3ZXJTdGF0ZS5pc0FjdGl2ZURpdmEpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgICAgIC8vIFNwYWNlIG9yIHBhZ2UgZG93biAtIGdvIHRvIHRoZSBuZXh0IHBhZ2VcbiAgICAgICAgICAgIGlmICgodGhpcy5zZXR0aW5ncy5lbmFibGVTcGFjZVNjcm9sbCAmJiAhZXZlbnQuc2hpZnRLZXkgJiYgZXZlbnQua2V5Q29kZSA9PT0gc3BhY2VLZXkpIHx8ICh0aGlzLnNldHRpbmdzLmVuYWJsZUtleVNjcm9sbCAmJiBldmVudC5rZXlDb2RlID09PSBwYWdlRG93bktleSkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydC50b3AgKz0gdGhpcy5zZXR0aW5ncy5wYW5lbEhlaWdodDtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghdGhpcy5zZXR0aW5ncy5lbmFibGVTcGFjZVNjcm9sbCAmJiBldmVudC5rZXlDb2RlID09PSBzcGFjZUtleSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVLZXlTY3JvbGwpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gRG9uJ3Qgc3RlYWwga2V5Ym9hcmQgc2hvcnRjdXRzIChtZXRhS2V5ID0gY29tbWFuZCBbT1MgWF0sIHN1cGVyIFtXaW4vTGludXhdKVxuICAgICAgICAgICAgICAgIGlmIChldmVudC5zaGlmdEtleSB8fCBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgICAgICAgICAgc3dpdGNoIChldmVudC5rZXlDb2RlKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBwYWdlVXBLZXk6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQYWdlIHVwIC0gZ28gdG8gdGhlIHByZXZpb3VzIHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQudG9wIC09IHRoaXMuc2V0dGluZ3MucGFuZWxIZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSB1cEFycm93S2V5OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXAgYXJyb3cgLSBzY3JvbGwgdXBcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQudG9wIC09IHRoaXMuc2V0dGluZ3MuYXJyb3dTY3JvbGxBbW91bnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSBkb3duQXJyb3dLZXk6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEb3duIGFycm93IC0gc2Nyb2xsIGRvd25cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQudG9wICs9IHRoaXMuc2V0dGluZ3MuYXJyb3dTY3JvbGxBbW91bnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSBsZWZ0QXJyb3dLZXk6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMZWZ0IGFycm93IC0gc2Nyb2xsIGxlZnRcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQubGVmdCAtPSB0aGlzLnNldHRpbmdzLmFycm93U2Nyb2xsQW1vdW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgcmlnaHRBcnJvd0tleTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJpZ2h0IGFycm93IC0gc2Nyb2xsIHJpZ2h0XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZpZXdwb3J0LmxlZnQgKz0gdGhpcy5zZXR0aW5ncy5hcnJvd1Njcm9sbEFtb3VudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICBjYXNlIGhvbWVLZXk6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIb21lIGtleSAtIGdvIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZpZXdwb3J0LnRvcCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSBlbmRLZXk6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBFbmQga2V5IC0gZ28gdG8gdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvdW50IG9uIHRoZSB2aWV3cG9ydCBjb29yZGluYXRlIHZhbHVlIGJlaW5nIG5vcm1hbGl6ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnZlcnRpY2FsbHlPcmllbnRlZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZpZXdwb3J0LnRvcCA9IEluZmluaXR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQubGVmdCA9IEluZmluaXR5O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcblxuICAgICAgICBkaXZhLkV2ZW50cy5zdWJzY3JpYmUoJ1ZpZXdlckRpZFRlcm1pbmF0ZScsIGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bi5kaXZhJyk7XG4gICAgICAgIH0sIHRoaXMuc2V0dGluZ3MuSUQpO1xuXG4gICAgICAgIC8vIHRoaXMuYmluZFRvdWNoRXZlbnRzKCk7XG5cbiAgICAgICAgLy8gSGFuZGxlIHdpbmRvdyByZXNpemluZyBldmVudHNcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMub25SZXNpemUuYmluZCh0aGlzKSwgZmFsc2UpO1xuXG4gICAgICAgIGRpdmEuRXZlbnRzLnN1YnNjcmliZSgnVmlld2VyRGlkVGVybWluYXRlJywgZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5vblJlc2l6ZSwgZmFsc2UpO1xuICAgICAgICB9LCB0aGlzLnNldHRpbmdzLklEKTtcblxuICAgICAgICAvLyBIYW5kbGUgb3JpZW50YXRpb24gY2hhbmdlIHNlcGFyYXRlbHlcbiAgICAgICAgaWYgKCdvbm9yaWVudGF0aW9uY2hhbmdlJyBpbiB3aW5kb3cpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsIHRoaXMub25SZXNpemUsIGZhbHNlKTtcblxuICAgICAgICAgICAgZGl2YS5FdmVudHMuc3Vic2NyaWJlKCdWaWV3ZXJEaWRUZXJtaW5hdGUnLCBmdW5jdGlvbigpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29yaWVudGF0aW9uY2hhbmdlJywgdGhpcy5vblJlc2l6ZSwgZmFsc2UpO1xuICAgICAgICAgICAgfSwgdGhpcy5zZXR0aW5ncy5JRCk7XG4gICAgICAgIH1cblxuICAgICAgICBkaXZhLkV2ZW50cy5zdWJzY3JpYmUoJ1BhbmVsU2l6ZURpZENoYW5nZScsIHRoaXMudXBkYXRlUGFuZWxTaXplLCB0aGlzLnNldHRpbmdzLklEKTtcblxuICAgICAgICAvLyBDbGVhciBwYWdlIGFuZCByZXNpemUgdGltZW91dHMgd2hlbiB0aGUgdmlld2VyIGlzIGRlc3Ryb3llZFxuICAgICAgICBkaXZhLkV2ZW50cy5zdWJzY3JpYmUoJ1ZpZXdlckRpZFRlcm1pbmF0ZScsICgpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnZpZXdlclN0YXRlLnJlbmRlcmVyKVxuICAgICAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUucmVuZGVyZXIuZGVzdHJveSgpO1xuXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy52aWV3ZXJTdGF0ZS5yZXNpemVUaW1lcik7XG4gICAgICAgIH0sIHRoaXMuc2V0dGluZ3MuSUQpO1xuICAgIH1cblxuICAgIGluaXRQbHVnaW5zICgpXG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuaGFzT3duUHJvcGVydHkoJ3BsdWdpbnMnKSlcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuXG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUucGx1Z2luSW5zdGFuY2VzID0gdGhpcy5zZXR0aW5ncy5wbHVnaW5zLm1hcCggKHBsdWdpbikgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgcCA9IG5ldyBwbHVnaW4odGhpcyk7XG5cbiAgICAgICAgICAgIGlmIChwLmlzUGFnZVRvb2wpXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5wYWdlVG9vbHMucHVzaChwKTtcblxuICAgICAgICAgICAgcmV0dXJuIHA7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNob3dUaHJvYmJlciAoKVxuICAgIHtcbiAgICAgICAgdGhpcy5oaWRlVGhyb2JiZXIoKTtcblxuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnRocm9iYmVyVGltZW91dElEID0gc2V0VGltZW91dCggKCkgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgbGV0IHRoYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuc2V0dGluZ3Muc2VsZWN0b3IgKyAndGhyb2JiZXInKTtcbiAgICAgICAgICAgIGlmICh0aGIpIHRoYi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgfSwgdGhpcy5zZXR0aW5ncy50aHJvYmJlclRpbWVvdXQpO1xuICAgIH1cblxuICAgIGhpZGVUaHJvYmJlciAoKVxuICAgIHtcbiAgICAgICAgLy8gQ2xlYXIgdGhlIHRpbWVvdXQsIGlmIGl0IGhhc24ndCBleGVjdXRlZCB5ZXRcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudmlld2VyU3RhdGUudGhyb2JiZXJUaW1lb3V0SUQpO1xuXG4gICAgICAgIGxldCB0aGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnNldHRpbmdzLnNlbGVjdG9yICsgJ3Rocm9iYmVyJyk7XG4gICAgICAgIC8vIEhpZGUgdGhlIHRocm9iYmVyIGlmIGl0IGhhcyBhbHJlYWR5IGV4ZWN1dGVkXG4gICAgICAgIGlmICh0aGIpIHRoYi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH1cblxuICAgIHNob3dFcnJvciAobWVzc2FnZSlcbiAgICB7XG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IGVsdCgnZGl2JywgdGhpcy5lbGVtQXR0cnMoJ2Vycm9yJyksIFtcbiAgICAgICAgICAgIGVsdCgnYnV0dG9uJywgdGhpcy5lbGVtQXR0cnMoJ2Vycm9yLWNsb3NlJywgeydhcmlhLWxhYmVsJzogJ0Nsb3NlIGRpYWxvZyd9KSksXG4gICAgICAgICAgICBlbHQoJ3AnLFxuICAgICAgICAgICAgICAgIGVsdCgnc3Ryb25nJywgJ0Vycm9yJylcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBlbHQoJ2RpdicsIG1lc3NhZ2UpXG4gICAgICAgIF0pO1xuXG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUub3V0ZXJPYmplY3QuYXBwZW5kQ2hpbGQoZXJyb3JFbGVtZW50KTtcblxuICAgICAgICAvL2JpbmQgZGlhbG9nIGNsb3NlIGJ1dHRvblxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuc2V0dGluZ3Muc2VsZWN0b3IgKyAnZXJyb3ItY2xvc2UnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGVycm9yRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVycm9yRWxlbWVudCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNldE1hbmlmZXN0IChtYW5pZmVzdCwgbG9hZE9wdGlvbnMpXG4gICAge1xuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLm1hbmlmZXN0ID0gbWFuaWZlc3Q7XG5cbiAgICAgICAgdGhpcy5oaWRlVGhyb2JiZXIoKTtcblxuICAgICAgICAvLyBDb252ZW5pZW5jZSB2YWx1ZVxuICAgICAgICB0aGlzLnZpZXdlclN0YXRlLm51bVBhZ2VzID0gdGhpcy5zZXR0aW5ncy5tYW5pZmVzdC5wYWdlcy5sZW5ndGg7XG5cbiAgICAgICAgdGhpcy5vcHRpb25zVmFsaWRhdG9yLnZhbGlkYXRlKHRoaXMudmlld2VyU3RhdGUub3B0aW9ucyk7XG5cbiAgICAgICAgdGhpcy5wdWJsaXNoKCdOdW1iZXJPZlBhZ2VzRGlkQ2hhbmdlJywgdGhpcy5zZXR0aW5ncy5udW1QYWdlcyk7XG5cbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlQXV0b1RpdGxlKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnNldHRpbmdzLnNlbGVjdG9yICsgJ3RpdGxlJyk7XG5cbiAgICAgICAgICAgIGlmICh0aXRsZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aXRsZS5pbm5lckhUTUwgPSB0aGlzLnNldHRpbmdzLm1hbmlmZXN0Lml0ZW1UaXRsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnBhcmVudE9iamVjdC5pbnNlcnRCZWZvcmUoXG4gICAgICAgICAgICAgICAgICAgIGVsdCgnZGl2JywgdGhpcy5lbGVtQXR0cnMoJ3RpdGxlJyksIFt0aGlzLnNldHRpbmdzLm1hbmlmZXN0Lml0ZW1UaXRsZV0pLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnBhcmVudE9iamVjdC5maXJzdENoaWxkXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgaG9yaXpvbnRhbCBhbmQgdmVydGljYWwgaW50ZXItcGFnZSBwYWRkaW5nIGJhc2VkIG9uIHRoZSBkaW1lbnNpb25zIG9mIHRoZSBhdmVyYWdlIHpvb20gbGV2ZWxcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuYWRhcHRpdmVQYWRkaW5nID4gMClcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgeiA9IE1hdGguZmxvb3IoKHRoaXMuc2V0dGluZ3MubWluWm9vbUxldmVsICsgdGhpcy5zZXR0aW5ncy5tYXhab29tTGV2ZWwpIC8gMik7XG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmhvcml6b250YWxQYWRkaW5nID0gcGFyc2VJbnQodGhpcy5zZXR0aW5ncy5tYW5pZmVzdC5nZXRBdmVyYWdlV2lkdGgoeikgKiB0aGlzLnNldHRpbmdzLmFkYXB0aXZlUGFkZGluZywgMTApO1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52ZXJ0aWNhbFBhZGRpbmcgPSBwYXJzZUludCh0aGlzLnNldHRpbmdzLm1hbmlmZXN0LmdldEF2ZXJhZ2VIZWlnaHQoeikgKiB0aGlzLnNldHRpbmdzLmFkYXB0aXZlUGFkZGluZywgMTApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gSXQncyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gMDsgdXNlIGZpeGVkUGFkZGluZyBpbnN0ZWFkXG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmhvcml6b250YWxQYWRkaW5nID0gdGhpcy5zZXR0aW5ncy5maXhlZFBhZGRpbmc7XG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLnZlcnRpY2FsUGFkZGluZyA9IHRoaXMuc2V0dGluZ3MuZml4ZWRQYWRkaW5nO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSB2ZXJ0aWNhbCBwYWRkaW5nIGlzIGF0IGxlYXN0IDQwLCBpZiBwbHVnaW4gaWNvbnMgYXJlIGVuYWJsZWRcbiAgICAgICAgaWYgKHRoaXMudmlld2VyU3RhdGUucGFnZVRvb2xzLmxlbmd0aClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52ZXJ0aWNhbFBhZGRpbmcgPSBNYXRoLm1heCg0MCwgdGhpcy52aWV3ZXJTdGF0ZS52ZXJ0aWNhbFBhZGRpbmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgd2UgZGV0ZWN0IGEgdmlld2luZ0hpbnQgb2YgJ3BhZ2VkJyBpbiB0aGUgbWFuaWZlc3Qgb3Igc2VxdWVuY2UsIGVuYWJsZSBib29rIHZpZXcgYnkgZGVmYXVsdFxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5tYW5pZmVzdC5wYWdlZClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5vcHRpb25zLmluQm9va0xheW91dCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQbHVnaW4gc2V0dXAgaG9va3Mgc2hvdWxkIGJlIGJvdW5kIHRvIHRoZSBPYmplY3REaWRMb2FkIGV2ZW50XG4gICAgICAgIHRoaXMucHVibGlzaCgnT2JqZWN0RGlkTG9hZCcsIHRoaXMuc2V0dGluZ3MpO1xuXG4gICAgICAgIC8vIEFkanVzdCB0aGUgZG9jdW1lbnQgcGFuZWwgZGltZW5zaW9uc1xuICAgICAgICB0aGlzLnVwZGF0ZVBhbmVsU2l6ZSgpO1xuXG4gICAgICAgIGxldCBuZWVkc1hDb29yZCwgbmVlZHNZQ29vcmQ7XG5cbiAgICAgICAgbGV0IGFuY2hvcmVkVmVydGljYWxseSA9IGZhbHNlO1xuICAgICAgICBsZXQgYW5jaG9yZWRIb3Jpem9udGFsbHkgPSBmYWxzZTtcblxuICAgICAgICAvLyBOQjogYD09YCBoZXJlIHdpbGwgY2hlY2sgYm90aCBudWxsIGFuZCB1bmRlZmluZWRcbiAgICAgICAgaWYgKGxvYWRPcHRpb25zLmdvRGlyZWN0bHlUbyA9PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICBsb2FkT3B0aW9ucy5nb0RpcmVjdGx5VG8gPSB0aGlzLnNldHRpbmdzLmdvRGlyZWN0bHlUbztcbiAgICAgICAgICAgIG5lZWRzWENvb3JkID0gbmVlZHNZQ29vcmQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgbmVlZHNYQ29vcmQgPSBsb2FkT3B0aW9ucy5ob3Jpem9udGFsT2Zmc2V0ID09IG51bGwgfHwgaXNOYU4obG9hZE9wdGlvbnMuaG9yaXpvbnRhbE9mZnNldCk7XG4gICAgICAgICAgICBuZWVkc1lDb29yZCA9IGxvYWRPcHRpb25zLnZlcnRpY2FsT2Zmc2V0ID09IG51bGwgfHwgaXNOYU4obG9hZE9wdGlvbnMudmVydGljYWxPZmZzZXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0IGRlZmF1bHQgdmFsdWVzIGZvciB0aGUgaG9yaXpvbnRhbCBhbmQgdmVydGljYWwgb2Zmc2V0c1xuICAgICAgICBpZiAobmVlZHNYQ29vcmQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIEZJWE1FOiBXaGF0IGlmIGluQm9va0xheW91dC92ZXJ0aWNhbGx5T3JpZW50ZWQgaXMgY2hhbmdlZCBieSBsb2FkT3B0aW9ucz9cbiAgICAgICAgICAgIGlmIChsb2FkT3B0aW9ucy5nb0RpcmVjdGx5VG8gPT09IDAgJiYgdGhpcy5zZXR0aW5ncy5pbkJvb2tMYXlvdXQgJiYgdGhpcy5zZXR0aW5ncy52ZXJ0aWNhbGx5T3JpZW50ZWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaW4gYm9vayBsYXlvdXQsIGNlbnRlciB0aGUgZmlyc3Qgb3BlbmluZyBieSBkZWZhdWx0XG4gICAgICAgICAgICAgICAgbG9hZE9wdGlvbnMuaG9yaXpvbnRhbE9mZnNldCA9IHRoaXMudmlld2VyU3RhdGUuaG9yaXpvbnRhbFBhZGRpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYW5jaG9yZWRIb3Jpem9udGFsbHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGxvYWRPcHRpb25zLmhvcml6b250YWxPZmZzZXQgPSB0aGlzLmdldFhPZmZzZXQobG9hZE9wdGlvbnMuZ29EaXJlY3RseVRvLCBcImNlbnRlclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChuZWVkc1lDb29yZClcbiAgICAgICAge1xuICAgICAgICAgICAgYW5jaG9yZWRWZXJ0aWNhbGx5ID0gdHJ1ZTtcbiAgICAgICAgICAgIGxvYWRPcHRpb25zLnZlcnRpY2FsT2Zmc2V0ID0gdGhpcy5nZXRZT2Zmc2V0KGxvYWRPcHRpb25zLmdvRGlyZWN0bHlUbywgXCJ0b3BcIik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlbG9hZFZpZXdlcihsb2FkT3B0aW9ucyk7XG5cbiAgICAgICAgLy9wcmVwIGRpbWVuc2lvbnMgb25lIGxhc3QgdGltZSBub3cgdGhhdCBwYWdlcyBoYXZlIGxvYWRlZFxuICAgICAgICB0aGlzLnVwZGF0ZVBhbmVsU2l6ZSgpO1xuXG4gICAgICAgIC8vIEZJWE1FOiBUaGlzIGlzIGEgaGFjayB0byBlbnN1cmUgdGhhdCB0aGUgb3V0ZXJFbGVtZW50IHNjcm9sbGJhcnMgYXJlIHRha2VuIGludG8gYWNjb3VudFxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy52ZXJ0aWNhbGx5T3JpZW50ZWQpXG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmlubmVyRWxlbWVudC5zdHlsZS5taW5XaWR0aCA9IHRoaXMuc2V0dGluZ3MucGFuZWxXaWR0aCArICdweCc7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUuaW5uZXJFbGVtZW50LnN0eWxlLm1pbkhlaWdodCA9IHRoaXMuc2V0dGluZ3MucGFuZWxIZWlnaHQgKyAncHgnO1xuXG4gICAgICAgIC8vIEZJWE1FOiBJZiB0aGUgcGFnZSB3YXMgc3VwcG9zZWQgdG8gYmUgcG9zaXRpb25lZCByZWxhdGl2ZSB0byB0aGUgdmlld3BvcnQgd2UgbmVlZCB0b1xuICAgICAgICAvLyByZWNhbGN1bGF0ZSBpdCB0byB0YWtlIGludG8gYWNjb3VudCB0aGUgc2Nyb2xsYmFyc1xuICAgICAgICBpZiAoYW5jaG9yZWRWZXJ0aWNhbGx5IHx8IGFuY2hvcmVkSG9yaXpvbnRhbGx5KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoYW5jaG9yZWRWZXJ0aWNhbGx5KVxuICAgICAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmVydGljYWxPZmZzZXQgPSB0aGlzLmdldFlPZmZzZXQodGhpcy5zZXR0aW5ncy5hY3RpdmVQYWdlSW5kZXgsIFwidG9wXCIpO1xuXG4gICAgICAgICAgICBpZiAoYW5jaG9yZWRIb3Jpem9udGFsbHkpXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5ob3Jpem9udGFsT2Zmc2V0ID0gdGhpcy5nZXRYT2Zmc2V0KHRoaXMuc2V0dGluZ3MuYWN0aXZlUGFnZUluZGV4LCBcImNlbnRlclwiKTtcblxuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5yZW5kZXJlci5nb3RvKHRoaXMuc2V0dGluZ3MuYWN0aXZlUGFnZUluZGV4LCB0aGlzLnZpZXdlclN0YXRlLnZlcnRpY2FsT2Zmc2V0LCB0aGlzLnZpZXdlclN0YXRlLmhvcml6b250YWxPZmZzZXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2lnbmFsIHRoYXQgZXZlcnl0aGluZyBzaG91bGQgYmUgc2V0IHVwIGFuZCByZWFkeSB0byBnby5cbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5sb2FkZWQgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMucHVibGlzaChcIlZpZXdlckRpZExvYWRcIiwgdGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgcHVibGlzaCAoZXZlbnQpXG4gICAge1xuICAgICAgICBjb25zdCBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICAgICAgZGl2YS5FdmVudHMucHVibGlzaChldmVudCwgYXJncywgdGhpcy5wdWJsaWNJbnN0YW5jZSk7XG4gICAgfVxuXG4gICAgZ2V0U2V0dGluZ3MgKClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzO1xuICAgIH1cblxuICAgIC8vIFRlbXBvcmFyeSBhY2Nlc3NvciBmb3IgdGhlIHN0YXRlIG9mIHRoZSB2aWV3ZXIgY29yZVxuICAgIC8vIFRPRE86IFJlcGxhY2UgdGhpcyB3aXRoIGEgbW9yZSByZXN0cmljdGVkIHZpZXcgb2Ygd2hhdGV2ZXIgbmVlZHNcbiAgICAvLyBiZSBleHBvc2VkIHRocm91Z2ggc2V0dGluZ3MgZm9yIGJhY2t3YXJkcyBjb21wYXRcbiAgICBnZXRJbnRlcm5hbFN0YXRlICgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3ZXJTdGF0ZTtcbiAgICB9XG5cbiAgICBnZXRQdWJsaWNJbnN0YW5jZSAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHVibGljSW5zdGFuY2U7XG4gICAgfVxuXG4gICAgZ2V0UGFnZVRvb2xzICgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3ZXJTdGF0ZS5wYWdlVG9vbHM7XG4gICAgfVxuXG4gICAgZ2V0Q3VycmVudExheW91dCAoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld2VyU3RhdGUucmVuZGVyZXIgPyB0aGlzLnZpZXdlclN0YXRlLnJlbmRlcmVyLmxheW91dCA6IG51bGw7XG4gICAgfVxuXG4gICAgLyoqIEdldCBhIGNvcHkgb2YgdGhlIGN1cnJlbnQgdmlld3BvcnQgZGltZW5zaW9ucyAqL1xuICAgIGdldFZpZXdwb3J0ICgpXG4gICAge1xuICAgICAgICBjb25zdCB2aWV3cG9ydCA9IHRoaXMudmlld2VyU3RhdGUudmlld3BvcnQ7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRvcDogdmlld3BvcnQudG9wLFxuICAgICAgICAgICAgbGVmdDogdmlld3BvcnQubGVmdCxcbiAgICAgICAgICAgIGJvdHRvbTogdmlld3BvcnQuYm90dG9tLFxuICAgICAgICAgICAgcmlnaHQ6IHZpZXdwb3J0LnJpZ2h0LFxuXG4gICAgICAgICAgICB3aWR0aDogdmlld3BvcnQud2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IHZpZXdwb3J0LmhlaWdodFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGFkZFBhZ2VPdmVybGF5IChvdmVybGF5KVxuICAgIHtcbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5wYWdlT3ZlcmxheXMuYWRkT3ZlcmxheShvdmVybGF5KTtcbiAgICB9XG5cbiAgICByZW1vdmVQYWdlT3ZlcmxheSAob3ZlcmxheSlcbiAgICB7XG4gICAgICAgIHRoaXMudmlld2VyU3RhdGUucGFnZU92ZXJsYXlzLnJlbW92ZU92ZXJsYXkob3ZlcmxheSk7XG4gICAgfVxuXG4gICAgZ2V0UGFnZVJlZ2lvbiAocGFnZUluZGV4LCBvcHRpb25zKVxuICAgIHtcbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy52aWV3ZXJTdGF0ZS5yZW5kZXJlci5sYXlvdXQ7XG4gICAgICAgIGNvbnN0IHJlZ2lvbiA9IGxheW91dC5nZXRQYWdlUmVnaW9uKHBhZ2VJbmRleCwgb3B0aW9ucyk7XG5cbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNvcnBvcmF0ZVZpZXdwb3J0KVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBzZWNvbmRhcnlEaW0gPSB0aGlzLnNldHRpbmdzLnZlcnRpY2FsbHlPcmllbnRlZCA/ICd3aWR0aCcgOiAnaGVpZ2h0JztcblxuICAgICAgICAgICAgaWYgKHRoaXMudmlld2VyU3RhdGUudmlld3BvcnRbc2Vjb25kYXJ5RGltXSA+IGxheW91dC5kaW1lbnNpb25zW3NlY29uZGFyeURpbV0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgZG9jT2Zmc2V0ID0gKHRoaXMudmlld2VyU3RhdGUudmlld3BvcnRbc2Vjb25kYXJ5RGltXSAtIGxheW91dC5kaW1lbnNpb25zW3NlY29uZGFyeURpbV0pIC8gMjtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnZlcnRpY2FsbHlPcmllbnRlZClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHJlZ2lvbi50b3AsXG4gICAgICAgICAgICAgICAgICAgICAgICBib3R0b206IHJlZ2lvbi5ib3R0b20sXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHJlZ2lvbi5sZWZ0ICsgZG9jT2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IHJlZ2lvbi5yaWdodCArIGRvY09mZnNldFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiByZWdpb24udG9wICsgZG9jT2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tOiByZWdpb24uYm90dG9tICsgZG9jT2Zmc2V0LFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiByZWdpb24ubGVmdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiByZWdpb24ucmlnaHRcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVnaW9uO1xuICAgIH1cblxuICAgIGdldFBhZ2VQb3NpdGlvbkF0Vmlld3BvcnRPZmZzZXQgKGNvb3JkcylcbiAgICB7XG4gICAgICAgIGNvbnN0IGRvY0Nvb3JkcyA9IHtcbiAgICAgICAgICAgIGxlZnQ6IGNvb3Jkcy5sZWZ0ICsgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydC5sZWZ0LFxuICAgICAgICAgICAgdG9wOiBjb29yZHMudG9wICsgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydC50b3BcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCByZW5kZXJlZFBhZ2VzID0gdGhpcy52aWV3ZXJTdGF0ZS5yZW5kZXJlci5nZXRSZW5kZXJlZFBhZ2VzKCk7XG4gICAgICAgIGNvbnN0IHBhZ2VDb3VudCA9IHJlbmRlcmVkUGFnZXMubGVuZ3RoO1xuXG4gICAgICAgIC8vIEZpbmQgdGhlIHBhZ2Ugb24gd2hpY2ggdGhlIGNvb3JkcyBvY2N1clxuICAgICAgICBmb3IgKGxldCBpPTA7IGkgPCBwYWdlQ291bnQ7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgcGFnZUluZGV4ID0gcmVuZGVyZWRQYWdlc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2lvbiA9IHRoaXMudmlld2VyU3RhdGUucmVuZGVyZXIubGF5b3V0LmdldFBhZ2VSZWdpb24ocGFnZUluZGV4KTtcblxuICAgICAgICAgICAgaWYgKHJlZ2lvbi5sZWZ0IDw9IGRvY0Nvb3Jkcy5sZWZ0ICYmIHJlZ2lvbi5yaWdodCA+PSBkb2NDb29yZHMubGVmdCAmJlxuICAgICAgICAgICAgICAgIHJlZ2lvbi50b3AgPD0gZG9jQ29vcmRzLnRvcCAmJiByZWdpb24uYm90dG9tID49IGRvY0Nvb3Jkcy50b3ApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgYW5jaG9yUGFnZTogcGFnZUluZGV4LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IGRvY0Nvb3Jkcy5sZWZ0IC0gcmVnaW9uLmxlZnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IGRvY0Nvb3Jkcy50b3AgLSByZWdpb24udG9wXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmFsbCBiYWNrIHRvIGN1cnJlbnQgcGFnZVxuICAgICAgICAvLyBGSVhNRTogV291bGQgYmUgYmV0dGVyIHRvIHVzZSB0aGUgY2xvc2VzdCBwYWdlIG9yIHNvbWV0aGluZ1xuICAgICAgICBjb25zdCBjdXJyZW50UmVnaW9uID0gdGhpcy52aWV3ZXJTdGF0ZS5yZW5kZXJlci5sYXlvdXQuZ2V0UGFnZVJlZ2lvbih0aGlzLnNldHRpbmdzLmFjdGl2ZVBhZ2VJbmRleCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFuY2hvclBhZ2U6IHRoaXMuc2V0dGluZ3MuYWN0aXZlUGFnZUluZGV4LFxuICAgICAgICAgICAgb2Zmc2V0OiB7XG4gICAgICAgICAgICAgICAgbGVmdDogZG9jQ29vcmRzLmxlZnQgLSBjdXJyZW50UmVnaW9uLmxlZnQsXG4gICAgICAgICAgICAgICAgdG9wOiBkb2NDb29yZHMudG9wIC0gY3VycmVudFJlZ2lvbi50b3BcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBzZXRNYW5pZmVzdCAobWFuaWZlc3QsIGxvYWRPcHRpb25zKVxuICAgIC8vIHtcbiAgICAvLyAgICAgc2V0TWFuaWZlc3QobWFuaWZlc3QsIGxvYWRPcHRpb25zIHx8IHt9KTtcbiAgICAvLyB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGN1cnJlbnQgcGFnZSB0byB0aGUgZ2l2ZW4gaW5kZXgsIGZpcmluZyBWaXNpYmxlUGFnZURpZENoYW5nZVxuICAgICAqXG4gICAgICogQHBhcmFtIHBhZ2VJbmRleFxuICAgICAqL1xuICAgIHNldEN1cnJlbnRQYWdlcyAoYWN0aXZlUGFnZSwgdmlzaWJsZVBhZ2VzKVxuICAgIHtcbiAgICAgICAgaWYgKCFhcnJheXNFcXVhbCh0aGlzLnZpZXdlclN0YXRlLmN1cnJlbnRQYWdlSW5kaWNlcywgdmlzaWJsZVBhZ2VzKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5jdXJyZW50UGFnZUluZGljZXMgPSB2aXNpYmxlUGFnZXM7XG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmFjdGl2ZVBhZ2VJbmRleCA9IGFjdGl2ZVBhZ2U7XG4gICAgICAgICAgICB0aGlzLnB1Ymxpc2goXCJWaXNpYmxlUGFnZURpZENoYW5nZVwiLCB2aXNpYmxlUGFnZXMpO1xuXG4gICAgICAgICAgICAvLyBQdWJsaXNoIGFuIGV2ZW50IGlmIHRoZSBwYWdlIHdlJ3JlIHN3aXRjaGluZyB0byBoYXMgb3RoZXIgaW1hZ2VzLlxuICAgICAgICAgICAgaWYgKHRoaXMudmlld2VyU3RhdGUubWFuaWZlc3QucGFnZXNbYWN0aXZlUGFnZV0ub3RoZXJJbWFnZXMubGVuZ3RoID4gMClcbiAgICAgICAgICAgICAgICB0aGlzLnB1Ymxpc2goJ1Zpc2libGVQYWdlSGFzQWx0ZXJuYXRlVmlld3MnLCBhY3RpdmVQYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFycmF5c0VxdWFsIChhLCBiKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGEubGVuZ3RoOyBpIDwgbGVuOyBpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGFbaV0gIT09IGJbaV0pXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0UGFnZU5hbWUgKHBhZ2VJbmRleClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdlclN0YXRlLm1hbmlmZXN0LnBhZ2VzW3BhZ2VJbmRleF0uZjtcbiAgICB9XG5cbiAgICByZWxvYWQgKG5ld09wdGlvbnMpXG4gICAge1xuICAgICAgICB0aGlzLnJlbG9hZFZpZXdlcihuZXdPcHRpb25zKTtcbiAgICB9XG5cbiAgICB6b29tICh6b29tTGV2ZWwsIGZvY2FsUG9pbnQpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVab29tKHpvb21MZXZlbCwgZm9jYWxQb2ludCk7XG4gICAgfVxuXG4gICAgZW5hYmxlU2Nyb2xsYWJsZSAoKVxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLnZpZXdlclN0YXRlLmlzU2Nyb2xsYWJsZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5iaW5kTW91c2VFdmVudHMoKTtcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlRHJhZ1Njcm9sbGFibGUoKTtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUub3B0aW9ucy5lbmFibGVLZXlTY3JvbGwgPSB0aGlzLnZpZXdlclN0YXRlLmluaXRpYWxLZXlTY3JvbGw7XG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLm9wdGlvbnMuZW5hYmxlU3BhY2VTY3JvbGwgPSB0aGlzLnZpZXdlclN0YXRlLmluaXRpYWxTcGFjZVNjcm9sbDtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnRFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gJ2F1dG8nO1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5pc1Njcm9sbGFibGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZW5hYmxlRHJhZ1Njcm9sbGFibGUgKClcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLnZpZXdlclN0YXRlLnZpZXdwb3J0T2JqZWN0Lmhhc0F0dHJpYnV0ZSgnbm9jaGlsZGRyYWcnKSlcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnRPYmplY3QucmVtb3ZlQXR0cmlidXRlKCdub2NoaWxkZHJhZycpO1xuICAgIH1cblxuICAgIGRpc2FibGVTY3JvbGxhYmxlICgpXG4gICAge1xuICAgICAgICBpZiAodGhpcy52aWV3ZXJTdGF0ZS5pc1Njcm9sbGFibGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGJsb2NrIGRyYWdnaW5nXG4gICAgICAgICAgICB0aGlzLmRpc2FibGVEcmFnU2Nyb2xsYWJsZSgpO1xuXG4gICAgICAgICAgICAvLyBibG9jayBkb3VibGUtY2xpY2sgem9vbWluZ1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5vdXRlck9iamVjdC5kYmxjbGljayA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLm91dGVyT2JqZWN0LmNvbnRleHRtZW51ID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gZGlzYWJsZSBhbGwgb3RoZXIgc2Nyb2xsaW5nIGFjdGlvbnNcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUudmlld3BvcnRFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG5cbiAgICAgICAgICAgIC8vIGJsb2NrIHNjcm9sbGluZyBrZXlzIGJlaGF2aW9yLCByZXNwZWN0aW5nIGluaXRpYWwgc2Nyb2xsIHNldHRpbmdzXG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmluaXRpYWxLZXlTY3JvbGwgPSB0aGlzLnNldHRpbmdzLmVuYWJsZUtleVNjcm9sbDtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUuaW5pdGlhbFNwYWNlU2Nyb2xsID0gdGhpcy5zZXR0aW5ncy5lbmFibGVTcGFjZVNjcm9sbDtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUub3B0aW9ucy5lbmFibGVLZXlTY3JvbGwgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMudmlld2VyU3RhdGUub3B0aW9ucy5lbmFibGVTcGFjZVNjcm9sbCA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0aGlzLnZpZXdlclN0YXRlLmlzU2Nyb2xsYWJsZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGlzYWJsZURyYWdTY3JvbGxhYmxlICgpXG4gICAge1xuICAgICAgICBpZiAoIXRoaXMudmlld2VyU3RhdGUudmlld3BvcnRPYmplY3QuaGFzQXR0cmlidXRlKCdub2NoaWxkZHJhZycpKVxuICAgICAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS52aWV3cG9ydE9iamVjdC5zZXRBdHRyaWJ1dGUoJ25vY2hpbGRkcmFnJywgXCJcIik7XG4gICAgfVxuXG4gICAgLy8gaXNWYWxpZE9wdGlvbiAoa2V5LCB2YWx1ZSlcbiAgICAvLyB7XG4gICAgLy8gICAgIHJldHVybiBpc1ZhbGlkT3B0aW9uKGtleSwgdmFsdWUpO1xuICAgIC8vIH1cblxuICAgIC8vIGdldFhPZmZzZXQgKHBhZ2VJbmRleCwgeEFuY2hvcilcbiAgICAvLyB7XG4gICAgLy8gICAgIHJldHVybiBnZXRYT2Zmc2V0KHBhZ2VJbmRleCwgeEFuY2hvcik7XG4gICAgLy8gfVxuXG4gICAgLy8gZ2V0WU9mZnNldCAocGFnZUluZGV4LCB5QW5jaG9yKVxuICAgIC8vIHtcbiAgICAvLyAgICAgcmV0dXJuIGdldFlPZmZzZXQocGFnZUluZGV4LCB5QW5jaG9yKTtcbiAgICAvLyB9XG5cbiAgICAvLyB0aGlzLnB1Ymxpc2ggPSBwdWJsaXNoO1xuXG4gICAgY2xlYXIgKClcbiAgICB7XG4gICAgICAgIHRoaXMuY2xlYXJWaWV3ZXIoKTtcbiAgICB9XG5cbiAgICBzZXRQZW5kaW5nTWFuaWZlc3RSZXF1ZXN0IChwZW5kaW5nTWFuaWZlc3RSZXF1ZXN0KVxuICAgIHtcbiAgICAgICAgdGhpcy52aWV3ZXJTdGF0ZS5wZW5kaW5nTWFuaWZlc3RSZXF1ZXN0ID0gcGVuZGluZ01hbmlmZXN0UmVxdWVzdDtcbiAgICB9XG5cbiAgICBkZXN0cm95ICgpXG4gICAge1xuICAgICAgICAvLyBVc2VmdWwgZXZlbnQgdG8gYWNjZXNzIGVsZW1lbnRzIGluIGRpdmEgYmVmb3JlIHRoZXkgZ2V0IGRlc3Ryb3llZC4gVXNlZCBieSB0aGUgaGlnaGxpZ2h0IHBsdWdpbi5cbiAgICAgICAgdGhpcy5wdWJsaXNoKCdWaWV3ZXJXaWxsVGVybWluYXRlJywgdGhpcy5zZXR0aW5ncyk7XG5cbiAgICAgICAgLy8gQ2FuY2VsIGFueSBwZW5kaW5nIHJlcXVlc3QgcmV0cmlldmluZyBhIG1hbmlmZXN0XG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnBlbmRpbmdNYW5pZmVzdFJlcXVlc3QpXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnBlbmRpbmdNYW5pZmVzdFJlcXVlc3QuYWJvcnQoKTtcblxuICAgICAgICAvLyBSZW1vdmVzIHRoZSBoaWRlLXNjcm9sbGJhciBjbGFzcyBmcm9tIHRoZSBib2R5XG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2RpdmEtaGlkZS1zY3JvbGxiYXInKTtcblxuICAgICAgICAvLyBFbXB0eSB0aGUgcGFyZW50IGNvbnRhaW5lciBhbmQgcmVtb3ZlIGFueSBkaXZhLXJlbGF0ZWQgZGF0YVxuICAgICAgICB0aGlzLnNldHRpbmdzLnBhcmVudE9iamVjdC5wYXJlbnQoKS5lbXB0eSgpLnJlbW92ZURhdGEoJ2RpdmEnKTtcblxuICAgICAgICAvLyBSZW1vdmUgYW55IGFkZGl0aW9uYWwgc3R5bGluZyBvbiB0aGUgcGFyZW50IGVsZW1lbnRcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5wYXJlbnRPYmplY3QucGFyZW50KCkucmVtb3ZlQXR0cignc3R5bGUnKS5yZW1vdmVBdHRyKCdjbGFzcycpO1xuXG4gICAgICAgIHRoaXMucHVibGlzaCgnVmlld2VyRGlkVGVybWluYXRlJywgdGhpcy5zZXR0aW5ncyk7XG5cbiAgICAgICAgLy8gQ2xlYXIgdGhlIEV2ZW50cyBjYWNoZVxuICAgICAgICBkaXZhLkV2ZW50cy51bnN1YnNjcmliZUFsbCh0aGlzLnNldHRpbmdzLklEKTtcbiAgICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/viewer-core.js\n");

/***/ }),

/***/ "./source/js/viewport.js":
/*!*******************************!*\
  !*** ./source/js/viewport.js ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Viewport; });\nclass Viewport\n{\n    constructor (outer, options)\n    {\n        options = options || {};\n\n        this.intersectionTolerance = options.intersectionTolerance || 0;\n\n        this.outer = outer;\n\n        this._top = this._left = this._width = this._height = this._innerDimensions = null;\n\n        this.invalidate();\n    }\n\n    intersectsRegion (region)\n    {\n        return this.hasHorizontalOverlap(region) && this.hasVerticalOverlap(region);\n    }\n\n    hasVerticalOverlap (region)\n    {\n        const top = this.top - this.intersectionTolerance;\n        const bottom = this.bottom + this.intersectionTolerance;\n\n        return (\n            fallsBetween(region.top, top, bottom) ||\n            fallsBetween(region.bottom, top, bottom) ||\n            (region.top <= top && region.bottom >= bottom)\n        );\n    }\n\n    hasHorizontalOverlap (region)\n    {\n        const left = this.left - this.intersectionTolerance;\n        const right = this.right + this.intersectionTolerance;\n\n        return (\n            fallsBetween(region.left, left, right) ||\n            fallsBetween(region.right, left, right) ||\n            (region.left <= left && region.right >= right)\n        );\n    }\n\n    invalidate ()\n    {\n        // FIXME: Should this check the inner dimensions as well?\n        this._width = this.outer.clientWidth;\n        this._height = this.outer.clientHeight;\n\n        this._top = this.outer.scrollTop;\n        this._left = this.outer.scrollLeft;\n    }\n\n    setInnerDimensions (dimensions)\n    {\n        this._innerDimensions = dimensions;\n\n        if (dimensions)\n        {\n            this._top = clamp(this._top, 0, dimensions.height - this._height);\n            this._left = clamp(this._left, 0, dimensions.width - this._width);\n        }\n    }\n}\n\nObject.defineProperties(Viewport.prototype, {\n    top: getCoordinateDescriptor('top', 'height'),\n    left: getCoordinateDescriptor('left', 'width'),\n\n    width: getDimensionDescriptor('width'),\n    height: getDimensionDescriptor('height'),\n\n    bottom: {\n        get: function ()\n        {\n            return this._top + this._height;\n        }\n    },\n    right: {\n        get: function ()\n        {\n            return this._left + this._width;\n        }\n    }\n});\n\nfunction getCoordinateDescriptor (coord, associatedDimension)\n{\n    const privateProp = '_' + coord;\n    const source = 'scroll' + coord.charAt(0).toUpperCase() + coord.slice(1);\n\n    return {\n        get: function ()\n        {\n            return this[privateProp];\n        },\n        set: function (newValue)\n        {\n            let normalized;\n\n            if (this._innerDimensions)\n            {\n                const maxAllowed = this._innerDimensions[associatedDimension] - this[associatedDimension];\n                normalized = clamp(newValue, 0, maxAllowed);\n            }\n            else\n            {\n                normalized = clampMin(newValue, 0);\n            }\n\n            this[privateProp] = this.outer[source] = normalized;\n        }\n    };\n}\n\nfunction getDimensionDescriptor (dimen)\n{\n    return {\n        get: function ()\n        {\n            return this['_' + dimen];\n        }\n    };\n}\n\nfunction fallsBetween (point, start, end)\n{\n    return point >= start && point <= end;\n}\n\nfunction clamp (value, min, max)\n{\n    return clampMin(clampMax(value, max), min);\n}\n\nfunction clampMin (value, min)\n{\n    return Math.max(value, min);\n}\n\nfunction clampMax (value, max)\n{\n    return Math.min(value, max);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zb3VyY2UvanMvdmlld3BvcnQuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvdmlld3BvcnQuanM/ZDMwNCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBWaWV3cG9ydFxue1xuICAgIGNvbnN0cnVjdG9yIChvdXRlciwgb3B0aW9ucylcbiAgICB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAgIHRoaXMuaW50ZXJzZWN0aW9uVG9sZXJhbmNlID0gb3B0aW9ucy5pbnRlcnNlY3Rpb25Ub2xlcmFuY2UgfHwgMDtcblxuICAgICAgICB0aGlzLm91dGVyID0gb3V0ZXI7XG5cbiAgICAgICAgdGhpcy5fdG9wID0gdGhpcy5fbGVmdCA9IHRoaXMuX3dpZHRoID0gdGhpcy5faGVpZ2h0ID0gdGhpcy5faW5uZXJEaW1lbnNpb25zID0gbnVsbDtcblxuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9XG5cbiAgICBpbnRlcnNlY3RzUmVnaW9uIChyZWdpb24pXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5oYXNIb3Jpem9udGFsT3ZlcmxhcChyZWdpb24pICYmIHRoaXMuaGFzVmVydGljYWxPdmVybGFwKHJlZ2lvbik7XG4gICAgfVxuXG4gICAgaGFzVmVydGljYWxPdmVybGFwIChyZWdpb24pXG4gICAge1xuICAgICAgICBjb25zdCB0b3AgPSB0aGlzLnRvcCAtIHRoaXMuaW50ZXJzZWN0aW9uVG9sZXJhbmNlO1xuICAgICAgICBjb25zdCBib3R0b20gPSB0aGlzLmJvdHRvbSArIHRoaXMuaW50ZXJzZWN0aW9uVG9sZXJhbmNlO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBmYWxsc0JldHdlZW4ocmVnaW9uLnRvcCwgdG9wLCBib3R0b20pIHx8XG4gICAgICAgICAgICBmYWxsc0JldHdlZW4ocmVnaW9uLmJvdHRvbSwgdG9wLCBib3R0b20pIHx8XG4gICAgICAgICAgICAocmVnaW9uLnRvcCA8PSB0b3AgJiYgcmVnaW9uLmJvdHRvbSA+PSBib3R0b20pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgaGFzSG9yaXpvbnRhbE92ZXJsYXAgKHJlZ2lvbilcbiAgICB7XG4gICAgICAgIGNvbnN0IGxlZnQgPSB0aGlzLmxlZnQgLSB0aGlzLmludGVyc2VjdGlvblRvbGVyYW5jZTtcbiAgICAgICAgY29uc3QgcmlnaHQgPSB0aGlzLnJpZ2h0ICsgdGhpcy5pbnRlcnNlY3Rpb25Ub2xlcmFuY2U7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGZhbGxzQmV0d2VlbihyZWdpb24ubGVmdCwgbGVmdCwgcmlnaHQpIHx8XG4gICAgICAgICAgICBmYWxsc0JldHdlZW4ocmVnaW9uLnJpZ2h0LCBsZWZ0LCByaWdodCkgfHxcbiAgICAgICAgICAgIChyZWdpb24ubGVmdCA8PSBsZWZ0ICYmIHJlZ2lvbi5yaWdodCA+PSByaWdodClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBpbnZhbGlkYXRlICgpXG4gICAge1xuICAgICAgICAvLyBGSVhNRTogU2hvdWxkIHRoaXMgY2hlY2sgdGhlIGlubmVyIGRpbWVuc2lvbnMgYXMgd2VsbD9cbiAgICAgICAgdGhpcy5fd2lkdGggPSB0aGlzLm91dGVyLmNsaWVudFdpZHRoO1xuICAgICAgICB0aGlzLl9oZWlnaHQgPSB0aGlzLm91dGVyLmNsaWVudEhlaWdodDtcblxuICAgICAgICB0aGlzLl90b3AgPSB0aGlzLm91dGVyLnNjcm9sbFRvcDtcbiAgICAgICAgdGhpcy5fbGVmdCA9IHRoaXMub3V0ZXIuc2Nyb2xsTGVmdDtcbiAgICB9XG5cbiAgICBzZXRJbm5lckRpbWVuc2lvbnMgKGRpbWVuc2lvbnMpXG4gICAge1xuICAgICAgICB0aGlzLl9pbm5lckRpbWVuc2lvbnMgPSBkaW1lbnNpb25zO1xuXG4gICAgICAgIGlmIChkaW1lbnNpb25zKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl90b3AgPSBjbGFtcCh0aGlzLl90b3AsIDAsIGRpbWVuc2lvbnMuaGVpZ2h0IC0gdGhpcy5faGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuX2xlZnQgPSBjbGFtcCh0aGlzLl9sZWZ0LCAwLCBkaW1lbnNpb25zLndpZHRoIC0gdGhpcy5fd2lkdGgpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhWaWV3cG9ydC5wcm90b3R5cGUsIHtcbiAgICB0b3A6IGdldENvb3JkaW5hdGVEZXNjcmlwdG9yKCd0b3AnLCAnaGVpZ2h0JyksXG4gICAgbGVmdDogZ2V0Q29vcmRpbmF0ZURlc2NyaXB0b3IoJ2xlZnQnLCAnd2lkdGgnKSxcblxuICAgIHdpZHRoOiBnZXREaW1lbnNpb25EZXNjcmlwdG9yKCd3aWR0aCcpLFxuICAgIGhlaWdodDogZ2V0RGltZW5zaW9uRGVzY3JpcHRvcignaGVpZ2h0JyksXG5cbiAgICBib3R0b206IHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdG9wICsgdGhpcy5faGVpZ2h0O1xuICAgICAgICB9XG4gICAgfSxcbiAgICByaWdodDoge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sZWZ0ICsgdGhpcy5fd2lkdGg7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuZnVuY3Rpb24gZ2V0Q29vcmRpbmF0ZURlc2NyaXB0b3IgKGNvb3JkLCBhc3NvY2lhdGVkRGltZW5zaW9uKVxue1xuICAgIGNvbnN0IHByaXZhdGVQcm9wID0gJ18nICsgY29vcmQ7XG4gICAgY29uc3Qgc291cmNlID0gJ3Njcm9sbCcgKyBjb29yZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGNvb3JkLnNsaWNlKDEpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gdGhpc1twcml2YXRlUHJvcF07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKG5ld1ZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgbm9ybWFsaXplZDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2lubmVyRGltZW5zaW9ucylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXhBbGxvd2VkID0gdGhpcy5faW5uZXJEaW1lbnNpb25zW2Fzc29jaWF0ZWREaW1lbnNpb25dIC0gdGhpc1thc3NvY2lhdGVkRGltZW5zaW9uXTtcbiAgICAgICAgICAgICAgICBub3JtYWxpemVkID0gY2xhbXAobmV3VmFsdWUsIDAsIG1heEFsbG93ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWQgPSBjbGFtcE1pbihuZXdWYWx1ZSwgMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXNbcHJpdmF0ZVByb3BdID0gdGhpcy5vdXRlcltzb3VyY2VdID0gbm9ybWFsaXplZDtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGdldERpbWVuc2lvbkRlc2NyaXB0b3IgKGRpbWVuKVxue1xuICAgIHJldHVybiB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXNbJ18nICsgZGltZW5dO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gZmFsbHNCZXR3ZWVuIChwb2ludCwgc3RhcnQsIGVuZClcbntcbiAgICByZXR1cm4gcG9pbnQgPj0gc3RhcnQgJiYgcG9pbnQgPD0gZW5kO1xufVxuXG5mdW5jdGlvbiBjbGFtcCAodmFsdWUsIG1pbiwgbWF4KVxue1xuICAgIHJldHVybiBjbGFtcE1pbihjbGFtcE1heCh2YWx1ZSwgbWF4KSwgbWluKTtcbn1cblxuZnVuY3Rpb24gY2xhbXBNaW4gKHZhbHVlLCBtaW4pXG57XG4gICAgcmV0dXJuIE1hdGgubWF4KHZhbHVlLCBtaW4pO1xufVxuXG5mdW5jdGlvbiBjbGFtcE1heCAodmFsdWUsIG1heClcbntcbiAgICByZXR1cm4gTWF0aC5taW4odmFsdWUsIG1heCk7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./source/js/viewport.js\n");

/***/ }),

/***/ 0:
/*!*****************************************************************************!*\
  !*** multi array.prototype.fill ./source/js/diva.js ./source/css/diva.scss ***!
  \*****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(/*! array.prototype.fill */"./node_modules/array.prototype.fill/index.js");
__webpack_require__(/*! ./source/js/diva.js */"./source/js/diva.js");
module.exports = __webpack_require__(/*! ./source/css/diva.scss */"./source/css/diva.scss");


/***/ })

/******/ });